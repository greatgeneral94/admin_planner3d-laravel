parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function Wc(a){return a&&a.__esModule?{d:a.default}:{d:a}}function mb(dest,source){Object.keys(source).forEach(function(key){if(key==="default"||key==="__esModule"){return}Object.defineProperty(dest,key,{enumerable:true,get:function get(){return source[key]}})});return dest}var ab=this;var AI={};function Xc(){if(!(this instanceof Xc))return new Xc;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var i=new Xc;for(var r in this)"function"!=typeof this[r]&&(i[r]=this[r]);return i}}var BI,Kq,Uh,ew,fw,CI,DI=false;function EI(e){console&&console.warn&&console.warn(e)}function Ua(){Ua.init.call(this)}function Xm(e){if("function"!=typeof e)throw new TypeError("The \"listener\" argument must be of type Function. Received type "+typeof e)}function gw(e){return void 0===e._maxListeners?Ua.defaultMaxListeners:e._maxListeners}function hw(e,t,r,n){var i,s,$;if(Xm(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),$=s[t]),void 0===$)$=s[t]=r,++e._eventsCount;else if("function"==typeof $?$=s[t]=n?[r,$]:[$,r]:n?$.unshift(r):$.push(r),(i=gw(e))>0&&$.length>i&&!$.warned){$.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=$.length,EI(o)}return e}function FI(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function iw(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=FI.bind(n);return i.listener=r,n.wrapFn=i,i}function jw(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?HI(i):lw(i,i.length)}function kw(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function lw(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function GI(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function HI(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function II(e,t){return new Promise(function(r,n){function i(){void 0!==s&&e.removeListener("error",s),r([].slice.call(arguments))}var s;"error"!==t&&(s=function(r){e.removeListener(t,i),n(r)},e.once("error",s)),e.once(t,i)})}function Lq(){if(DI)return;DI=true;Kq={};Uh="object"==typeof Reflect?Reflect:null;ew=Uh&&"function"==typeof Uh.apply?Uh.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};BI=Uh&&"function"==typeof Uh.ownKeys?Uh.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};fw=Number.isNaN||function(e){return e!=e};(Kq=Ua).once=II,Ua.EventEmitter=Ua,Ua.prototype._events=void 0,Ua.prototype._eventsCount=0,Ua.prototype._maxListeners=void 0;CI=10;Object.defineProperty(Ua,"defaultMaxListeners",{enumerable:!0,get:function(){return CI},set:function(e){if("number"!=typeof e||e<0||fw(e))throw new RangeError("The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received "+e+".");CI=e}}),Ua.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ua.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||fw(e))throw new RangeError("The value of \"n\" is out of range. It must be a non-negative number. Received "+e+".");return this._maxListeners=e,this},Ua.prototype.getMaxListeners=function(){return gw(this)},Ua.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var $=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw $.context=s,$}var o=i[e];if(void 0===o)return!1;if("function"==typeof o)ew(o,this,t);else{var v=o.length,a=lw(o,v);for(r=0;r<v;++r)ew(a[r],this,t)}return!0},Ua.prototype.addListener=function(e,t){return hw(this,e,t,!1)},Ua.prototype.on=Ua.prototype.addListener,Ua.prototype.prependListener=function(e,t){return hw(this,e,t,!0)},Ua.prototype.once=function(e,t){return Xm(t),this.on(e,iw(this,e,t)),this},Ua.prototype.prependOnceListener=function(e,t){return Xm(t),this.prependListener(e,iw(this,e,t)),this},Ua.prototype.removeListener=function(e,t){var r,n,i,s,$;if(Xm(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){$=r[s].listener,i=s;break}if(i<0)return this;0===i?r.shift():GI(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,$||t)}return this},Ua.prototype.off=Ua.prototype.removeListener,Ua.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,s=Object.keys(r);for(n=0;n<s.length;++n)"removeListener"!==(i=s[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},Ua.prototype.listeners=function(e){return jw(this,e,!0)},Ua.prototype.rawListeners=function(e){return jw(this,e,!1)},Ua.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):kw.call(e,t)},Ua.prototype.listenerCount=kw,Ua.prototype.eventNames=function(){return this._eventsCount>0?BI(this._events):[]}}var Vh,JI=false;function Wh(){if(JI)return;JI=true;Vh={};Vh="function"==typeof Object.create?function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:function(t,e){if(e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t}}}var Xh,Yh,Mq,Cb,ik,Fg,Nq,mw,KI=false;function Oq(){throw new Error("setTimeout has not been defined")}function Pq(){throw new Error("clearTimeout has not been defined")}function nw($){if(Xh===setTimeout)return setTimeout($,0);if((Xh===Oq||!Xh)&&setTimeout)return Xh=setTimeout,setTimeout($,0);try{return Xh($,0)}catch(e){try{return Xh.call(null,$,0)}catch(e){return Xh.call(this,$,0)}}}function LI($){if(Yh===clearTimeout)return clearTimeout($);if((Yh===Pq||!Yh)&&clearTimeout)return Yh=clearTimeout,clearTimeout($);try{return Yh($)}catch(e){try{return Yh.call(null,$)}catch(e){return Yh.call(this,$)}}}function MI(){Nq&&ik&&(Nq=!1,ik.length?Fg=ik.concat(Fg):mw=-1,Fg.length&&ow())}function ow(){if(!Nq){var $=nw(MI);Nq=!0;for(var e=Fg.length;e;){for(ik=Fg,Fg=[];++mw<e;)ik&&ik[mw].run();mw=-1,e=Fg.length}ik=null,Nq=!1,LI($)}}function pw($,e){this.fun=$,this.array=e}function De(){}function Qq(){if(KI)return;KI=true;Mq={};Cb=Mq={};!function(){try{Xh="function"==typeof setTimeout?setTimeout:Oq}catch($){Xh=Oq}try{Yh="function"==typeof clearTimeout?clearTimeout:Pq}catch($){Yh=Pq}}();Fg=[];Nq=!1;mw=-1;Cb.nextTick=function($){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Fg.push(new pw($,e)),1!==Fg.length||Nq||nw(ow)},pw.prototype.run=function(){this.fun.apply(null,this.array)},Cb.title="browser",Cb.env={},Cb.argv=[],Cb.version="",Cb.versions={},Cb.on=De,Cb.addListener=De,Cb.once=De,Cb.off=De,Cb.removeListener=De,Cb.removeAllListeners=De,Cb.emit=De,Cb.prependListener=De,Cb.prependOnceListener=De,Cb.listeners=function($){return[]},Cb.binding=function($){throw new Error("process.binding is not supported")},Cb.cwd=function(){return"/"},Cb.chdir=function($){throw new Error("process.chdir is not supported")},Cb.umask=function(){return 0}}var Ym,vd,NI=false;function OI(r,e,$,n){if("function"!=typeof r)throw new TypeError("\"callback\" argument must be a function");var v,c,s=arguments.length;switch(s){case 0:case 1:return vd.nextTick(r);case 2:return vd.nextTick(function(){r.call(null,e)});case 3:return vd.nextTick(function(){r.call(null,e,$)});case 4:return vd.nextTick(function(){r.call(null,e,$,n)});default:for(v=new Array(s-1),c=0;c<v.length;)v[c++]=arguments[c];return vd.nextTick(function(){r.apply(null,v)});}}function Zm(){if(NI)return;NI=true;Ym={};vd=(Qq(),Mq);Ym=void 0===vd||!vd.version||0===vd.version.indexOf("v0.")||0===vd.version.indexOf("v1.")&&0!==vd.version.indexOf("v1.8.")?{nextTick:OI}:vd}var qw,PI,QI=false;function rw(){if(QI)return;QI=true;qw={};PI={}.toString;qw=Array.isArray||function(r){return"[object Array]"==PI.call(r)}}var sw,RI=false;function tw(){if(RI)return;RI=true;sw={};sw=(Lq(),Kq).EventEmitter}var $m,SI,TI,UI,VI=false;function uw($){var r=$.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var p=$.indexOf("=");return-1===p&&(p=r),[p,p===r?0:4-p%4]}function WI($){var r=uw($),p=r[0],o=r[1];return 3*(p+o)/4-o}function XI($,r,p){return 3*(r+p)/4-p}function YI($){var r,p,o=uw($),e=o[0],y=o[1],h=new $yh9p$var$Arr(XI($,e,y)),a=0,t=y>0?e-4:e;for(p=0;p<t;p+=4)r=$yh9p$var$revLookup[$.charCodeAt(p)]<<18|$yh9p$var$revLookup[$.charCodeAt(p+1)]<<12|$yh9p$var$revLookup[$.charCodeAt(p+2)]<<6|$yh9p$var$revLookup[$.charCodeAt(p+3)],h[a++]=r>>16&255,h[a++]=r>>8&255,h[a++]=255&r;return 2===y&&(r=$yh9p$var$revLookup[$.charCodeAt(p)]<<2|$yh9p$var$revLookup[$.charCodeAt(p+1)]>>4,h[a++]=255&r),1===y&&(r=$yh9p$var$revLookup[$.charCodeAt(p)]<<10|$yh9p$var$revLookup[$.charCodeAt(p+1)]<<4|$yh9p$var$revLookup[$.charCodeAt(p+2)]>>2,h[a++]=r>>8&255,h[a++]=255&r),h}function ZI($){return $yh9p$var$lookup[$>>18&63]+$yh9p$var$lookup[$>>12&63]+$yh9p$var$lookup[$>>6&63]+$yh9p$var$lookup[63&$]}function $I($,r,p){for(var o,e=[],y=r;y<p;y+=3)o=($[y]<<16&16711680)+($[y+1]<<8&65280)+(255&$[y+2]),e.push(ZI(o));return e.join("")}function _I($){for(var r,p=$.length,o=p%3,e=[],y=0,h=p-o;y<h;y+=16383)e.push($I($,y,y+16383>h?h:y+16383));return 1===o?(r=$[p-1],e.push($yh9p$var$lookup[r>>2]+$yh9p$var$lookup[r<<4&63]+"==")):2===o&&(r=($[p-2]<<8)+$[p-1],e.push($yh9p$var$lookup[r>>10]+$yh9p$var$lookup[r>>4&63]+$yh9p$var$lookup[r<<2&63]+"=")),e.join("")}function aJ(){if(VI)return;VI=true;$m={};SI=WI;$m.byteLength=SI;TI=YI;$m.toByteArray=TI;UI=_I;$m.fromByteArray=UI;for(var $yh9p$var$lookup=[],$yh9p$var$revLookup=[],$yh9p$var$Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,$yh9p$var$code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$yh9p$var$i=0,$yh9p$var$len=$yh9p$var$code.length;$yh9p$var$i<$yh9p$var$len;++$yh9p$var$i)$yh9p$var$lookup[$yh9p$var$i]=$yh9p$var$code[$yh9p$var$i],$yh9p$var$revLookup[$yh9p$var$code.charCodeAt($yh9p$var$i)]=$yh9p$var$i;$yh9p$var$revLookup["-".charCodeAt(0)]=62,$yh9p$var$revLookup["_".charCodeAt(0)]=63}var Rq,bJ,cJ,dJ=false;function eJ(){if(dJ)return;dJ=true;Rq={};bJ=function(t,r,o,a,$){var e,p,J=8*$-a-1,N=(1<<J)-1,h=N>>1,M=-7,w=o?$-1:0,f=o?-1:1,i=t[r+w];for(w+=f,e=i&(1<<-M)-1,i>>=-M,M+=J;M>0;e=256*e+t[r+w],w+=f,M-=8);for(p=e&(1<<-M)-1,e>>=-M,M+=a;M>0;p=256*p+t[r+w],w+=f,M-=8);if(0===e)e=1-h;else{if(e===N)return p?NaN:1/0*(i?-1:1);p+=Math.pow(2,a),e-=h}return(i?-1:1)*p*Math.pow(2,e-a)};Rq.read=bJ;cJ=function(t,r,o,a,$,e){var p,J,N,h=8*e-$-1,M=(1<<h)-1,w=M>>1,f=23===$?Math.pow(2,-24)-Math.pow(2,-77):0,i=a?0:e-1,g=a?1:-1,s=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(J=isNaN(r)?1:0,p=M):(p=Math.floor(Math.log(r)/Math.LN2),r*(N=Math.pow(2,-p))<1&&(p--,N*=2),(r+=p+w>=1?f/N:f*Math.pow(2,1-w))*N>=2&&(p++,N/=2),p+w>=M?(J=0,p=M):p+w>=1?(J=(r*N-1)*Math.pow(2,$),p+=w):(J=r*Math.pow(2,w-1)*Math.pow(2,$),p=0));$>=8;t[o+i]=255&J,i+=g,J/=256,$-=8);for(p=p<<$|J,h+=$;h>0;t[o+i]=255&p,i+=g,p/=256,h-=8);t[o+i-g]|=128*s};Rq.write=cJ}var Ee,Sq,Zh,vw,fJ,gJ,ww,hJ,xw,iJ,jJ=false;function kJ(){try{var r=new Uint8Array(1);return r.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===r.foo()&&"function"==typeof r.subarray&&0===r.subarray(1,1).byteLength}catch(e){return!1}}function _m(){return da.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Fe(r,e){if(_m()<e)throw new RangeError("Invalid typed array length");return da.TYPED_ARRAY_SUPPORT?(r=new Uint8Array(e)).__proto__=da.prototype:(null===r&&(r=new da(e)),r.length=e),r}function da(r,e,t){if(!(da.TYPED_ARRAY_SUPPORT||this instanceof da))return new da(r,e,t);if("number"==typeof r){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return Tq(this,r)}return yw(this,r,e,t)}function yw(r,e,t,$){if("number"==typeof e)throw new TypeError("\"value\" argument must not be a number");return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?nJ(r,e,t,$):"string"==typeof e?mJ(r,e,t):oJ(r,e)}function zw(r){if("number"!=typeof r)throw new TypeError("\"size\" argument must be a number");if(r<0)throw new RangeError("\"size\" argument must not be negative")}function lJ(r,e,t,$){return zw(e),e<=0?Fe(r,e):void 0!==t?"string"==typeof $?Fe(r,e).fill(t,$):Fe(r,e).fill(t):Fe(r,e)}function Tq(r,e){if(zw(e),r=Fe(r,e<0?0:0|Vq(e)),!da.TYPED_ARRAY_SUPPORT)for(var t=0;t<e;++t)r[t]=0;return r}function mJ(r,e,t){if("string"==typeof t&&""!==t||(t="utf8"),!da.isEncoding(t))throw new TypeError("\"encoding\" must be a valid string encoding");var $=0|Aw(e,t),n=(r=Fe(r,$)).write(e,t);return n!==$&&(r=r.slice(0,n)),r}function Uq(r,e){var t=e.length<0?0:0|Vq(e.length);r=Fe(r,t);for(var $=0;$<t;$+=1)r[$]=255&e[$];return r}function nJ(r,e,t,$){if(e.byteLength,t<0||e.byteLength<t)throw new RangeError("'offset' is out of bounds");if(e.byteLength<t+($||0))throw new RangeError("'length' is out of bounds");return e=void 0===t&&void 0===$?new Uint8Array(e):void 0===$?new Uint8Array(e,t):new Uint8Array(e,t,$),da.TYPED_ARRAY_SUPPORT?(r=e).__proto__=da.prototype:r=Uq(r,e),r}function oJ(r,e){if(da.isBuffer(e)){var t=0|Vq(e.length);return 0===(r=Fe(r,t)).length?r:(e.copy(r,0,0,t),r)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||HJ(e.length)?Fe(r,0):Uq(r,e);if("Buffer"===e.type&&vw(e.data))return Uq(r,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Vq(r){if(r>=_m())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+_m().toString(16)+" bytes");return 0|r}function pJ(r){return+r!=r&&(r=0),da.alloc(+r)}function Aw(r,e){if(da.isBuffer(r))return r.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(r)||r instanceof ArrayBuffer))return r.byteLength;"string"!=typeof r&&(r=""+r);var t=r.length;if(0===t)return 0;for(var $=!1;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":case void 0:return cn(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*t;case"hex":return t>>>1;case"base64":return Iw(r).length;default:if($)return cn(r).length;e=(""+e).toLowerCase(),$=!0;}}function qJ(r,e,t){var $=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===t||t>this.length)&&(t=this.length),t<=0)return"";if((t>>>=0)<=(e>>>=0))return"";for(r||(r="utf8");;)switch(r){case"hex":return AJ(this,e,t);case"utf8":case"utf-8":return Ew(this,e,t);case"ascii":return yJ(this,e,t);case"latin1":case"binary":return zJ(this,e,t);case"base64":return wJ(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return BJ(this,e,t);default:if($)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),$=!0;}}function Gg(r,e,t){var $=r[e];r[e]=r[t],r[t]=$}function Bw(r,e,t,$,n){if(0===r.length)return-1;if("string"==typeof t?($=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,isNaN(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0){if(!n)return-1;t=0}if("string"==typeof e&&(e=da.from(e,$)),da.isBuffer(e))return 0===e.length?-1:Cw(r,e,t,$,n);if("number"==typeof e)return e&=255,da.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):Cw(r,[e],t,$,n);throw new TypeError("val must be string, number or Buffer")}function Cw(r,e,t,$,n){var s,f=1,h=r.length,a=e.length;if(void 0!==$&&("ucs2"===($=String($).toLowerCase())||"ucs-2"===$||"utf16le"===$||"utf-16le"===$)){if(r.length<2||e.length<2)return-1;f=2,h/=2,a/=2,t/=2}function i(r,e){return 1===f?r[e]:r.readUInt16BE(e*f)}if(n){var o=-1;for(s=t;s<h;s++)if(i(r,s)===i(e,-1===o?0:s-o)){if(-1===o&&(o=s),s-o+1===a)return o*f}else-1!==o&&(s-=s-o),o=-1}else for(t+a>h&&(t=h-a),s=t;s>=0;s--){for(var u=!0,d=0;d<a;d++)if(i(r,s+d)!==i(e,d)){u=!1;break}if(u)return s}return-1}function rJ(r,e,t,$){t=Number(t)||0;var n=r.length-t;$?($=Number($))>n&&($=n):$=n;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");$>s/2&&($=s/2);for(var f=0;f<$;++f){var h=parseInt(e.substr(2*f,2),16);if(isNaN(h))return f;r[t+f]=h}return f}function sJ(r,e,t,$){return dn(cn(e,r.length-t),r,t,$)}function Dw(r,e,t,$){return dn(FJ(e),r,t,$)}function tJ(r,e,t,$){return Dw(r,e,t,$)}function uJ(r,e,t,$){return dn(Iw(e),r,t,$)}function vJ(r,e,t,$){return dn(GJ(e,r.length-t),r,t,$)}function wJ(r,e,t){return 0===e&&t===r.length?Sq.fromByteArray(r):Sq.fromByteArray(r.slice(e,t))}function Ew(r,e,t){t=Math.min(r.length,t);for(var $=[],n=e;n<t;){var s,f,h,a,i=r[n],o=null,u=i>239?4:i>223?3:i>191?2:1;if(n+u<=t)switch(u){case 1:i<128&&(o=i);break;case 2:128==(192&(s=r[n+1]))&&(a=(31&i)<<6|63&s)>127&&(o=a);break;case 3:s=r[n+1],f=r[n+2],128==(192&s)&&128==(192&f)&&(a=(15&i)<<12|(63&s)<<6|63&f)>2047&&(a<55296||a>57343)&&(o=a);break;case 4:s=r[n+1],f=r[n+2],h=r[n+3],128==(192&s)&&128==(192&f)&&128==(192&h)&&(a=(15&i)<<18|(63&s)<<12|(63&f)<<6|63&h)>65535&&a<1114112&&(o=a);}null===o?(o=65533,u=1):o>65535&&(o-=65536,$.push(o>>>10&1023|55296),o=56320|1023&o),$.push(o),n+=u}return xJ($)}function xJ(r){var e=r.length;if(e<=xw)return String.fromCharCode.apply(String,r);for(var t="",$=0;$<e;)t+=String.fromCharCode.apply(String,r.slice($,$+=xw));return t}function yJ(r,e,t){var $="";t=Math.min(r.length,t);for(var n=e;n<t;++n)$+=String.fromCharCode(127&r[n]);return $}function zJ(r,e,t){var $="";t=Math.min(r.length,t);for(var n=e;n<t;++n)$+=String.fromCharCode(r[n]);return $}function AJ(r,e,t){var $=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>$)&&(t=$);for(var n="",s=e;s<t;++s)n+=EJ(r[s]);return n}function BJ(r,e,t){for(var $=r.slice(e,t),n="",s=0;s<$.length;s+=2)n+=String.fromCharCode($[s]+256*$[s+1]);return n}function Tb(r,e,t){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}function qc(r,e,t,$,n,s){if(!da.isBuffer(r))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(e>n||e<s)throw new RangeError("\"value\" argument is out of bounds");if(t+$>r.length)throw new RangeError("Index out of range")}function an(r,e,t,$){e<0&&(e=65535+e+1);for(var n=0,s=Math.min(r.length-t,2);n<s;++n)r[t+n]=(e&255<<8*($?n:1-n))>>>8*($?n:1-n)}function bn(r,e,t,$){e<0&&(e=4294967295+e+1);for(var n=0,s=Math.min(r.length-t,4);n<s;++n)r[t+n]=e>>>8*($?n:3-n)&255}function Fw(r,e,t,$,n,s){if(t+$>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function Gw(r,e,t,$,n){return n||Fw(r,e,t,4,3.4028234663852886e38,-3.4028234663852886e38),Zh.write(r,e,t,$,23,4),t+4}function Hw(r,e,t,$,n){return n||Fw(r,e,t,8,1.7976931348623157e308,-1.7976931348623157e308),Zh.write(r,e,t,$,52,8),t+8}function CJ(r){if((r=DJ(r).replace(iJ,"")).length<2)return"";for(;r.length%4!=0;)r+="=";return r}function DJ(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function EJ(r){return r<16?"0"+r.toString(16):r.toString(16)}function cn(r,e){var t;e=e||1/0;for(var $=r.length,n=null,s=[],f=0;f<$;++f){if((t=r.charCodeAt(f))>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(f+1===$){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=65536+(n-55296<<10|t-56320)}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,63&t|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return s}function FJ(r){for(var e=[],t=0;t<r.length;++t)e.push(255&r.charCodeAt(t));return e}function GJ(r,e){for(var t,$,n,s=[],f=0;f<r.length&&!((e-=2)<0);++f)$=(t=r.charCodeAt(f))>>8,n=t%256,s.push(n),s.push($);return s}function Iw(r){return Sq.toByteArray(CJ(r))}function dn(r,e,t,$){for(var n=0;n<$&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function HJ(r){return r!=r}function jk(){if(jJ)return;jJ=true;Ee={};Sq=(aJ(),$m);Zh=(eJ(),Rq);vw=(rw(),qw);fJ=da;Ee.Buffer=fJ;gJ=pJ;Ee.SlowBuffer=gJ;ww=50;Ee.INSPECT_MAX_BYTES=ww,da.TYPED_ARRAY_SUPPORT=void 0!==ab.TYPED_ARRAY_SUPPORT?ab.TYPED_ARRAY_SUPPORT:kJ();hJ=_m();Ee.kMaxLength=hJ,da.poolSize=8192,da._augment=function(r){return r.__proto__=da.prototype,r},da.from=function(r,e,t){return yw(null,r,e,t)},da.TYPED_ARRAY_SUPPORT&&(da.prototype.__proto__=Uint8Array.prototype,da.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&da[Symbol.species]===da&&Object.defineProperty(da,Symbol.species,{value:null,configurable:!0})),da.alloc=function(r,e,t){return lJ(null,r,e,t)},da.allocUnsafe=function(r){return Tq(null,r)},da.allocUnsafeSlow=function(r){return Tq(null,r)},da.isBuffer=function(r){return!(null==r||!r._isBuffer)},da.compare=function(r,e){if(!da.isBuffer(r)||!da.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(r===e)return 0;for(var t=r.length,$=e.length,n=0,s=Math.min(t,$);n<s;++n)if(r[n]!==e[n]){t=r[n],$=e[n];break}return t<$?-1:$<t?1:0},da.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},da.concat=function(r,e){if(!vw(r))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===r.length)return da.alloc(0);var t;if(void 0===e)for(e=0,t=0;t<r.length;++t)e+=r[t].length;var $=da.allocUnsafe(e),n=0;for(t=0;t<r.length;++t){var s=r[t];if(!da.isBuffer(s))throw new TypeError("\"list\" argument must be an Array of Buffers");s.copy($,n),n+=s.length}return $},da.byteLength=Aw,da.prototype._isBuffer=!0,da.prototype.swap16=function(){var r=this.length;if(r%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<r;e+=2)Gg(this,e,e+1);return this},da.prototype.swap32=function(){var r=this.length;if(r%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<r;e+=4)Gg(this,e,e+3),Gg(this,e+1,e+2);return this},da.prototype.swap64=function(){var r=this.length;if(r%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<r;e+=8)Gg(this,e,e+7),Gg(this,e+1,e+6),Gg(this,e+2,e+5),Gg(this,e+3,e+4);return this},da.prototype.toString=function(){var r=0|this.length;return 0===r?"":0===arguments.length?Ew(this,0,r):qJ.apply(this,arguments)},da.prototype.equals=function(r){if(!da.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r||0===da.compare(this,r)},da.prototype.inspect=function(){var r="",e=ww;return this.length>0&&(r=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(r+=" ... ")),"<Buffer "+r+">"},da.prototype.compare=function(r,e,t,$,n){if(!da.isBuffer(r))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===t&&(t=r?r.length:0),void 0===$&&($=0),void 0===n&&(n=this.length),e<0||t>r.length||$<0||n>this.length)throw new RangeError("out of range index");if($>=n&&e>=t)return 0;if($>=n)return-1;if(e>=t)return 1;if(this===r)return 0;for(var s=(n>>>=0)-($>>>=0),f=(t>>>=0)-(e>>>=0),h=Math.min(s,f),a=this.slice($,n),i=r.slice(e,t),o=0;o<h;++o)if(a[o]!==i[o]){s=a[o],f=i[o];break}return s<f?-1:f<s?1:0},da.prototype.includes=function(r,e,t){return-1!==this.indexOf(r,e,t)},da.prototype.indexOf=function(r,e,t){return Bw(this,r,e,t,!0)},da.prototype.lastIndexOf=function(r,e,t){return Bw(this,r,e,t,!1)},da.prototype.write=function(r,e,t,$){if(void 0===e)$="utf8",t=this.length,e=0;else if(void 0===t&&"string"==typeof e)$=e,t=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(t)?(t|=0,void 0===$&&($="utf8")):($=t,t=void 0)}var n=this.length-e;if((void 0===t||t>n)&&(t=n),r.length>0&&(t<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");$||($="utf8");for(var s=!1;;)switch($){case"hex":return rJ(this,r,e,t);case"utf8":case"utf-8":return sJ(this,r,e,t);case"ascii":return Dw(this,r,e,t);case"latin1":case"binary":return tJ(this,r,e,t);case"base64":return uJ(this,r,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return vJ(this,r,e,t);default:if(s)throw new TypeError("Unknown encoding: "+$);$=(""+$).toLowerCase(),s=!0;}},da.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};xw=4096;da.prototype.slice=function(r,e){var t,$=this.length;if((r=~~r)<0?(r+=$)<0&&(r=0):r>$&&(r=$),(e=void 0===e?$:~~e)<0?(e+=$)<0&&(e=0):e>$&&(e=$),e<r&&(e=r),da.TYPED_ARRAY_SUPPORT)(t=this.subarray(r,e)).__proto__=da.prototype;else{var n=e-r;t=new da(n,void 0);for(var s=0;s<n;++s)t[s]=this[s+r]}return t},da.prototype.readUIntLE=function(r,e,t){r|=0,e|=0,t||Tb(r,e,this.length);for(var $=this[r],n=1,s=0;++s<e&&(n*=256);)$+=this[r+s]*n;return $},da.prototype.readUIntBE=function(r,e,t){r|=0,e|=0,t||Tb(r,e,this.length);for(var $=this[r+--e],n=1;e>0&&(n*=256);)$+=this[r+--e]*n;return $},da.prototype.readUInt8=function(r,e){return e||Tb(r,1,this.length),this[r]},da.prototype.readUInt16LE=function(r,e){return e||Tb(r,2,this.length),this[r]|this[r+1]<<8},da.prototype.readUInt16BE=function(r,e){return e||Tb(r,2,this.length),this[r]<<8|this[r+1]},da.prototype.readUInt32LE=function(r,e){return e||Tb(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+16777216*this[r+3]},da.prototype.readUInt32BE=function(r,e){return e||Tb(r,4,this.length),16777216*this[r]+(this[r+1]<<16|this[r+2]<<8|this[r+3])},da.prototype.readIntLE=function(r,e,t){r|=0,e|=0,t||Tb(r,e,this.length);for(var $=this[r],n=1,s=0;++s<e&&(n*=256);)$+=this[r+s]*n;return $>=(n*=128)&&($-=Math.pow(2,8*e)),$},da.prototype.readIntBE=function(r,e,t){r|=0,e|=0,t||Tb(r,e,this.length);for(var $=e,n=1,s=this[r+--$];$>0&&(n*=256);)s+=this[r+--$]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*e)),s},da.prototype.readInt8=function(r,e){return e||Tb(r,1,this.length),128&this[r]?-1*(255-this[r]+1):this[r]},da.prototype.readInt16LE=function(r,e){e||Tb(r,2,this.length);var t=this[r]|this[r+1]<<8;return 32768&t?4294901760|t:t},da.prototype.readInt16BE=function(r,e){e||Tb(r,2,this.length);var t=this[r+1]|this[r]<<8;return 32768&t?4294901760|t:t},da.prototype.readInt32LE=function(r,e){return e||Tb(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},da.prototype.readInt32BE=function(r,e){return e||Tb(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},da.prototype.readFloatLE=function(r,e){return e||Tb(r,4,this.length),Zh.read(this,r,!0,23,4)},da.prototype.readFloatBE=function(r,e){return e||Tb(r,4,this.length),Zh.read(this,r,!1,23,4)},da.prototype.readDoubleLE=function(r,e){return e||Tb(r,8,this.length),Zh.read(this,r,!0,52,8)},da.prototype.readDoubleBE=function(r,e){return e||Tb(r,8,this.length),Zh.read(this,r,!1,52,8)},da.prototype.writeUIntLE=function(r,e,t,$){(r=+r,e|=0,t|=0,$)||qc(this,r,e,t,Math.pow(2,8*t)-1,0);var n=1,s=0;for(this[e]=255&r;++s<t&&(n*=256);)this[e+s]=r/n&255;return e+t},da.prototype.writeUIntBE=function(r,e,t,$){(r=+r,e|=0,t|=0,$)||qc(this,r,e,t,Math.pow(2,8*t)-1,0);var n=t-1,s=1;for(this[e+n]=255&r;--n>=0&&(s*=256);)this[e+n]=r/s&255;return e+t},da.prototype.writeUInt8=function(r,e,t){return r=+r,e|=0,t||qc(this,r,e,1,255,0),da.TYPED_ARRAY_SUPPORT||(r=Math.floor(r)),this[e]=255&r,e+1},da.prototype.writeUInt16LE=function(r,e,t){return r=+r,e|=0,t||qc(this,r,e,2,65535,0),da.TYPED_ARRAY_SUPPORT?(this[e]=255&r,this[e+1]=r>>>8):an(this,r,e,!0),e+2},da.prototype.writeUInt16BE=function(r,e,t){return r=+r,e|=0,t||qc(this,r,e,2,65535,0),da.TYPED_ARRAY_SUPPORT?(this[e]=r>>>8,this[e+1]=255&r):an(this,r,e,!1),e+2},da.prototype.writeUInt32LE=function(r,e,t){return r=+r,e|=0,t||qc(this,r,e,4,4294967295,0),da.TYPED_ARRAY_SUPPORT?(this[e+3]=r>>>24,this[e+2]=r>>>16,this[e+1]=r>>>8,this[e]=255&r):bn(this,r,e,!0),e+4},da.prototype.writeUInt32BE=function(r,e,t){return r=+r,e|=0,t||qc(this,r,e,4,4294967295,0),da.TYPED_ARRAY_SUPPORT?(this[e]=r>>>24,this[e+1]=r>>>16,this[e+2]=r>>>8,this[e+3]=255&r):bn(this,r,e,!1),e+4},da.prototype.writeIntLE=function(r,e,t,$){if(r=+r,e|=0,!$){var n=Math.pow(2,8*t-1);qc(this,r,e,t,n-1,-n)}var s=0,f=1,h=0;for(this[e]=255&r;++s<t&&(f*=256);)r<0&&0===h&&0!==this[e+s-1]&&(h=1),this[e+s]=(r/f>>0)-h&255;return e+t},da.prototype.writeIntBE=function(r,e,t,$){if(r=+r,e|=0,!$){var n=Math.pow(2,8*t-1);qc(this,r,e,t,n-1,-n)}var s=t-1,f=1,h=0;for(this[e+s]=255&r;--s>=0&&(f*=256);)r<0&&0===h&&0!==this[e+s+1]&&(h=1),this[e+s]=(r/f>>0)-h&255;return e+t},da.prototype.writeInt8=function(r,e,t){return r=+r,e|=0,t||qc(this,r,e,1,127,-128),da.TYPED_ARRAY_SUPPORT||(r=Math.floor(r)),r<0&&(r=255+r+1),this[e]=255&r,e+1},da.prototype.writeInt16LE=function(r,e,t){return r=+r,e|=0,t||qc(this,r,e,2,32767,-32768),da.TYPED_ARRAY_SUPPORT?(this[e]=255&r,this[e+1]=r>>>8):an(this,r,e,!0),e+2},da.prototype.writeInt16BE=function(r,e,t){return r=+r,e|=0,t||qc(this,r,e,2,32767,-32768),da.TYPED_ARRAY_SUPPORT?(this[e]=r>>>8,this[e+1]=255&r):an(this,r,e,!1),e+2},da.prototype.writeInt32LE=function(r,e,t){return r=+r,e|=0,t||qc(this,r,e,4,2147483647,-2147483648),da.TYPED_ARRAY_SUPPORT?(this[e]=255&r,this[e+1]=r>>>8,this[e+2]=r>>>16,this[e+3]=r>>>24):bn(this,r,e,!0),e+4},da.prototype.writeInt32BE=function(r,e,t){return r=+r,e|=0,t||qc(this,r,e,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),da.TYPED_ARRAY_SUPPORT?(this[e]=r>>>24,this[e+1]=r>>>16,this[e+2]=r>>>8,this[e+3]=255&r):bn(this,r,e,!1),e+4},da.prototype.writeFloatLE=function(r,e,t){return Gw(this,r,e,!0,t)},da.prototype.writeFloatBE=function(r,e,t){return Gw(this,r,e,!1,t)},da.prototype.writeDoubleLE=function(r,e,t){return Hw(this,r,e,!0,t)},da.prototype.writeDoubleBE=function(r,e,t){return Hw(this,r,e,!1,t)},da.prototype.copy=function(r,e,t,$){if(t||(t=0),$||0===$||($=this.length),e>=r.length&&(e=r.length),e||(e=0),$>0&&$<t&&($=t),$===t)return 0;if(0===r.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("sourceStart out of bounds");if($<0)throw new RangeError("sourceEnd out of bounds");$>this.length&&($=this.length),r.length-e<$-t&&($=r.length-e+t);var n,s=$-t;if(this===r&&t<e&&e<$)for(n=s-1;n>=0;--n)r[n+e]=this[n+t];else if(s<1e3||!da.TYPED_ARRAY_SUPPORT)for(n=0;n<s;++n)r[n+e]=this[n+t];else Uint8Array.prototype.set.call(r,this.subarray(t,t+s),e);return s},da.prototype.fill=function(r,e,t,$){if("string"==typeof r){if("string"==typeof e?($=e,e=0,t=this.length):"string"==typeof t&&($=t,t=this.length),1===r.length){var n=r.charCodeAt(0);n<256&&(r=n)}if(void 0!==$&&"string"!=typeof $)throw new TypeError("encoding must be a string");if("string"==typeof $&&!da.isEncoding($))throw new TypeError("Unknown encoding: "+$)}else"number"==typeof r&&(r&=255);if(e<0||this.length<e||this.length<t)throw new RangeError("Out of range index");if(t<=e)return this;var s;if(e>>>=0,t=void 0===t?this.length:t>>>0,r||(r=0),"number"==typeof r)for(s=e;s<t;++s)this[s]=r;else{var f=da.isBuffer(r)?r:cn(new da(r,$).toString()),h=f.length;for(s=0;s<t-e;++s)this[s+e]=f[s%h]}return this};iJ=/[^+\/0-9A-Za-z-_]/g}var IJ,$h,en,Ge,JJ=false;function Jw(r,$){for(var f in r)$[f]=r[f]}function _h(r,$,f){return Ge(r,$,f)}function fn(){if(JJ)return;JJ=true;$h={};en=(jk(),Ee);Ge=en.Buffer;Ge.from&&Ge.alloc&&Ge.allocUnsafe&&Ge.allocUnsafeSlow?$h=en:(Jw(en,$h),IJ=_h,$h.Buffer=IJ),Jw(Ge,_h),_h.from=function(r,$,f){if("number"==typeof r)throw new TypeError("Argument must not be a number");return Ge(r,$,f)},_h.alloc=function(r,$,f){if("number"!=typeof r)throw new TypeError("Argument must be a number");var e=Ge(r);return void 0!==$?"string"==typeof f?e.fill($,f):e.fill($):e.fill(0),e},_h.allocUnsafe=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return Ge(r)},_h.allocUnsafeSlow=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return en.SlowBuffer(r)}}var Db,KJ,LJ,MJ,NJ,OJ,PJ,QJ,RJ,SJ,TJ,UJ,VJ,WJ,XJ,YJ,ZJ,$J=false;function _J($){return Array.isArray?Array.isArray($):"[object Array]"===gn($)}function aK($){return"boolean"==typeof $}function bK($){return null===$}function cK($){return null==$}function dK($){return"number"==typeof $}function eK($){return"string"==typeof $}function fK($){return"symbol"==typeof $}function gK($){return void 0===$}function hK($){return"[object RegExp]"===gn($)}function iK($){return"object"==typeof $&&null!==$}function jK($){return"[object Date]"===gn($)}function kK($){return"[object Error]"===gn($)||$ instanceof Error}function lK($){return"function"==typeof $}function mK($){return null===$||"boolean"==typeof $||"number"==typeof $||"string"==typeof $||"symbol"==typeof $||void 0===$}function gn($){return Object.prototype.toString.call($)}function kk(){if($J)return;$J=true;Db={};KJ=(jk(),Ee).Buffer;LJ=_J;Db.isArray=LJ;MJ=aK;Db.isBoolean=MJ;NJ=bK;Db.isNull=NJ;OJ=cK;Db.isNullOrUndefined=OJ;PJ=dK;Db.isNumber=PJ;QJ=eK;Db.isString=QJ;RJ=fK;Db.isSymbol=RJ;SJ=gK;Db.isUndefined=SJ;TJ=hK;Db.isRegExp=TJ;UJ=iK;Db.isObject=UJ;VJ=jK;Db.isDate=VJ;WJ=kK;Db.isError=WJ;XJ=lK;Db.isFunction=XJ;YJ=mK;Db.isPrimitive=YJ;ZJ=KJ.isBuffer;Db.isBuffer=ZJ}var nK=false;function Kw(){if(nK)return;nK=true}var Lw,Mw,lk,oK=false;function pK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qK(t,e,a){t.copy(e,a)}function rK(){if(oK)return;oK=true;Lw={};Mw=(fn(),$h).Buffer;lk=(Kw(),{});Lw=function(){function t(){pK(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,a=""+e.data;e=e.next;)a+=t+e.data;return a},t.prototype.concat=function(t){if(0===this.length)return Mw.alloc(0);if(1===this.length)return this.head.data;for(var e=Mw.allocUnsafe(t>>>0),a=this.head,i=0;a;)qK(a.data,e,i),i+=a.data.length,a=a.next;return e},t}(),lk&&lk.inspect&&lk.inspect.custom&&(Lw.prototype[lk.inspect.custom]=function(){var t=lk.inspect({length:this.length});return this.constructor.name+" "+t})}var Nw,Ow,sK=false;function tK(t,e){var a=this,r=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return r||i?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||Ow.nextTick(Pw,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(Ow.nextTick(Pw,a,t),a._writableState&&(a._writableState.errorEmitted=!0)):e&&e(t)}),this)}function uK(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Pw(t,e){t.emit("error",e)}function Qw(){if(sK)return;sK=true;Nw={};Ow=(Zm(),Ym);Nw={destroy:tK,undestroy:uK}}var vK,wK=false;function xK(r,o){if(Wq("noDeprecation"))return r;var e=!1;return function(){if(!e){if(Wq("throwDeprecation"))throw new Error(o);Wq("traceDeprecation")?console.trace(o):console.warn(o),e=!0}return r.apply(this,arguments)}}function Wq(r){try{if(!ab.localStorage)return!1}catch(e){return!1}var o=ab.localStorage[r];return null!=o&&"true"===String(o).toLowerCase()}function yK(){if(wK)return;wK=true;vK={};vK=xK}var Xq,a,Hg,hn,zK,Rw,AK,Sw,jn,BK,Tw,Uw,CK=false;function Vw(e){var r=this;this.next=null,this.entry=null,this.finish=function(){RK(r,e)}}function DK(e){return jn.from(e)}function EK(e){return jn.isBuffer(e)||e instanceof BK}function FK(){}function mk(e,r){hn=hn||(Jg(),Ig),e=e||{};var t=r instanceof hn;this.objectMode=!!e.objectMode,t&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,n=e.writableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:t&&(n||0===n)?n:a,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var $=!1===e.decodeStrings;this.decodeStrings=!$,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){MK(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Vw(this)}function Eb(e){if(hn=hn||(Jg(),Ig),!(Tw.call(Eb,this)||this instanceof hn))return new Eb(e);this._writableState=new mk(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),Sw.call(this)}function GK(e,r){var t=new Error("write after end");e.emit("error",t),Hg.nextTick(r,t)}function HK(e,r,t,i){var n=!0,a=!1;return null===t?a=new TypeError("May not write null values to stream"):"string"==typeof t||void 0===t||r.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),Hg.nextTick(i,a),n=!1),n}function IK(e,r,t){return e.objectMode||!1===e.decodeStrings||"string"!=typeof r||(r=jn.from(r,t)),r}function JK(e,r,t,i,n,a){if(!t){var $=IK(r,i,n);i!==$&&(t=!0,n="buffer",i=$)}var o=r.objectMode?1:i.length;r.length+=o;var s=r.length<r.highWaterMark;if(s||(r.needDrain=!0),r.writing||r.corked){var f=r.lastBufferedRequest;r.lastBufferedRequest={chunk:i,encoding:n,isBuf:t,callback:a,next:null},f?f.next=r.lastBufferedRequest:r.bufferedRequest=r.lastBufferedRequest,r.bufferedRequestCount+=1}else Yq(e,r,!1,o,i,n,a);return s}function Yq(e,r,t,i,n,a,$){r.writelen=i,r.writecb=$,r.writing=!0,r.sync=!0,t?e._writev(n,r.onwrite):e._write(n,a,r.onwrite),r.sync=!1}function KK(e,r,t,i,n){--r.pendingcb,t?(Hg.nextTick(n,i),Hg.nextTick(nk,e,r),e._writableState.errorEmitted=!0,e.emit("error",i)):(n(i),e._writableState.errorEmitted=!0,e.emit("error",i),nk(e,r))}function LK(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function MK(e,r){var t=e._writableState,i=t.sync,n=t.writecb;if(LK(t),r)KK(e,t,i,r,n);else{var a=Yw(t);a||t.corked||t.bufferProcessing||!t.bufferedRequest||Xw(e,t),i?zK(Ww,e,t,a,n):Ww(e,t,a,n)}}function Ww(e,r,t,i){t||NK(e,r),r.pendingcb--,i(),nk(e,r)}function NK(e,r){0===r.length&&r.needDrain&&(r.needDrain=!1,e.emit("drain"))}function Xw(e,r){r.bufferProcessing=!0;var t=r.bufferedRequest;if(e._writev&&t&&t.next){var i=r.bufferedRequestCount,n=new Array(i),a=r.corkedRequestsFree;a.entry=t;for(var $=0,o=!0;t;)n[$]=t,t.isBuf||(o=!1),t=t.next,$+=1;n.allBuffers=o,Yq(e,r,!0,r.length,n,"",a.finish),r.pendingcb++,r.lastBufferedRequest=null,a.next?(r.corkedRequestsFree=a.next,a.next=null):r.corkedRequestsFree=new Vw(r),r.bufferedRequestCount=0}else{for(;t;){var s=t.chunk,f=t.encoding,u=t.callback;if(Yq(e,r,!1,r.objectMode?1:s.length,s,f,u),t=t.next,r.bufferedRequestCount--,r.writing)break}null===t&&(r.lastBufferedRequest=null)}r.bufferedRequest=t,r.bufferProcessing=!1}function Yw(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function OK(e,r){e._final(function(t){r.pendingcb--,t&&e.emit("error",t),r.prefinished=!0,e.emit("prefinish"),nk(e,r)})}function PK(e,r){r.prefinished||r.finalCalled||("function"==typeof e._final?(r.pendingcb++,r.finalCalled=!0,Hg.nextTick(OK,e,r)):(r.prefinished=!0,e.emit("prefinish")))}function nk(e,r){var t=Yw(r);return t&&(PK(e,r),0===r.pendingcb&&(r.finished=!0,e.emit("finish"))),t}function QK(e,r,t){r.ending=!0,nk(e,r),t&&(r.finished?Hg.nextTick(t):e.once("finish",t)),r.ended=!0,e.writable=!1}function RK(e,r,t){var i=e.entry;for(e.entry=null;i;){var n=i.callback;r.pendingcb--,n(t),i=i.next}r.corkedRequestsFree?r.corkedRequestsFree.next=e:r.corkedRequestsFree=e}function Zq(){if(CK)return;CK=true;Xq={};a=(Qq(),Mq);Hg=(Zm(),Ym);Xq=Eb;zK=Hg.nextTick;Eb.WritableState=mk;Rw=Object.create((kk(),Db));Rw.inherits=(Wh(),Vh);AK={deprecate:(yK(),vK)};Sw=(tw(),sw);jn=(fn(),$h).Buffer;BK=ab.Uint8Array||function(){};Uw=(Qw(),Nw);Rw.inherits(Eb,Sw),mk.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r},function(){try{Object.defineProperty(mk.prototype,"buffer",{get:AK.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(Tw=Function.prototype[Symbol.hasInstance],Object.defineProperty(Eb,Symbol.hasInstance,{value:function(e){return!!Tw.call(this,e)||this===Eb&&e&&e._writableState instanceof mk}})):Tw=function(e){return e instanceof this},Eb.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Eb.prototype.write=function(e,r,t){var i=this._writableState,n=!1,a=!i.objectMode&&EK(e);return a&&!jn.isBuffer(e)&&(e=DK(e)),"function"==typeof r&&(t=r,r=null),a?r="buffer":r||(r=i.defaultEncoding),"function"!=typeof t&&(t=FK),i.ended?GK(this,t):(a||HK(this,i,e,t))&&(i.pendingcb++,n=JK(this,i,a,e,r,t)),n},Eb.prototype.cork=function(){this._writableState.corked++},Eb.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||Xw(this,e))},Eb.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(Eb.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Eb.prototype._write=function(e,r,t){t(new Error("_write() is not implemented"))},Eb.prototype._writev=null,Eb.prototype.end=function(e,r,t){var i=this._writableState;"function"==typeof e?(t=e,e=null,r=null):"function"==typeof r&&(t=r,r=null),null!=e&&this.write(e,r),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||QK(this,i,t)},Object.defineProperty(Eb.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),Eb.prototype.destroy=Uw.destroy,Eb.prototype._undestroy=Uw.undestroy,Eb.prototype._destroy=function(e,r){this.end(),r(e)}}var Ig,Zw,SK,$w,_w,$q,TK=false;function He(e){if(!(this instanceof He))return new He(e);_w.call(this,e),$q.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",UK)}function UK(){this.allowHalfOpen||this._writableState.ended||Zw.nextTick(VK,this)}function VK(e){e.end()}function Jg(){if(TK)return;TK=true;Ig={};Zw=(Zm(),Ym);SK=Object.keys||function(e){var $=[];for(var r in e)$.push(r);return $};Ig=He;$w=Object.create((kk(),Db));$w.inherits=(Wh(),Vh);_w=(qx(),cx);$q=(Zq(),Xq);$w.inherits(He,_w);for(var $wldW$var$keys=SK($q.prototype),$wldW$var$v=0;$wldW$var$v<$wldW$var$keys.length;$wldW$var$v++){var $wldW$var$method=$wldW$var$keys[$wldW$var$v];He.prototype[$wldW$var$method]||(He.prototype[$wldW$var$method]=$q.prototype[$wldW$var$method])}Object.defineProperty(He.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(He.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),He.prototype._destroy=function(e,$){this.push(null),this.end(),Zw.nextTick($,e)}}var _q,ar,ax,WK,XK=false;function YK(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0;}}function ZK(t){var e=YK(t);if("string"!=typeof e&&(ar.isEncoding===ax||!ax(t)))throw new Error("Unknown encoding: "+t);return e||t}function ok(t){var e;switch(this.encoding=ZK(t),this.encoding){case"utf16le":this.text=dL,this.end=eL,e=4;break;case"utf8":this.fillLast=aL,e=4;break;case"base64":this.text=fL,this.end=gL,e=3;break;default:return this.write=hL,void(this.end=iL);}this.lastNeed=0,this.lastTotal=0,this.lastChar=ar.allocUnsafe(e)}function br(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function $K(t,e,r){var a=e.length-1;if(a<r)return 0;var s=br(e[a]);return s>=0?(s>0&&(t.lastNeed=s-1),s):--a<r||-2===s?0:(s=br(e[a]))>=0?(s>0&&(t.lastNeed=s-2),s):--a<r||-2===s?0:(s=br(e[a]))>=0?(s>0&&(2===s?s=0:t.lastNeed=s-3),s):0}function _K(t,e,r){if(128!=(192&e[0]))return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"\uFFFD"}}function aL(t){var e=this.lastTotal-this.lastNeed,r=_K(this,t,e);return void 0!==r?r:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function bL(t,e){var r=$K(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var a=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,a),t.toString("utf8",e,a)}function cL(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function dL(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var a=r.charCodeAt(r.length-1);if(a>=55296&&a<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function eL(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function fL(t,e){var r=(t.length-e)%3;return 0===r?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function gL(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function hL(t){return t.toString(this.encoding)}function iL(t){return t&&t.length?this.write(t):""}function bx(){if(XK)return;XK=true;_q={};ar=(fn(),$h).Buffer;ax=ar.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1;}};WK=ok;_q.StringDecoder=WK,ok.prototype.write=function(t){if(0===t.length)return"";var e,r;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""},ok.prototype.end=cL,ok.prototype.text=bL,ok.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}}var cx,dx,ai,ex,jL,b,fx,cr,pk,kL,gx,dr,Sa,kn,lL,hx,er,ix,mL=false;function nL(e){return pk.from(e)}function oL(e){return pk.isBuffer(e)||e instanceof kL}function pL(e,r,a){if("function"==typeof e.prependListener)return e.prependListener(r,a);e._events&&e._events[r]?jL(e._events[r])?e._events[r].unshift(a):e._events[r]=[a,e._events[r]]:e.on(r,a)}function jx(e,r){e=e||{};var a=r instanceof(ex=ex||(Jg(),Ig));this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var t=e.highWaterMark,n=e.readableHighWaterMark,$=this.objectMode?16:16384;this.highWaterMark=t||0===t?t:a&&(n||0===n)?n:$,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new lL,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(kn||(kn=(bx(),_q).StringDecoder),this.decoder=new kn(e.encoding),this.encoding=e.encoding)}function db(e){if(ex=ex||(Jg(),Ig),!(this instanceof db))return new db(e);this._readableState=new jx(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),cr.call(this)}function kx(e,r,a,t,n){var $,i=e._readableState;null===r?(i.reading=!1,tL(e,i)):(n||($=qL(i,r)),$?e.emit("error",$):i.objectMode||r&&r.length>0?("string"==typeof r||i.objectMode||Object.getPrototypeOf(r)===pk.prototype||(r=nL(r)),t?i.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):fr(e,i,r,!0):i.ended?e.emit("error",new Error("stream.push() after EOF")):(i.reading=!1,i.decoder&&!a?(r=i.decoder.write(r),i.objectMode||0!==r.length?fr(e,i,r,!1):nx(e,i)):fr(e,i,r,!1))):t||(i.reading=!1));return rL(i)}function fr(e,r,a,t){r.flowing&&0===r.length&&!r.sync?(e.emit("data",a),e.read(0)):(r.length+=r.objectMode?1:a.length,t?r.buffer.unshift(a):r.buffer.push(a),r.needReadable&&ln(e)),nx(e,r)}function qL(e,r){var a;return oL(r)||"string"==typeof r||void 0===r||e.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a}function rL(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function sL(e){return e>=ix?e=ix:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function lx(e,r){return e<=0||0===r.length&&r.ended?0:r.objectMode?1:e!=e?r.flowing&&r.length?r.buffer.head.data.length:r.length:(e>r.highWaterMark&&(r.highWaterMark=sL(e)),e<=r.length?e:r.ended?r.length:(r.needReadable=!0,0))}function tL(e,r){if(!r.ended){if(r.decoder){var a=r.decoder.end();a&&a.length&&(r.buffer.push(a),r.length+=r.objectMode?1:a.length)}r.ended=!0,ln(e)}}function ln(e){var r=e._readableState;r.needReadable=!1,r.emittedReadable||(Sa("emitReadable",r.flowing),r.emittedReadable=!0,r.sync?ai.nextTick(mx,e):mx(e))}function mx(e){Sa("emit readable"),e.emit("readable"),gr(e)}function nx(e,r){r.readingMore||(r.readingMore=!0,ai.nextTick(uL,e,r))}function uL(e,r){for(var a=r.length;!r.reading&&!r.flowing&&!r.ended&&r.length<r.highWaterMark&&(Sa("maybeReadMore read 0"),e.read(0),a!==r.length);)a=r.length;r.readingMore=!1}function vL(e){return function(){var r=e._readableState;Sa("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,0===r.awaitDrain&&fx(e,"data")&&(r.flowing=!0,gr(e))}}function wL(e){Sa("readable nexttick read 0"),e.read(0)}function xL(e,r){r.resumeScheduled||(r.resumeScheduled=!0,ai.nextTick(yL,e,r))}function yL(e,r){r.reading||(Sa("resume read 0"),e.read(0)),r.resumeScheduled=!1,r.awaitDrain=0,e.emit("resume"),gr(e),r.flowing&&!r.reading&&e.read(0)}function gr(e){var r=e._readableState;for(Sa("flow",r.flowing);r.flowing&&null!==e.read(););}function ox(e,r){return 0===r.length?null:(r.objectMode?a=r.buffer.shift():!e||e>=r.length?(a=r.decoder?r.buffer.join(""):1===r.buffer.length?r.buffer.head.data:r.buffer.concat(r.length),r.buffer.clear()):a=zL(e,r.buffer,r.decoder),a);var a}function zL(e,r,a){var t;return e<r.head.data.length?(t=r.head.data.slice(0,e),r.head.data=r.head.data.slice(e)):t=e===r.head.data.length?r.shift():a?AL(e,r):BL(e,r),t}function AL(e,r){var a=r.head,t=1,n=a.data;for(e-=n.length;a=a.next;){var $=a.data,i=e>$.length?$.length:e;if(i===$.length?n+=$:n+=$.slice(0,e),0===(e-=i)){i===$.length?(++t,a.next?r.head=a.next:r.head=r.tail=null):(r.head=a,a.data=$.slice(i));break}++t}return r.length-=t,n}function BL(e,r){var a=pk.allocUnsafe(e),t=r.head,n=1;for(t.data.copy(a),e-=t.data.length;t=t.next;){var $=t.data,i=e>$.length?$.length:e;if($.copy(a,a.length-e,0,i),0===(e-=i)){i===$.length?(++n,t.next?r.head=t.next:r.head=r.tail=null):(r.head=t,t.data=$.slice(i));break}++n}return r.length-=n,a}function hr(e){var r=e._readableState;if(r.length>0)throw new Error("\"endReadable()\" called on non-empty stream");r.endEmitted||(r.ended=!0,ai.nextTick(CL,r,e))}function CL(e,r){e.endEmitted||0!==e.length||(e.endEmitted=!0,r.readable=!1,r.emit("end"))}function px(e,r){for(var a=0,t=e.length;a<t;a++)if(e[a]===r)return a;return-1}function qx(){if(mL)return;mL=true;cx={};dx=(Qq(),Mq);ai=(Zm(),Ym);cx=db;jL=(rw(),qw);db.ReadableState=jx;b=(Lq(),Kq).EventEmitter;fx=function(e,r){return e.listeners(r).length};cr=(tw(),sw);pk=(fn(),$h).Buffer;kL=ab.Uint8Array||function(){};gx=Object.create((kk(),Db));gx.inherits=(Wh(),Vh);dr=(Kw(),{});Sa=void 0;Sa=dr&&dr.debuglog?dr.debuglog("stream"):function(){};lL=(rK(),Lw);hx=(Qw(),Nw);gx.inherits(db,cr);er=["error","close","destroy","pause","resume"];Object.defineProperty(db.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),db.prototype.destroy=hx.destroy,db.prototype._undestroy=hx.undestroy,db.prototype._destroy=function(e,r){this.push(null),r(e)},db.prototype.push=function(e,r){var a,t=this._readableState;return t.objectMode?a=!0:"string"==typeof e&&((r=r||t.defaultEncoding)!==t.encoding&&(e=pk.from(e,r),r=""),a=!0),kx(this,e,r,!1,a)},db.prototype.unshift=function(e){return kx(this,e,null,!0,!1)},db.prototype.isPaused=function(){return!1===this._readableState.flowing},db.prototype.setEncoding=function(e){return kn||(kn=(bx(),_q).StringDecoder),this._readableState.decoder=new kn(e),this._readableState.encoding=e,this};ix=8388608;db.prototype.read=function(e){Sa("read",e),e=parseInt(e,10);var r=this._readableState,a=e;if(0!==e&&(r.emittedReadable=!1),0===e&&r.needReadable&&(r.length>=r.highWaterMark||r.ended))return Sa("read: emitReadable",r.length,r.ended),0===r.length&&r.ended?hr(this):ln(this),null;if(0===(e=lx(e,r))&&r.ended)return 0===r.length&&hr(this),null;var t,n=r.needReadable;return Sa("need readable",n),(0===r.length||r.length-e<r.highWaterMark)&&Sa("length less than watermark",n=!0),r.ended||r.reading?Sa("reading or ended",n=!1):n&&(Sa("do read"),r.reading=!0,r.sync=!0,0===r.length&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(e=lx(a,r))),null===(t=e>0?ox(e,r):null)?(r.needReadable=!0,e=0):r.length-=e,0===r.length&&(r.ended||(r.needReadable=!0),a!==e&&r.ended&&hr(this)),null!==t&&this.emit("data",t),t},db.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},db.prototype.pipe=function(e,r){var a=this,t=this._readableState;switch(t.pipesCount){case 0:t.pipes=e;break;case 1:t.pipes=[t.pipes,e];break;default:t.pipes.push(e);}t.pipesCount+=1,Sa("pipe count=%d opts=%j",t.pipesCount,r);var n=(!r||!1!==r.end)&&e!==dx.stdout&&e!==dx.stderr?i:w;function $(r,n){Sa("onunpipe"),r===a&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,Sa("cleanup"),e.removeListener("close",m),e.removeListener("finish",s),e.removeListener("drain",d),e.removeListener("error",u),e.removeListener("unpipe",$),a.removeListener("end",i),a.removeListener("end",w),a.removeListener("data",l),g=!0,!t.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function i(){Sa("onend"),e.end()}t.endEmitted?ai.nextTick(n):a.once("end",n),e.on("unpipe",$);var d=vL(a);e.on("drain",d);var g=!1;var o=!1;function l(r){Sa("ondata"),o=!1,!1!==e.write(r)||o||((1===t.pipesCount&&t.pipes===e||t.pipesCount>1&&-1!==px(t.pipes,e))&&!g&&(Sa("false write response, pause",a._readableState.awaitDrain),a._readableState.awaitDrain++,o=!0),a.pause())}function u(r){Sa("onerror",r),w(),e.removeListener("error",u),0===fx(e,"error")&&e.emit("error",r)}function m(){e.removeListener("finish",s),w()}function s(){Sa("onfinish"),e.removeListener("close",m),w()}function w(){Sa("unpipe"),a.unpipe(e)}return a.on("data",l),pL(e,"error",u),e.once("close",m),e.once("finish",s),e.emit("pipe",a),t.flowing||(Sa("pipe resume"),a.resume()),e},db.prototype.unpipe=function(e){var r=this._readableState,a={hasUnpiped:!1};if(0===r.pipesCount)return this;if(1===r.pipesCount)return e&&e!==r.pipes?this:(e||(e=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,e&&e.emit("unpipe",this,a),this);if(!e){var t=r.pipes,n=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var $=0;$<n;$++)t[$].emit("unpipe",this,a);return this}var i=px(r.pipes,e);return-1===i?this:(r.pipes.splice(i,1),r.pipesCount-=1,1===r.pipesCount&&(r.pipes=r.pipes[0]),e.emit("unpipe",this,a),this)},db.prototype.on=function(e,r){var a=cr.prototype.on.call(this,e,r);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var t=this._readableState;t.endEmitted||t.readableListening||(t.readableListening=t.needReadable=!0,t.emittedReadable=!1,t.reading?t.length&&ln(this):ai.nextTick(wL,this))}return a},db.prototype.addListener=db.prototype.on,db.prototype.resume=function(){var e=this._readableState;return e.flowing||(Sa("resume"),e.flowing=!0,xL(this,e)),this},db.prototype.pause=function(){return Sa("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Sa("pause"),this._readableState.flowing=!1,this.emit("pause")),this},db.prototype.wrap=function(e){var r=this,a=this._readableState,t=!1;for(var n in e.on("end",function(){if(Sa("wrapped end"),a.decoder&&!a.ended){var e=a.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(n){(Sa("wrapped data"),a.decoder&&(n=a.decoder.write(n)),a.objectMode&&null==n)||(a.objectMode||n&&n.length)&&(r.push(n)||(t=!0,e.pause()))}),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(r){return function(){return e[r].apply(e,arguments)}}(n));for(var $=0;$<er.length;$++)e.on(er[$],this.emit.bind(this,er[$]));return this._read=function(r){Sa("wrapped _read",r),t&&(t=!1,e.resume())},this},Object.defineProperty(db.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),db._fromList=ox}var rx,mn,sx,DL=false;function EL(r,t){var e=this._transformState;e.transforming=!1;var n=e.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));e.writechunk=null,e.writecb=null,null!=t&&this.push(t),n(r);var a=this._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}function Ie(r){if(!(this instanceof Ie))return new Ie(r);mn.call(this,r),this._transformState={afterTransform:EL.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",FL)}function FL(){var r=this;"function"==typeof this._flush?this._flush(function(t,e){tx(r,t,e)}):tx(this,null,null)}function tx(r,t,e){if(t)return r.emit("error",t);if(null!=e&&r.push(e),r._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(r._transformState.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}function ux(){if(DL)return;DL=true;rx={};rx=Ie;mn=(Jg(),Ig);sx=Object.create((kk(),Db));sx.inherits=(Wh(),Vh),sx.inherits(Ie,mn),Ie.prototype.push=function(r,t){return this._transformState.needTransform=!1,mn.prototype.push.call(this,r,t)},Ie.prototype._transform=function(r,t,e){throw new Error("_transform() is not implemented")},Ie.prototype._write=function(r,t,e){var n=this._transformState;if(n.writecb=e,n.writechunk=r,n.writeencoding=t,!n.transforming){var a=this._readableState;(n.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},Ie.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Ie.prototype._destroy=function(r,t){var e=this;mn.prototype._destroy.call(this,r,function(r){t(r),e.emit("close")})}}var GL,vx,wx,HL=false;function qk(r){if(!(this instanceof qk))return new qk(r);vx.call(this,r)}function IL(){if(HL)return;HL=true;GL={};GL=qk;vx=(ux(),rx);wx=Object.create((kk(),Db));wx.inherits=(Wh(),Vh),wx.inherits(qk,vx),qk.prototype._transform=function(r,$,a){a(null,r)}}var Ld,JL,KL,LL,ML,NL,OL,PL=false;function ir(){if(PL)return;PL=true;Ld={};JL=Ld=Ld=(qx(),cx);Ld.Stream=JL;KL=Ld;Ld.Readable=KL;LL=(Zq(),Xq);Ld.Writable=LL;ML=(Jg(),Ig);Ld.Duplex=ML;NL=(ux(),rx);Ld.Transform=NL;OL=(IL(),GL);Ld.PassThrough=OL}var QL,RL=false;function SL(){if(RL)return;RL=true;QL={};QL=(Zq(),Xq)}var TL,UL=false;function VL(){if(UL)return;UL=true;TL={};TL=(Jg(),Ig)}var WL,XL=false;function YL(){if(XL)return;XL=true;WL={};WL=(ir(),Ld).Transform}var ZL,$L=false;function _L(){if($L)return;$L=true;ZL={};ZL=(ir(),Ld).PassThrough}var aM,jr,bM,cM=false;function Md(){jr.call(this)}function dM(){if(cM)return;cM=true;aM={};aM=Md;jr=(Lq(),Kq).EventEmitter;bM=(Wh(),Vh);bM(Md,jr),Md.Readable=(ir(),Ld),Md.Writable=(SL(),QL),Md.Duplex=(VL(),TL),Md.Transform=(YL(),WL),Md.PassThrough=(_L(),ZL),Md.Stream=Md,Md.prototype.pipe=function(e,r){var n=this;function a(r){e.writable&&!1===e.write(r)&&n.pause&&n.pause()}function $(){n.readable&&n.resume&&n.resume()}n.on("data",a),e.on("drain",$),e._isStdio||r&&!1===r.end||(n.on("end",o),n.on("close",i));var t=!1;function o(){t||(t=!0,e.end())}function i(){t||(t=!0,"function"==typeof e.destroy&&e.destroy())}function s(e){if(f(),0===jr.listenerCount(this,"error"))throw e}function f(){n.removeListener("data",a),e.removeListener("drain",$),n.removeListener("end",o),n.removeListener("close",i),n.removeListener("error",s),e.removeListener("error",s),n.removeListener("end",f),n.removeListener("close",f),e.removeListener("close",f)}return n.on("error",s),e.on("error",s),n.on("end",f),n.on("close",f),e.on("close",f),e.emit("pipe",n),e}}var xx,eM=false;function yx(){if(eM)return;eM=true;xx={};xx=(dM(),aM)}var nn,zx,fM,Fb,gM,hM,iM,jM,kM,lM,mM=false;function vf(){if(mM)return;mM=true;fM=(jk(),Ee).Buffer;Fb={};gM=!0;Fb.base64=gM;hM=!0;Fb.array=hM;iM=!0;Fb.string=iM;jM="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array;Fb.arraybuffer=jM;kM=void 0!==fM;Fb.nodebuffer=kM;lM="undefined"!=typeof Uint8Array;if(Fb.uint8array=lM,"undefined"==typeof ArrayBuffer)nn=!1,Fb.blob=nn;else{var $untT$var$buffer=new ArrayBuffer(0);try{nn=0===new Blob([$untT$var$buffer],{type:"application/zip"}).size,Fb.blob=nn}catch(e){try{var $untT$var$Builder=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,$untT$var$builder=new $untT$var$Builder;$untT$var$builder.append($untT$var$buffer),nn=0===$untT$var$builder.getBlob("application/zip").size,Fb.blob=nn}catch(e){nn=!1,Fb.blob=nn}}}try{zx=!!(yx(),xx).Readable,Fb.nodestream=zx}catch(e){zx=!1,Fb.nodestream=zx}}var kr={},nM=(nb(),Ha),oM=(vf(),Fb),Nd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ax=function(r){for(var t,$,e,a,s,n,o,c=[],h=0,q=r.length,P=q,i="string"!==nM.getTypeOf(r);h<r.length;)P=q-h,i?(t=r[h++],$=h<q?r[h++]:0,e=h<q?r[h++]:0):(t=r.charCodeAt(h++),$=h<q?r.charCodeAt(h++):0,e=h<q?r.charCodeAt(h++):0),a=t>>2,s=(3&t)<<4|$>>4,n=P>1?(15&$)<<2|e>>6:64,o=P>2?63&e:64,c.push(Nd.charAt(a)+Nd.charAt(s)+Nd.charAt(n)+Nd.charAt(o));return c.join("")};kr.encode=Ax;var pM=function(r){var t,$,e,a,s,n,o=0,c=0;if("data:"===r.substr(0,"data:".length))throw new Error("Invalid base64 input, it looks like a data url.");var h,q=3*(r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(r.charAt(r.length-1)===Nd.charAt(64)&&q--,r.charAt(r.length-2)===Nd.charAt(64)&&q--,q%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=oM.uint8array?new Uint8Array(0|q):new Array(0|q);o<r.length;)t=Nd.indexOf(r.charAt(o++))<<2|(a=Nd.indexOf(r.charAt(o++)))>>4,$=(15&a)<<4|(s=Nd.indexOf(r.charAt(o++)))>>2,e=(3&s)<<6|(n=Nd.indexOf(r.charAt(o++))),h[c++]=t,64!==s&&(h[c++]=$),64!==n&&(h[c++]=e);return h};kr.decode=pM;var on,Je,qM=false;function pn(){if(qM)return;qM=true;on={};Je=(jk(),Ee).Buffer;on={isNode:void 0!==Je,newBufferFrom:function(r,f){if(Je.from&&Je.from!==Uint8Array.from)return Je.from(r,f);if("number"==typeof r)throw new Error("The \"data\" argument must not be a number");return new Je(r,f)},allocBuffer:function(r){if(Je.alloc)return Je.alloc(r);var f=new Je(r);return f.fill(0),f},isBuffer:function(r){return Je.isBuffer(r)},isStream:function(r){return r&&"function"==typeof r.on&&"function"==typeof r.pause&&"function"==typeof r.resume}}}var rM,sM=false;function tM(){if(sM)return;sM=true;rM={};rM="function"==typeof setImmediate?setImmediate:function(){var e=[].slice.apply(arguments);e.splice(1,0,0),setTimeout.apply(null,e)}}var uM,vM,wM,Bx,qn,xM=false;function rn(){var e,$;vM=!0;for(var a=qn.length;a;){for($=qn,qn=[],e=-1;++e<a;)$[e]();a=qn.length}vM=!1}function yM(e){1!==qn.push(e)||vM||uM()}function zM(){if(xM)return;xM=true;wM={};Bx=ab.MutationObserver||ab.WebKitMutationObserver;if(Bx){var $uUPe$var$called=0,$uUPe$var$observer=new Bx(rn),$uUPe$var$element=ab.document.createTextNode("");$uUPe$var$observer.observe($uUPe$var$element,{characterData:!0}),uM=function(){$uUPe$var$element.data=$uUPe$var$called=++$uUPe$var$called%2}}else if(ab.setImmediate||void 0===ab.MessageChannel)uM="document"in ab&&"onreadystatechange"in ab.document.createElement("script")?function(){var e=ab.document.createElement("script");e.onreadystatechange=function(){rn(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},ab.document.documentElement.appendChild(e)}:function(){setTimeout(rn,0)};else{var $uUPe$var$channel=new ab.MessageChannel;$uUPe$var$channel.port1.onmessage=rn,uM=function(){$uUPe$var$channel.port2.postMessage(0)}}qn=[];wM=yM}var AM,BM,dc,Cx,lr,Dx,CM=false;function bi(){}function wf(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=Dx,this.queue=[],this.outcome=void 0,e!==bi&&Ex(this,e)}function rk(e,r,t){this.promise=e,"function"==typeof r&&(this.onFulfilled=r,this.callFulfilled=this.otherCallFulfilled),"function"==typeof t&&(this.onRejected=t,this.callRejected=this.otherCallRejected)}function mr(e,r,t){BM(function(){var $;try{$=r(t)}catch(a){return dc.reject(e,a)}$===e?dc.reject(e,new TypeError("Cannot resolve promise with itself")):dc.resolve(e,$)})}function DM(e){var r=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof r)return function(){r.apply(e,arguments)}}function Ex(e,r){var t=!1;function $(r){t||(t=!0,dc.reject(e,r))}function a(r){t||(t=!0,dc.resolve(e,r))}var n=Fx(function(){r(a,$)});"error"===n.status&&$(n.value)}function Fx(e,r){var t={};try{t.value=e(r),t.status="success"}catch($){t.status="error",t.value=$}return t}function EM(e){return e instanceof this?e:dc.resolve(new this(bi),e)}function FM(e){var r=new this(bi);return dc.reject(r,e)}function GM(e){var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,$=!1;if(!t)return this.resolve([]);for(var a=new Array(t),n=0,o=-1,i=new this(bi);++o<t;)s(e[o],o);return i;function s(e,o){r.resolve(e).then(function(e){a[o]=e,++n!==t||$||($=!0,dc.resolve(i,a))},function(e){$||($=!0,dc.reject(i,e))})}}function HM(e){var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,$=!1;if(!t)return this.resolve([]);for(var a,n=-1,o=new this(bi);++n<t;)a=e[n],r.resolve(a).then(function(e){$||($=!0,dc.resolve(o,e))},function(e){$||($=!0,dc.reject(o,e))});return o}function IM(){if(CM)return;CM=true;AM={};BM=(zM(),wM);dc={};Cx=["REJECTED"];lr=["FULFILLED"];Dx=["PENDING"];AM=wf,wf.prototype.finally=function(e){if("function"!=typeof e)return this;var r=this.constructor;return this.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})})},wf.prototype.catch=function(e){return this.then(null,e)},wf.prototype.then=function(e,r){if("function"!=typeof e&&this.state===lr||"function"!=typeof r&&this.state===Cx)return this;var t=new this.constructor(bi);this.state!==Dx?mr(t,this.state===lr?e:r,this.outcome):this.queue.push(new rk(t,e,r));return t},rk.prototype.callFulfilled=function(e){dc.resolve(this.promise,e)},rk.prototype.otherCallFulfilled=function(e){mr(this.promise,this.onFulfilled,e)},rk.prototype.callRejected=function(e){dc.reject(this.promise,e)},rk.prototype.otherCallRejected=function(e){mr(this.promise,this.onRejected,e)},dc.resolve=function(e,r){var t=Fx(DM,r);if("error"===t.status)return dc.reject(e,t.value);var $=t.value;if($)Ex(e,$);else{e.state=lr,e.outcome=r;for(var a=-1,n=e.queue.length;++a<n;)e.queue[a].callFulfilled(r)}return e},dc.reject=function(e,r){e.state=Cx,e.outcome=r;for(var t=-1,$=e.queue.length;++t<$;)e.queue[t].callRejected(r);return e},wf.resolve=EM,wf.reject=FM,wf.all=GM,wf.race=HM}var sk,c,JM=false;function tk(){if(JM)return;JM=true;sk={};c=null;sk={Promise:c="undefined"!=typeof Promise?Promise:(IM(),AM)}}var Ha,xf,KM,ci,LM,nr,MM,sn,NM,yf,Gx,tn,or,OM,PM,QM,RM,SM,TM,UM,VM=false;function WM(r){return un(r,xf.uint8array?new Uint8Array(r.length):new Array(r.length))}function uk(r){return r}function un(r,n){for(var e=0;e<r.length;++e)n[e]=255&r.charCodeAt(e);return n}function vk(r){var n=65536,e=tn(r),t=!0;if("uint8array"===e?t=sn.applyCanBeUsed.uint8array:"nodebuffer"===e&&(t=sn.applyCanBeUsed.nodebuffer),t)for(;n>1;)try{return sn.stringifyByChunk(r,e,n)}catch(a){n=Math.floor(n/2)}return sn.stringifyByChar(r)}function vn(r,n){for(var e=0;e<r.length;e++)n[e]=r[e];return n}function nb(){if(VM)return;VM=true;Ha={};xf=(vf(),Fb);KM=kr;ci=(pn(),on);LM=(tM(),rM);nr=(tk(),sk);MM=function(r,n){or("blob");try{return new Blob([r],{type:n})}catch(t){try{var e=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return e.append(r),e.getBlob(n)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};Ha.newBlob=MM;sn={stringifyByChunk:function(r,n,e){var t=[],a=0,$=r.length;if($<=e)return String.fromCharCode.apply(null,r);for(;a<$;)"array"===n||"nodebuffer"===n?t.push(String.fromCharCode.apply(null,r.slice(a,Math.min(a+e,$)))):t.push(String.fromCharCode.apply(null,r.subarray(a,Math.min(a+e,$)))),a+=e;return t.join("")},stringifyByChar:function(r){for(var n="",e=0;e<r.length;e++)n+=String.fromCharCode(r[e]);return n},applyCanBeUsed:{uint8array:function(){try{return xf.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(r){return!1}}(),nodebuffer:function(){try{return xf.nodebuffer&&1===String.fromCharCode.apply(null,ci.allocBuffer(1)).length}catch(r){return!1}}()}};NM=vk;Ha.applyFromCharCode=NM;yf={};yf.string={string:uk,array:function(r){return un(r,new Array(r.length))},arraybuffer:function(r){return yf.string.uint8array(r).buffer},uint8array:function(r){return un(r,new Uint8Array(r.length))},nodebuffer:function(r){return un(r,ci.allocBuffer(r.length))}},yf.array={string:vk,array:uk,arraybuffer:function(r){return new Uint8Array(r).buffer},uint8array:function(r){return new Uint8Array(r)},nodebuffer:function(r){return ci.newBufferFrom(r)}},yf.arraybuffer={string:function(r){return vk(new Uint8Array(r))},array:function(r){return vn(new Uint8Array(r),new Array(r.byteLength))},arraybuffer:uk,uint8array:function(r){return new Uint8Array(r)},nodebuffer:function(r){return ci.newBufferFrom(new Uint8Array(r))}},yf.uint8array={string:vk,array:function(r){return vn(r,new Array(r.length))},arraybuffer:function(r){return r.buffer},uint8array:uk,nodebuffer:function(r){return ci.newBufferFrom(r)}},yf.nodebuffer={string:vk,array:function(r){return vn(r,new Array(r.length))},arraybuffer:function(r){return yf.nodebuffer.uint8array(r).buffer},uint8array:function(r){return vn(r,new Uint8Array(r.length))},nodebuffer:uk};Gx=function(r,n){if(n||(n=""),!r)return n;or(r);var e=tn(n);return yf[e][r](n)};Ha.transformTo=Gx;tn=function(r){return"string"==typeof r?"string":"[object Array]"===Object.prototype.toString.call(r)?"array":xf.nodebuffer&&ci.isBuffer(r)?"nodebuffer":xf.uint8array&&r instanceof Uint8Array?"uint8array":xf.arraybuffer&&r instanceof ArrayBuffer?"arraybuffer":void 0};Ha.getTypeOf=tn;or=function(r){if(!xf[r.toLowerCase()])throw new Error(r+" is not supported by this platform")};Ha.checkSupport=or;OM=65535;Ha.MAX_VALUE_16BITS=OM;PM=-1;Ha.MAX_VALUE_32BITS=PM;QM=function(r){var n,e,t="";for(e=0;e<(r||"").length;e++)t+="\\x"+((n=r.charCodeAt(e))<16?"0":"")+n.toString(16).toUpperCase();return t};Ha.pretty=QM;RM=function(r,n,e){LM(function(){r.apply(e||null,n||[])})};Ha.delay=RM;SM=function(r,n){var e=function(){};e.prototype=n.prototype,r.prototype=new e};Ha.inherits=SM;TM=function(){var r,n,e={};for(r=0;r<arguments.length;r++)for(n in arguments[r])arguments[r].hasOwnProperty(n)&&void 0===e[n]&&(e[n]=arguments[r][n]);return e};Ha.extend=TM;UM=function(r,n,e,t,a){return nr.Promise.resolve(n).then(function(r){return xf.blob&&(r instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(r)))&&"undefined"!=typeof FileReader?new nr.Promise(function(n,e){var t=new FileReader;t.onload=function(r){n(r.target.result)},t.onerror=function(r){e(r.target.error)},t.readAsArrayBuffer(r)}):r}).then(function(n){var $=tn(n);return $?("arraybuffer"===$?n=Gx("uint8array",n):"string"===$&&(a?n=KM.decode(n):e&&!0!==t&&(n=WM(n))),n):nr.Promise.reject(new Error("Can't read the data of '"+r+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})};Ha.prepareContent=UM}var Ga={};function Hx(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}Hx.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,i){return this._listeners[e].push(i),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,i){if(this._listeners[e])for(var t=0;t<this._listeners[e].length;t++)this._listeners[e][t].call(this,i)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var i=this;return e.on("data",function(e){i.processChunk(e)}),e.on("end",function(){i.end()}),e.on("error",function(e){i.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,i){return this.extraStreamInfo[e]=i,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},Ga=Hx;for(var di=(nb(),Ha),Kg=(vf(),Fb),XM=(pn(),on),wk=new Array(256),zf=0;zf<256;zf++)wk[zf]=zf>=252?6:zf>=248?5:zf>=240?4:zf>=224?3:zf>=192?2:1;wk[254]=wk[254]=1;var YM=function(r){var e,$,t,a,o,n=r.length,f=0;for(a=0;a<n;a++)55296==(64512&($=r.charCodeAt(a)))&&a+1<n&&56320==(64512&(t=r.charCodeAt(a+1)))&&($=65536+($-55296<<10)+(t-56320),a++),f+=$<128?1:$<2048?2:$<65536?3:4;for(e=Kg.uint8array?new Uint8Array(f):new Array(f),o=0,a=0;o<f;a++)55296==(64512&($=r.charCodeAt(a)))&&a+1<n&&56320==(64512&(t=r.charCodeAt(a+1)))&&($=65536+($-55296<<10)+(t-56320),a++),$<128?e[o++]=$:$<2048?(e[o++]=192|$>>>6,e[o++]=128|63&$):$<65536?(e[o++]=224|$>>>12,e[o++]=128|$>>>6&63,e[o++]=128|63&$):(e[o++]=240|$>>>18,e[o++]=128|$>>>12&63,e[o++]=128|$>>>6&63,e[o++]=128|63&$);return e},ZM=function(r,e){var $;for((e=e||r.length)>r.length&&(e=r.length),$=e-1;$>=0&&128==(192&r[$]);)$--;return $<0?e:0===$?e:$+wk[r[$]]>e?$:e},$M=function(r){var e,$,t,a,o=r.length,n=new Array(2*o);for($=0,e=0;e<o;)if((t=r[e++])<128)n[$++]=t;else if((a=wk[t])>4)n[$++]=65533,e+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&e<o;)t=t<<6|63&r[e++],a--;a>1?n[$++]=65533:t<65536?n[$++]=t:(t-=65536,n[$++]=55296|t>>10&1023,n[$++]=56320|1023&t)}return n.length!==$&&(n.subarray?n=n.subarray(0,$):n.length=$),di.applyFromCharCode(n)},xk=function(r){return Kg.nodebuffer?XM.newBufferFrom(r,"utf-8"):YM(r)};var Lg=function(r){return Kg.nodebuffer?di.transformTo("nodebuffer",r).toString("utf-8"):(r=di.transformTo(Kg.uint8array?"uint8array":"array",r),$M(r))};function wn(){Ga.call(this,"utf-8 decode"),this.leftOver=null}di.inherits(wn,Ga),wn.prototype.processChunk=function(r){var e=di.transformTo(Kg.uint8array?"uint8array":"array",r.data);if(this.leftOver&&this.leftOver.length){if(Kg.uint8array){var $=e;(e=new Uint8Array($.length+this.leftOver.length)).set(this.leftOver,0),e.set($,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var t=ZM(e),a=e;t!==e.length&&(Kg.uint8array?(a=e.subarray(0,t),this.leftOver=e.subarray(t,e.length)):(a=e.slice(0,t),this.leftOver=e.slice(t,e.length))),this.push({data:Lg(a),meta:r.meta})},wn.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:Lg(this.leftOver),meta:{}}),this.leftOver=null)};var _M=wn;function pr(){Ga.call(this,"utf-8 encode")}di.inherits(pr,Ga),pr.prototype.processChunk=function(r){this.push({data:xk(r.data),meta:r.meta})};var Ix=pr;var aN={},Jx=(nb(),Ha);function qr(r){Ga.call(this,"ConvertWorker to "+r),this.destType=r}Jx.inherits(qr,Ga),qr.prototype.processChunk=function(r){this.push({data:Jx.transformTo(this.destType,r.data),meta:r.meta})},aN=qr;var bN,Kx,cN,dN=false;function rr(e,r,a){Kx.call(this,r),this._helper=e;var t=this;e.on("data",function(e,r){t.push(e)||t._helper.pause(),a&&a(r)}).on("error",function(e){t.emit("error",e)}).on("end",function(){t.push(null)})}function eN(){if(dN)return;dN=true;bN={};Kx=(yx(),xx).Readable;cN=(nb(),Ha);cN.inherits(rr,Kx),rr.prototype._read=function(){this._helper.resume()},bN=rr}var Lx={},fN=(jk(),Ee).Buffer,Mg=(nb(),Ha),gN=(vf(),Fb),hN=(tk(),sk),iN=null;if(gN.nodestream)try{iN=(eN(),bN)}catch(e){}function jN(r,e,t){switch(r){case"blob":return Mg.newBlob(Mg.transformTo("arraybuffer",e),t);case"base64":return Ax(e);default:return Mg.transformTo(r,e);}}function kN(r,e){var t,a=0,$=null,u=0;for(t=0;t<e.length;t++)u+=e[t].length;switch(r){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":for($=new Uint8Array(u),t=0;t<e.length;t++)$.set(e[t],a),a+=e[t].length;return $;case"nodebuffer":return fN.concat(e);default:throw new Error("concat : unsupported type '"+r+"'");}}function lN(r,t){return new hN.Promise(function(a,$){var u=[],n=r._internalType,o=r._outputType,s=r._mimeType;r.on("data",function(r,e){u.push(r),t&&t(e)}).on("error",function(r){u=[],$(r)}).on("end",function(){try{var r=jN(o,kN(n,u),s);a(r)}catch(e){$(e)}u=[]}).resume()})}function Mx(r,t,a){var $=t;switch(t){case"blob":case"arraybuffer":$="uint8array";break;case"base64":$="string";}try{this._internalType=$,this._outputType=t,this._mimeType=a,Mg.checkSupport($),this._worker=r.pipe(new aN($)),r.lock()}catch(e){this._worker=new Ga("error"),this._worker.error(e)}}Mx.prototype={accumulate:function(r){return lN(this,r)},on:function(r,e){var t=this;return"data"===r?this._worker.on(r,function(r){e.call(t,r.data,r.meta)}):this._worker.on(r,function(){Mg.delay(e,arguments,t)}),this},resume:function(){return Mg.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(r){if(Mg.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new iN(this,{objectMode:"nodebuffer"!==this._outputType},r)}},Lx=Mx;var Yc={},mN=!1;Yc.base64=mN;var nN=!1;Yc.binary=nN;var oN=!1;Yc.dir=oN;var Nx=!0;Yc.createFolders=Nx;var pN=null;Yc.date=pN;var qN=null;Yc.compression=qN;var rN=null;Yc.compressionOptions=rN;var sN=null;Yc.comment=sN;var tN=null;Yc.unixPermissions=tN;var uN=null;Yc.dosPermissions=uN;var sr={},xn=(nb(),Ha),vN=16384;function ei(t){Ga.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then(function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=xn.getTypeOf(t),e.isPaused||e._tickAndRepeat()},function(t){e.error(t)})}xn.inherits(ei,Ga),ei.prototype.cleanUp=function(){Ga.prototype.cleanUp.call(this),this.data=null},ei.prototype.resume=function(){return!!Ga.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,xn.delay(this._tickAndRepeat,[],this)),!0)},ei.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(xn.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},ei.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=vN,e=null,i=Math.min(this.max,this.index+t);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,i);break;case"uint8array":e=this.data.subarray(this.index,i);break;case"array":case"nodebuffer":e=this.data.slice(this.index,i);}return this.index=i,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},sr=ei;var yk={},wN=(nb(),Ha);var Ox={},xN=(nb(),Ha);function tr(r){Ga.call(this,"DataLengthProbe for "+r),this.propName=r,this.withStreamInfo(r,0)}xN.inherits(tr,Ga),tr.prototype.processChunk=function(r){if(r){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+r.data.length}Ga.prototype.processChunk.call(this,r)},Ox=tr;function yN(){for(var r,$=[],c=0;c<256;c++){r=c;for(var v=0;v<8;v++)r=1&r?3988292384^r>>>1:r>>>1;$[c]=r}return $}var Px=yN();function zN(r,$,c,v){var a=Px,e=v+c;r^=-1;for(var t=v;t<e;t++)r=r>>>8^a[255&(r^$[t])];return-1^r}function AN(r,$,c,v){var a=Px,e=v+c;r^=-1;for(var t=v;t<e;t++)r=r>>>8^a[255&(r^$.charCodeAt(t))];return-1^r}yk=function(r,$){return void 0!==r&&r.length?"string"!==wN.getTypeOf(r)?zN(0|$,r,r.length,0):AN(0|$,r,r.length,0):0};var Qx={},BN=(nb(),Ha);function ur(){Ga.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}BN.inherits(ur,Ga),ur.prototype.processChunk=function(r){this.streamInfo.crc32=yk(r.data,this.streamInfo.crc32||0),this.push(r)},Qx=ur;var fi={},Rx=(tk(),sk),vr=Ox;vr=Ox;function wr(e,r,t,s,o){this.compressedSize=e,this.uncompressedSize=r,this.crc32=t,this.compression=s,this.compressedContent=o}wr.prototype={getContentWorker:function(){var e=new sr(Rx.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new vr("data_length")),r=this;return e.on("end",function(){if(this.streamInfo.data_length!==r.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new sr(Rx.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},wr.createWorkerFrom=function(e,r,t){return e.pipe(new Qx).pipe(new vr("uncompressedSize")).pipe(r.compressWorker(t)).pipe(new vr("compressedSize")).withStreamInfo("compression",r)},fi=wr;var CN={},xr=function(e,r,t){this.name=e,this.dir=t.dir,this.date=t.date,this.comment=t.comment,this.unixPermissions=t.unixPermissions,this.dosPermissions=t.dosPermissions,this._data=r,this._dataBinary=t.binary,this.options={compression:t.compression,compressionOptions:t.compressionOptions}};xr.prototype={internalStream:function(e){var r=null,t="string";try{if(!e)throw new Error("No output type specified.");var a="string"===(t=e.toLowerCase())||"text"===t;"binarystring"!==t&&"text"!==t||(t="string"),r=this._decompressWorker();var $=!this._dataBinary;$&&!a&&(r=r.pipe(new Ix)),!$&&a&&(r=r.pipe(new _M))}catch(i){(r=new Ga("error")).error(i)}return new Lx(r,t,"")},async:function(e,r){return this.internalStream(e).accumulate(r)},nodeStream:function(e,r){return this.internalStream(e||"nodebuffer").toNodejsStream(r)},_compressWorker:function(e,r){if(this._data instanceof fi&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var t=this._decompressWorker();return this._dataBinary||(t=t.pipe(new Ix)),fi.createWorkerFrom(t,e,r)},_decompressWorker:function(){return this._data instanceof fi?this._data.getContentWorker():this._data instanceof Ga?this._data:new sr(this._data)}};for(var Sx=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],DN=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},yr=0;yr<Sx.length;yr++)xr.prototype[Sx[yr]]=DN;CN=xr;var Zc,rc,gi,ib={},EN="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function FN(t,r){return Object.prototype.hasOwnProperty.call(t,r)}var hi=function(t){for(var r=Array.prototype.slice.call(arguments,1);r.length;){var $=r.shift();if($){if("object"!=typeof $)throw new TypeError($+"must be non-object");for(var e in $)FN($,e)&&(t[e]=$[e])}}return t};ib.assign=hi;var zk=function(t,r){return t.length===r?t:t.subarray?t.subarray(0,r):(t.length=r,t)};ib.shrinkBuf=zk;var GN={arraySet:function(t,r,$,e,n){if(r.subarray&&t.subarray)t.set(r.subarray($,$+e),n);else for(var o=0;o<e;o++)t[n+o]=r[$+o]},flattenChunks:function(t){var r,$,e,n,o,a;for(e=0,r=0,$=t.length;r<$;r++)e+=t[r].length;for(a=new Uint8Array(e),n=0,r=0,$=t.length;r<$;r++)o=t[r],a.set(o,n),n+=o.length;return a}},HN={arraySet:function(t,r,$,e,n){for(var o=0;o<e;o++)t[n+o]=r[$+o]},flattenChunks:function(t){return[].concat.apply([],t)}},Tx=function(t){t?(Zc=Uint8Array,ib.Buf8=Zc,rc=Uint16Array,ib.Buf16=rc,gi=Int32Array,ib.Buf32=gi,hi(ib,GN)):(Zc=Array,ib.Buf8=Zc,rc=Array,ib.Buf16=rc,gi=Array,ib.Buf32=gi,hi(ib,HN))};ib.setTyped=Tx,Tx(EN);var IN=4,Ux=0,Vx=1,JN=2;function ii($){for(var r=$.length;--r>=0;)$[r]=0}var KN=0,Wx=1,LN=2,MN=3,NN=258,zr=29,Ak=256,Bk=Ak+1+zr,ji=30,Ar=19,Xx=2*Bk+1,Ng=15,Br=16,ON=7,Cr=256,Yx=16,Zx=17,$x=18,Dr=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],yn=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],PN=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],_x=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],QN=512,Le=new Array(2*(Bk+2));ii(Le);var Ck=new Array(2*ji);ii(Ck);var Dk=new Array(QN);ii(Dk);var Ek=new Array(NN-MN+1);ii(Ek);var Er=new Array(zr);ii(Er);var RN,SN,TN,zn=new Array(ji);function Fr($,r,s,e,_){this.static_tree=$,this.extra_bits=r,this.extra_base=s,this.elems=e,this.max_length=_,this.has_stree=$&&$.length}function Gr($,r){this.dyn_tree=$,this.max_code=0,this.stat_desc=r}function ay($){return $<256?Dk[$]:Dk[256+($>>>7)]}function Fk($,r){$.pending_buf[$.pending++]=255&r,$.pending_buf[$.pending++]=r>>>8&255}function sc($,r,s){$.bi_valid>Br-s?($.bi_buf|=r<<$.bi_valid&65535,Fk($,$.bi_buf),$.bi_buf=r>>Br-$.bi_valid,$.bi_valid+=s-Br):($.bi_buf|=r<<$.bi_valid&65535,$.bi_valid+=s)}function Od($,r,s){sc($,s[2*r],s[2*r+1])}function by($,r){var s=0;do{s|=1&$,$>>>=1,s<<=1}while(--r>0);return s>>>1}function UN($){16===$.bi_valid?(Fk($,$.bi_buf),$.bi_buf=0,$.bi_valid=0):$.bi_valid>=8&&($.pending_buf[$.pending++]=255&$.bi_buf,$.bi_buf>>=8,$.bi_valid-=8)}function VN($,r){var s,e,_,a,t,v,R=r.dyn_tree,J=r.max_code,Q=r.stat_desc.static_tree,i=r.stat_desc.has_stree,n=r.stat_desc.extra_bits,d=r.stat_desc.extra_base,l=r.stat_desc.max_length,o=0;for(a=0;a<=Ng;a++)$.bl_count[a]=0;for(R[2*$.heap[$.heap_max]+1]=0,s=$.heap_max+1;s<Xx;s++)(a=R[2*R[2*(e=$.heap[s])+1]+1]+1)>l&&(a=l,o++),R[2*e+1]=a,e>J||($.bl_count[a]++,t=0,e>=d&&(t=n[e-d]),v=R[2*e],$.opt_len+=v*(a+t),i&&($.static_len+=v*(Q[2*e+1]+t)));if(0!==o){do{for(a=l-1;0===$.bl_count[a];)a--;$.bl_count[a]--,$.bl_count[a+1]+=2,$.bl_count[l]--,o-=2}while(o>0);for(a=l;0!==a;a--)for(e=$.bl_count[a];0!==e;)(_=$.heap[--s])>J||(R[2*_+1]!==a&&($.opt_len+=(a-R[2*_+1])*R[2*_],R[2*_+1]=a),e--)}}function cy($,r,s){var e,_,a=new Array(Ng+1),t=0;for(e=1;e<=Ng;e++)a[e]=t=t+s[e-1]<<1;for(_=0;_<=r;_++){var v=$[2*_+1];0!==v&&($[2*_]=by(a[v]++,v))}}function WN(){var $,r,s,e,_,a=new Array(Ng+1);for(s=0,e=0;e<zr-1;e++)for(Er[e]=s,$=0;$<1<<Dr[e];$++)Ek[s++]=e;for(Ek[s-1]=e,_=0,e=0;e<16;e++)for(zn[e]=_,$=0;$<1<<yn[e];$++)Dk[_++]=e;for(_>>=7;e<ji;e++)for(zn[e]=_<<7,$=0;$<1<<yn[e]-7;$++)Dk[256+_++]=e;for(r=0;r<=Ng;r++)a[r]=0;for($=0;$<=143;)Le[2*$+1]=8,$++,a[8]++;for(;$<=255;)Le[2*$+1]=9,$++,a[9]++;for(;$<=279;)Le[2*$+1]=7,$++,a[7]++;for(;$<=287;)Le[2*$+1]=8,$++,a[8]++;for(cy(Le,Bk+1,a),$=0;$<ji;$++)Ck[2*$+1]=5,Ck[2*$]=by($,5);RN=new Fr(Le,Dr,Ak+1,Bk,Ng),SN=new Fr(Ck,yn,0,ji,Ng),TN=new Fr(new Array(0),PN,0,Ar,ON)}function dy($){var r;for(r=0;r<Bk;r++)$.dyn_ltree[2*r]=0;for(r=0;r<ji;r++)$.dyn_dtree[2*r]=0;for(r=0;r<Ar;r++)$.bl_tree[2*r]=0;$.dyn_ltree[2*Cr]=1,$.opt_len=$.static_len=0,$.last_lit=$.matches=0}function ey($){$.bi_valid>8?Fk($,$.bi_buf):$.bi_valid>0&&($.pending_buf[$.pending++]=$.bi_buf),$.bi_buf=0,$.bi_valid=0}function XN($,r,s,e){ey($),e&&(Fk($,s),Fk($,~s)),ib.arraySet($.pending_buf,$.window,r,s,$.pending),$.pending+=s}function fy($,r,s,e){var _=2*r,a=2*s;return $[_]<$[a]||$[_]===$[a]&&e[r]<=e[s]}function Hr($,r,s){for(var e=$.heap[s],_=s<<1;_<=$.heap_len&&(_<$.heap_len&&fy(r,$.heap[_+1],$.heap[_],$.depth)&&_++,!fy(r,e,$.heap[_],$.depth));)$.heap[s]=$.heap[_],s=_,_<<=1;$.heap[s]=e}function gy($,r,s){var e,_,a,t,v=0;if(0!==$.last_lit)do{e=$.pending_buf[$.d_buf+2*v]<<8|$.pending_buf[$.d_buf+2*v+1],_=$.pending_buf[$.l_buf+v],v++,0===e?Od($,_,r):(Od($,(a=Ek[_])+Ak+1,r),0!==(t=Dr[a])&&sc($,_-=Er[a],t),Od($,a=ay(--e),s),0!==(t=yn[a])&&sc($,e-=zn[a],t))}while(v<$.last_lit);Od($,Cr,r)}function Ir($,r){var s,e,_,a=r.dyn_tree,t=r.stat_desc.static_tree,v=r.stat_desc.has_stree,R=r.stat_desc.elems,J=-1;for($.heap_len=0,$.heap_max=Xx,s=0;s<R;s++)0!==a[2*s]?($.heap[++$.heap_len]=J=s,$.depth[s]=0):a[2*s+1]=0;for(;$.heap_len<2;)a[2*(_=$.heap[++$.heap_len]=J<2?++J:0)]=1,$.depth[_]=0,$.opt_len--,v&&($.static_len-=t[2*_+1]);for(r.max_code=J,s=$.heap_len>>1;s>=1;s--)Hr($,a,s);_=R;do{s=$.heap[1],$.heap[1]=$.heap[$.heap_len--],Hr($,a,1),e=$.heap[1],$.heap[--$.heap_max]=s,$.heap[--$.heap_max]=e,a[2*_]=a[2*s]+a[2*e],$.depth[_]=($.depth[s]>=$.depth[e]?$.depth[s]:$.depth[e])+1,a[2*s+1]=a[2*e+1]=_,$.heap[1]=_++,Hr($,a,1)}while($.heap_len>=2);$.heap[--$.heap_max]=$.heap[1],VN($,r),cy(a,J,$.bl_count)}function hy($,r,s){var e,_,a=-1,t=r[1],v=0,R=7,J=4;for(0===t&&(R=138,J=3),r[2*(s+1)+1]=65535,e=0;e<=s;e++)_=t,t=r[2*(e+1)+1],++v<R&&_===t||(v<J?$.bl_tree[2*_]+=v:0!==_?(_!==a&&$.bl_tree[2*_]++,$.bl_tree[2*Yx]++):v<=10?$.bl_tree[2*Zx]++:$.bl_tree[2*$x]++,v=0,a=_,0===t?(R=138,J=3):_===t?(R=6,J=3):(R=7,J=4))}function iy($,r,s){var e,_,a=-1,t=r[1],v=0,R=7,J=4;for(0===t&&(R=138,J=3),e=0;e<=s;e++)if(_=t,t=r[2*(e+1)+1],!(++v<R&&_===t)){if(v<J)do{Od($,_,$.bl_tree)}while(0!=--v);else 0!==_?(_!==a&&(Od($,_,$.bl_tree),v--),Od($,Yx,$.bl_tree),sc($,v-3,2)):v<=10?(Od($,Zx,$.bl_tree),sc($,v-3,3)):(Od($,$x,$.bl_tree),sc($,v-11,7));v=0,a=_,0===t?(R=138,J=3):_===t?(R=6,J=3):(R=7,J=4)}}function YN($){var r;for(hy($,$.dyn_ltree,$.l_desc.max_code),hy($,$.dyn_dtree,$.d_desc.max_code),Ir($,$.bl_desc),r=Ar-1;r>=3&&0===$.bl_tree[2*_x[r]+1];r--);return $.opt_len+=3*(r+1)+5+5+4,r}function ZN($,r,s,e){var _;for(sc($,r-257,5),sc($,s-1,5),sc($,e-4,4),_=0;_<e;_++)sc($,$.bl_tree[2*_x[_]+1],3);iy($,$.dyn_ltree,r-1),iy($,$.dyn_dtree,s-1)}function $N($){var r,s=4093624447;for(r=0;r<=31;r++,s>>>=1)if(1&s&&0!==$.dyn_ltree[2*r])return Ux;if(0!==$.dyn_ltree[18]||0!==$.dyn_ltree[20]||0!==$.dyn_ltree[26])return Vx;for(r=32;r<Ak;r++)if(0!==$.dyn_ltree[2*r])return Vx;return Ux}ii(zn);var _N=!1;function aO($){_N||(WN(),_N=!0),$.l_desc=new Gr($.dyn_ltree,RN),$.d_desc=new Gr($.dyn_dtree,SN),$.bl_desc=new Gr($.bl_tree,TN),$.bi_buf=0,$.bi_valid=0,dy($)}function jy($,r,s,e){sc($,(KN<<1)+(e?1:0),3),XN($,r,s,!0)}function bO($){sc($,Wx<<1,3),Od($,Cr,Le),UN($)}function cO($,r,s,e){var _,a,t=0;$.level>0?($.strm.data_type===JN&&($.strm.data_type=$N($)),Ir($,$.l_desc),Ir($,$.d_desc),t=YN($),_=$.opt_len+3+7>>>3,(a=$.static_len+3+7>>>3)<=_&&(_=a)):_=a=s+5,s+4<=_&&-1!==r?jy($,r,s,e):$.strategy===IN||a===_?(sc($,(Wx<<1)+(e?1:0),3),gy($,Le,Ck)):(sc($,(LN<<1)+(e?1:0),3),ZN($,$.l_desc.max_code+1,$.d_desc.max_code+1,t+1),gy($,$.dyn_ltree,$.dyn_dtree)),dy($),e&&ey($)}function dO($,r,s){return $.pending_buf[$.d_buf+2*$.last_lit]=r>>>8&255,$.pending_buf[$.d_buf+2*$.last_lit+1]=255&r,$.pending_buf[$.l_buf+$.last_lit]=255&s,$.last_lit++,0===r?$.dyn_ltree[2*s]++:($.matches++,r--,$.dyn_ltree[2*(Ek[s]+Ak+1)]++,$.dyn_dtree[2*ay(r)]++),$.last_lit===$.lit_bufsize-1}var eO=aO;var fO=jy;var gO=cO;var Af=dO;var hO=bO;var Gk={};function iO(r,$,o,e){for(var a=65535&r|0,u=r>>>16&65535|0,x=0;0!==o;){o-=x=o>2e3?2e3:o;do{u=u+(a=a+$[e++]|0)|0}while(--x);a%=65521,u%=65521}return a|u<<16|0}Gk=iO;var Ub={};function jO(){for(var r,$=[],a=0;a<256;a++){r=a;for(var v=0;v<8;v++)r=1&r?3988292384^r>>>1:r>>>1;$[a]=r}return $}var kO=jO();function lO(r,$,a,v){var c=kO,e=v+a;r^=-1;for(var k=v;k<e;k++)r=r>>>8^c[255&(r^$[k])];return-1^r}Ub=lO;var Og={};Og={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};var Hk,Pg=0,mO=1,nO=3,Bf=4,ky=5,Pd=0,ly=1,$c=-2,oO=-3,Jr=-5,pO=-1,qO=1,An=2,rO=3,sO=4,tO=2,Kr=8,uO=9,vO=29,wO=256,Lr=wO+1+vO,xO=30,yO=19,zO=2*Lr+1,AO=15,Ia=3,Cf=258,wd=Cf+Ia+1,BO=32,Bn=42,Mr=69,Cn=73,Dn=91,En=103,Qg=113,Ik=666,Vb=1,Jk=2,Rg=3,ki=4,CO=3;function Df($,a){return $.msg=Og[a],a}function my($){return($<<1)-($>4?9:0)}function Ef($){for(var a=$.length;--a>=0;)$[a]=0}function Ff($){var a=$.state,t=a.pending;t>$.avail_out&&(t=$.avail_out),0!==t&&(ib.arraySet($.output,a.pending_buf,a.pending_out,t,$.next_out),$.next_out+=t,a.pending_out+=t,$.total_out+=t,$.avail_out-=t,a.pending-=t,0===a.pending&&(a.pending_out=0))}function $b($,a){gO($,$.block_start>=0?$.block_start:-1,$.strstart-$.block_start,a),$.block_start=$.strstart,Ff($.strm)}function Na($,a){$.pending_buf[$.pending++]=a}function Kk($,a){$.pending_buf[$.pending++]=a>>>8&255,$.pending_buf[$.pending++]=255&a}function DO($,a,t,r){var B=$.avail_in;return B>r&&(B=r),0===B?0:($.avail_in-=B,ib.arraySet(a,$.input,$.next_in,B,t),1===$.state.wrap?$.adler=Gk($.adler,a,B,t):2===$.state.wrap&&($.adler=Ub($.adler,a,B,t)),$.next_in+=B,$.total_in+=B,B)}function ny($,a){var t,r,B=$.max_chain_length,e=$.strstart,_=$.prev_length,s=$.nice_match,k=$.strstart>$.w_size-wd?$.strstart-($.w_size-wd):0,i=$.window,n=$.w_mask,v=$.prev,L=$.strstart+Cf,l=i[e+_-1],h=i[e+_];$.prev_length>=$.good_match&&(B>>=2),s>$.lookahead&&(s=$.lookahead);do{if(i[(t=a)+_]===h&&i[t+_-1]===l&&i[t]===i[e]&&i[++t]===i[e+1]){e+=2,t++;do{}while(i[++e]===i[++t]&&i[++e]===i[++t]&&i[++e]===i[++t]&&i[++e]===i[++t]&&i[++e]===i[++t]&&i[++e]===i[++t]&&i[++e]===i[++t]&&i[++e]===i[++t]&&e<L);if(r=Cf-(L-e),e=L-Cf,r>_){if($.match_start=a,_=r,r>=s)break;l=i[e+_-1],h=i[e+_]}}}while((a=v[a&n])>k&&0!=--B);return _<=$.lookahead?_:$.lookahead}function Sg($){var a,t,r,B,e,_=$.w_size;do{if(B=$.window_size-$.lookahead-$.strstart,$.strstart>=_+(_-wd)){ib.arraySet($.window,$.window,_,_,0),$.match_start-=_,$.strstart-=_,$.block_start-=_,a=t=$.hash_size;do{r=$.head[--a],$.head[a]=r>=_?r-_:0}while(--t);a=t=_;do{r=$.prev[--a],$.prev[a]=r>=_?r-_:0}while(--t);B+=_}if(0===$.strm.avail_in)break;if(t=DO($.strm,$.window,$.strstart+$.lookahead,B),$.lookahead+=t,$.lookahead+$.insert>=Ia)for(e=$.strstart-$.insert,$.ins_h=$.window[e],$.ins_h=($.ins_h<<$.hash_shift^$.window[e+1])&$.hash_mask;$.insert&&($.ins_h=($.ins_h<<$.hash_shift^$.window[e+Ia-1])&$.hash_mask,$.prev[e&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=e,e++,$.insert--,!($.lookahead+$.insert<Ia)););}while($.lookahead<wd&&0!==$.strm.avail_in)}function EO($,a){var t=65535;for(t>$.pending_buf_size-5&&(t=$.pending_buf_size-5);;){if($.lookahead<=1){if(Sg($),0===$.lookahead&&a===Pg)return Vb;if(0===$.lookahead)break}$.strstart+=$.lookahead,$.lookahead=0;var r=$.block_start+t;if((0===$.strstart||$.strstart>=r)&&($.lookahead=$.strstart-r,$.strstart=r,$b($,!1),0===$.strm.avail_out))return Vb;if($.strstart-$.block_start>=$.w_size-wd&&($b($,!1),0===$.strm.avail_out))return Vb}return $.insert=0,a===Bf?($b($,!0),0===$.strm.avail_out?Rg:ki):($.strstart>$.block_start&&($b($,!1),$.strm.avail_out),Vb)}function Nr($,a){for(var t,r;;){if($.lookahead<wd){if(Sg($),$.lookahead<wd&&a===Pg)return Vb;if(0===$.lookahead)break}if(t=0,$.lookahead>=Ia&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+Ia-1])&$.hash_mask,t=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),0!==t&&$.strstart-t<=$.w_size-wd&&($.match_length=ny($,t)),$.match_length>=Ia){if(r=Af($,$.strstart-$.match_start,$.match_length-Ia),$.lookahead-=$.match_length,$.match_length<=$.max_lazy_match&&$.lookahead>=Ia){$.match_length--;do{$.strstart++,$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+Ia-1])&$.hash_mask,t=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart}while(0!=--$.match_length);$.strstart++}else $.strstart+=$.match_length,$.match_length=0,$.ins_h=$.window[$.strstart],$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+1])&$.hash_mask;}else r=Af($,0,$.window[$.strstart]),$.lookahead--,$.strstart++;if(r&&($b($,!1),0===$.strm.avail_out))return Vb}return $.insert=$.strstart<Ia-1?$.strstart:Ia-1,a===Bf?($b($,!0),0===$.strm.avail_out?Rg:ki):$.last_lit&&($b($,!1),0===$.strm.avail_out)?Vb:Jk}function li($,a){for(var t,r,B;;){if($.lookahead<wd){if(Sg($),$.lookahead<wd&&a===Pg)return Vb;if(0===$.lookahead)break}if(t=0,$.lookahead>=Ia&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+Ia-1])&$.hash_mask,t=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),$.prev_length=$.match_length,$.prev_match=$.match_start,$.match_length=Ia-1,0!==t&&$.prev_length<$.max_lazy_match&&$.strstart-t<=$.w_size-wd&&($.match_length=ny($,t),$.match_length<=5&&($.strategy===qO||$.match_length===Ia&&$.strstart-$.match_start>4096)&&($.match_length=Ia-1)),$.prev_length>=Ia&&$.match_length<=$.prev_length){B=$.strstart+$.lookahead-Ia,r=Af($,$.strstart-1-$.prev_match,$.prev_length-Ia),$.lookahead-=$.prev_length-1,$.prev_length-=2;do{++$.strstart<=B&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+Ia-1])&$.hash_mask,t=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart)}while(0!=--$.prev_length);if($.match_available=0,$.match_length=Ia-1,$.strstart++,r&&($b($,!1),0===$.strm.avail_out))return Vb}else if($.match_available){if((r=Af($,0,$.window[$.strstart-1]))&&$b($,!1),$.strstart++,$.lookahead--,0===$.strm.avail_out)return Vb}else $.match_available=1,$.strstart++,$.lookahead--}return $.match_available&&(r=Af($,0,$.window[$.strstart-1]),$.match_available=0),$.insert=$.strstart<Ia-1?$.strstart:Ia-1,a===Bf?($b($,!0),0===$.strm.avail_out?Rg:ki):$.last_lit&&($b($,!1),0===$.strm.avail_out)?Vb:Jk}function FO($,a){for(var t,r,B,e,_=$.window;;){if($.lookahead<=Cf){if(Sg($),$.lookahead<=Cf&&a===Pg)return Vb;if(0===$.lookahead)break}if($.match_length=0,$.lookahead>=Ia&&$.strstart>0&&(r=_[B=$.strstart-1])===_[++B]&&r===_[++B]&&r===_[++B]){e=$.strstart+Cf;do{}while(r===_[++B]&&r===_[++B]&&r===_[++B]&&r===_[++B]&&r===_[++B]&&r===_[++B]&&r===_[++B]&&r===_[++B]&&B<e);$.match_length=Cf-(e-B),$.match_length>$.lookahead&&($.match_length=$.lookahead)}if($.match_length>=Ia?(t=Af($,1,$.match_length-Ia),$.lookahead-=$.match_length,$.strstart+=$.match_length,$.match_length=0):(t=Af($,0,$.window[$.strstart]),$.lookahead--,$.strstart++),t&&($b($,!1),0===$.strm.avail_out))return Vb}return $.insert=0,a===Bf?($b($,!0),0===$.strm.avail_out?Rg:ki):$.last_lit&&($b($,!1),0===$.strm.avail_out)?Vb:Jk}function GO($,a){for(var t;;){if(0===$.lookahead&&(Sg($),0===$.lookahead)){if(a===Pg)return Vb;break}if($.match_length=0,t=Af($,0,$.window[$.strstart]),$.lookahead--,$.strstart++,t&&($b($,!1),0===$.strm.avail_out))return Vb}return $.insert=0,a===Bf?($b($,!0),0===$.strm.avail_out?Rg:ki):$.last_lit&&($b($,!1),0===$.strm.avail_out)?Vb:Jk}function Qd($,a,t,r,B){this.good_length=$,this.max_lazy=a,this.nice_length=t,this.max_chain=r,this.func=B}function HO($){$.window_size=2*$.w_size,Ef($.head),$.max_lazy_match=Hk[$.level].max_lazy,$.good_match=Hk[$.level].good_length,$.nice_match=Hk[$.level].nice_length,$.max_chain_length=Hk[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=Ia-1,$.match_available=0,$.ins_h=0}function IO(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Kr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new rc(2*zO),this.dyn_dtree=new rc(2*(2*xO+1)),this.bl_tree=new rc(2*(2*yO+1)),Ef(this.dyn_ltree),Ef(this.dyn_dtree),Ef(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new rc(AO+1),this.heap=new rc(2*Lr+1),Ef(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new rc(2*Lr+1),Ef(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function JO($){var a;return $&&$.state?($.total_in=$.total_out=0,$.data_type=tO,(a=$.state).pending=0,a.pending_out=0,a.wrap<0&&(a.wrap=-a.wrap),a.status=a.wrap?Bn:Qg,$.adler=2===a.wrap?0:1,a.last_flush=Pg,eO(a),Pd):Df($,$c)}function KO($){var a=JO($);return a===Pd&&HO($.state),a}function LO($,a){return $&&$.state?2!==$.state.wrap?$c:($.state.gzhead=a,Pd):$c}function MO($,a,t,r,B,e){if(!$)return $c;var _=1;if(a===pO&&(a=6),r<0?(_=0,r=-r):r>15&&(_=2,r-=16),B<1||B>uO||t!==Kr||r<8||r>15||a<0||a>9||e<0||e>sO)return Df($,$c);8===r&&(r=9);var s=new IO;return $.state=s,s.strm=$,s.wrap=_,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=B+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+Ia-1)/Ia),s.window=new Zc(2*s.w_size),s.head=new rc(s.hash_size),s.prev=new rc(s.w_size),s.lit_bufsize=1<<B+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Zc(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=a,s.strategy=e,s.method=t,KO($)}function NO($,a){var t,r,B,e;if(!$||!$.state||a>ky||a<0)return $?Df($,$c):$c;if(r=$.state,!$.output||!$.input&&0!==$.avail_in||r.status===Ik&&a!==Bf)return Df($,0===$.avail_out?Jr:$c);if(r.strm=$,t=r.last_flush,r.last_flush=a,r.status===Bn)if(2===r.wrap)$.adler=0,Na(r,31),Na(r,139),Na(r,8),r.gzhead?(Na(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Na(r,255&r.gzhead.time),Na(r,r.gzhead.time>>8&255),Na(r,r.gzhead.time>>16&255),Na(r,r.gzhead.time>>24&255),Na(r,9===r.level?2:r.strategy>=An||r.level<2?4:0),Na(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Na(r,255&r.gzhead.extra.length),Na(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&($.adler=Ub($.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Mr):(Na(r,0),Na(r,0),Na(r,0),Na(r,0),Na(r,0),Na(r,9===r.level?2:r.strategy>=An||r.level<2?4:0),Na(r,CO),r.status=Qg);else{var _=Kr+(r.w_bits-8<<4)<<8;_|=(r.strategy>=An||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(_|=BO),_+=31-_%31,r.status=Qg,Kk(r,_),0!==r.strstart&&(Kk(r,$.adler>>>16),Kk(r,65535&$.adler)),$.adler=1}if(r.status===Mr)if(r.gzhead.extra){for(B=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>B&&($.adler=Ub($.adler,r.pending_buf,r.pending-B,B)),Ff($),B=r.pending,r.pending!==r.pending_buf_size));)Na(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>B&&($.adler=Ub($.adler,r.pending_buf,r.pending-B,B)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=Cn)}else r.status=Cn;if(r.status===Cn)if(r.gzhead.name){B=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>B&&($.adler=Ub($.adler,r.pending_buf,r.pending-B,B)),Ff($),B=r.pending,r.pending===r.pending_buf_size)){e=1;break}e=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Na(r,e)}while(0!==e);r.gzhead.hcrc&&r.pending>B&&($.adler=Ub($.adler,r.pending_buf,r.pending-B,B)),0===e&&(r.gzindex=0,r.status=Dn)}else r.status=Dn;if(r.status===Dn)if(r.gzhead.comment){B=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>B&&($.adler=Ub($.adler,r.pending_buf,r.pending-B,B)),Ff($),B=r.pending,r.pending===r.pending_buf_size)){e=1;break}e=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Na(r,e)}while(0!==e);r.gzhead.hcrc&&r.pending>B&&($.adler=Ub($.adler,r.pending_buf,r.pending-B,B)),0===e&&(r.status=En)}else r.status=En;if(r.status===En&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&Ff($),r.pending+2<=r.pending_buf_size&&(Na(r,255&$.adler),Na(r,$.adler>>8&255),$.adler=0,r.status=Qg)):r.status=Qg),0!==r.pending){if(Ff($),0===$.avail_out)return r.last_flush=-1,Pd}else if(0===$.avail_in&&my(a)<=my(t)&&a!==Bf)return Df($,Jr);if(r.status===Ik&&0!==$.avail_in)return Df($,Jr);if(0!==$.avail_in||0!==r.lookahead||a!==Pg&&r.status!==Ik){var s=r.strategy===An?GO(r,a):r.strategy===rO?FO(r,a):Hk[r.level].func(r,a);if(s!==Rg&&s!==ki||(r.status=Ik),s===Vb||s===Rg)return 0===$.avail_out&&(r.last_flush=-1),Pd;if(s===Jk&&(a===mO?hO(r):a!==ky&&(fO(r,0,0,!1),a===nO&&(Ef(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Ff($),0===$.avail_out))return r.last_flush=-1,Pd}return a!==Bf?Pd:r.wrap<=0?ly:(2===r.wrap?(Na(r,255&$.adler),Na(r,$.adler>>8&255),Na(r,$.adler>>16&255),Na(r,$.adler>>24&255),Na(r,255&$.total_in),Na(r,$.total_in>>8&255),Na(r,$.total_in>>16&255),Na(r,$.total_in>>24&255)):(Kk(r,$.adler>>>16),Kk(r,65535&$.adler)),Ff($),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?Pd:ly)}function OO($){var a;return $&&$.state?(a=$.state.status)!==Bn&&a!==Mr&&a!==Cn&&a!==Dn&&a!==En&&a!==Qg&&a!==Ik?Df($,$c):($.state=null,a===Qg?Df($,oO):Pd):$c}function PO($,a){var t,r,B,e,_,s,k,i,n=a.length;if(!$||!$.state)return $c;if(2===(e=(t=$.state).wrap)||1===e&&t.status!==Bn||t.lookahead)return $c;for(1===e&&($.adler=Gk($.adler,a,n,0)),t.wrap=0,n>=t.w_size&&(0===e&&(Ef(t.head),t.strstart=0,t.block_start=0,t.insert=0),i=new Zc(t.w_size),ib.arraySet(i,a,n-t.w_size,t.w_size,0),a=i,n=t.w_size),_=$.avail_in,s=$.next_in,k=$.input,$.avail_in=n,$.next_in=0,$.input=a,Sg(t);t.lookahead>=Ia;){r=t.strstart,B=t.lookahead-(Ia-1);do{t.ins_h=(t.ins_h<<t.hash_shift^t.window[r+Ia-1])&t.hash_mask,t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++}while(--B);t.strstart=r,t.lookahead=Ia-1,Sg(t)}return t.strstart+=t.lookahead,t.block_start=t.strstart,t.insert=t.lookahead,t.lookahead=0,t.match_length=t.prev_length=Ia-1,t.match_available=0,$.next_in=s,$.input=k,$.avail_in=_,t.wrap=e,Pd}Hk=[new Qd(0,0,0,0,EO),new Qd(4,4,8,4,Nr),new Qd(4,5,16,8,Nr),new Qd(4,6,32,32,Nr),new Qd(4,4,16,16,li),new Qd(8,16,32,32,li),new Qd(8,16,128,128,li),new Qd(8,32,128,256,li),new Qd(32,128,258,1024,li),new Qd(32,258,258,4096,li)];var QO=MO;var RO=LO;var SO=NO;var TO=OO;var UO=PO;var VO=!0,WO=!0;try{String.fromCharCode.apply(null,[0])}catch(__){VO=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(__){WO=!1}for(var Lk=new Zc(256),Gf=0;Gf<256;Gf++)Lk[Gf]=Gf>=252?6:Gf>=248?5:Gf>=240?4:Gf>=224?3:Gf>=192?2:1;Lk[254]=Lk[254]=1;var Or=function(r){var $,t,n,a,e,u=r.length,f=0;for(a=0;a<u;a++)55296==(64512&(t=r.charCodeAt(a)))&&a+1<u&&56320==(64512&(n=r.charCodeAt(a+1)))&&(t=65536+(t-55296<<10)+(n-56320),a++),f+=t<128?1:t<2048?2:t<65536?3:4;for($=new Zc(f),e=0,a=0;e<f;a++)55296==(64512&(t=r.charCodeAt(a)))&&a+1<u&&56320==(64512&(n=r.charCodeAt(a+1)))&&(t=65536+(t-55296<<10)+(n-56320),a++),t<128?$[e++]=t:t<2048?($[e++]=192|t>>>6,$[e++]=128|63&t):t<65536?($[e++]=224|t>>>12,$[e++]=128|t>>>6&63,$[e++]=128|63&t):($[e++]=240|t>>>18,$[e++]=128|t>>>12&63,$[e++]=128|t>>>6&63,$[e++]=128|63&t);return $};function oy(r,$){if($<65534&&(r.subarray&&WO||!r.subarray&&VO))return String.fromCharCode.apply(null,zk(r,$));for(var t="",n=0;n<$;n++)t+=String.fromCharCode(r[n]);return t}var XO=function(r){return oy(r,r.length)};var YO=function(r){for(var $=new Zc(r.length),t=0,n=$.length;t<n;t++)$[t]=r.charCodeAt(t);return $};var ZO=function(r,$){var t,n,a,e,u=$||r.length,f=new Array(2*u);for(n=0,t=0;t<u;)if((a=r[t++])<128)f[n++]=a;else if((e=Lk[a])>4)f[n++]=65533,t+=e-1;else{for(a&=2===e?31:3===e?15:7;e>1&&t<u;)a=a<<6|63&r[t++],e--;e>1?f[n++]=65533:a<65536?f[n++]=a:(a-=65536,f[n++]=55296|a>>10&1023,f[n++]=56320|1023&a)}return oy(f,n)};var $O=function(r,$){var t;for(($=$||r.length)>r.length&&($=r.length),t=$-1;t>=0&&128==(192&r[t]);)t--;return t<0?$:0===t?$:t+Lk[r[t]]>$?t:$};var py={};function _O(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}py=_O;var Mk={},qy=Object.prototype.toString,aP=0,Pr=4,mi=0,ry=1,sy=2,bP=-1,cP=0,dP=8;function Tg($){if(!(this instanceof Tg))return new Tg($);this.options=hi({level:bP,method:dP,chunkSize:16384,windowBits:15,memLevel:8,strategy:cP,to:""},$||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new py,this.strm.avail_out=0;var n=QO(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==mi)throw new Error(Og[n]);if(t.header&&RO(this.strm,t.header),t.dictionary){var r;if(r="string"==typeof t.dictionary?Or(t.dictionary):"[object ArrayBuffer]"===qy.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=UO(this.strm,r))!==mi)throw new Error(Og[n]);this._dict_set=!0}}function Qr($,t){var n=new Tg(t);if(n.push($,!0),n.err)throw n.msg||Og[n.err];return n.result}function eP($,t){return(t=t||{}).raw=!0,Qr($,t)}function fP($,t){return(t=t||{}).gzip=!0,Qr($,t)}Tg.prototype.push=function($,t){var n,r,e=this.strm,a=this.options.chunkSize;if(this.ended)return!1;r=t===~~t?t:!0===t?Pr:aP,"string"==typeof $?e.input=Or($):"[object ArrayBuffer]"===qy.call($)?e.input=new Uint8Array($):e.input=$,e.next_in=0,e.avail_in=e.input.length;do{if(0===e.avail_out&&(e.output=new Zc(a),e.next_out=0,e.avail_out=a),(n=SO(e,r))!==ry&&n!==mi)return this.onEnd(n),this.ended=!0,!1;0!==e.avail_out&&(0!==e.avail_in||r!==Pr&&r!==sy)||("string"===this.options.to?this.onData(XO(zk(e.output,e.next_out))):this.onData(zk(e.output,e.next_out)))}while((e.avail_in>0||0===e.avail_out)&&n!==ry);return r===Pr?(n=TO(this.strm),this.onEnd(n),this.ended=!0,n===mi):r!==sy||(this.onEnd(mi),e.avail_out=0,!0)},Tg.prototype.onData=function($){this.chunks.push($)},Tg.prototype.onEnd=function($){$===mi&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=ib.flattenChunks(this.chunks)),this.chunks=[],this.err=$,this.msg=this.strm.msg};var gP=Tg;Mk.Deflate=gP;var hP=Qr;Mk.deflate=hP;var iP=eP;Mk.deflateRaw=iP;var jP=fP;Mk.gzip=jP;var kP={},Fn=30,lP=12;kP=function(i,e){var a,o,t,d,n,l,$,r,s,f,v,b,c,u,w,P,h,m,k,L,M,_,x,g,A;a=i.state,o=i.next_in,g=i.input,t=o+(i.avail_in-5),d=i.next_out,A=i.output,n=d-(e-i.avail_out),l=d+(i.avail_out-257),$=a.dmax,r=a.wsize,s=a.whave,f=a.wnext,v=a.window,b=a.hold,c=a.bits,u=a.lencode,w=a.distcode,P=(1<<a.lenbits)-1,h=(1<<a.distbits)-1;i:do{c<15&&(b+=g[o++]<<c,c+=8,b+=g[o++]<<c,c+=8),m=u[b&P];e:for(;;){if(b>>>=k=m>>>24,c-=k,0===(k=m>>>16&255))A[d++]=65535&m;else{if(!(16&k)){if(0==(64&k)){m=u[(65535&m)+(b&(1<<k)-1)];continue e}if(32&k){a.mode=lP;break i}i.msg="invalid literal/length code",a.mode=Fn;break i}L=65535&m,(k&=15)&&(c<k&&(b+=g[o++]<<c,c+=8),L+=b&(1<<k)-1,b>>>=k,c-=k),c<15&&(b+=g[o++]<<c,c+=8,b+=g[o++]<<c,c+=8),m=w[b&h];a:for(;;){if(b>>>=k=m>>>24,c-=k,!(16&(k=m>>>16&255))){if(0==(64&k)){m=w[(65535&m)+(b&(1<<k)-1)];continue a}i.msg="invalid distance code",a.mode=Fn;break i}if(M=65535&m,c<(k&=15)&&(b+=g[o++]<<c,(c+=8)<k&&(b+=g[o++]<<c,c+=8)),(M+=b&(1<<k)-1)>$){i.msg="invalid distance too far back",a.mode=Fn;break i}if(b>>>=k,c-=k,M>(k=d-n)){if((k=M-k)>s&&a.sane){i.msg="invalid distance too far back",a.mode=Fn;break i}if(_=0,x=v,0===f){if(_+=r-k,k<L){L-=k;do{A[d++]=v[_++]}while(--k);_=d-M,x=A}}else if(f<k){if(_+=r+f-k,(k-=f)<L){L-=k;do{A[d++]=v[_++]}while(--k);if(_=0,f<L){L-=k=f;do{A[d++]=v[_++]}while(--k);_=d-M,x=A}}}else if(_+=f-k,k<L){L-=k;do{A[d++]=v[_++]}while(--k);_=d-M,x=A}for(;L>2;)A[d++]=x[_++],A[d++]=x[_++],A[d++]=x[_++],L-=3;L&&(A[d++]=x[_++],L>1&&(A[d++]=x[_++]))}else{_=d-M;do{A[d++]=A[_++],A[d++]=A[_++],A[d++]=A[_++],L-=3}while(L>2);L&&(A[d++]=A[_++],L>1&&(A[d++]=A[_++]))}break}}break}}while(o<t&&d<l);o-=L=c>>3,b&=(1<<(c-=L<<3))-1,i.next_in=o,i.next_out=d,i.avail_in=o<t?t-o+5:5-(o-t),i.avail_out=d<l?l-d+257:257-(d-l),a.hold=b,a.bits=c};var Nk={},ni=15,ty=852,uy=592,vy=0,Rr=1,wy=2,mP=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],nP=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],oP=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],pP=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Nk=function($,r,u,l,N,a,q,v){var S,e,f,t,i,o,E,n,s,I=v.bits,T=0,B=0,D=0,O=0,b=0,A=0,L=0,M=0,X=0,x=0,G=null,H=0,U=new rc(ni+1),_=new rc(ni+1),d=null,c=0;for(T=0;T<=ni;T++)U[T]=0;for(B=0;B<l;B++)U[r[u+B]]++;for(b=I,O=ni;O>=1&&0===U[O];O--);if(b>O&&(b=O),0===O)return N[a++]=20971520,N[a++]=20971520,v.bits=1,0;for(D=1;D<O&&0===U[D];D++);for(b<D&&(b=D),M=1,T=1;T<=ni;T++)if(M<<=1,(M-=U[T])<0)return-1;if(M>0&&($===vy||1!==O))return-1;for(_[1]=0,T=1;T<ni;T++)_[T+1]=_[T]+U[T];for(B=0;B<l;B++)0!==r[u+B]&&(q[_[r[u+B]]++]=B);if($===vy?(G=d=q,o=19):$===Rr?(G=mP,H-=257,d=nP,c-=257,o=256):(G=oP,d=pP,o=-1),x=0,B=0,T=D,i=a,A=b,L=0,f=-1,t=(X=1<<b)-1,$===Rr&&X>ty||$===wy&&X>uy)return 1;for(;;){E=T-L,q[B]<o?(n=0,s=q[B]):q[B]>o?(n=d[c+q[B]],s=G[H+q[B]]):(n=96,s=0),S=1<<T-L,D=e=1<<A;do{N[i+(x>>L)+(e-=S)]=E<<24|n<<16|s|0}while(0!==e);for(S=1<<T-1;x&S;)S>>=1;if(0!==S?(x&=S-1,x+=S):x=0,B++,0==--U[T]){if(T===O)break;T=r[u+q[B]]}if(T>b&&(x&t)!==f){for(0===L&&(L=b),i+=D,M=1<<(A=T-L);A+L<O&&!((M-=U[A+L])<=0);)A++,M<<=1;if(X+=1<<A,$===Rr&&X>ty||$===wy&&X>uy)return 1;N[f=x&t]=b<<24|A<<16|i-a|0}}return 0!==x&&(N[i+x]=T-L<<24|64<<16|0),v.bits=b,0};var qP=0,xy=1,yy=2,zy=4,rP=5,Gn=6,Ug=0,sP=1,tP=2,_c=-2,Ay=-3,Sr=-4,uP=-5,By=8,Cy=1,Dy=2,Ey=3,Fy=4,Gy=5,Hy=6,Iy=7,Jy=8,Ky=9,Ly=10,Hn=11,Me=12,Tr=13,My=14,Ur=15,Ny=16,Oy=17,Py=18,Qy=19,In=20,Jn=21,Ry=22,Sy=23,Ty=24,Uy=25,Vy=26,Vr=27,Wy=28,Xy=29,jb=30,Wr=31,vP=32,wP=852,xP=592;function Yy($){return($>>>24&255)+($>>>8&65280)+((65280&$)<<8)+((255&$)<<24)}function yP(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new rc(320),this.work=new rc(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function zP($){var e;return $&&$.state?(e=$.state,$.total_in=$.total_out=e.total=0,$.msg="",e.wrap&&($.adler=1&e.wrap),e.mode=Cy,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new gi(wP),e.distcode=e.distdyn=new gi(xP),e.sane=1,e.back=-1,Ug):_c}function AP($){var e;return $&&$.state?((e=$.state).wsize=0,e.whave=0,e.wnext=0,zP($)):_c}function BP($,e){var a,r;return $&&$.state?(r=$.state,e<0?(a=0,e=-e):(a=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?_c:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=a,r.wbits=e,AP($))):_c}function CP($,e){var a,r;return $?(r=new yP,$.state=r,r.window=null,(a=BP($,e))!==Ug&&($.state=null),a):_c}var Zy,$y,DP=!0;function EP($){if(DP){var e;for(Zy=new gi(512),$y=new gi(32),e=0;e<144;)$.lens[e++]=8;for(;e<256;)$.lens[e++]=9;for(;e<280;)$.lens[e++]=7;for(;e<288;)$.lens[e++]=8;for(Nk(xy,$.lens,0,288,Zy,0,$.work,{bits:9}),e=0;e<32;)$.lens[e++]=5;Nk(yy,$.lens,0,32,$y,0,$.work,{bits:5}),DP=!1}$.lencode=Zy,$.lenbits=9,$.distcode=$y,$.distbits=5}function _y($,e,a,r){var t,i=$.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Zc(i.wsize)),r>=i.wsize?(ib.arraySet(i.window,e,a-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):((t=i.wsize-i.wnext)>r&&(t=r),ib.arraySet(i.window,e,a-r,t,i.wnext),(r-=t)?(ib.arraySet(i.window,e,a-r,r,0),i.wnext=r,i.whave=i.wsize):(i.wnext+=t,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=t))),0}function FP($,e){var a,r,t,i,D,n,I,v,s,K,G,l,o,f,d,c,h,E,b,_,k,m,w,R,u=0,x=new Zc(4),T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!$||!$.state||!$.output||!$.input&&0!==$.avail_in)return _c;(a=$.state).mode===Me&&(a.mode=Tr),D=$.next_out,t=$.output,I=$.avail_out,i=$.next_in,r=$.input,n=$.avail_in,v=a.hold,s=a.bits,K=n,G=I,m=Ug;$:for(;;)switch(a.mode){case Cy:if(0===a.wrap){a.mode=Tr;break}for(;s<16;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}if(2&a.wrap&&35615===v){a.check=0,x[0]=255&v,x[1]=v>>>8&255,a.check=Ub(a.check,x,2,0),v=0,s=0,a.mode=Dy;break}if(a.flags=0,a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&v)<<8)+(v>>8))%31){$.msg="incorrect header check",a.mode=jb;break}if((15&v)!==By){$.msg="unknown compression method",a.mode=jb;break}if(s-=4,k=8+(15&(v>>>=4)),0===a.wbits)a.wbits=k;else if(k>a.wbits){$.msg="invalid window size",a.mode=jb;break}a.dmax=1<<k,$.adler=a.check=1,a.mode=512&v?Ly:Me,v=0,s=0;break;case Dy:for(;s<16;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}if(a.flags=v,(255&a.flags)!==By){$.msg="unknown compression method",a.mode=jb;break}if(57344&a.flags){$.msg="unknown header flags set",a.mode=jb;break}a.head&&(a.head.text=v>>8&1),512&a.flags&&(x[0]=255&v,x[1]=v>>>8&255,a.check=Ub(a.check,x,2,0)),v=0,s=0,a.mode=Ey;case Ey:for(;s<32;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}a.head&&(a.head.time=v),512&a.flags&&(x[0]=255&v,x[1]=v>>>8&255,x[2]=v>>>16&255,x[3]=v>>>24&255,a.check=Ub(a.check,x,4,0)),v=0,s=0,a.mode=Fy;case Fy:for(;s<16;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}a.head&&(a.head.xflags=255&v,a.head.os=v>>8),512&a.flags&&(x[0]=255&v,x[1]=v>>>8&255,a.check=Ub(a.check,x,2,0)),v=0,s=0,a.mode=Gy;case Gy:if(1024&a.flags){for(;s<16;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}a.length=v,a.head&&(a.head.extra_len=v),512&a.flags&&(x[0]=255&v,x[1]=v>>>8&255,a.check=Ub(a.check,x,2,0)),v=0,s=0}else a.head&&(a.head.extra=null);a.mode=Hy;case Hy:if(1024&a.flags&&((l=a.length)>n&&(l=n),l&&(a.head&&(k=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Array(a.head.extra_len)),ib.arraySet(a.head.extra,r,i,l,k)),512&a.flags&&(a.check=Ub(a.check,r,l,i)),n-=l,i+=l,a.length-=l),a.length))break $;a.length=0,a.mode=Iy;case Iy:if(2048&a.flags){if(0===n)break $;l=0;do{k=r[i+l++],a.head&&k&&a.length<65536&&(a.head.name+=String.fromCharCode(k))}while(k&&l<n);if(512&a.flags&&(a.check=Ub(a.check,r,l,i)),n-=l,i+=l,k)break $}else a.head&&(a.head.name=null);a.length=0,a.mode=Jy;case Jy:if(4096&a.flags){if(0===n)break $;l=0;do{k=r[i+l++],a.head&&k&&a.length<65536&&(a.head.comment+=String.fromCharCode(k))}while(k&&l<n);if(512&a.flags&&(a.check=Ub(a.check,r,l,i)),n-=l,i+=l,k)break $}else a.head&&(a.head.comment=null);a.mode=Ky;case Ky:if(512&a.flags){for(;s<16;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}if(v!==(65535&a.check)){$.msg="header crc mismatch",a.mode=jb;break}v=0,s=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),$.adler=a.check=0,a.mode=Me;break;case Ly:for(;s<32;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}$.adler=a.check=Yy(v),v=0,s=0,a.mode=Hn;case Hn:if(0===a.havedict)return $.next_out=D,$.avail_out=I,$.next_in=i,$.avail_in=n,a.hold=v,a.bits=s,tP;$.adler=a.check=1,a.mode=Me;case Me:if(e===rP||e===Gn)break $;case Tr:if(a.last){v>>>=7&s,s-=7&s,a.mode=Vr;break}for(;s<3;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}switch(a.last=1&v,s-=1,3&(v>>>=1)){case 0:a.mode=My;break;case 1:if(EP(a),a.mode=In,e===Gn){v>>>=2,s-=2;break $}break;case 2:a.mode=Oy;break;case 3:$.msg="invalid block type",a.mode=jb;}v>>>=2,s-=2;break;case My:for(v>>>=7&s,s-=7&s;s<32;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}if((65535&v)!=(v>>>16^65535)){$.msg="invalid stored block lengths",a.mode=jb;break}if(a.length=65535&v,v=0,s=0,a.mode=Ur,e===Gn)break $;case Ur:a.mode=Ny;case Ny:if(l=a.length){if(l>n&&(l=n),l>I&&(l=I),0===l)break $;ib.arraySet(t,r,i,l,D),n-=l,i+=l,I-=l,D+=l,a.length-=l;break}a.mode=Me;break;case Oy:for(;s<14;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}if(a.nlen=257+(31&v),v>>>=5,s-=5,a.ndist=1+(31&v),v>>>=5,s-=5,a.ncode=4+(15&v),v>>>=4,s-=4,a.nlen>286||a.ndist>30){$.msg="too many length or distance symbols",a.mode=jb;break}a.have=0,a.mode=Py;case Py:for(;a.have<a.ncode;){for(;s<3;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}a.lens[T[a.have++]]=7&v,v>>>=3,s-=3}for(;a.have<19;)a.lens[T[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,w={bits:a.lenbits},m=Nk(qP,a.lens,0,19,a.lencode,0,a.work,w),a.lenbits=w.bits,m){$.msg="invalid code lengths set",a.mode=jb;break}a.have=0,a.mode=Qy;case Qy:for(;a.have<a.nlen+a.ndist;){for(;c=(u=a.lencode[v&(1<<a.lenbits)-1])>>>16&255,h=65535&u,!((d=u>>>24)<=s);){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}if(h<16)v>>>=d,s-=d,a.lens[a.have++]=h;else{if(16===h){for(R=d+2;s<R;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}if(v>>>=d,s-=d,0===a.have){$.msg="invalid bit length repeat",a.mode=jb;break}k=a.lens[a.have-1],l=3+(3&v),v>>>=2,s-=2}else if(17===h){for(R=d+3;s<R;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}s-=d,k=0,l=3+(7&(v>>>=d)),v>>>=3,s-=3}else{for(R=d+7;s<R;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}s-=d,k=0,l=11+(127&(v>>>=d)),v>>>=7,s-=7}if(a.have+l>a.nlen+a.ndist){$.msg="invalid bit length repeat",a.mode=jb;break}for(;l--;)a.lens[a.have++]=k}}if(a.mode===jb)break;if(0===a.lens[256]){$.msg="invalid code -- missing end-of-block",a.mode=jb;break}if(a.lenbits=9,w={bits:a.lenbits},m=Nk(xy,a.lens,0,a.nlen,a.lencode,0,a.work,w),a.lenbits=w.bits,m){$.msg="invalid literal/lengths set",a.mode=jb;break}if(a.distbits=6,a.distcode=a.distdyn,w={bits:a.distbits},m=Nk(yy,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,w),a.distbits=w.bits,m){$.msg="invalid distances set",a.mode=jb;break}if(a.mode=In,e===Gn)break $;case In:a.mode=Jn;case Jn:if(n>=6&&I>=258){$.next_out=D,$.avail_out=I,$.next_in=i,$.avail_in=n,a.hold=v,a.bits=s,kP($,G),D=$.next_out,t=$.output,I=$.avail_out,i=$.next_in,r=$.input,n=$.avail_in,v=a.hold,s=a.bits,a.mode===Me&&(a.back=-1);break}for(a.back=0;c=(u=a.lencode[v&(1<<a.lenbits)-1])>>>16&255,h=65535&u,!((d=u>>>24)<=s);){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}if(c&&0==(240&c)){for(E=d,b=c,_=h;c=(u=a.lencode[_+((v&(1<<E+b)-1)>>E)])>>>16&255,h=65535&u,!(E+(d=u>>>24)<=s);){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}v>>>=E,s-=E,a.back+=E}if(v>>>=d,s-=d,a.back+=d,a.length=h,0===c){a.mode=Vy;break}if(32&c){a.back=-1,a.mode=Me;break}if(64&c){$.msg="invalid literal/length code",a.mode=jb;break}a.extra=15&c,a.mode=Ry;case Ry:if(a.extra){for(R=a.extra;s<R;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}a.length+=v&(1<<a.extra)-1,v>>>=a.extra,s-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=Sy;case Sy:for(;c=(u=a.distcode[v&(1<<a.distbits)-1])>>>16&255,h=65535&u,!((d=u>>>24)<=s);){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}if(0==(240&c)){for(E=d,b=c,_=h;c=(u=a.distcode[_+((v&(1<<E+b)-1)>>E)])>>>16&255,h=65535&u,!(E+(d=u>>>24)<=s);){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}v>>>=E,s-=E,a.back+=E}if(v>>>=d,s-=d,a.back+=d,64&c){$.msg="invalid distance code",a.mode=jb;break}a.offset=h,a.extra=15&c,a.mode=Ty;case Ty:if(a.extra){for(R=a.extra;s<R;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}a.offset+=v&(1<<a.extra)-1,v>>>=a.extra,s-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){$.msg="invalid distance too far back",a.mode=jb;break}a.mode=Uy;case Uy:if(0===I)break $;if(l=G-I,a.offset>l){if((l=a.offset-l)>a.whave&&a.sane){$.msg="invalid distance too far back",a.mode=jb;break}l>a.wnext?(l-=a.wnext,o=a.wsize-l):o=a.wnext-l,l>a.length&&(l=a.length),f=a.window}else f=t,o=D-a.offset,l=a.length;l>I&&(l=I),I-=l,a.length-=l;do{t[D++]=f[o++]}while(--l);0===a.length&&(a.mode=Jn);break;case Vy:if(0===I)break $;t[D++]=a.length,I--,a.mode=Jn;break;case Vr:if(a.wrap){for(;s<32;){if(0===n)break $;n--,v|=r[i++]<<s,s+=8}if(G-=I,$.total_out+=G,a.total+=G,G&&($.adler=a.check=a.flags?Ub(a.check,t,G,D-G):Gk(a.check,t,G,D-G)),G=I,(a.flags?v:Yy(v))!==a.check){$.msg="incorrect data check",a.mode=jb;break}v=0,s=0}a.mode=Wy;case Wy:if(a.wrap&&a.flags){for(;s<32;){if(0===n)break $;n--,v+=r[i++]<<s,s+=8}if(v!==(4294967295&a.total)){$.msg="incorrect length check",a.mode=jb;break}v=0,s=0}a.mode=Xy;case Xy:m=sP;break $;case jb:m=Ay;break $;case Wr:return Sr;case vP:default:return _c;}return $.next_out=D,$.avail_out=I,$.next_in=i,$.avail_in=n,a.hold=v,a.bits=s,(a.wsize||G!==$.avail_out&&a.mode<jb&&(a.mode<Vr||e!==zy))&&_y($,$.output,$.next_out,G-$.avail_out)?(a.mode=Wr,Sr):(K-=$.avail_in,G-=$.avail_out,$.total_in+=K,$.total_out+=G,a.total+=G,a.wrap&&G&&($.adler=a.check=a.flags?Ub(a.check,t,G,$.next_out-G):Gk(a.check,t,G,$.next_out-G)),$.data_type=a.bits+(a.last?64:0)+(a.mode===Me?128:0)+(a.mode===In||a.mode===Ur?256:0),(0===K&&0===G||e===zy)&&m===Ug&&(m=uP),m)}function GP($){if(!$||!$.state)return _c;var e=$.state;return e.window&&(e.window=null),$.state=null,Ug}function HP($,e){var a;return $&&$.state?0==(2&(a=$.state).wrap)?_c:(a.head=e,e.done=!1,Ug):_c}function IP($,e){var a,r=e.length;return $&&$.state?0!==(a=$.state).wrap&&a.mode!==Hn?_c:a.mode===Hn&&Gk(1,e,r,0)!==a.check?Ay:_y($,e,r,r)?(a.mode=Wr,Sr):(a.havedict=1,Ug):_c}var JP=CP;var KP=FP;var LP=GP;var MP=HP;var az=IP;var tb={};tb={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var NP={};function OP(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}NP=OP;var Ok={},bz=Object.prototype.toString;function Vg(a){if(!(this instanceof Vg))return new Vg(a);this.options=hi({chunkSize:16384,windowBits:0,to:""},a||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||a&&a.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new py,this.strm.avail_out=0;var $=JP(this.strm,t.windowBits);if($!==tb.Z_OK)throw new Error(Og[$]);if(this.header=new NP,MP(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Or(t.dictionary):"[object ArrayBuffer]"===bz.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&($=az(this.strm,t.dictionary))!==tb.Z_OK))throw new Error(Og[$])}function Xr(a,t){var $=new Vg(t);if($.push(a,!0),$.err)throw $.msg||Og[$.err];return $.result}function PP(a,t){return(t=t||{}).raw=!0,Xr(a,t)}Vg.prototype.push=function(a,t){var $,i,r,n,f,e=this.strm,s=this.options.chunkSize,o=this.options.dictionary,k=!1;if(this.ended)return!1;i=t===~~t?t:!0===t?tb.Z_FINISH:tb.Z_NO_FLUSH,"string"==typeof a?e.input=YO(a):"[object ArrayBuffer]"===bz.call(a)?e.input=new Uint8Array(a):e.input=a,e.next_in=0,e.avail_in=e.input.length;do{if(0===e.avail_out&&(e.output=new Zc(s),e.next_out=0,e.avail_out=s),($=KP(e,tb.Z_NO_FLUSH))===tb.Z_NEED_DICT&&o&&($=az(this.strm,o)),$===tb.Z_BUF_ERROR&&!0===k&&($=tb.Z_OK,k=!1),$!==tb.Z_STREAM_END&&$!==tb.Z_OK)return this.onEnd($),this.ended=!0,!1;e.next_out&&(0!==e.avail_out&&$!==tb.Z_STREAM_END&&(0!==e.avail_in||i!==tb.Z_FINISH&&i!==tb.Z_SYNC_FLUSH)||("string"===this.options.to?(r=$O(e.output,e.next_out),n=e.next_out-r,f=ZO(e.output,r),e.next_out=n,e.avail_out=s-n,n&&ib.arraySet(e.output,e.output,r,n,0),this.onData(f)):this.onData(zk(e.output,e.next_out)))),0===e.avail_in&&0===e.avail_out&&(k=!0)}while((e.avail_in>0||0===e.avail_out)&&$!==tb.Z_STREAM_END);return $===tb.Z_STREAM_END&&(i=tb.Z_FINISH),i===tb.Z_FINISH?($=LP(this.strm),this.onEnd($),this.ended=!0,$===tb.Z_OK):i!==tb.Z_SYNC_FLUSH||(this.onEnd(tb.Z_OK),e.avail_out=0,!0)},Vg.prototype.onData=function(a){this.chunks.push(a)},Vg.prototype.onEnd=function(a){a===tb.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=ib.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg};var QP=Vg;Ok.Inflate=QP;var RP=Xr;Ok.inflate=RP;var SP=PP;Ok.inflateRaw=SP;var TP=Xr;Ok.ungzip=TP;var UP={},VP=hi,cz={};VP(cz,Mk,Ok,tb),UP=cz;var Kn={},WP="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,dz=(nb(),Ha),XP=WP?"uint8array":"array",YP="\b\0";function Wg(r,e){Ga.call(this,"FlateWorker/"+r),this._pako=null,this._pakoAction=r,this._pakoOptions=e,this.meta={}}Kn.magic=YP,dz.inherits(Wg,Ga),Wg.prototype.processChunk=function(r){this.meta=r.meta,null===this._pako&&this._createPako(),this._pako.push(dz.transformTo(XP,r.data),!1)},Wg.prototype.flush=function(){Ga.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},Wg.prototype.cleanUp=function(){Ga.prototype.cleanUp.call(this),this._pako=null},Wg.prototype._createPako=function(){this._pako=new UP[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var r=this;this._pako.onData=function(e){r.push({data:e,meta:r.meta})}};var ZP=function(r){return new Wg("Deflate",r)};Kn.compressWorker=ZP;var $P=function(){return new Wg("Inflate",{})};Kn.uncompressWorker=$P;var Xg={},_P={magic:"\0\0",compressWorker:function(r){return new Ga("STORE compression")},uncompressWorker:function(){return new Ga("STORE decompression")}};Xg.STORE=_P;Xg.DEFLATE=Kn;var Yr="PK\x03\x04";var Zr="PK\x01\x02";var $r="PK\x05\x06";var ez="PK\x06\x07";var _r="PK\x06\x06";var aQ="PK\x07\b";var bQ={},oi=(nb(),Ha),bb=function(e,r){var t,$="";for(t=0;t<r;t++)$+=String.fromCharCode(255&e),e>>>=8;return $},cQ=function(e,r){var t=e;return e||(t=r?16893:33204),(65535&t)<<16},dQ=function(e,r){return 63&(e||0)},fz=function(e,r,t,$,i,s){var o,a,n=e.file,c=e.compression,u=s!==xk,x=oi.transformTo("string",s(n.name)),h=oi.transformTo("string",xk(n.name)),l=n.comment,p=oi.transformTo("string",s(l)),v=oi.transformTo("string",xk(l)),d=h.length!==n.name.length,j=v.length!==l.length,f="",m="",g="",T=n.dir,F=n.date,H={crc32:0,compressedSize:0,uncompressedSize:0};r&&!t||(H.crc32=e.crc32,H.compressedSize=e.compressedSize,H.uncompressedSize=e.uncompressedSize);var W=0;r&&(W|=8),u||!d&&!j||(W|=2048);var k=0,S=0;T&&(k|=16),"UNIX"===i?(S=798,k|=cQ(n.unixPermissions,T)):(S=20,k|=dQ(n.dosPermissions,T)),o=F.getUTCHours(),o<<=6,o|=F.getUTCMinutes(),o<<=5,o|=F.getUTCSeconds()/2,a=F.getUTCFullYear()-1980,a<<=4,a|=F.getUTCMonth()+1,a<<=5,a|=F.getUTCDate(),d&&(m=bb(1,1)+bb(yk(x),4)+h,f+="up"+bb(m.length,2)+m),j&&(g=bb(1,1)+bb(yk(p),4)+v,f+="uc"+bb(g.length,2)+g);var y="";return y+="\n\0",y+=bb(W,2),y+=c.magic,y+=bb(o,2),y+=bb(a,2),y+=bb(H.crc32,4),y+=bb(H.compressedSize,4),y+=bb(H.uncompressedSize,4),y+=bb(x.length,2),y+=bb(f.length,2),{fileRecord:Yr+y+x+f,dirRecord:Zr+bb(S,2)+y+bb(p.length,2)+"\0\0\0\0"+bb(k,4)+bb($,4)+x+f+p}},eQ=function(e,r,t,$,i){var s=oi.transformTo("string",i($));return $r+"\0\0\0\0"+bb(e,2)+bb(e,2)+bb(r,4)+bb(t,4)+bb(s.length,2)+s},fQ=function(e){return aQ+bb(e.crc32,4)+bb(e.compressedSize,4)+bb(e.uncompressedSize,4)};function xd(e,r,t,$){Ga.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=r,this.zipPlatform=t,this.encodeFileName=$,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}oi.inherits(xd,Ga),xd.prototype.push=function(e){var r=e.meta.percent||0,t=this.entriesCount,$=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,Ga.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:t?(r+100*(t-$-1))/t:100}}))},xd.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var r=this.streamFiles&&!e.file.dir;if(r){var t=fz(e,r,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:t.fileRecord,meta:{percent:0}})}else this.accumulate=!0},xd.prototype.closedSource=function(e){this.accumulate=!1;var r=this.streamFiles&&!e.file.dir,t=fz(e,r,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(t.dirRecord),r)this.push({data:fQ(e),meta:{percent:100}});else for(this.push({data:t.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},xd.prototype.flush=function(){for(var e=this.bytesWritten,r=0;r<this.dirRecords.length;r++)this.push({data:this.dirRecords[r],meta:{percent:100}});var t=this.bytesWritten-e,$=eQ(this.dirRecords.length,t,e,this.zipComment,this.encodeFileName);this.push({data:$,meta:{percent:100}})},xd.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},xd.prototype.registerPrevious=function(e){this._sources.push(e);var r=this;return e.on("data",function(e){r.processChunk(e)}),e.on("end",function(){r.closedSource(r.previous.streamInfo),r._sources.length?r.prepareNextSource():r.end()}),e.on("error",function(e){r.error(e)}),this},xd.prototype.resume=function(){return!!Ga.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},xd.prototype.error=function(e){var r=this._sources;if(!Ga.prototype.error.call(this,e))return!1;for(var t=0;t<r.length;t++)try{r[t].error(e)}catch(e){}return!0},xd.prototype.lock=function(){Ga.prototype.lock.call(this);for(var e=this._sources,r=0;r<e.length;r++)e[r].lock()},bQ=xd;var gQ=function(r,e){var o=r||e,s=Xg[o];if(!s)throw new Error(o+" is not a valid compression method !");return s},hQ=function(r,e,o){var s=new bQ(e.streamFiles,o,e.platform,e.encodeFileName),i=0;try{r.forEach(function(r,o){i++;var n=gQ(o.options.compression,e.compression),t=o.options.compressionOptions||e.compressionOptions||{},$=o.dir,p=o.date;o._compressWorker(n,t).withStreamInfo("file",{name:r,dir:$,date:p,comment:o.comment||"",unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions}).pipe(s)}),s.entriesCount=i}catch(n){s.error(n)}return s};var iQ={},jQ=(nb(),Ha);function Pk(e,r){Ga.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(r)}jQ.inherits(Pk,Ga),Pk.prototype._bindStream=function(e){var r=this;this._stream=e,e.pause(),e.on("data",function(e){r.push({data:e,meta:{percent:0}})}).on("error",function(e){r.isPaused?this.generatedError=e:r.error(e)}).on("end",function(){r.isPaused?r._upstreamEnded=!0:r.end()})},Pk.prototype.pause=function(){return!!Ga.prototype.pause.call(this)&&(this._stream.pause(),!0)},Pk.prototype.resume=function(){return!!Ga.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},iQ=Pk;var kQ={},Qk=(nb(),Ha),gz=(pn(),on),hz=function(e,r,t){var a,i=Qk.getTypeOf(r),n=Qk.extend(t||{},Yc);n.date=n.date||new Date,null!==n.compression&&(n.compression=n.compression.toUpperCase()),"string"==typeof n.unixPermissions&&(n.unixPermissions=parseInt(n.unixPermissions,8)),n.unixPermissions&&16384&n.unixPermissions&&(n.dir=!0),n.dosPermissions&&16&n.dosPermissions&&(n.dir=!0),n.dir&&(e=iz(e)),n.createFolders&&(a=lQ(e))&&jz.call(this,a,!0);var s="string"===i&&!1===n.binary&&!1===n.base64;t&&void 0!==t.binary||(n.binary=!s),(r instanceof fi&&0===r.uncompressedSize||n.dir||!r||0===r.length)&&(n.base64=!1,n.binary=!0,r="",n.compression="STORE",i="string");var $=null;$=r instanceof fi||r instanceof Ga?r:gz.isNode&&gz.isStream(r)?new iQ(e,r):Qk.prepareContent(e,r,n.binary,n.optimizedBinaryString,n.base64);var o=new CN(e,$,n);this.files[e]=o},lQ=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var r=e.lastIndexOf("/");return r>0?e.substring(0,r):""},iz=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},jz=function(e,r){return r=void 0!==r?r:Nx,e=iz(e),this.files[e]||hz.call(this,e,null,{dir:!0,createFolders:r}),this.files[e]};function kz(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var mQ={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var r,t,a;for(r in this.files)this.files.hasOwnProperty(r)&&(a=this.files[r],(t=r.slice(this.root.length,r.length))&&r.slice(0,this.root.length)===this.root&&e(t,a))},filter:function(e){var r=[];return this.forEach(function(t,a){e(t,a)&&r.push(a)}),r},file:function(e,r,t){if(1===arguments.length){if(kz(e)){var a=e;return this.filter(function(e,r){return!r.dir&&a.test(e)})}var i=this.files[this.root+e];return i&&!i.dir?i:null}return e=this.root+e,hz.call(this,e,r,t),this},folder:function(e){if(!e)return this;if(kz(e))return this.filter(function(r,t){return t.dir&&e.test(r)});var r=this.root+e,t=jz.call(this,r),a=this.clone();return a.root=t.name,a},remove:function(e){e=this.root+e;var r=this.files[e];if(r||("/"!==e.slice(-1)&&(e+="/"),r=this.files[e]),r&&!r.dir)delete this.files[e];else for(var t=this.filter(function(r,t){return t.name.slice(0,e.length)===e}),a=0;a<t.length;a++)delete this.files[t[a].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var r,t={};try{if((t=Qk.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:xk})).type=t.type.toLowerCase(),t.compression=t.compression.toUpperCase(),"binarystring"===t.type&&(t.type="string"),!t.type)throw new Error("No output type specified.");Qk.checkSupport(t.type),"darwin"!==t.platform&&"freebsd"!==t.platform&&"linux"!==t.platform&&"sunos"!==t.platform||(t.platform="UNIX"),"win32"===t.platform&&(t.platform="DOS");var a=t.comment||this.comment||"";r=hQ(this,t,a)}catch(i){(r=new Ga("error")).error(i)}return new Lx(r,t.type||"string",t.mimeType)},generateAsync:function(e,r){return this.generateInternalStream(e).accumulate(r)},generateNodeStream:function(e,r){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(r)}};kQ=mQ;var Ln={},nQ=(nb(),Ha);function lz(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}lz.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,n=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)n=(n<<8)+this.byteAt(e);return this.index+=t,n},readString:function(t){return nQ.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},Ln=lz;var as={},oQ=(nb(),Ha);function pi(r){Ln.call(this,r);for(var a=0;a<this.data.length;a++)r[a]=255&r[a]}oQ.inherits(pi,Ln),pi.prototype.byteAt=function(r){return this.data[this.zero+r]},pi.prototype.lastIndexOfSignature=function(r){for(var a=r.charCodeAt(0),t=r.charCodeAt(1),e=r.charCodeAt(2),o=r.charCodeAt(3),$=this.length-4;$>=0;--$)if(this.data[$]===a&&this.data[$+1]===t&&this.data[$+2]===e&&this.data[$+3]===o)return $-this.zero;return-1},pi.prototype.readAndCheckSignature=function(r){var a=r.charCodeAt(0),t=r.charCodeAt(1),e=r.charCodeAt(2),o=r.charCodeAt(3),$=this.readData(4);return a===$[0]&&t===$[1]&&e===$[2]&&o===$[3]},pi.prototype.readData=function(r){if(this.checkOffset(r),0===r)return[];var a=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,a},as=pi;var pQ={},qQ=(nb(),Ha);function qi(r){Ln.call(this,r)}qQ.inherits(qi,Ln),qi.prototype.byteAt=function(r){return this.data.charCodeAt(this.zero+r)},qi.prototype.lastIndexOfSignature=function(r){return this.data.lastIndexOf(r)-this.zero},qi.prototype.readAndCheckSignature=function(r){return r===this.readData(4)},qi.prototype.readData=function(r){this.checkOffset(r);var t=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,t},pQ=qi;var bs={},rQ=(nb(),Ha);function cs(r){as.call(this,r)}rQ.inherits(cs,as),cs.prototype.readData=function(r){if(this.checkOffset(r),0===r)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+r);return this.index+=r,t},bs=cs;var sQ={},tQ=(nb(),Ha);function ds(e){bs.call(this,e)}tQ.inherits(ds,bs),ds.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r},sQ=ds;var Mn={},Nn=(nb(),Ha),mz=(vf(),Fb);Mn=function(r){var $=Nn.getTypeOf(r);return Nn.checkSupport($),"string"!==$||mz.uint8array?"nodebuffer"===$?new sQ(r):mz.uint8array?new bs(Nn.transformTo("uint8array",r)):new as(Nn.transformTo("array",r)):new pQ(r)};var uQ={},Hf=(nb(),Ha),vQ=(vf(),Fb),wQ=0,xQ=3,yQ=function(e){for(var r in Xg)if(Xg.hasOwnProperty(r)&&Xg[r].magic===e)return Xg[r];return null};function nz(e,r){this.options=e,this.loadOptions=r}nz.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var r,t;if(e.skip(22),this.fileNameLength=e.readInt(2),t=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(t),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(r=yQ(this.compressionMethod)))throw new Error("Corrupted zip : compression "+Hf.pretty(this.compressionMethod)+" unknown (inner file : "+Hf.transformTo("string",this.fileName)+")");this.decompressed=new fi(this.compressedSize,this.uncompressedSize,this.crc32,r,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var r=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(r),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),e===wQ&&(this.dosPermissions=63&this.externalFileAttributes),e===xQ&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var r=Mn(this.extraFields[1].value);this.uncompressedSize===Hf.MAX_VALUE_32BITS&&(this.uncompressedSize=r.readInt(8)),this.compressedSize===Hf.MAX_VALUE_32BITS&&(this.compressedSize=r.readInt(8)),this.localHeaderOffset===Hf.MAX_VALUE_32BITS&&(this.localHeaderOffset=r.readInt(8)),this.diskNumberStart===Hf.MAX_VALUE_32BITS&&(this.diskNumberStart=r.readInt(4))}},readExtraFields:function(e){var r,t,s,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)r=e.readInt(2),t=e.readInt(2),s=e.readData(t),this.extraFields[r]={id:r,length:t,value:s};e.setIndex(i)},handleUTF8:function(){var e=vQ.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=Lg(this.fileName),this.fileCommentStr=Lg(this.fileComment);else{var r=this.findExtraFieldUnicodePath();if(null!==r)this.fileNameStr=r;else{var t=Hf.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(t)}var s=this.findExtraFieldUnicodeComment();if(null!==s)this.fileCommentStr=s;else{var i=Hf.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var r=Mn(e.value);return 1!==r.readInt(1)?null:yk(this.fileName)!==r.readInt(4)?null:Lg(r.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var r=Mn(e.value);return 1!==r.readInt(1)?null:yk(this.fileComment)!==r.readInt(4)?null:Lg(r.readData(e.length-5))}return null}},uQ=nz;var zQ={},Ne=(nb(),Ha),AQ=(vf(),Fb);function oz(r){this.files=[],this.loadOptions=r}oz.prototype={checkSignature:function(r){if(!this.reader.readAndCheckSignature(r)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+Ne.pretty(e)+", expected "+Ne.pretty(r)+")")}},isSignature:function(r,e){var t=this.reader.index;this.reader.setIndex(r);var i=this.reader.readString(4)===e;return this.reader.setIndex(t),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var r=this.reader.readData(this.zipCommentLength),e=AQ.uint8array?"uint8array":"array",t=Ne.transformTo(e,r);this.zipComment=this.loadOptions.decodeFileName(t)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var r,e,t,i=this.zip64EndOfCentralSize-44;0<i;)r=this.reader.readInt(2),e=this.reader.readInt(4),t=this.reader.readData(e),this.zip64ExtensibleData[r]={id:r,length:e,value:t}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var r,e;for(r=0;r<this.files.length;r++)e=this.files[r],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(Yr),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var r;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(Zr);)(r=new uQ({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(r);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var r=this.reader.lastIndexOfSignature($r);if(r<0)throw!this.isSignature(0,Yr)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(r);var e=r;if(this.checkSignature($r),this.readBlockEndOfCentral(),this.diskNumber===Ne.MAX_VALUE_16BITS||this.diskWithCentralDirStart===Ne.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===Ne.MAX_VALUE_16BITS||this.centralDirRecords===Ne.MAX_VALUE_16BITS||this.centralDirSize===Ne.MAX_VALUE_32BITS||this.centralDirOffset===Ne.MAX_VALUE_32BITS){if(this.zip64=!0,(r=this.reader.lastIndexOfSignature(ez))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(r),this.checkSignature(ez),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,_r)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(_r),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(_r),this.readBlockZip64EndOfCentral()}var t=this.centralDirOffset+this.centralDirSize;this.zip64&&(t+=20,t+=12+this.zip64EndOfCentralSize);var i=e-t;if(i>0)this.isSignature(e,Zr)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(r){this.reader=Mn(r)},load:function(r){this.prepareReader(r),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},zQ=oz;var BQ={},pz=(nb(),Ha),On=(tk(),sk),CQ=(pz=(nb(),Ha),zQ),qz=(pn(),on);function DQ(e){return new On.Promise(function(r,t){var i=e.decompressed.getContentWorker().pipe(new Qx);i.on("error",function(e){t(e)}).on("end",function(){i.streamInfo.crc32!==e.decompressed.crc32?t(new Error("Corrupted zip : CRC32 mismatch")):r()}).resume()})}BQ=function(e,r){var t=this;return r=pz.extend(r||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:Lg}),qz.isNode&&qz.isStream(e)?On.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):pz.prepareContent("the loaded zip file",e,!0,r.optimizedBinaryString,r.base64).then(function(e){var t=new CQ(r);return t.load(e),t}).then(function(e){var t=[On.Promise.resolve(e)],i=e.files;if(r.checkCRC32)for(var n=0;n<i.length;n++)t.push(DQ(i[n]));return On.Promise.all(t)}).then(function(e){for(var i=e.shift(),n=i.files,$=0;$<n.length;$++){var a=n[$];t.file(a.fileNameStr,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:r.createFolders})}return i.zipComment.length&&(t.comment=i.zipComment),t})};Xc.prototype=kQ,Xc.prototype.loadAsync=BQ,Xc.support=(vf(),Fb),Xc.defaults=Yc,Xc.version="3.5.0",Xc.loadAsync=function(i,r){return new Xc().loadAsync(i,r)},Xc.external=(tk(),sk),AI=Xc;var es,fs={};!function(e,t){"function"==typeof es&&es.amd?es([],t):void 0!==fs?t():(t(),e.FileSaver={})}(fs,function(){function e(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){r(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function t(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function n(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof ab&&ab.global===ab?ab:void 0,a=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),r=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(a,r,i){var c=o.URL||o.webkitURL,l=document.createElement("a");r=r||a.name||"download",l.download=r,l.rel="noopener","string"==typeof a?(l.href=a,l.origin===location.origin?n(l):t(l.href)?e(a,r,i):n(l,l.target="_blank")):(l.href=c.createObjectURL(a),setTimeout(function(){c.revokeObjectURL(l.href)},4e4),setTimeout(function(){n(l)},0))}:"msSaveOrOpenBlob"in navigator?function(o,a,r){if(a=a||o.name||"download","string"!=typeof o)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e}(o,r),a);else if(t(o))e(o,a,r);else{var i=document.createElement("a");i.href=o,i.target="_blank",setTimeout(function(){n(i)})}}:function(t,n,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,r);var c="application/octet-stream"===t.type,l=/constructor/i.test(o.HTMLElement)||o.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||c&&l||a)&&"undefined"!=typeof FileReader){var f=new FileReader;f.onloadend=function(){var e=f.result;e=s?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},f.readAsDataURL(t)}else{var u=o.URL||o.webkitURL,d=u.createObjectURL(t);i?i.location=d:location.href=d,i=null,setTimeout(function(){u.revokeObjectURL(d)},4e4)}});o.saveAs=r.saveAs=r,fs=r});function EQ(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function rz(e,i){for(var r=0;r<i.length;r++){var o=i[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function FQ(e,i,r){return i&&rz(e.prototype,i),r&&rz(e,r),e}function GQ(e){return(GQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sz(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function IQ(e,t,r){return t&&sz(e.prototype,t),r&&sz(e,r),e}function JQ(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KQ(e,t)}function KQ(e,t){return(KQ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LQ(e){var t=OQ();return function(){var r,o=tz(e);if(t){var n=tz(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return MQ(this,r)}}function MQ(e,t){return!t||"object"!==GQ(t)&&"function"!=typeof t?NQ(e):t}function NQ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OQ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function tz(e){return(tz=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PQ={};function gs(){var r=this;if(!(this instanceof gs))return new(Function.prototype.bind.apply(gs,[null].concat(Array.prototype.slice.call(arguments))));Array.from(arguments).forEach(function(n){r[n]=Symbol(n)})}PQ=gs;var If="inch";var Jf="feetAndInch";var Oe="m";var Rd="cm";var Kf="mm";var Pn=Wc(PQ);var za=Pn.d("STRAIGHT","CURVED");var Yg=300;var ri={color:"#FFFFFF",repeat:Yg,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png"};var uz={color:"#FFFFFF",emissive:"#181818",repeat:Yg,ambientmap:"textures/Floor/Marble_Tiles_001/Marble_Tiles_001_ambientOcclusion.jpg",colormap:"textures/Floor/Marble_Tiles_001/Marble_Tiles_001_basecolor.jpg",roughnessmap:"textures/Floor/Marble_Tiles_001/Marble_Tiles_001_roughness.jpg",normalmap:"textures/Floor/Marble_Tiles_001/Marble_Tiles_001_normal.jpg"};void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const t=Object(e);for(let r=1;r<arguments.length;r++){const e=arguments[r];if(null!=e)for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t});const Lf={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Mf={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},QQ=0,vz=1,RQ=2,wz=1,xz=2,Rk=3,Pe=0,Ob=1,Pb=2,Nf=0,Sk=1,yz=2,zz=3,Az=4,SQ=5,si=100,TQ=101,UQ=102,VQ=200,WQ=201,XQ=202,YQ=203,Bz=204,Cz=205,ZQ=206,$Q=207,_Q=208,aR=209,bR=210,cR=0,dR=1,eR=2,hs=3,fR=4,gR=5,hR=6,iR=7,Qn=0,jR=1,kR=2,ti=0,lR=1,mR=2,nR=3,oR=4,pR=5,Rn=301,is=302,Dz=303,js=304,Tk=306,ks=307,tc=1e3,ec=1001,ui=1002,Gb=1003,Uk=1004,Vk=1005,Qb=1006,Sn=1007,Of=1008,Wk=1009,qR=1010,rR=1011,Tn=1012,sR=1013,Un=1014,Pf=1015,Vn=1016,tR=1017,uR=1018,vR=1019,Xk=1020,wR=1021,Sd=1022,Gc=1023,xR=1024,yR=1025,zR=Gc,vi=1026,Yk=1027,AR=1028,BR=1029,CR=1030,DR=1031,ER=1032,FR=1033,Ez=33776,Fz=33777,Gz=33778,Hz=33779,Iz=35840,Jz=35841,Kz=35842,Lz=35843,GR=36196,Mz=37492,Nz=37496,HR=37808,IR=37809,JR=37810,KR=37811,LR=37812,MR=37813,NR=37814,OR=37815,PR=37816,QR=37817,RR=37818,SR=37819,TR=37820,UR=37821,VR=36492,WR=37840,XR=37841,YR=37842,ZR=37843,$R=37844,_R=37845,aS=37846,bS=37847,cS=37848,dS=37849,eS=37850,fS=37851,gS=37852,hS=37853,iS=2201,Oz=2300,ls=2301,wi=2400,ms=2500,jS=1,Pz=2,uc=3e3,vc=3001,ns=3007,os=3002,kS=3003,Qz=3004,Rz=3005,Sz=3006,lS=3200,mS=3201,Zg=0,nS=1,ps=7680,oS=519,Wn=35044,Zk=35048;function Qa(){}Object.assign(Qa.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)},removeEventListener:function(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const e=r.indexOf(t);-1!==e&&r.splice(e,1)}},dispatchEvent:function(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const r=t.slice(0);for(let t=0,n=r.length;t<n;t++)r[t].call(this,e)}}});const _b=[];for(let e=0;e<256;e++)_b[e]=(e<16?"0":"")+e.toString(16);const ta={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(_b[255&e]+_b[e>>8&255]+_b[e>>16&255]+_b[e>>24&255]+"-"+_b[255&t]+_b[t>>8&255]+"-"+_b[t>>16&15|64]+_b[t>>24&255]+"-"+_b[63&r|128]+_b[r>>8&255]+"-"+_b[r>>16&255]+_b[r>>24&255]+_b[255&n]+_b[n>>8&255]+_b[n>>16&255]+_b[n>>24&255]).toUpperCase()},clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,n,o){return n+(e-t)*(o-n)/(r-t)},lerp:function(e,t,r){return(1-r)*e+r*t},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*ta.DEG2RAD},radToDeg:function(e){return e*ta.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,r,n,o){const i=Math.cos,a=Math.sin,s=i(r/2),d=a(r/2),$=i((t+n)/2),c=a((t+n)/2),p=i((t-n)/2),l=a((t-n)/2),u=i((n-t)/2),h=a((n-t)/2);switch(o){case"XYX":e.set(s*c,d*p,d*l,s*$);break;case"YZY":e.set(d*l,s*c,d*p,s*$);break;case"ZXZ":e.set(d*p,d*l,s*c,s*$);break;case"XZX":e.set(s*c,d*h,d*u,s*$);break;case"YXY":e.set(d*u,s*c,d*h,s*$);break;case"ZYZ":e.set(d*h,d*u,s*c,s*$);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+o);}}};function ca(e=0,t=0){this.x=e,this.y=t}function nc(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}let $k;Object.defineProperties(ca.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(ca.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e);}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){const t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){const r=Math.cos(t),n=Math.sin(t),o=this.x-e.x,i=this.y-e.y;return this.x=o*r-i*n+e.x,this.y=o*n+i*r+e.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Object.assign(nc.prototype,{isMatrix3:!0,set:function(e,t,r,n,o,i,a,s,d){const $=this.elements;return $[0]=e,$[1]=n,$[2]=a,$[3]=t,$[4]=o,$[5]=s,$[6]=r,$[7]=i,$[8]=d,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this},extractBasis:function(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this},setFromMatrix4:function(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){const r=e.elements,n=t.elements,o=this.elements,i=r[0],a=r[3],s=r[6],d=r[1],$=r[4],c=r[7],p=r[2],l=r[5],u=r[8],h=n[0],f=n[3],m=n[6],x=n[1],R=n[4],g=n[7],v=n[2],q=n[5],K=n[8];return o[0]=i*h+a*x+s*v,o[3]=i*f+a*R+s*q,o[6]=i*m+a*g+s*K,o[1]=d*h+$*x+c*v,o[4]=d*f+$*R+c*q,o[7]=d*m+$*g+c*K,o[2]=p*h+l*x+u*v,o[5]=p*f+l*R+u*q,o[8]=p*m+l*g+u*K,this},multiplyScalar:function(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){const e=this.elements,t=e[0],r=e[1],n=e[2],o=e[3],i=e[4],a=e[5],s=e[6],d=e[7],$=e[8];return t*i*$-t*a*d-r*o*$+r*a*s+n*o*d-n*i*s},getInverse:function(e,t){void 0!==t&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const r=e.elements,n=this.elements,o=r[0],i=r[1],a=r[2],s=r[3],d=r[4],$=r[5],c=r[6],p=r[7],l=r[8],u=l*d-$*p,h=$*c-l*s,f=p*s-d*c,m=o*u+i*h+a*f;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);const x=1/m;return n[0]=u*x,n[1]=(a*p-l*i)*x,n[2]=($*i-a*d)*x,n[3]=h*x,n[4]=(l*o-a*c)*x,n[5]=(a*s-$*o)*x,n[6]=f*x,n[7]=(i*c-p*o)*x,n[8]=(d*o-i*s)*x,this},transpose:function(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,r,n,o,i,a){const s=Math.cos(o),d=Math.sin(o);this.set(r*s,r*d,-r*(s*i+d*a)+i+e,-n*d,n*s,-n*(-d*i+s*a)+a+t,0,0,1)},scale:function(e,t){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this},rotate:function(e){const t=Math.cos(e),r=Math.sin(e),n=this.elements,o=n[0],i=n[3],a=n[6],s=n[1],d=n[4],$=n[7];return n[0]=t*o+r*s,n[3]=t*i+r*d,n[6]=t*a+r*$,n[1]=-r*o+t*s,n[4]=-r*i+t*d,n[7]=-r*a+t*$,this},translate:function(e,t){const r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this},equals:function(e){const t=this.elements,r=e.elements;for(let n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}});const Qf={getDataURL:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===$k&&($k=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),$k.width=e.width,$k.height=e.height;const r=$k.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=$k}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}};let pS=0;function $a(e,t,r,n,o,i,a,s,d,$){Object.defineProperty(this,"id",{value:pS++}),this.uuid=ta.generateUUID(),this.name="",this.image=void 0!==e?e:$a.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:$a.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:ec,this.wrapT=void 0!==n?n:ec,this.magFilter=void 0!==o?o:Qb,this.minFilter=void 0!==i?i:Of,this.anisotropy=void 0!==d?d:1,this.format=void 0!==a?a:Gc,this.internalFormat=null,this.type=void 0!==s?s:Wk,this.offset=new ca(0,0),this.repeat=new ca(1,1),this.center=new ca(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new nc,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==$?$:uc,this.version=0,this.onUpdate=null}function Ta(e=0,t=0,r=0,n=1){this.x=e,this.y=t,this.z=r,this.w=n}function ad(e,t,r){this.width=e,this.height=t,this.scissor=new Ta(0,0,e,t),this.scissorTest=!1,this.viewport=new Ta(0,0,e,t),r=r||{},this.texture=new $a(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:Qb,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}function Tz(e,t,r){ad.call(this,e,t,r),this.samples=4}function yb(e=0,t=0,r=0,n=1){this._x=e,this._y=t,this._z=r,this._w=n}$a.DEFAULT_IMAGE=void 0,$a.DEFAULT_MAPPING=300,$a.prototype=Object.assign(Object.create(Qa.prototype),{constructor:$a,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const n=this.image;if(void 0===n.uuid&&(n.uuid=ta.generateUUID()),!t&&void 0===e.images[n.uuid]){let t;if(Array.isArray(n)){t=[];for(let e=0,r=n.length;e<r;e++)t.push(Qf.getDataURL(n[e]))}else t=Qf.getDataURL(n);e.images[n.uuid]={uuid:n.uuid,url:t}}r.image=n.uuid}return t||(e.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case tc:e.x=e.x-Math.floor(e.x);break;case ec:e.x=e.x<0?0:1;break;case ui:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);}if(e.y<0||e.y>1)switch(this.wrapT){case tc:e.y=e.y-Math.floor(e.y);break;case ec:e.y=e.y<0?0:1;break;case ui:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty($a.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.defineProperties(Ta.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(Ta.prototype,{isVector4:!0,set:function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e);}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){const t=this.x,r=this.y,n=this.z,o=this.w,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n+i[12]*o,this.y=i[1]*t+i[5]*r+i[9]*n+i[13]*o,this.z=i[2]*t+i[6]*r+i[10]*n+i[14]*o,this.w=i[3]*t+i[7]*r+i[11]*n+i[15]*o,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){let t,r,n,o;const i=e.elements,a=i[0],s=i[4],d=i[8],$=i[1],c=i[5],p=i[9],l=i[2],u=i[6],h=i[10];if(Math.abs(s-$)<.01&&Math.abs(d-l)<.01&&Math.abs(p-u)<.01){if(Math.abs(s+$)<.1&&Math.abs(d+l)<.1&&Math.abs(p+u)<.1&&Math.abs(a+c+h-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const e=(a+1)/2,i=(c+1)/2,f=(h+1)/2,m=(s+$)/4,x=(d+l)/4,R=(p+u)/4;return e>i&&e>f?e<.01?(r=0,n=.707106781,o=.707106781):(n=m/(r=Math.sqrt(e)),o=x/r):i>f?i<.01?(r=.707106781,n=0,o=.707106781):(r=m/(n=Math.sqrt(i)),o=R/n):f<.01?(r=.707106781,n=.707106781,o=0):(r=x/(o=Math.sqrt(f)),n=R/o),this.set(r,n,o,t),this}let f=Math.sqrt((u-p)*(u-p)+(d-l)*(d-l)+($-s)*($-s));return Math.abs(f)<.001&&(f=1),this.x=(u-p)/f,this.y=(d-l)/f,this.z=($-s)/f,this.w=Math.acos((a+c+h-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),ad.prototype=Object.assign(Object.create(Qa.prototype),{constructor:ad,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Tz.prototype=Object.assign(Object.create(ad.prototype),{constructor:Tz,isWebGLMultisampleRenderTarget:!0,copy:function(e){return ad.prototype.copy.call(this,e),this.samples=e.samples,this}}),Object.assign(yb,{slerp:function(e,t,r,n){return r.copy(e).slerp(t,n)},slerpFlat:function(e,t,r,n,o,i,a){let s=r[n+0],d=r[n+1],$=r[n+2],c=r[n+3];const p=o[i+0],l=o[i+1],u=o[i+2],h=o[i+3];if(c!==h||s!==p||d!==l||$!==u){let e=1-a,t=s*p+d*l+$*u+c*h,r=t>=0?1:-1,n=1-t*t;if(n>Number.EPSILON){const o=Math.sqrt(n),i=Math.atan2(o,t*r);e=Math.sin(e*i)/o,a=Math.sin(a*i)/o}const o=a*r;if(s=s*e+p*o,d=d*e+l*o,$=$*e+u*o,c=c*e+h*o,e===1-a){const e=1/Math.sqrt(s*s+d*d+$*$+c*c);s*=e,d*=e,$*=e,c*=e}}e[t]=s,e[t+1]=d,e[t+2]=$,e[t+3]=c},multiplyQuaternionsFlat:function(e,t,r,n,o,i){const a=r[n],s=r[n+1],d=r[n+2],$=r[n+3],c=o[i],p=o[i+1],l=o[i+2],u=o[i+3];return e[t]=a*u+$*c+s*l-d*p,e[t+1]=s*u+$*p+d*c-a*l,e[t+2]=d*u+$*l+a*p-s*c,e[t+3]=$*u-a*c-s*p-d*l,e}}),Object.defineProperties(yb.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(yb.prototype,{isQuaternion:!0,set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const r=e._x,n=e._y,o=e._z,i=e.order,a=Math.cos,s=Math.sin,d=a(r/2),$=a(n/2),c=a(o/2),p=s(r/2),l=s(n/2),u=s(o/2);switch(i){case"XYZ":this._x=p*$*c+d*l*u,this._y=d*l*c-p*$*u,this._z=d*$*u+p*l*c,this._w=d*$*c-p*l*u;break;case"YXZ":this._x=p*$*c+d*l*u,this._y=d*l*c-p*$*u,this._z=d*$*u-p*l*c,this._w=d*$*c+p*l*u;break;case"ZXY":this._x=p*$*c-d*l*u,this._y=d*l*c+p*$*u,this._z=d*$*u+p*l*c,this._w=d*$*c-p*l*u;break;case"ZYX":this._x=p*$*c-d*l*u,this._y=d*l*c+p*$*u,this._z=d*$*u-p*l*c,this._w=d*$*c+p*l*u;break;case"YZX":this._x=p*$*c+d*l*u,this._y=d*l*c+p*$*u,this._z=d*$*u-p*l*c,this._w=d*$*c-p*l*u;break;case"XZY":this._x=p*$*c-d*l*u,this._y=d*l*c-p*$*u,this._z=d*$*u+p*l*c,this._w=d*$*c+p*l*u;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+i);}return!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){const r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this},setFromRotationMatrix:function(e){const t=e.elements,r=t[0],n=t[4],o=t[8],i=t[1],a=t[5],s=t[9],d=t[2],$=t[6],c=t[10],p=r+a+c;if(p>0){const e=.5/Math.sqrt(p+1);this._w=.25/e,this._x=($-s)*e,this._y=(o-d)*e,this._z=(i-n)*e}else if(r>a&&r>c){const e=2*Math.sqrt(1+r-a-c);this._w=($-s)/e,this._x=.25*e,this._y=(n+i)/e,this._z=(o+d)/e}else if(a>c){const e=2*Math.sqrt(1+a-r-c);this._w=(o-d)/e,this._x=(n+i)/e,this._y=.25*e,this._z=(s+$)/e}else{const e=2*Math.sqrt(1+c-r-a);this._w=(i-n)/e,this._x=(o+d)/e,this._y=(s+$)/e,this._z=.25*e}return this._onChangeCallback(),this},setFromUnitVectors:function(e,t){let r=e.dot(t)+1;return r<1e-6?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(ta.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){const r=this.angleTo(e);if(0===r)return this;const n=Math.min(1,t/r);return this.slerp(e,n),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){const r=e._x,n=e._y,o=e._z,i=e._w,a=t._x,s=t._y,d=t._z,$=t._w;return this._x=r*$+i*a+n*d-o*s,this._y=n*$+i*s+o*a-r*d,this._z=o*$+i*d+r*s-n*a,this._w=i*$-r*a-n*s-o*d,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);const r=this._x,n=this._y,o=this._z,i=this._w;let a=i*e._w+r*e._x+n*e._y+o*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=i,this._x=r,this._y=n,this._z=o,this;const s=1-a*a;if(s<=Number.EPSILON){const e=1-t;return this._w=e*i+t*this._w,this._x=e*r+t*this._x,this._y=e*n+t*this._y,this._z=e*o+t*this._z,this.normalize(),this._onChangeCallback(),this}const d=Math.sqrt(s),$=Math.atan2(d,a),c=Math.sin((1-t)*$)/d,p=Math.sin(t*$)/d;return this._w=i*c+this._w*p,this._x=r*c+this._x*p,this._y=n*c+this._y*p,this._z=o*c+this._z*p,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},fromBufferAttribute:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});const qs=new ba,Uz=new yb;function ba(e=0,t=0,r=0){this.x=e,this.y=t,this.z=r}Object.assign(ba.prototype,{isVector3:!0,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e);}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Uz.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(Uz.setFromAxisAngle(e,t))},applyMatrix3:function(e){const t=this.x,r=this.y,n=this.z,o=e.elements;return this.x=o[0]*t+o[3]*r+o[6]*n,this.y=o[1]*t+o[4]*r+o[7]*n,this.z=o[2]*t+o[5]*r+o[8]*n,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){const t=this.x,r=this.y,n=this.z,o=e.elements,i=1/(o[3]*t+o[7]*r+o[11]*n+o[15]);return this.x=(o[0]*t+o[4]*r+o[8]*n+o[12])*i,this.y=(o[1]*t+o[5]*r+o[9]*n+o[13])*i,this.z=(o[2]*t+o[6]*r+o[10]*n+o[14])*i,this},applyQuaternion:function(e){const t=this.x,r=this.y,n=this.z,o=e.x,i=e.y,a=e.z,s=e.w,d=s*t+i*n-a*r,$=s*r+a*t-o*n,c=s*n+o*r-i*t,p=-o*t-i*r-a*n;return this.x=d*s+p*-o+$*-a-c*-i,this.y=$*s+p*-i+c*-o-d*-a,this.z=c*s+p*-a+d*-i-$*-o,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){const t=this.x,r=this.y,n=this.z,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*n,this.y=o[1]*t+o[5]*r+o[9]*n,this.z=o[2]*t+o[6]*r+o[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){const r=e.x,n=e.y,o=e.z,i=t.x,a=t.y,s=t.z;return this.x=n*s-o*a,this.y=o*i-r*s,this.z=r*a-n*i,this},projectOnVector:function(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)},projectOnPlane:function(e){return qs.copy(this).projectOnVector(e),this.sub(qs)},reflect:function(e){return this.sub(qs.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(ta.clamp(r,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){const t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,r){const n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,3*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});const xi=new ba,yd=new fa,qS=new ba(0,0,0),rS=new ba(1,1,1),Rf=new ba,Xn=new ba,Hc=new ba;function fa(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(fa.prototype,{isMatrix4:!0,set:function(e,t,r,n,o,i,a,s,d,$,c,p,l,u,h,f){const m=this.elements;return m[0]=e,m[4]=t,m[8]=r,m[12]=n,m[1]=o,m[5]=i,m[9]=a,m[13]=s,m[2]=d,m[6]=$,m[10]=c,m[14]=p,m[3]=l,m[7]=u,m[11]=h,m[15]=f,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new fa().fromArray(this.elements)},copy:function(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this},copyPosition:function(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this},extractBasis:function(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this},extractRotation:function(e){const t=this.elements,r=e.elements,n=1/xi.setFromMatrixColumn(e,0).length(),o=1/xi.setFromMatrixColumn(e,1).length(),i=1/xi.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*o,t[5]=r[5]*o,t[6]=r[6]*o,t[7]=0,t[8]=r[8]*i,t[9]=r[9]*i,t[10]=r[10]*i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,r=e.x,n=e.y,o=e.z,i=Math.cos(r),a=Math.sin(r),s=Math.cos(n),d=Math.sin(n),$=Math.cos(o),c=Math.sin(o);if("XYZ"===e.order){const e=i*$,r=i*c,n=a*$,o=a*c;t[0]=s*$,t[4]=-s*c,t[8]=d,t[1]=r+n*d,t[5]=e-o*d,t[9]=-a*s,t[2]=o-e*d,t[6]=n+r*d,t[10]=i*s}else if("YXZ"===e.order){const e=s*$,r=s*c,n=d*$,o=d*c;t[0]=e+o*a,t[4]=n*a-r,t[8]=i*d,t[1]=i*c,t[5]=i*$,t[9]=-a,t[2]=r*a-n,t[6]=o+e*a,t[10]=i*s}else if("ZXY"===e.order){const e=s*$,r=s*c,n=d*$,o=d*c;t[0]=e-o*a,t[4]=-i*c,t[8]=n+r*a,t[1]=r+n*a,t[5]=i*$,t[9]=o-e*a,t[2]=-i*d,t[6]=a,t[10]=i*s}else if("ZYX"===e.order){const e=i*$,r=i*c,n=a*$,o=a*c;t[0]=s*$,t[4]=n*d-r,t[8]=e*d+o,t[1]=s*c,t[5]=o*d+e,t[9]=r*d-n,t[2]=-d,t[6]=a*s,t[10]=i*s}else if("YZX"===e.order){const e=i*s,r=i*d,n=a*s,o=a*d;t[0]=s*$,t[4]=o-e*c,t[8]=n*c+r,t[1]=c,t[5]=i*$,t[9]=-a*$,t[2]=-d*$,t[6]=r*c+n,t[10]=e-o*c}else if("XZY"===e.order){const e=i*s,r=i*d,n=a*s,o=a*d;t[0]=s*$,t[4]=-c,t[8]=d*$,t[1]=e*c+o,t[5]=i*$,t[9]=r*c-n,t[2]=n*c-r,t[6]=a*$,t[10]=o*c+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(qS,e,rS)},lookAt:function(e,t,r){const n=this.elements;return Hc.subVectors(e,t),0===Hc.lengthSq()&&(Hc.z=1),Hc.normalize(),Rf.crossVectors(r,Hc),0===Rf.lengthSq()&&(1===Math.abs(r.z)?Hc.x+=1e-4:Hc.z+=1e-4,Hc.normalize(),Rf.crossVectors(r,Hc)),Rf.normalize(),Xn.crossVectors(Hc,Rf),n[0]=Rf.x,n[4]=Xn.x,n[8]=Hc.x,n[1]=Rf.y,n[5]=Xn.y,n[9]=Hc.y,n[2]=Rf.z,n[6]=Xn.z,n[10]=Hc.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){const r=e.elements,n=t.elements,o=this.elements,i=r[0],a=r[4],s=r[8],d=r[12],$=r[1],c=r[5],p=r[9],l=r[13],u=r[2],h=r[6],f=r[10],m=r[14],x=r[3],R=r[7],g=r[11],v=r[15],q=n[0],K=n[4],y=n[8],_=n[12],b=n[1],M=n[5],w=n[9],S=n[13],T=n[2],A=n[6],E=n[10],L=n[14],C=n[3],B=n[7],P=n[11],G=n[15];return o[0]=i*q+a*b+s*T+d*C,o[4]=i*K+a*M+s*A+d*B,o[8]=i*y+a*w+s*E+d*P,o[12]=i*_+a*S+s*L+d*G,o[1]=$*q+c*b+p*T+l*C,o[5]=$*K+c*M+p*A+l*B,o[9]=$*y+c*w+p*E+l*P,o[13]=$*_+c*S+p*L+l*G,o[2]=u*q+h*b+f*T+m*C,o[6]=u*K+h*M+f*A+m*B,o[10]=u*y+h*w+f*E+m*P,o[14]=u*_+h*S+f*L+m*G,o[3]=x*q+R*b+g*T+v*C,o[7]=x*K+R*M+g*A+v*B,o[11]=x*y+R*w+g*E+v*P,o[15]=x*_+R*S+g*L+v*G,this},multiplyScalar:function(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){const e=this.elements,t=e[0],r=e[4],n=e[8],o=e[12],i=e[1],a=e[5],s=e[9],d=e[13],$=e[2],c=e[6],p=e[10],l=e[14];return e[3]*(+o*s*c-n*d*c-o*a*p+r*d*p+n*a*l-r*s*l)+e[7]*(+t*s*l-t*d*p+o*i*p-n*i*l+n*d*$-o*s*$)+e[11]*(+t*d*c-t*a*l-o*i*c+r*i*l+o*a*$-r*d*$)+e[15]*(-n*a*$-t*s*c+t*a*p+n*i*c-r*i*p+r*s*$)},transpose:function(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e,t,r){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this},getInverse:function(e,t){void 0!==t&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const r=this.elements,n=e.elements,o=n[0],i=n[1],a=n[2],s=n[3],d=n[4],$=n[5],c=n[6],p=n[7],l=n[8],u=n[9],h=n[10],f=n[11],m=n[12],x=n[13],R=n[14],g=n[15],v=u*R*p-x*h*p+x*c*f-$*R*f-u*c*g+$*h*g,q=m*h*p-l*R*p-m*c*f+d*R*f+l*c*g-d*h*g,K=l*x*p-m*u*p+m*$*f-d*x*f-l*$*g+d*u*g,y=m*u*c-l*x*c-m*$*h+d*x*h+l*$*R-d*u*R,_=o*v+i*q+a*K+s*y;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const b=1/_;return r[0]=v*b,r[1]=(x*h*s-u*R*s-x*a*f+i*R*f+u*a*g-i*h*g)*b,r[2]=($*R*s-x*c*s+x*a*p-i*R*p-$*a*g+i*c*g)*b,r[3]=(u*c*s-$*h*s-u*a*p+i*h*p+$*a*f-i*c*f)*b,r[4]=q*b,r[5]=(l*R*s-m*h*s+m*a*f-o*R*f-l*a*g+o*h*g)*b,r[6]=(m*c*s-d*R*s-m*a*p+o*R*p+d*a*g-o*c*g)*b,r[7]=(d*h*s-l*c*s+l*a*p-o*h*p-d*a*f+o*c*f)*b,r[8]=K*b,r[9]=(m*u*s-l*x*s-m*i*f+o*x*f+l*i*g-o*u*g)*b,r[10]=(d*x*s-m*$*s+m*i*p-o*x*p-d*i*g+o*$*g)*b,r[11]=(l*$*s-d*u*s-l*i*p+o*u*p+d*i*f-o*$*f)*b,r[12]=y*b,r[13]=(l*x*a-m*u*a+m*i*h-o*x*h-l*i*R+o*u*R)*b,r[14]=(m*$*a-d*x*a-m*i*c+o*x*c+d*i*R-o*$*R)*b,r[15]=(d*u*a-l*$*a+l*i*c-o*u*c-d*i*h+o*$*h)*b,this},scale:function(e){const t=this.elements,r=e.x,n=e.y,o=e.z;return t[0]*=r,t[4]*=n,t[8]*=o,t[1]*=r,t[5]*=n,t[9]*=o,t[2]*=r,t[6]*=n,t[10]*=o,t[3]*=r,t[7]*=n,t[11]*=o,this},getMaxScaleOnAxis:function(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){const r=Math.cos(t),n=Math.sin(t),o=1-r,i=e.x,a=e.y,s=e.z,d=o*i,$=o*a;return this.set(d*i+r,d*a-n*s,d*s+n*a,0,d*a+n*s,$*a+r,$*s-n*i,0,d*s-n*a,$*s+n*i,o*s*s+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(e,t,r){return this.set(1,t,r,0,e,1,r,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,r){const n=this.elements,o=t._x,i=t._y,a=t._z,s=t._w,d=o+o,$=i+i,c=a+a,p=o*d,l=o*$,u=o*c,h=i*$,f=i*c,m=a*c,x=s*d,R=s*$,g=s*c,v=r.x,q=r.y,K=r.z;return n[0]=(1-(h+m))*v,n[1]=(l+g)*v,n[2]=(u-R)*v,n[3]=0,n[4]=(l-g)*q,n[5]=(1-(p+m))*q,n[6]=(f+x)*q,n[7]=0,n[8]=(u+R)*K,n[9]=(f-x)*K,n[10]=(1-(p+h))*K,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this},decompose:function(e,t,r){const n=this.elements;let o=xi.set(n[0],n[1],n[2]).length(),i=xi.set(n[4],n[5],n[6]).length(),a=xi.set(n[8],n[9],n[10]).length();this.determinant()<0&&(o=-o),e.x=n[12],e.y=n[13],e.z=n[14],yd.copy(this);const s=1/o,d=1/i,$=1/a;return yd.elements[0]*=s,yd.elements[1]*=s,yd.elements[2]*=s,yd.elements[4]*=d,yd.elements[5]*=d,yd.elements[6]*=d,yd.elements[8]*=$,yd.elements[9]*=$,yd.elements[10]*=$,t.setFromRotationMatrix(yd),r.x=o,r.y=i,r.z=a,this},makePerspective:function(e,t,r,n,o,i){void 0===i&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,s=2*o/(t-e),d=2*o/(r-n),$=(t+e)/(t-e),c=(r+n)/(r-n),p=-(i+o)/(i-o),l=-2*i*o/(i-o);return a[0]=s,a[4]=0,a[8]=$,a[12]=0,a[1]=0,a[5]=d,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=p,a[14]=l,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,r,n,o,i){const a=this.elements,s=1/(t-e),d=1/(r-n),$=1/(i-o),c=(t+e)*s,p=(r+n)*d,l=(i+o)*$;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*d,a[9]=0,a[13]=-p,a[2]=0,a[6]=0,a[10]=-2*$,a[14]=-l,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){const t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}});const Vz=new fa,Wz=new yb;function yi(e=0,t=0,r=0,n=yi.DefaultOrder){this._x=e,this._y=t,this._z=r,this._order=n}function rs(){this.mask=1}yi.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],yi.DefaultOrder="XYZ",Object.defineProperties(yi.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(yi.prototype,{isEuler:!0,set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._order=n||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,r){const n=ta.clamp,o=e.elements,i=o[0],a=o[4],s=o[8],d=o[1],$=o[5],c=o[9],p=o[2],l=o[6],u=o[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,u),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(l,$),this._z=0);break;case"YXZ":this._x=Math.asin(-n(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,u),this._z=Math.atan2(d,$)):(this._y=Math.atan2(-p,i),this._z=0);break;case"ZXY":this._x=Math.asin(n(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(-p,u),this._z=Math.atan2(-a,$)):(this._y=0,this._z=Math.atan2(d,i));break;case"ZYX":this._y=Math.asin(-n(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(l,u),this._z=Math.atan2(d,i)):(this._x=0,this._z=Math.atan2(-a,$));break;case"YZX":this._z=Math.asin(n(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-c,$),this._y=Math.atan2(-p,i)):(this._x=0,this._y=Math.atan2(s,u));break;case"XZY":this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(l,$),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-c,u),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t);}return this._order=t,!1!==r&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,r){return Vz.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Vz,t,r)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return Wz.setFromEuler(this),this.setFromQuaternion(Wz,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new ba(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(rs.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return 0!=(this.mask&e.mask)}});let sS=0;const Xz=new ba,zi=new yb,Qe=new fa,Yn=new ba,_k=new ba,tS=new ba,uS=new yb,Yz=new ba(1,0,0),Zz=new ba(0,1,0),$z=new ba(0,0,1),vS={type:"added"},wS={type:"removed"};function ja(){Object.defineProperty(this,"id",{value:sS++}),this.uuid=ta.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ja.DefaultUp.clone();const e=new ba,t=new yi,r=new yb,n=new ba(1,1,1);t._onChange(function(){r.setFromEuler(t,!1)}),r._onChange(function(){t.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new fa},normalMatrix:{value:new nc}}),this.matrix=new fa,this.matrixWorld=new fa,this.matrixAutoUpdate=ja.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new rs,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function $g(){ja.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}ja.DefaultUp=new ba(0,1,0),ja.DefaultMatrixAutoUpdate=!0,ja.prototype=Object.assign(Object.create(Qa.prototype),{constructor:ja,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return zi.setFromAxisAngle(e,t),this.quaternion.multiply(zi),this},rotateOnWorldAxis:function(e,t){return zi.setFromAxisAngle(e,t),this.quaternion.premultiply(zi),this},rotateX:function(e){return this.rotateOnAxis(Yz,e)},rotateY:function(e){return this.rotateOnAxis(Zz,e)},rotateZ:function(e){return this.rotateOnAxis($z,e)},translateOnAxis:function(e,t){return Xz.copy(e).applyQuaternion(this.quaternion),this.position.add(Xz.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(Yz,e)},translateY:function(e){return this.translateOnAxis(Zz,e)},translateZ:function(e){return this.translateOnAxis($z,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(Qe.getInverse(this.matrixWorld))},lookAt:function(e,t,r){e.isVector3?Yn.copy(e):Yn.set(e,t,r);const n=this.parent;this.updateWorldMatrix(!0,!1),_k.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Qe.lookAt(_k,Yn,this.up):Qe.lookAt(Yn,_k,this.up),this.quaternion.setFromRotationMatrix(Qe),n&&(Qe.extractRotation(n.matrixWorld),zi.setFromRotationMatrix(Qe),this.quaternion.premultiply(zi.inverse()))},add:function(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(vS)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(wS)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),Qe.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Qe.multiply(e.parent.matrixWorld)),e.applyMatrix4(Qe),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){const n=this.children[r].getObjectByProperty(e,t);if(void 0!==n)return n}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new ba),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new yb),this.updateMatrixWorld(!0),this.matrixWorld.decompose(_k,e,tS),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new ba),this.updateMatrixWorld(!0),this.matrixWorld.decompose(_k,uS,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new ba),this.updateMatrixWorld(!0);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)},traverseVisible:function(e){if(!1===this.visible)return;e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)},traverseAncestors:function(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){const r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,r=e.length;t<r;t++)e[t].updateWorldMatrix(!1,!0)}},toJSON:function(e){const t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const n={};function o(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){n.geometry=o(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const r=t.shapes;if(Array.isArray(r))for(let t=0,n=r.length;t<n;t++){const n=r[t];o(e.shapes,n)}else o(e.shapes,r)}}if(void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let r=0,n=this.material.length;r<n;r++)t.push(o(e.materials,this.material[r]));n.material=t}else n.material=o(e.materials,this.material);if(this.children.length>0){n.children=[];for(let t=0;t<this.children.length;t++)n.children.push(this.children[t].toJSON(e).object)}if(t){const t=i(e.geometries),n=i(e.materials),o=i(e.textures),a=i(e.images),s=i(e.shapes);t.length>0&&(r.geometries=t),n.length>0&&(r.materials=n),o.length>0&&(r.textures=o),a.length>0&&(r.images=a),s.length>0&&(r.shapes=s)}return r.object=n,r;function i(e){const t=[];for(const r in e){const n=e[r];delete n.metadata,t.push(n)}return t}},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let r=0;r<e.children.length;r++){const t=e.children[r];this.add(t.clone())}return this}}),$g.prototype=Object.assign(Object.create(ja.prototype),{constructor:$g,isScene:!0,copy:function(e,t){return ja.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){const t=ja.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});const Se=[new ba,new ba,new ba,new ba,new ba,new ba,new ba,new ba],al=new ba,ss=new wc,Ai=new ba,Bi=new ba,Ci=new ba,Sf=new ba,Tf=new ba,_g=new ba,bl=new ba,Zn=new ba,$n=new ba,ah=new ba;function wc(e,t){this.min=void 0!==e?e:new ba(1/0,1/0,1/0),this.max=void 0!==t?t:new ba(-1/0,-1/0,-1/0)}function ts(e,t,r,n,o){for(let i=0,a=e.length-3;i<=a;i+=3){ah.fromArray(e,i);const a=o.x*Math.abs(ah.x)+o.y*Math.abs(ah.y)+o.z*Math.abs(ah.z),s=t.dot(ah),d=r.dot(ah),$=n.dot(ah);if(Math.max(-Math.max(s,d,$),Math.min(s,d,$))>a)return!1}return!0}Object.assign(wc.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){let t=1/0,r=1/0,n=1/0,o=-1/0,i=-1/0,a=-1/0;for(let s=0,d=e.length;s<d;s+=3){const d=e[s],$=e[s+1],c=e[s+2];d<t&&(t=d),$<r&&(r=$),c<n&&(n=c),d>o&&(o=d),$>i&&(i=$),c>a&&(a=c)}return this.min.set(t,r,n),this.max.set(o,i,a),this},setFromBufferAttribute:function(e){let t=1/0,r=1/0,n=1/0,o=-1/0,i=-1/0,a=-1/0;for(let s=0,d=e.count;s<d;s++){const d=e.getX(s),$=e.getY(s),c=e.getZ(s);d<t&&(t=d),$<r&&(r=$),c<n&&(n=c),d>o&&(o=d),$>i&&(i=$),c>a&&(a=c)}return this.min.set(t,r,n),this.max.set(o,i,a),this},setFromPoints:function(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){const r=al.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new ba),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new ba),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);const t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),ss.copy(t.boundingBox),ss.applyMatrix4(e.matrixWorld),this.union(ss));const r=e.children;for(let n=0,o=r.length;n<o;n++)this.expandByObject(r[n]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new ba),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,al),al.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(bl),Zn.subVectors(this.max,bl),Ai.subVectors(e.a,bl),Bi.subVectors(e.b,bl),Ci.subVectors(e.c,bl),Sf.subVectors(Bi,Ai),Tf.subVectors(Ci,Bi),_g.subVectors(Ai,Ci);let t=[0,-Sf.z,Sf.y,0,-Tf.z,Tf.y,0,-_g.z,_g.y,Sf.z,0,-Sf.x,Tf.z,0,-Tf.x,_g.z,0,-_g.x,-Sf.y,Sf.x,0,-Tf.y,Tf.x,0,-_g.y,_g.x,0];return!!ts(t,Ai,Bi,Ci,Zn)&&!!ts(t=[1,0,0,0,1,0,0,0,1],Ai,Bi,Ci,Zn)&&($n.crossVectors(Sf,Tf),ts(t=[$n.x,$n.y,$n.z],Ai,Bi,Ci,Zn))},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new ba),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return al.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(al).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()?this:(Se[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Se[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Se[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Se[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Se[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Se[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Se[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Se[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Se),this)},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});const xS=new wc;function Td(e,t){this.center=void 0!==e?e:new ba,this.radius=void 0!==t?t:-1}Object.assign(Td.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){const r=this.center;void 0!==t?r.copy(t):xS.setFromPoints(e).getCenter(r);let n=0;for(let o=0,i=e.length;o<i;o++)n=Math.max(n,r.distanceToSquared(e[o]));return this.radius=Math.sqrt(n),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){const r=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new ba),t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new wc),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});const Te=new ba,us=new ba,_n=new ba,Uf=new ba,vs=new ba,ao=new ba,ws=new ba;function Di(e,t){this.origin=void 0!==e?e:new ba,this.direction=void 0!==t?t:new ba(0,0,-1)}Object.assign(Di.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new ba),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,Te)),this},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new ba),t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){const t=Te.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Te.copy(this.direction).multiplyScalar(t).add(this.origin),Te.distanceToSquared(e))},distanceSqToSegment:function(e,t,r,n){us.copy(e).add(t).multiplyScalar(.5),_n.copy(t).sub(e).normalize(),Uf.copy(this.origin).sub(us);const o=.5*e.distanceTo(t),i=-this.direction.dot(_n),a=Uf.dot(this.direction),s=-Uf.dot(_n),d=Uf.lengthSq(),$=Math.abs(1-i*i);let c,p,l,u;if($>0){if(p=i*a-s,u=o*$,(c=i*s-a)>=0){if(p>=-u){if(p<=u){const e=1/$;l=(c*=e)*(c+i*(p*=e)+2*a)+p*(i*c+p+2*s)+d}else p=o,l=-(c=Math.max(0,-(i*p+a)))*c+p*(p+2*s)+d;}else p=-o,l=-(c=Math.max(0,-(i*p+a)))*c+p*(p+2*s)+d;}else p<=-u?l=-(c=Math.max(0,-(-i*o+a)))*c+(p=c>0?-o:Math.min(Math.max(-o,-s),o))*(p+2*s)+d:p<=u?(c=0,l=(p=Math.min(Math.max(-o,-s),o))*(p+2*s)+d):l=-(c=Math.max(0,-(i*o+a)))*c+(p=c>0?o:Math.min(Math.max(-o,-s),o))*(p+2*s)+d;}else p=i>0?-o:o,l=-(c=Math.max(0,-(i*p+a)))*c+p*(p+2*s)+d;return r&&r.copy(this.direction).multiplyScalar(c).add(this.origin),n&&n.copy(_n).multiplyScalar(p).add(us),l},intersectSphere:function(e,t){Te.subVectors(e.center,this.origin);const r=Te.dot(this.direction),n=Te.dot(Te)-r*r,o=e.radius*e.radius;if(n>o)return null;const i=Math.sqrt(o-n),a=r-i,s=r+i;return a<0&&s<0?null:a<0?this.at(s,t):this.at(a,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){const r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},intersectsPlane:function(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){let r,n,o,i,a,s;const d=1/this.direction.x,$=1/this.direction.y,c=1/this.direction.z,p=this.origin;return d>=0?(r=(e.min.x-p.x)*d,n=(e.max.x-p.x)*d):(r=(e.max.x-p.x)*d,n=(e.min.x-p.x)*d),$>=0?(o=(e.min.y-p.y)*$,i=(e.max.y-p.y)*$):(o=(e.max.y-p.y)*$,i=(e.min.y-p.y)*$),r>i||o>n?null:((o>r||r!=r)&&(r=o),(i<n||n!=n)&&(n=i),c>=0?(a=(e.min.z-p.z)*c,s=(e.max.z-p.z)*c):(a=(e.max.z-p.z)*c,s=(e.min.z-p.z)*c),r>s||a>n?null:((a>r||r!=r)&&(r=a),(s<n||n!=n)&&(n=s),n<0?null:this.at(r>=0?r:n,t)))},intersectsBox:function(e){return null!==this.intersectBox(e,Te)},intersectTriangle:function(e,t,r,n,o){vs.subVectors(t,e),ao.subVectors(r,e),ws.crossVectors(vs,ao);let i,a=this.direction.dot(ws);if(a>0){if(n)return null;i=1}else{if(!(a<0))return null;i=-1,a=-a}Uf.subVectors(this.origin,e);const s=i*this.direction.dot(ao.crossVectors(Uf,ao));if(s<0)return null;const d=i*this.direction.dot(vs.cross(Uf));if(d<0)return null;if(s+d>a)return null;const $=-i*Uf.dot(ws);return $<0?null:this.at($/a,o)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});const xs=new ba,yS=new ba,zS=new nc;function xc(e,t){this.normal=void 0!==e?e:new ba(1,0,0),this.constant=void 0!==t?t:0}Object.assign(xc.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,r){const n=xs.subVectors(r,t).cross(yS.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new ba),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new ba);const r=e.delta(xs),n=this.normal.dot(r);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;const o=-(e.start.dot(this.normal)+this.constant)/n;return o<0||o>1?void 0:t.copy(r).multiplyScalar(o).add(e.start)},intersectsLine:function(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new ba),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){const r=t||zS.getNormalMatrix(e),n=this.coplanarPoint(xs).applyMatrix4(e),o=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(o),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});const zd=new ba,Ue=new ba,ys=new ba,Ve=new ba,Ei=new ba,Fi=new ba,_z=new ba,zs=new ba,As=new ba,Bs=new ba;function ac(e,t,r){this.a=void 0!==e?e:new ba,this.b=void 0!==t?t:new ba,this.c=void 0!==r?r:new ba}Object.assign(ac,{getNormal:function(e,t,r,n){void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new ba),n.subVectors(r,t),zd.subVectors(e,t),n.cross(zd);const o=n.lengthSq();return o>0?n.multiplyScalar(1/Math.sqrt(o)):n.set(0,0,0)},getBarycoord:function(e,t,r,n,o){zd.subVectors(n,t),Ue.subVectors(r,t),ys.subVectors(e,t);const i=zd.dot(zd),a=zd.dot(Ue),s=zd.dot(ys),d=Ue.dot(Ue),$=Ue.dot(ys),c=i*d-a*a;if(void 0===o&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),o=new ba),0===c)return o.set(-2,-1,-1);const p=1/c,l=(d*s-a*$)*p,u=(i*$-a*s)*p;return o.set(1-l-u,u,l)},containsPoint:function(e,t,r,n){return ac.getBarycoord(e,t,r,n,Ve),Ve.x>=0&&Ve.y>=0&&Ve.x+Ve.y<=1},getUV:function(e,t,r,n,o,i,a,s){return this.getBarycoord(e,t,r,n,Ve),s.set(0,0),s.addScaledVector(o,Ve.x),s.addScaledVector(i,Ve.y),s.addScaledVector(a,Ve.z),s},isFrontFacing:function(e,t,r,n){return zd.subVectors(r,t),Ue.subVectors(e,t),zd.cross(Ue).dot(n)<0}}),Object.assign(ac.prototype,{set:function(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this},setFromPointsAndIndices:function(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return zd.subVectors(this.c,this.b),Ue.subVectors(this.a,this.b),.5*zd.cross(Ue).length()},getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new ba),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return ac.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new xc),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return ac.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,r,n,o){return ac.getUV(e,this.a,this.b,this.c,t,r,n,o)},containsPoint:function(e){return ac.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return ac.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new ba);const r=this.a,n=this.b,o=this.c;let i,a;Ei.subVectors(n,r),Fi.subVectors(o,r),zs.subVectors(e,r);const s=Ei.dot(zs),d=Fi.dot(zs);if(s<=0&&d<=0)return t.copy(r);As.subVectors(e,n);const $=Ei.dot(As),c=Fi.dot(As);if($>=0&&c<=$)return t.copy(n);const p=s*c-$*d;if(p<=0&&s>=0&&$<=0)return i=s/(s-$),t.copy(r).addScaledVector(Ei,i);Bs.subVectors(e,o);const l=Ei.dot(Bs),u=Fi.dot(Bs);if(u>=0&&l<=u)return t.copy(o);const h=l*d-s*u;if(h<=0&&d>=0&&u<=0)return a=d/(d-u),t.copy(r).addScaledVector(Fi,a);const f=$*u-l*c;if(f<=0&&c-$>=0&&l-u>=0)return _z.subVectors(o,n),a=(c-$)/(c-$+(l-u)),t.copy(n).addScaledVector(_z,a);const m=1/(f+h+p);return i=h*m,a=p*m,t.copy(r).addScaledVector(Ei,i).addScaledVector(Fi,a)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});const aA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ad={h:0,s:0,l:0},bo={h:0,s:0,l:0};function ga(e,t,r){return void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}function Cs(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e}function Ds(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Es(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}function aa(e,t,r,n,o,i){this.a=e,this.b=t,this.c=r,this.normal=n&&n.isVector3?n:new ba,this.vertexNormals=Array.isArray(n)?n:[],this.color=o&&o.isColor?o:new ga,this.vertexColors=Array.isArray(o)?o:[],this.materialIndex=void 0!==i?i:0}Object.assign(ga.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,r){return this.r=e,this.g=t,this.b=r,this},setHSL:function(e,t,r){if(e=ta.euclideanModulo(e,1),t=ta.clamp(t,0,1),r=ta.clamp(r,0,1),0===t)this.r=this.g=this.b=r;else{const n=r<=.5?r*(1+t):r+t-r*t,o=2*r-n;this.r=Cs(o,n,e+1/3),this.g=Cs(o,n,e),this.b=Cs(o,n,e-1/3)}return this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){let e;const n=r[1],o=r[2];switch(n){case"rgb":case"rgba":if(e=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,t(e[5]),this;if(e=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,t(e[5]),this;break;case"hsl":case"hsla":if(e=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){const r=parseFloat(e[1])/360,n=parseInt(e[2],10)/100,o=parseInt(e[3],10)/100;return t(e[5]),this.setHSL(r,n,o)}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(e)){const e=r[1],t=e.length;if(3===t)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,this;if(6===t)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},setColorName:function(e){const t=aA[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);const r=t>0?1/t:1;return this.r=Math.pow(e.r,r),this.g=Math.pow(e.g,r),this.b=Math.pow(e.b,r),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=Ds(e.r),this.g=Ds(e.g),this.b=Ds(e.b),this},copyLinearToSRGB:function(e){return this.r=Es(e.r),this.g=Es(e.g),this.b=Es(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});const t=this.r,r=this.g,n=this.b,o=Math.max(t,r,n),i=Math.min(t,r,n);let a,s;const d=(i+o)/2;if(i===o)a=0,s=0;else{const e=o-i;switch(s=d<=.5?e/(o+i):e/(2-o-i),o){case t:a=(r-n)/e+(r<n?6:0);break;case r:a=(n-t)/e+2;break;case n:a=(t-r)/e+4;}a/=6}return e.h=a,e.s=s,e.l=d,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,r){return this.getHSL(Ad),Ad.h+=e,Ad.s+=t,Ad.l+=r,this.setHSL(Ad.h,Ad.s,Ad.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(Ad),e.getHSL(bo);const r=ta.lerp(Ad.h,bo.h,t),n=ta.lerp(Ad.s,bo.s,t),o=ta.lerp(Ad.l,bo.l,t);return this.setHSL(r,n,o),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},fromBufferAttribute:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},toJSON:function(){return this.getHex()}}),ga.NAMES=aA,Object.assign(aa.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});let AS=0;function ua(){Object.defineProperty(this,"id",{value:AS++}),this.uuid=ta.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=Sk,this.side=Pe,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Bz,this.blendDst=Cz,this.blendEquation=si,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=hs,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=oS,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ps,this.stencilZFail=ps,this.stencilZPass=ps,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function kb(e){ua.call(this),this.type="MeshBasicMaterial",this.color=new ga(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Qn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}ua.prototype=Object.assign(Object.create(Qa.prototype),{constructor:ua,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(const t in e){const r=e[t];if(void 0===r){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r;continue}const n=this[t];void 0!==n?n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}},toJSON:function(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){const t=[];for(const r in e){const n=e[r];delete n.metadata,t.push(n)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(r.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,r.reflectivity=this.reflectivity,r.refractionRatio=this.refractionRatio,void 0!==this.combine&&(r.combine=this.combine),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Sk&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),this.side!==Pe&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.morphNormals&&(r.morphNormals=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t){const t=n(e.textures),o=n(e.images);t.length>0&&(r.textures=t),o.length>0&&(r.images=o)}return r},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(null!==t){const e=t.length;r=new Array(e);for(let n=0;n!==e;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(ua.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),kb.prototype=Object.create(ua.prototype),kb.prototype.constructor=kb,kb.prototype.isMeshBasicMaterial=!0,kb.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};const cb=new ba,co=new ca;function pa(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===r,this.usage=Wn,this.updateRange={offset:0,count:-1},this.version=0}function Fs(e,t,r){pa.call(this,new Int8Array(e),t,r)}function Gs(e,t,r){pa.call(this,new Uint8Array(e),t,r)}function Hs(e,t,r){pa.call(this,new Uint8ClampedArray(e),t,r)}function Is(e,t,r){pa.call(this,new Int16Array(e),t,r)}function cl(e,t,r){pa.call(this,new Uint16Array(e),t,r)}function Js(e,t,r){pa.call(this,new Int32Array(e),t,r)}function dl(e,t,r){pa.call(this,new Uint32Array(e),t,r)}function ma(e,t,r){pa.call(this,new Float32Array(e),t,r)}function Ks(e,t,r){pa.call(this,new Float64Array(e),t,r)}function bA(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function cA(e){if(0===e.length)return-1/0;let t=e[0];for(let r=1,n=e.length;r<n;++r)e[r]>t&&(t=e[r]);return t}Object.defineProperty(pa.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(pa.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,o=this.itemSize;n<o;n++)this.array[e+n]=t.array[r+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){const t=this.array;let r=0;for(let n=0,o=e.length;n<o;n++){let o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new ga),t[r++]=o.r,t[r++]=o.g,t[r++]=o.b}return this},copyVector2sArray:function(e){const t=this.array;let r=0;for(let n=0,o=e.length;n<o;n++){let o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new ca),t[r++]=o.x,t[r++]=o.y}return this},copyVector3sArray:function(e){const t=this.array;let r=0;for(let n=0,o=e.length;n<o;n++){let o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new ba),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z}return this},copyVector4sArray:function(e){const t=this.array;let r=0;for(let n=0,o=e.length;n<o;n++){let o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new Ta),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z,t[r++]=o.w}return this},applyMatrix3:function(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)co.fromBufferAttribute(this,t),co.applyMatrix3(e),this.setXY(t,co.x,co.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)cb.fromBufferAttribute(this,t),cb.applyMatrix3(e),this.setXYZ(t,cb.x,cb.y,cb.z);return this},applyMatrix4:function(e){for(let t=0,r=this.count;t<r;t++)cb.x=this.getX(t),cb.y=this.getY(t),cb.z=this.getZ(t),cb.applyMatrix4(e),this.setXYZ(t,cb.x,cb.y,cb.z);return this},applyNormalMatrix:function(e){for(let t=0,r=this.count;t<r;t++)cb.x=this.getX(t),cb.y=this.getY(t),cb.z=this.getZ(t),cb.applyNormalMatrix(e),this.setXYZ(t,cb.x,cb.y,cb.z);return this},transformDirection:function(e){for(let t=0,r=this.count;t<r;t++)cb.x=this.getX(t),cb.y=this.getY(t),cb.z=this.getZ(t),cb.transformDirection(e),this.setXYZ(t,cb.x,cb.y,cb.z);return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this},setXYZW:function(e,t,r,n,o){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=o,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Fs.prototype=Object.create(pa.prototype),Fs.prototype.constructor=Fs,Gs.prototype=Object.create(pa.prototype),Gs.prototype.constructor=Gs,Hs.prototype=Object.create(pa.prototype),Hs.prototype.constructor=Hs,Is.prototype=Object.create(pa.prototype),Is.prototype.constructor=Is,cl.prototype=Object.create(pa.prototype),cl.prototype.constructor=cl,Js.prototype=Object.create(pa.prototype),Js.prototype.constructor=Js,dl.prototype=Object.create(pa.prototype),dl.prototype.constructor=dl,ma.prototype=Object.create(pa.prototype),ma.prototype.constructor=ma,Ks.prototype=Object.create(pa.prototype),Ks.prototype.constructor=Ks,Object.assign(bA.prototype,{computeGroups:function(e){const t=[];let r,n,o=void 0;const i=e.faces;for(n=0;n<i.length;n++){const e=i[n];e.materialIndex!==o&&(o=e.materialIndex,void 0!==r&&(r.count=3*n-r.start,t.push(r)),r={start:3*n,materialIndex:o})}void 0!==r&&(r.count=3*n-r.start,t.push(r)),this.groups=t},fromGeometry:function(e){const t=e.faces,r=e.vertices,n=e.faceVertexUvs,o=n[0]&&n[0].length>0,i=n[1]&&n[1].length>0,a=e.morphTargets,s=a.length;let d;if(s>0){d=[];for(let e=0;e<s;e++)d[e]={name:a[e].name,data:[]};this.morphTargets.position=d}const $=e.morphNormals,c=$.length;let p;if(c>0){p=[];for(let e=0;e<c;e++)p[e]={name:$[e].name,data:[]};this.morphTargets.normal=p}const l=e.skinIndices,u=e.skinWeights,h=l.length===r.length,f=u.length===r.length;r.length>0&&0===t.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let m=0;m<t.length;m++){const e=t[m];this.vertices.push(r[e.a],r[e.b],r[e.c]);const x=e.vertexNormals;if(3===x.length)this.normals.push(x[0],x[1],x[2]);else{const t=e.normal;this.normals.push(t,t,t)}const R=e.vertexColors;if(3===R.length)this.colors.push(R[0],R[1],R[2]);else{const t=e.color;this.colors.push(t,t,t)}if(!0===o){const e=n[0][m];void 0!==e?this.uvs.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",m),this.uvs.push(new ca,new ca,new ca))}if(!0===i){const e=n[1][m];void 0!==e?this.uvs2.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",m),this.uvs2.push(new ca,new ca,new ca))}for(let t=0;t<s;t++){const r=a[t].vertices;d[t].data.push(r[e.a],r[e.b],r[e.c])}for(let t=0;t<c;t++){const e=$[t].vertexNormals[m];p[t].data.push(e.a,e.b,e.c)}h&&this.skinIndices.push(l[e.a],l[e.b],l[e.c]),f&&this.skinWeights.push(u[e.a],u[e.b],u[e.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});const Ud=new fa,Ls=new ja,Gi=new ba,Ic=new wc,el=new wc,Wb=new ba;function ia(){Object.defineProperty(this,"id",{value:2}),this.uuid=ta.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}ia.prototype=Object.assign(Object.create(Qa.prototype),{constructor:ia,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(cA(e)>65535?dl:cl)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const t=new nc().getNormalMatrix(e);r.applyNormalMatrix(t),r.needsUpdate=!0}const n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return Ud.makeRotationX(e),this.applyMatrix4(Ud),this},rotateY:function(e){return Ud.makeRotationY(e),this.applyMatrix4(Ud),this},rotateZ:function(e){return Ud.makeRotationZ(e),this.applyMatrix4(Ud),this},translate:function(e,t,r){return Ud.makeTranslation(e,t,r),this.applyMatrix4(Ud),this},scale:function(e,t,r){return Ud.makeScale(e,t,r),this.applyMatrix4(Ud),this},lookAt:function(e){return Ls.lookAt(e),Ls.updateMatrix(),this.applyMatrix4(Ls.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Gi).negate(),this.translate(Gi.x,Gi.y,Gi.z),this},setFromObject:function(e){const t=e.geometry;if(e.isPoints||e.isLine){const e=new ma(3*t.vertices.length,3),r=new ma(3*t.colors.length,3);if(this.setAttribute("position",e.copyVector3sArray(t.vertices)),this.setAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){const e=new ma(t.lineDistances.length,1);this.setAttribute("lineDistance",e.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){const t=[];for(let r=0,n=e.length;r<n;r++){const n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new ma(t,3)),this},updateFromObject:function(e){let t=e.geometry;if(e.isMesh){let e=t.__directGeometry;if(!0===t.elementsNeedUpdate&&(e=void 0,t.elementsNeedUpdate=!1),void 0===e)return this.fromGeometry(t);e.verticesNeedUpdate=t.verticesNeedUpdate,e.normalsNeedUpdate=t.normalsNeedUpdate,e.colorsNeedUpdate=t.colorsNeedUpdate,e.uvsNeedUpdate=t.uvsNeedUpdate,e.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=e}if(!0===t.verticesNeedUpdate){const e=this.attributes.position;void 0!==e&&(e.copyVector3sArray(t.vertices),e.needsUpdate=!0),t.verticesNeedUpdate=!1}if(!0===t.normalsNeedUpdate){const e=this.attributes.normal;void 0!==e&&(e.copyVector3sArray(t.normals),e.needsUpdate=!0),t.normalsNeedUpdate=!1}if(!0===t.colorsNeedUpdate){const e=this.attributes.color;void 0!==e&&(e.copyColorsArray(t.colors),e.needsUpdate=!0),t.colorsNeedUpdate=!1}if(t.uvsNeedUpdate){const e=this.attributes.uv;void 0!==e&&(e.copyVector2sArray(t.uvs),e.needsUpdate=!0),t.uvsNeedUpdate=!1}if(t.lineDistancesNeedUpdate){const e=this.attributes.lineDistance;void 0!==e&&(e.copyArray(t.lineDistances),e.needsUpdate=!0),t.lineDistancesNeedUpdate=!1}return t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new bA().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){const t=new Float32Array(3*e.vertices.length);if(this.setAttribute("position",new pa(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){const t=new Float32Array(3*e.normals.length);this.setAttribute("normal",new pa(t,3).copyVector3sArray(e.normals))}if(e.colors.length>0){const t=new Float32Array(3*e.colors.length);this.setAttribute("color",new pa(t,3).copyColorsArray(e.colors))}if(e.uvs.length>0){const t=new Float32Array(2*e.uvs.length);this.setAttribute("uv",new pa(t,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){const t=new Float32Array(2*e.uvs2.length);this.setAttribute("uv2",new pa(t,2).copyVector2sArray(e.uvs2))}this.groups=e.groups;for(const r in e.morphTargets){const t=[],n=e.morphTargets[r];for(let e=0,r=n.length;e<r;e++){const r=n[e],o=new ma(3*r.data.length,3);o.name=r.name,t.push(o.copyVector3sArray(r.data))}this.morphAttributes[r]=t}if(e.skinIndices.length>0){const t=new ma(4*e.skinIndices.length,4);this.setAttribute("skinIndex",t.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){const t=new ma(4*e.skinWeights.length,4);this.setAttribute("skinWeight",t.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new wc);const e=this.attributes.position,t=this.morphAttributes.position;if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,n=t.length;r<n;r++){const e=t[r];Ic.setFromBufferAttribute(e),this.morphTargetsRelative?(Wb.addVectors(this.boundingBox.min,Ic.min),this.boundingBox.expandByPoint(Wb),Wb.addVectors(this.boundingBox.max,Ic.max),this.boundingBox.expandByPoint(Wb)):(this.boundingBox.expandByPoint(Ic.min),this.boundingBox.expandByPoint(Ic.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error("THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.",this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Td);const e=this.attributes.position,t=this.morphAttributes.position;if(e){const r=this.boundingSphere.center;if(Ic.setFromBufferAttribute(e),t)for(let e=0,o=t.length;e<o;e++){const r=t[e];el.setFromBufferAttribute(r),this.morphTargetsRelative?(Wb.addVectors(Ic.min,el.min),Ic.expandByPoint(Wb),Wb.addVectors(Ic.max,el.max),Ic.expandByPoint(Wb)):(Ic.expandByPoint(el.min),Ic.expandByPoint(el.max))}Ic.getCenter(r);let n=0;for(let t=0,o=e.count;t<o;t++)Wb.fromBufferAttribute(e,t),n=Math.max(n,r.distanceToSquared(Wb));if(t)for(let o=0,i=t.length;o<i;o++){const i=t[o],a=this.morphTargetsRelative;for(let t=0,o=i.count;t<o;t++)Wb.fromBufferAttribute(i,t),a&&(Gi.fromBufferAttribute(e,t),Wb.add(Gi)),n=Math.max(n,r.distanceToSquared(Wb))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error("THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.",this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new pa(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let e=0,t=r.count;e<t;e++)r.setXYZ(e,0,0,0);const n=new ba,o=new ba,i=new ba,a=new ba,s=new ba,d=new ba,$=new ba,c=new ba;if(e)for(let p=0,l=e.count;p<l;p+=3){const l=e.getX(p+0),u=e.getX(p+1),h=e.getX(p+2);n.fromBufferAttribute(t,l),o.fromBufferAttribute(t,u),i.fromBufferAttribute(t,h),$.subVectors(i,o),c.subVectors(n,o),$.cross(c),a.fromBufferAttribute(r,l),s.fromBufferAttribute(r,u),d.fromBufferAttribute(r,h),a.add($),s.add($),d.add($),r.setXYZ(l,a.x,a.y,a.z),r.setXYZ(u,s.x,s.y,s.z),r.setXYZ(h,d.x,d.y,d.z)}else for(let e=0,p=t.count;e<p;e+=3)n.fromBufferAttribute(t,e+0),o.fromBufferAttribute(t,e+1),i.fromBufferAttribute(t,e+2),$.subVectors(i,o),c.subVectors(n,o),$.cross(c),r.setXYZ(e+0,$.x,$.y,$.z),r.setXYZ(e+1,$.x,$.y,$.z),r.setXYZ(e+2,$.x,$.y,$.z);this.normalizeNormals(),r.needsUpdate=!0}},merge:function(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const r=this.attributes;for(const n in r){if(void 0===e.attributes[n])continue;const o=r[n].array,i=e.attributes[n],a=i.array,s=i.itemSize*t,d=Math.min(a.length,o.length-s);for(let e=0,t=s;e<d;e++,t++)o[t]=a[e]}return this},normalizeNormals:function(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Wb.fromBufferAttribute(e,t),Wb.normalize(),e.setXYZ(t,Wb.x,Wb.y,Wb.z)},toNonIndexed:function(){function e(e,t){const r=e.array,n=e.itemSize,o=e.normalized,i=new r.constructor(t.length*n);let a=0,s=0;for(let d=0,$=t.length;d<$;d++){a=t[d]*n;for(let e=0;e<n;e++)i[s++]=r[a++]}return new pa(i,n,o)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const t=new ia,r=this.index.array,n=this.attributes;for(const a in n){const o=e(n[a],r);t.setAttribute(a,o)}const o=this.morphAttributes;for(const a in o){const n=[],i=o[a];for(let t=0,o=i.length;t<o;t++){const o=e(i[t],r);n.push(o)}t.morphAttributes[a]=n}t.morphTargetsRelative=this.morphTargetsRelative;const i=this.groups;for(let a=0,s=i.length;a<s;a++){const e=i[a];t.addGroup(e.start,e.count,e.materialIndex)}return t},toJSON:function(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const s in r){const t=r[s],n=t.toJSON(e.data);""!==t.name&&(n.name=t.name),e.data.attributes[s]=n}const n={};let o=!1;for(const s in this.morphAttributes){const t=this.morphAttributes[s],r=[];for(let n=0,o=t.length;n<o;n++){const o=t[n],i=o.toJSON(e.data);""!==o.name&&(i.name=o.name),r.push(i)}r.length>0&&(n[s]=r,o=!0)}o&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);const i=this.groups;i.length>0&&(e.data.groups=JSON.parse(JSON.stringify(i)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e},clone:function(){return new ia().copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;null!==r&&this.setIndex(r.clone(t));const n=e.attributes;for(const d in n){const e=n[d];this.setAttribute(d,e.clone(t))}const o=e.morphAttributes;for(const d in o){const e=[],r=o[d];for(let n=0,o=r.length;n<o;n++)e.push(r[n].clone(t));this.morphAttributes[d]=e}this.morphTargetsRelative=e.morphTargetsRelative;const i=e.groups;for(let d=0,$=i.length;d<$;d++){const e=i[d];this.addGroup(e.start,e.count,e.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const s=e.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const dA=new fa,bh=new Di,Ms=new Td,Vf=new ba,Wf=new ba,Xf=new ba,Ns=new ba,Os=new ba,Ps=new ba,eo=new ba,fo=new ba,go=new ba,Hi=new ca,Ii=new ca,Ji=new ca,fl=new ba,ho=new ba;function Aa(e,t){ja.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new ia,this.material=void 0!==t?t:new kb,this.updateMorphTargets()}function eA(e,t,r,n,o,i,a,s){let d;if(null===(d=t.side===Ob?n.intersectTriangle(a,i,o,!0,s):n.intersectTriangle(o,i,a,t.side!==Pb,s)))return null;ho.copy(s),ho.applyMatrix4(e.matrixWorld);const $=r.ray.origin.distanceTo(ho);return $<r.near||$>r.far?null:{distance:$,point:ho.clone(),object:e}}function io(e,t,r,n,o,i,a,s,d,$,c,p){Vf.fromBufferAttribute(o,$),Wf.fromBufferAttribute(o,c),Xf.fromBufferAttribute(o,p);const l=e.morphTargetInfluences;if(t.morphTargets&&i&&l){eo.set(0,0,0),fo.set(0,0,0),go.set(0,0,0);for(let e=0,t=i.length;e<t;e++){const t=l[e],r=i[e];0!==t&&(Ns.fromBufferAttribute(r,$),Os.fromBufferAttribute(r,c),Ps.fromBufferAttribute(r,p),a?(eo.addScaledVector(Ns,t),fo.addScaledVector(Os,t),go.addScaledVector(Ps,t)):(eo.addScaledVector(Ns.sub(Vf),t),fo.addScaledVector(Os.sub(Wf),t),go.addScaledVector(Ps.sub(Xf),t)))}Vf.add(eo),Wf.add(fo),Xf.add(go)}e.isSkinnedMesh&&(e.boneTransform($,Vf),e.boneTransform(c,Wf),e.boneTransform(p,Xf));const u=eA(e,t,r,n,Vf,Wf,Xf,fl);if(u){s&&(Hi.fromBufferAttribute(s,$),Ii.fromBufferAttribute(s,c),Ji.fromBufferAttribute(s,p),u.uv=ac.getUV(fl,Vf,Wf,Xf,Hi,Ii,Ji,new ca)),d&&(Hi.fromBufferAttribute(d,$),Ii.fromBufferAttribute(d,c),Ji.fromBufferAttribute(d,p),u.uv2=ac.getUV(fl,Vf,Wf,Xf,Hi,Ii,Ji,new ca));const e=new aa($,c,p);ac.getNormal(Vf,Wf,Xf,e.normal),u.face=e}return u}Aa.prototype=Object.assign(Object.create(ja.prototype),{constructor:Aa,isMesh:!0,copy:function(e){return ja.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const e=t[r[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,r=e.length;t<r;t++){const r=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){const r=this.geometry,n=this.material,o=this.matrixWorld;if(void 0===n)return;if(null===r.boundingSphere&&r.computeBoundingSphere(),Ms.copy(r.boundingSphere),Ms.applyMatrix4(o),!1===e.ray.intersectsSphere(Ms))return;if(dA.getInverse(o),bh.copy(e.ray).applyMatrix4(dA),null!==r.boundingBox&&!1===bh.intersectsBox(r.boundingBox))return;let i;if(r.isBufferGeometry){const o=r.index,a=r.attributes.position,s=r.morphAttributes.position,d=r.morphTargetsRelative,$=r.attributes.uv,c=r.attributes.uv2,p=r.groups,l=r.drawRange;if(null!==o){if(Array.isArray(n))for(let r=0,u=p.length;r<u;r++){const u=p[r],h=n[u.materialIndex];for(let r=Math.max(u.start,l.start),n=Math.min(u.start+u.count,l.start+l.count);r<n;r+=3){const n=o.getX(r),p=o.getX(r+1),l=o.getX(r+2);(i=io(this,h,e,bh,a,s,d,$,c,n,p,l))&&(i.faceIndex=Math.floor(r/3),i.face.materialIndex=u.materialIndex,t.push(i))}}else{for(let r=Math.max(0,l.start),p=Math.min(o.count,l.start+l.count);r<p;r+=3){const p=o.getX(r),l=o.getX(r+1),u=o.getX(r+2);(i=io(this,n,e,bh,a,s,d,$,c,p,l,u))&&(i.faceIndex=Math.floor(r/3),t.push(i))}}}else if(void 0!==a)if(Array.isArray(n))for(let r=0,u=p.length;r<u;r++){const o=p[r],u=n[o.materialIndex];for(let r=Math.max(o.start,l.start),n=Math.min(o.start+o.count,l.start+l.count);r<n;r+=3){(i=io(this,u,e,bh,a,s,d,$,c,r,r+1,r+2))&&(i.faceIndex=Math.floor(r/3),i.face.materialIndex=o.materialIndex,t.push(i))}}else{for(let r=Math.max(0,l.start),o=Math.min(a.count,l.start+l.count);r<o;r+=3){(i=io(this,n,e,bh,a,s,d,$,c,r,r+1,r+2))&&(i.faceIndex=Math.floor(r/3),t.push(i))}}}else if(r.isGeometry){const o=Array.isArray(n),a=r.vertices,s=r.faces;let d;const $=r.faceVertexUvs[0];$.length>0&&(d=$);for(let r=0,c=s.length;r<c;r++){const $=s[r],c=o?n[$.materialIndex]:n;if(void 0===c)continue;const p=a[$.a],l=a[$.b],u=a[$.c];if(i=eA(this,c,e,bh,p,l,u,fl)){if(d&&d[r]){const e=d[r];Hi.copy(e[0]),Ii.copy(e[1]),Ji.copy(e[2]),i.uv=ac.getUV(fl,p,l,u,Hi,Ii,Ji,new ca)}i.face=$,i.faceIndex=r,t.push(i)}}}}});const Vd=new fa,Qs=new ja,jo=new ba;function oa(){Object.defineProperty(this,"id",{value:2}),this.uuid=ta.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}oa.prototype=Object.assign(Object.create(Qa.prototype),{constructor:oa,isGeometry:!0,applyMatrix4:function(e){const t=new nc().getNormalMatrix(e);for(let r=0,n=this.vertices.length;r<n;r++){this.vertices[r].applyMatrix4(e)}for(let r=0,n=this.faces.length;r<n;r++){const e=this.faces[r];e.normal.applyMatrix3(t).normalize();for(let r=0,n=e.vertexNormals.length;r<n;r++)e.vertexNormals[r].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return Vd.makeRotationX(e),this.applyMatrix4(Vd),this},rotateY:function(e){return Vd.makeRotationY(e),this.applyMatrix4(Vd),this},rotateZ:function(e){return Vd.makeRotationZ(e),this.applyMatrix4(Vd),this},translate:function(e,t,r){return Vd.makeTranslation(e,t,r),this.applyMatrix4(Vd),this},scale:function(e,t,r){return Vd.makeScale(e,t,r),this.applyMatrix4(Vd),this},lookAt:function(e){return Qs.lookAt(e),Qs.updateMatrix(),this.applyMatrix4(Qs.matrix),this},fromBufferGeometry:function(e){const t=this,r=null!==e.index?e.index:void 0,n=e.attributes;if(void 0===n.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const o=n.position,i=n.normal,a=n.color,s=n.uv,d=n.uv2;void 0!==d&&(this.faceVertexUvs[1]=[]);for(let p=0;p<o.count;p++)t.vertices.push(new ba().fromBufferAttribute(o,p)),void 0!==a&&t.colors.push(new ga().fromBufferAttribute(a,p));function $(e,r,n,o){const $=void 0===a?[]:[t.colors[e].clone(),t.colors[r].clone(),t.colors[n].clone()],c=new aa(e,r,n,void 0===i?[]:[new ba().fromBufferAttribute(i,e),new ba().fromBufferAttribute(i,r),new ba().fromBufferAttribute(i,n)],$,o);t.faces.push(c),void 0!==s&&t.faceVertexUvs[0].push([new ca().fromBufferAttribute(s,e),new ca().fromBufferAttribute(s,r),new ca().fromBufferAttribute(s,n)]),void 0!==d&&t.faceVertexUvs[1].push([new ca().fromBufferAttribute(d,e),new ca().fromBufferAttribute(d,r),new ca().fromBufferAttribute(d,n)])}const c=e.groups;if(c.length>0)for(let p=0;p<c.length;p++){const e=c[p],t=e.start;for(let n=t,o=t+e.count;n<o;n+=3)void 0!==r?$(r.getX(n),r.getX(n+1),r.getX(n+2),e.materialIndex):$(n,n+1,n+2,e.materialIndex)}else if(void 0!==r)for(let p=0;p<r.count;p+=3)$(r.getX(p),r.getX(p+1),r.getX(p+2));else for(let p=0;p<o.count;p+=3)$(p,p+1,p+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(jo).negate(),this.translate(jo.x,jo.y,jo.z),this},normalize:function(){this.computeBoundingSphere();const e=this.boundingSphere.center,t=this.boundingSphere.radius,r=0===t?1:1/t,n=new fa;return n.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix4(n),this},computeFaceNormals:function(){const e=new ba,t=new ba;for(let r=0,n=this.faces.length;r<n;r++){const n=this.faces[r],o=this.vertices[n.a],i=this.vertices[n.b],a=this.vertices[n.c];e.subVectors(a,i),t.subVectors(o,i),e.cross(t),e.normalize(),n.normal.copy(e)}},computeVertexNormals:function(e){void 0===e&&(e=!0);const t=new Array(this.vertices.length);for(let r=0,n=this.vertices.length;r<n;r++)t[r]=new ba;if(e){const e=new ba,r=new ba;for(let n=0,o=this.faces.length;n<o;n++){const o=this.faces[n],i=this.vertices[o.a],a=this.vertices[o.b],s=this.vertices[o.c];e.subVectors(s,a),r.subVectors(i,a),e.cross(r),t[o.a].add(e),t[o.b].add(e),t[o.c].add(e)}}else{this.computeFaceNormals();for(let e=0,r=this.faces.length;e<r;e++){const r=this.faces[e];t[r.a].add(r.normal),t[r.b].add(r.normal),t[r.c].add(r.normal)}}for(let r=0,n=this.vertices.length;r<n;r++)t[r].normalize();for(let r=0,n=this.faces.length;r<n;r++){const e=this.faces[r],n=e.vertexNormals;3===n.length?(n[0].copy(t[e.a]),n[1].copy(t[e.b]),n[2].copy(t[e.c])):(n[0]=t[e.a].clone(),n[1]=t[e.b].clone(),n[2]=t[e.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e],r=t.vertexNormals;3===r.length?(r[0].copy(t.normal),r[1].copy(t.normal),r[2].copy(t.normal)):(r[0]=t.normal.clone(),r[1]=t.normal.clone(),r[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let t=0,r=this.faces.length;t<r;t++){const e=this.faces[t];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]);for(let t=0,r=e.vertexNormals.length;t<r;t++)e.__originalVertexNormals[t]?e.__originalVertexNormals[t].copy(e.vertexNormals[t]):e.__originalVertexNormals[t]=e.vertexNormals[t].clone()}const e=new oa;e.faces=this.faces;for(let t=0,r=this.morphTargets.length;t<r;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];const e=this.morphNormals[t].faceNormals,r=this.morphNormals[t].vertexNormals;for(let t=0,n=this.faces.length;t<n;t++){const t=new ba,n={a:new ba,b:new ba,c:new ba};e.push(t),r.push(n)}}const r=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e],n=r.faceNormals[e],o=r.vertexNormals[e];n.copy(t.normal),o.a.copy(t.vertexNormals[0]),o.b.copy(t.vertexNormals[1]),o.c.copy(t.vertexNormals[2])}}for(let t=0,r=this.faces.length;t<r;t++){const e=this.faces[t];e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new wc),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Td),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(!e||!e.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);let n,o=this.vertices.length,i=this.vertices,a=e.vertices,s=this.faces,d=e.faces,$=this.colors,c=e.colors;void 0===r&&(r=0),void 0!==t&&(n=new nc().getNormalMatrix(t));for(let p=0,l=a.length;p<l;p++){const e=a[p].clone();void 0!==t&&e.applyMatrix4(t),i.push(e)}for(let p=0,l=c.length;p<l;p++)$.push(c[p].clone());for(let p=0,l=d.length;p<l;p++){let e,t,i,a=d[p],$=a.vertexNormals,c=a.vertexColors;(e=new aa(a.a+o,a.b+o,a.c+o)).normal.copy(a.normal),void 0!==n&&e.normal.applyMatrix3(n).normalize();for(let r=0,o=$.length;r<o;r++)t=$[r].clone(),void 0!==n&&t.applyMatrix3(n).normalize(),e.vertexNormals.push(t);e.color.copy(a.color);for(let r=0,n=c.length;r<n;r++)i=c[r],e.vertexColors.push(i.clone());e.materialIndex=a.materialIndex+r,s.push(e)}for(let p=0,l=e.faceVertexUvs.length;p<l;p++){const t=e.faceVertexUvs[p];void 0===this.faceVertexUvs[p]&&(this.faceVertexUvs[p]=[]);for(let e=0,r=t.length;e<r;e++){const r=t[e],n=[];for(let e=0,t=r.length;e<t;e++)n.push(r[e].clone());this.faceVertexUvs[p].push(n)}}},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){const e={},t=[],r=[],n=Math.pow(10,4);for(let a=0,s=this.vertices.length;a<s;a++){const o=this.vertices[a],i=Math.round(o.x*n)+"_"+Math.round(o.y*n)+"_"+Math.round(o.z*n);void 0===e[i]?(e[i]=a,t.push(this.vertices[a]),r[a]=t.length-1):r[a]=r[e[i]]}const o=[];for(let a=0,s=this.faces.length;a<s;a++){const e=this.faces[a];e.a=r[e.a],e.b=r[e.b],e.c=r[e.c];const t=[e.a,e.b,e.c];for(let r=0;r<3;r++)if(t[r]===t[(r+1)%3]){o.push(a);break}}for(let a=o.length-1;a>=0;a--){const e=o[a];this.faces.splice(e,1);for(let t=0,r=this.faceVertexUvs.length;t<r;t++)this.faceVertexUvs[t].splice(e,1)}const i=this.vertices.length-t.length;return this.vertices=t,i},setFromPoints:function(e){this.vertices=[];for(let t=0,r=e.length;t<r;t++){const r=e[t];this.vertices.push(new ba(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){const e=this.faces,t=e.length;for(let a=0;a<t;a++)e[a]._id=a;e.sort(function(e,t){return e.materialIndex-t.materialIndex});const r=this.faceVertexUvs[0],n=this.faceVertexUvs[1];let o,i;r&&r.length===t&&(o=[]),n&&n.length===t&&(i=[]);for(let a=0;a<t;a++){const t=e[a]._id;o&&o.push(r[t]),i&&i.push(n[t])}o&&(this.faceVertexUvs[0]=o),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){const e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){const t=this.parameters;for(const r in t)void 0!==t[r]&&(e[r]=t[r]);return e}const t=[];for(let u=0;u<this.vertices.length;u++){const e=this.vertices[u];t.push(e.x,e.y,e.z)}const r=[],n=[],o={},i=[],a={},s=[],d={};for(let u=0;u<this.faces.length;u++){const e=this.faces[u],t=!0,n=!1,o=void 0!==this.faceVertexUvs[0][u],i=e.normal.length()>0,a=e.vertexNormals.length>0,s=1!==e.color.r||1!==e.color.g||1!==e.color.b,d=e.vertexColors.length>0;let h=0;if(h=$(h,0,0),h=$(h,1,t),h=$(h,2,n),h=$(h,3,o),h=$(h,4,i),h=$(h,5,a),h=$(h,6,s),h=$(h,7,d),r.push(h),r.push(e.a,e.b,e.c),r.push(e.materialIndex),o){const e=this.faceVertexUvs[0][u];r.push(l(e[0]),l(e[1]),l(e[2]))}if(i&&r.push(c(e.normal)),a){const t=e.vertexNormals;r.push(c(t[0]),c(t[1]),c(t[2]))}if(s&&r.push(p(e.color)),d){const t=e.vertexColors;r.push(p(t[0]),p(t[1]),p(t[2]))}}function $(e,t,r){return r?e|1<<t:e&~(1<<t)}function c(e){const t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==o[t]?o[t]:(o[t]=n.length/3,n.push(e.x,e.y,e.z),o[t])}function p(e){const t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==a[t]?a[t]:(a[t]=i.length,i.push(e.getHex()),a[t])}function l(e){const t=e.x.toString()+e.y.toString();return void 0!==d[t]?d[t]:(d[t]=s.length/2,s.push(e.x,e.y),d[t])}return e.data={},e.data.vertices=t,e.data.normals=n,i.length>0&&(e.data.colors=i),s.length>0&&(e.data.uvs=[s]),e.data.faces=r,e},clone:function(){return new oa().copy(this)},copy:function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;const t=e.vertices;for(let p=0,l=t.length;p<l;p++)this.vertices.push(t[p].clone());const r=e.colors;for(let p=0,l=r.length;p<l;p++)this.colors.push(r[p].clone());const n=e.faces;for(let p=0,l=n.length;p<l;p++)this.faces.push(n[p].clone());for(let p=0,l=e.faceVertexUvs.length;p<l;p++){const t=e.faceVertexUvs[p];void 0===this.faceVertexUvs[p]&&(this.faceVertexUvs[p]=[]);for(let e=0,r=t.length;e<r;e++){const r=t[e],n=[];for(let e=0,t=r.length;e<t;e++){const t=r[e];n.push(t.clone())}this.faceVertexUvs[p].push(n)}}const o=e.morphTargets;for(let p=0,l=o.length;p<l;p++){const e={};if(e.name=o[p].name,void 0!==o[p].vertices){e.vertices=[];for(let t=0,r=o[p].vertices.length;t<r;t++)e.vertices.push(o[p].vertices[t].clone())}if(void 0!==o[p].normals){e.normals=[];for(let t=0,r=o[p].normals.length;t<r;t++)e.normals.push(o[p].normals[t].clone())}this.morphTargets.push(e)}const i=e.morphNormals;for(let p=0,l=i.length;p<l;p++){const e={};if(void 0!==i[p].vertexNormals){e.vertexNormals=[];for(let t=0,r=i[p].vertexNormals.length;t<r;t++){const r=i[p].vertexNormals[t],n={};n.a=r.a.clone(),n.b=r.b.clone(),n.c=r.c.clone(),e.vertexNormals.push(n)}}if(void 0!==i[p].faceNormals){e.faceNormals=[];for(let t=0,r=i[p].faceNormals.length;t<r;t++)e.faceNormals.push(i[p].faceNormals[t].clone())}this.morphNormals.push(e)}const a=e.skinWeights;for(let p=0,l=a.length;p<l;p++)this.skinWeights.push(a[p].clone());const s=e.skinIndices;for(let p=0,l=s.length;p<l;p++)this.skinIndices.push(s[p].clone());const d=e.lineDistances;for(let p=0,l=d.length;p<l;p++)this.lineDistances.push(d[p]);const $=e.boundingBox;null!==$&&(this.boundingBox=$.clone());const c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class BS extends oa{constructor(e,t,r,n,o,i){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:o,depthSegments:i},this.fromBufferGeometry(new Yf(e,t,r,n,o,i)),this.mergeVertices()}}class Yf extends ia{constructor(e,t,r,n,o,i){super(),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:o,depthSegments:i};const a=this;e=e||1,t=t||1,r=r||1,n=Math.floor(n)||1,o=Math.floor(o)||1,i=Math.floor(i)||1;const s=[],d=[],$=[],c=[];let p=0,l=0;function u(e,t,r,n,o,i,u,h,f,m,x){const R=i/f,g=u/m,v=i/2,q=u/2,K=h/2,y=f+1,_=m+1;let b=0,M=0;const w=new ba;for(let a=0;a<_;a++){const i=a*g-q;for(let s=0;s<y;s++){const p=s*R-v;w[e]=p*n,w[t]=i*o,w[r]=K,d.push(w.x,w.y,w.z),w[e]=0,w[t]=0,w[r]=h>0?1:-1,$.push(w.x,w.y,w.z),c.push(s/f),c.push(1-a/m),b+=1}}for(let a=0;a<m;a++)for(let e=0;e<f;e++){const t=p+e+y*a,r=p+e+y*(a+1),n=p+(e+1)+y*(a+1),o=p+(e+1)+y*a;s.push(t,r,o),s.push(r,n,o),M+=6}a.addGroup(l,M,x),l+=M,p+=b}u("z","y","x",-1,-1,r,t,e,i,o,0),u("z","y","x",1,-1,r,t,-e,i,o,1),u("x","z","y",1,1,e,r,t,n,i,2),u("x","z","y",1,-1,e,r,-t,n,i,3),u("x","y","z",1,-1,e,t,r,n,o,4),u("x","y","z",-1,-1,e,t,-r,n,o,5),this.setIndex(s),this.setAttribute("position",new ma(d,3)),this.setAttribute("normal",new ma($,3)),this.setAttribute("uv",new ma(c,2))}}function Ki(e){const t={};for(const r in e){t[r]={};for(const n in e[r]){const o=e[r][n];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture)?t[r][n]=o.clone():Array.isArray(o)?t[r][n]=o.slice():t[r][n]=o}}return t}function fc(e){const t={};for(let r=0;r<e.length;r++){const n=Ki(e[r]);for(const e in n)t[e]=n[e]}return t}const CS={clone:Ki,merge:fc};var DS="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",ES="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function gc(e){ua.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=DS,this.fragmentShader=ES,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function We(){ja.call(this),this.type="Camera",this.matrixWorldInverse=new fa,this.projectionMatrix=new fa,this.projectionMatrixInverse=new fa}function zb(e,t,r,n){We.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==r?r:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}gc.prototype=Object.create(ua.prototype),gc.prototype.constructor=gc,gc.prototype.isShaderMaterial=!0,gc.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ki(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this},gc.prototype.toJSON=function(e){const t=ua.prototype.toJSON.call(this,e);t.uniforms={};for(const n in this.uniforms){const r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const r={};for(const n in this.extensions)!0===this.extensions[n]&&(r[n]=!0);return Object.keys(r).length>0&&(t.extensions=r),t},We.prototype=Object.assign(Object.create(ja.prototype),{constructor:We,isCamera:!0,copy:function(e,t){return ja.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new ba),this.updateMatrixWorld(!0);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){ja.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){ja.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),zb.prototype=Object.assign(Object.create(We.prototype),{constructor:zb,isPerspectiveCamera:!0,copy:function(e,t){return We.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){const t=.5*this.getFilmHeight()/e;this.fov=2*ta.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){const e=Math.tan(.5*ta.DEG2RAD*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*ta.RAD2DEG*Math.atan(Math.tan(.5*ta.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,r,n,o,i){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=o,this.view.height=i,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){let e=this.near,t=e*Math.tan(.5*ta.DEG2RAD*this.fov)/this.zoom,r=2*t,n=this.aspect*r,o=-.5*n,i=this.view;if(null!==this.view&&this.view.enabled){const e=i.fullWidth,a=i.fullHeight;o+=i.offsetX*n/e,t-=i.offsetY*r/a,n*=i.width/e,r*=i.height/a}const a=this.filmOffset;0!==a&&(o+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+n,t,t-r,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){const t=ja.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});const Li=90,Mi=1;function Ni(e,t,r){if(ja.call(this),this.type="CubeCamera",!0!==r.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=r;const n=new zb(Li,Mi,e,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new ba(1,0,0)),this.add(n);const o=new zb(Li,Mi,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new ba(-1,0,0)),this.add(o);const i=new zb(Li,Mi,e,t);i.layers=this.layers,i.up.set(0,0,1),i.lookAt(new ba(0,1,0)),this.add(i);const a=new zb(Li,Mi,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new ba(0,-1,0)),this.add(a);const s=new zb(Li,Mi,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new ba(0,0,1)),this.add(s);const d=new zb(Li,Mi,e,t);d.layers=this.layers,d.up.set(0,-1,0),d.lookAt(new ba(0,0,-1)),this.add(d),this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();const $=e.xr.enabled,c=e.getRenderTarget();e.xr.enabled=!1;const p=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,n),e.setRenderTarget(r,1),e.render(t,o),e.setRenderTarget(r,2),e.render(t,i),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,s),r.texture.generateMipmaps=p,e.setRenderTarget(r,5),e.render(t,d),e.setRenderTarget(c),e.xr.enabled=$},this.clear=function(e,t,n,o){const i=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(r,a),e.clear(t,n,o);e.setRenderTarget(i)}}function Oi(e,t,r){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=r),ad.call(this,e,e,t)}function Pi(e,t,r,n,o,i,a,s,d,$,c,p){$a.call(this,null,i,a,s,d,$,n,o,c,p),this.image={data:e||null,width:t||1,height:r||1},this.magFilter=void 0!==d?d:Gb,this.minFilter=void 0!==$?$:Gb,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Ni.prototype=Object.create(ja.prototype),Ni.prototype.constructor=Ni,Oi.prototype=Object.create(ad.prototype),Oi.prototype.constructor=Oi,Oi.prototype.isWebGLCubeRenderTarget=!0,Oi.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;const r=new $g,n={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#include <common>","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV = equirectUv( direction );","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},o=new gc({name:"CubemapFromEquirect",uniforms:Ki(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Ob,blending:Nf});o.uniforms.tEquirect.value=t;const i=new Aa(new Yf(5,5,5),o);return r.add(i),new Ni(1,10,this).update(e,r),i.geometry.dispose(),i.material.dispose(),this},Pi.prototype=Object.create($a.prototype),Pi.prototype.constructor=Pi,Pi.prototype.isDataTexture=!0;const Qi=new Td,ko=new ba;function gl(e,t,r,n,o,i){this.planes=[void 0!==e?e:new xc,void 0!==t?t:new xc,void 0!==r?r:new xc,void 0!==n?n:new xc,void 0!==o?o:new xc,void 0!==i?i:new xc]}Object.assign(gl.prototype,{set:function(e,t,r,n,o,i){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(n),a[4].copy(o),a[5].copy(i),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this},setFromProjectionMatrix:function(e){const t=this.planes,r=e.elements,n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],d=r[5],$=r[6],c=r[7],p=r[8],l=r[9],u=r[10],h=r[11],f=r[12],m=r[13],x=r[14],R=r[15];return t[0].setComponents(a-n,c-s,h-p,R-f).normalize(),t[1].setComponents(a+n,c+s,h+p,R+f).normalize(),t[2].setComponents(a+o,c+d,h+l,R+m).normalize(),t[3].setComponents(a-o,c-d,h-l,R-m).normalize(),t[4].setComponents(a-i,c-$,h-u,R-x).normalize(),t[5].setComponents(a+i,c+$,h+u,R+x).normalize(),this},intersectsObject:function(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Qi.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Qi)},intersectsSprite:function(e){return Qi.center.set(0,0,0),Qi.radius=.7071067811865476,Qi.applyMatrix4(e.matrixWorld),this.intersectsSphere(Qi)},intersectsSphere:function(e){const t=this.planes,r=e.center,n=-e.radius;for(let o=0;o<6;o++){if(t[o].distanceToPoint(r)<n)return!1}return!0},intersectsBox:function(e){const t=this.planes;for(let r=0;r<6;r++){const n=t[r];if(ko.x=n.normal.x>0?e.max.x:e.min.x,ko.y=n.normal.y>0?e.max.y:e.min.y,ko.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(ko)<0)return!1}return!0},containsPoint:function(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}});const na={common:{diffuse:{value:new ga(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new nc},uv2Transform:{value:new nc},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ca(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ga(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ga(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new nc}},sprite:{diffuse:{value:new ga(15658734)},opacity:{value:1},center:{value:new ca(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new nc}}};function fA(){let e=null,t=!1,r=null,n=null;function o(t,i){r(t,i),n=e.requestAnimationFrame(o)}return{start:function(){!0!==t&&null!==r&&(n=e.requestAnimationFrame(o),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function FS(e,t){const r=t.isWebGL2,n=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),n.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const r=n.get(t);r&&(e.deleteBuffer(r.buffer),n.delete(t))},update:function(t,o){t.isInterleavedBufferAttribute&&(t=t.data);const i=n.get(t);void 0===i?n.set(t,function(t,r){const n=t.array,o=t.usage,i=e.createBuffer();e.bindBuffer(r,i),e.bufferData(r,n,o),t.onUploadCallback();let a=5126;return n instanceof Float32Array?a=5126:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?a=5123:n instanceof Int16Array?a=5122:n instanceof Uint32Array?a=5125:n instanceof Int32Array?a=5124:n instanceof Int8Array?a=5120:n instanceof Uint8Array&&(a=5121),{buffer:i,type:a,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version}}(t,o)):i.version<t.version&&(function(t,n,o){const i=n.array,a=n.updateRange;e.bindBuffer(o,t),-1===a.count?e.bufferSubData(o,0,i):(r?e.bufferSubData(o,a.offset*i.BYTES_PER_ELEMENT,i,a.offset,a.count):e.bufferSubData(o,a.offset*i.BYTES_PER_ELEMENT,i.subarray(a.offset,a.offset+a.count)),a.count=-1)}(i.buffer,t,o),i.version=t.version)}}}function lo(e,t,r,n){oa.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n},this.fromBufferGeometry(new Ri(e,t,r,n)),this.mergeVertices()}function Ri(e,t,r,n){ia.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};const o=(e=e||1)/2,i=(t=t||1)/2,a=Math.floor(r)||1,s=Math.floor(n)||1,d=a+1,$=s+1,c=e/a,p=t/s,l=[],u=[],h=[],f=[];for(let m=0;m<$;m++){const e=m*p-i;for(let t=0;t<d;t++){const r=t*c-o;u.push(r,-e,0),h.push(0,0,1),f.push(t/a),f.push(1-m/s)}}for(let m=0;m<s;m++)for(let e=0;e<a;e++){const t=e+d*m,r=e+d*(m+1),n=e+1+d*(m+1),o=e+1+d*m;l.push(t,r,o),l.push(r,n,o)}this.setIndex(l),this.setAttribute("position",new ma(u,3)),this.setAttribute("normal",new ma(h,3)),this.setAttribute("uv",new ma(f,2))}lo.prototype=Object.create(oa.prototype),lo.prototype.constructor=lo,Ri.prototype=Object.create(ia.prototype),Ri.prototype.constructor=Ri;var GS="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",HS="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",IS="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",JS="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",KS="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",LS="vec3 transformed = vec3( position );",MS="vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",NS="vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",OS="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",PS="#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",QS="#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",RS="#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",SS="#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",TS="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",US="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",VS="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",WS="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",XS="#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",YS="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {\n      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {\n      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {\n      uv = vec2(direction.x, direction.y) / abs(direction.z);    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",ZS="vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",$S="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",_S="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",aT="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",bT="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",cT="gl_FragColor = linearToOutputTexel( gl_FragColor );",dT="\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",eT="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",fT="#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",gT="#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",hT="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",iT="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",jT="#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",kT="#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",lT="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",mT="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",nT="#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",oT="#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",pT="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",qT="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",rT="uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",sT="#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",tT="ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",uT="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",vT="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",wT="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",xT="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",yT="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",zT="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",AT="#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",BT="#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",CT="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",DT="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",ET="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",FT="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",GT="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",HT="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",IT="#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",JT="#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",KT="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",LT="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",MT="#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",NT="#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",OT="#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",PT="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",QT="#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",RT="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",ST="#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",TT="#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",UT="#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",VT="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",WT="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",XT="vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",YT="#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",ZT="#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",$T="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",_T="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",aU="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",bU="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",cU="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",dU="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",eU="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",fU="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",gU="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",hU="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",iU="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",jU="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",kU="#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",lU="#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",mU="#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",nU="#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",oU="#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",pU="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",qU="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",rU="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",sU="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",tU="uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",uU="varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",vU="#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",wU="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",xU="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",yU="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",zU="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",AU="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",BU="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",CU="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",DU="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",EU="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",FU="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",GU="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",HU="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",IU="#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",JU="#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",KU="#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",LU="#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",MU="#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",NU="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",OU="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",PU="#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",QU="#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",RU="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",SU="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",TU="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",UU="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",VU="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",WU="#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",XU="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",YU="uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}";const Ea={alphamap_fragment:GS,alphamap_pars_fragment:HS,alphatest_fragment:IS,aomap_fragment:JS,aomap_pars_fragment:KS,begin_vertex:LS,beginnormal_vertex:MS,bsdfs:NS,bumpmap_pars_fragment:OS,clipping_planes_fragment:PS,clipping_planes_pars_fragment:QS,clipping_planes_pars_vertex:RS,clipping_planes_vertex:SS,color_fragment:TS,color_pars_fragment:US,color_pars_vertex:VS,color_vertex:WS,common:XS,cube_uv_reflection_fragment:YS,defaultnormal_vertex:ZS,displacementmap_pars_vertex:$S,displacementmap_vertex:_S,emissivemap_fragment:aT,emissivemap_pars_fragment:bT,encodings_fragment:cT,encodings_pars_fragment:dT,envmap_fragment:eT,envmap_common_pars_fragment:fT,envmap_pars_fragment:gT,envmap_pars_vertex:hT,envmap_physical_pars_fragment:sT,envmap_vertex:iT,fog_vertex:jT,fog_pars_vertex:kT,fog_fragment:lT,fog_pars_fragment:mT,gradientmap_pars_fragment:nT,lightmap_fragment:oT,lightmap_pars_fragment:pT,lights_lambert_vertex:qT,lights_pars_begin:rT,lights_toon_fragment:tT,lights_toon_pars_fragment:uT,lights_phong_fragment:vT,lights_phong_pars_fragment:wT,lights_physical_fragment:xT,lights_physical_pars_fragment:yT,lights_fragment_begin:zT,lights_fragment_maps:AT,lights_fragment_end:BT,logdepthbuf_fragment:CT,logdepthbuf_pars_fragment:DT,logdepthbuf_pars_vertex:ET,logdepthbuf_vertex:FT,map_fragment:GT,map_pars_fragment:HT,map_particle_fragment:IT,map_particle_pars_fragment:JT,metalnessmap_fragment:KT,metalnessmap_pars_fragment:LT,morphnormal_vertex:MT,morphtarget_pars_vertex:NT,morphtarget_vertex:OT,normal_fragment_begin:PT,normal_fragment_maps:QT,normalmap_pars_fragment:RT,clearcoat_normal_fragment_begin:ST,clearcoat_normal_fragment_maps:TT,clearcoat_pars_fragment:UT,packing:VT,premultiplied_alpha_fragment:WT,project_vertex:XT,dithering_fragment:YT,dithering_pars_fragment:ZT,roughnessmap_fragment:$T,roughnessmap_pars_fragment:_T,shadowmap_pars_fragment:aU,shadowmap_pars_vertex:bU,shadowmap_vertex:cU,shadowmask_pars_fragment:dU,skinbase_vertex:eU,skinning_pars_vertex:fU,skinning_vertex:gU,skinnormal_vertex:hU,specularmap_fragment:iU,specularmap_pars_fragment:jU,tonemapping_fragment:kU,tonemapping_pars_fragment:lU,uv_pars_fragment:mU,uv_pars_vertex:nU,uv_vertex:oU,uv2_pars_fragment:pU,uv2_pars_vertex:qU,uv2_vertex:rU,worldpos_vertex:sU,background_frag:tU,background_vert:uU,cube_frag:vU,cube_vert:wU,depth_frag:xU,depth_vert:yU,distanceRGBA_frag:zU,distanceRGBA_vert:AU,equirect_frag:BU,equirect_vert:CU,linedashed_frag:DU,linedashed_vert:EU,meshbasic_frag:FU,meshbasic_vert:GU,meshlambert_frag:HU,meshlambert_vert:IU,meshmatcap_frag:JU,meshmatcap_vert:KU,meshtoon_frag:LU,meshtoon_vert:MU,meshphong_frag:NU,meshphong_vert:OU,meshphysical_frag:PU,meshphysical_vert:QU,normal_frag:RU,normal_vert:SU,points_frag:TU,points_vert:UU,shadow_frag:VU,shadow_vert:WU,sprite_frag:XU,sprite_vert:YU},Xe={basic:{uniforms:fc([na.common,na.specularmap,na.envmap,na.aomap,na.lightmap,na.fog]),vertexShader:Ea.meshbasic_vert,fragmentShader:Ea.meshbasic_frag},lambert:{uniforms:fc([na.common,na.specularmap,na.envmap,na.aomap,na.lightmap,na.emissivemap,na.fog,na.lights,{emissive:{value:new ga(0)}}]),vertexShader:Ea.meshlambert_vert,fragmentShader:Ea.meshlambert_frag},phong:{uniforms:fc([na.common,na.specularmap,na.envmap,na.aomap,na.lightmap,na.emissivemap,na.bumpmap,na.normalmap,na.displacementmap,na.fog,na.lights,{emissive:{value:new ga(0)},specular:{value:new ga(1118481)},shininess:{value:30}}]),vertexShader:Ea.meshphong_vert,fragmentShader:Ea.meshphong_frag},standard:{uniforms:fc([na.common,na.envmap,na.aomap,na.lightmap,na.emissivemap,na.bumpmap,na.normalmap,na.displacementmap,na.roughnessmap,na.metalnessmap,na.fog,na.lights,{emissive:{value:new ga(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ea.meshphysical_vert,fragmentShader:Ea.meshphysical_frag},toon:{uniforms:fc([na.common,na.aomap,na.lightmap,na.emissivemap,na.bumpmap,na.normalmap,na.displacementmap,na.gradientmap,na.fog,na.lights,{emissive:{value:new ga(0)}}]),vertexShader:Ea.meshtoon_vert,fragmentShader:Ea.meshtoon_frag},matcap:{uniforms:fc([na.common,na.bumpmap,na.normalmap,na.displacementmap,na.fog,{matcap:{value:null}}]),vertexShader:Ea.meshmatcap_vert,fragmentShader:Ea.meshmatcap_frag},points:{uniforms:fc([na.points,na.fog]),vertexShader:Ea.points_vert,fragmentShader:Ea.points_frag},dashed:{uniforms:fc([na.common,na.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ea.linedashed_vert,fragmentShader:Ea.linedashed_frag},depth:{uniforms:fc([na.common,na.displacementmap]),vertexShader:Ea.depth_vert,fragmentShader:Ea.depth_frag},normal:{uniforms:fc([na.common,na.bumpmap,na.normalmap,na.displacementmap,{opacity:{value:1}}]),vertexShader:Ea.normal_vert,fragmentShader:Ea.normal_frag},sprite:{uniforms:fc([na.sprite,na.fog]),vertexShader:Ea.sprite_vert,fragmentShader:Ea.sprite_frag},background:{uniforms:{uvTransform:{value:new nc},t2D:{value:null}},vertexShader:Ea.background_vert,fragmentShader:Ea.background_frag},cube:{uniforms:fc([na.envmap,{opacity:{value:1}}]),vertexShader:Ea.cube_vert,fragmentShader:Ea.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ea.equirect_vert,fragmentShader:Ea.equirect_frag},distanceRGBA:{uniforms:fc([na.common,na.displacementmap,{referencePosition:{value:new ba},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ea.distanceRGBA_vert,fragmentShader:Ea.distanceRGBA_frag},shadow:{uniforms:fc([na.lights,na.fog,{color:{value:new ga(0)},opacity:{value:1}}]),vertexShader:Ea.shadow_vert,fragmentShader:Ea.shadow_frag}};function ZU(e,t,r,n){const o=new ga(0);let i,a,s=0,d=null,$=0,c=null;function p(e,r){t.buffers.color.setClear(e.r,e.g,e.b,r,n)}return{getClearColor:function(){return o},setClearColor:function(e,t){o.set(e),p(o,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){p(o,s=e)},render:function(t,n,l,u){let h=!0===n.isScene?n.background:null;const f=e.xr,m=f.getSession&&f.getSession();if(m&&"additive"===m.environmentBlendMode&&(h=null),null===h?p(o,s):h&&h.isColor&&(p(h,1),u=!0),(e.autoClear||u)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),h&&(h.isCubeTexture||h.isWebGLCubeRenderTarget||h.mapping===Tk)){void 0===a&&((a=new Aa(new Yf(1,1,1),new gc({name:"BackgroundCubeMaterial",uniforms:Ki(Xe.cube.uniforms),vertexShader:Xe.cube.vertexShader,fragmentShader:Xe.cube.fragmentShader,side:Ob,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(a));const n=h.isWebGLCubeRenderTarget?h.texture:h;a.material.uniforms.envMap.value=n,a.material.uniforms.flipEnvMap.value=n.isCubeTexture?-1:1,d===h&&$===n.version&&c===e.toneMapping||(a.material.needsUpdate=!0,d=h,$=n.version,c=e.toneMapping),t.unshift(a,a.geometry,a.material,0,0,null)}else h&&h.isTexture&&(void 0===i&&((i=new Aa(new Ri(2,2),new gc({name:"BackgroundMaterial",uniforms:Ki(Xe.background.uniforms),vertexShader:Xe.background.vertexShader,fragmentShader:Xe.background.fragmentShader,side:Pe,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(i)),i.material.uniforms.t2D.value=h,!0===h.matrixAutoUpdate&&h.updateMatrix(),i.material.uniforms.uvTransform.value.copy(h.matrix),d===h&&$===h.version&&c===e.toneMapping||(i.material.needsUpdate=!0,d=h,$=h.version,c=e.toneMapping),t.unshift(i,i.geometry,i.material,0,0,null))}}}function $U(e,t,r,n){const o=e.getParameter(34921),i=n.isWebGL2?null:t.get("OES_vertex_array_object"),a=n.isWebGL2||null!==i,s={},d=l(null);let $=d;function c(t){return n.isWebGL2?e.bindVertexArray(t):i.bindVertexArrayOES(t)}function p(t){return n.isWebGL2?e.deleteVertexArray(t):i.deleteVertexArrayOES(t)}function l(e){const t=[],r=[],n=[];for(let i=0;i<o;i++)t[i]=0,r[i]=0,n[i]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:n,object:e,attributes:{}}}function u(){const e=$.newAttributes;for(let t=0,r=e.length;t<r;t++)e[t]=0}function h(e){f(e,0)}function f(r,o){const i=$.newAttributes,a=$.enabledAttributes,s=$.attributeDivisors;if(i[r]=1,0===a[r]&&(e.enableVertexAttribArray(r),a[r]=1),s[r]!==o){(n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,o),s[r]=o}}function m(){const t=$.newAttributes,r=$.enabledAttributes;for(let n=0,o=r.length;n<o;n++)r[n]!==t[n]&&(e.disableVertexAttribArray(n),r[n]=0)}function x(t,r,o,i,a,s){!0!==n.isWebGL2||5124!==o&&5125!==o?e.vertexAttribPointer(t,r,o,i,a,s):e.vertexAttribIPointer(t,r,o,i,a,s)}function R(){g(),$!==d&&c(($=d).object)}function g(){d.geometry=null,d.program=null,d.wireframe=!1}return{setup:function(o,d,p,R,g){let v=!1;if(a){const t=function(t,r,o){const a=!0===o.wireframe;let d=s[t.id];void 0===d&&(d={},s[t.id]=d);let $=d[r.id];void 0===$&&($={},d[r.id]=$);let c=$[a];return void 0===c&&(c=l(n.isWebGL2?e.createVertexArray():i.createVertexArrayOES()),$[a]=c),c}(R,p,d);$!==t&&c(($=t).object),(v=function(e){const t=$.attributes,r=e.attributes;if(Object.keys(t).length!==Object.keys(r).length)return!0;for(const n in r){const e=t[n],o=r[n];if(e.attribute!==o)return!0;if(e.data!==o.data)return!0}return!1}(R))&&function(e){const t={},r=e.attributes;for(const n in r){const e=r[n],o={};o.attribute=e,e.data&&(o.data=e.data),t[n]=o}$.attributes=t}(R)}else{const e=!0===d.wireframe;$.geometry===R.id&&$.program===p.id&&$.wireframe===e||($.geometry=R.id,$.program=p.id,$.wireframe=e,v=!0)}!0===o.isInstancedMesh&&(v=!0),null!==g&&r.update(g,34963),v&&(function(o,i,a,s){if(!1===n.isWebGL2&&(o.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;u();const d=s.attributes,$=a.getAttributes(),c=i.defaultAttributeValues;for(const t in $){const n=$[t];if(n>=0){const i=d[t];if(void 0!==i){const t=i.normalized,o=i.itemSize,a=r.get(i);if(void 0===a)continue;const d=a.buffer,$=a.type,c=a.bytesPerElement;if(i.isInterleavedBufferAttribute){const r=i.data,a=r.stride,p=i.offset;r&&r.isInstancedInterleavedBuffer?(f(n,r.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=r.meshPerAttribute*r.count)):h(n),e.bindBuffer(34962,d),x(n,o,$,t,a*c,p*c)}else i.isInstancedBufferAttribute?(f(n,i.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=i.meshPerAttribute*i.count)):h(n),e.bindBuffer(34962,d),x(n,o,$,t,0,0)}else if("instanceMatrix"===t){const t=r.get(o.instanceMatrix);if(void 0===t)continue;const i=t.buffer,a=t.type;f(n+0,1),f(n+1,1),f(n+2,1),f(n+3,1),e.bindBuffer(34962,i),e.vertexAttribPointer(n+0,4,a,!1,64,0),e.vertexAttribPointer(n+1,4,a,!1,64,16),e.vertexAttribPointer(n+2,4,a,!1,64,32),e.vertexAttribPointer(n+3,4,a,!1,64,48)}else if(void 0!==c){const r=c[t];if(void 0!==r)switch(r.length){case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:e.vertexAttrib1fv(n,r);}}}}m()}(o,d,p,R),null!==g&&e.bindBuffer(34963,r.get(g).buffer))},reset:R,resetDefaultState:g,dispose:function(){R();for(const e in s){const t=s[e];for(const e in t){const r=t[e];for(const e in r)p(r[e].object),delete r[e];delete t[e]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0===s[e.id])return;const t=s[e.id];for(const r in t){const e=t[r];for(const t in e)p(e[t].object),delete e[t];delete t[r]}delete s[e.id]},releaseStatesOfProgram:function(e){for(const t in s){const r=s[t];if(void 0===r[e.id])continue;const n=r[e.id];for(const e in n)p(n[e].object),delete n[e];delete r[e.id]}},initAttributes:u,enableAttribute:h,disableUnusedAttributes:m}}function _U(e,t,r,n){const o=n.isWebGL2;let i;this.setMode=function(e){i=e},this.render=function(t,n){e.drawArrays(i,t,n),r.update(n,i)},this.renderInstances=function(n,a,s,d){if(0===d)return;let $,c;if(o)$=e,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===($=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");$[c](i,a,s,d),r.update(s,i,d)}}function aV(e,t,r){let n;function o(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const i="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext;let a=void 0!==r.precision?r.precision:"highp";const s=o(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);const d=!0===r.logarithmicDepthBuffer,$=e.getParameter(34930),c=e.getParameter(35660),p=e.getParameter(3379),l=e.getParameter(34076),u=e.getParameter(34921),h=e.getParameter(36347),f=e.getParameter(36348),m=e.getParameter(36349),x=c>0,R=i||!!t.get("OES_texture_float");return{isWebGL2:i,getMaxAnisotropy:function(){if(void 0!==n)return n;const r=t.get("EXT_texture_filter_anisotropic");return n=null!==r?e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:o,precision:a,logarithmicDepthBuffer:d,maxTextures:$,maxVertexTextures:c,maxTextureSize:p,maxCubemapSize:l,maxAttributes:u,maxVertexUniforms:h,maxVaryings:f,maxFragmentUniforms:m,vertexTextures:x,floatFragmentTextures:R,floatVertexTextures:x&&R,maxSamples:i?e.getParameter(36183):0}}function bV(){const e=this;let t=null,r=0,n=!1,o=!1;const i=new xc,a=new nc,s={value:null,needsUpdate:!1};function d(){s.value!==t&&(s.value=t,s.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function $(t,r,n,o){let d=null!==t?t.length:0,$=null;if(0!==d){if($=s.value,!0!==o||null===$){const e=n+4*d,o=r.matrixWorldInverse;a.getNormalMatrix(o),(null===$||$.length<e)&&($=new Float32Array(e));for(let r=0,s=n;r!==d;++r,s+=4)i.copy(t[r]).applyMatrix4(o,a),i.normal.toArray($,s),$[s+3]=i.constant}s.value=$,s.needsUpdate=!0}return e.numPlanes=d,e.numIntersection=0,$}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,o,i){const a=0!==e.length||o||0!==r||n;return n=o,t=$(e,i,0),r=e.length,a},this.beginShadows=function(){o=!0,$(null)},this.endShadows=function(){o=!1,d()},this.setState=function(e,i,a,c,p,l){if(!n||null===e||0===e.length||o&&!a)o?$(null):d();else{const n=o?0:r,a=4*n;let d=p.clippingState||null;s.value=d,d=$(e,c,a,l);for(let e=0;e!==a;++e)d[e]=t[e];p.clippingState=d,this.numIntersection=i?this.numPlanes:0,this.numPlanes+=n}}}function cV(e){const t={};return{get:function(r){if(void 0!==t[r])return t[r];let n;switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r);}return null===n&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),t[r]=n,n}}}function dV(e,t,r,n){const o=new WeakMap,i=new WeakMap;function a(e){const s=e.target,d=o.get(s);null!==d.index&&t.remove(d.index);for(const r in d.attributes)t.remove(d.attributes[r]);s.removeEventListener("dispose",a),o.delete(s);const $=i.get(d);$&&(t.remove($),i.delete(d)),n.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,r.memory.geometries--}function s(e){const r=[],n=e.index,o=e.attributes.position;let a=0;if(null!==n){const e=n.array;a=n.version;for(let t=0,n=e.length;t<n;t+=3){const n=e[t+0],o=e[t+1],i=e[t+2];r.push(n,o,o,i,i,n)}}else{const e=o.array;a=o.version;for(let t=0,n=e.length/3-1;t<n;t+=3){const e=t+0,n=t+1,o=t+2;r.push(e,n,n,o,o,e)}}const s=new(cA(r)>65535?dl:cl)(r,1);s.version=a;const d=i.get(e);d&&t.remove(d),i.set(e,s)}return{get:function(e,t){let n=o.get(t);return n||(t.addEventListener("dispose",a),t.isBufferGeometry?n=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=new ia().setFromObject(e)),n=t._bufferGeometry),o.set(t,n),r.memory.geometries++,n)},update:function(e){const r=e.attributes;for(const o in r)t.update(r[o],34962);const n=e.morphAttributes;for(const o in n){const e=n[o];for(let r=0,n=e.length;r<n;r++)t.update(e[r],34962)}},getWireframeAttribute:function(e){const t=i.get(e);if(t){const r=e.index;null!==r&&t.version<r.version&&s(e)}else s(e);return i.get(e)}}}function eV(e,t,r,n){const o=n.isWebGL2;let i,a,s;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,s=e.bytesPerElement},this.render=function(t,n){e.drawElements(i,n,a,t*s),r.update(n,i)},this.renderInstances=function(n,d,$,c){if(0===c)return;let p,l;if(o)p=e,l="drawElementsInstanced";else if(l="drawElementsInstancedANGLE",null===(p=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[l](i,$,a,d*s,c),r.update($,i,c)}}function fV(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,r,n){switch(n=n||1,t.calls++,r){case 4:t.triangles+=n*(e/3);break;case 1:t.lines+=n*(e/2);break;case 3:t.lines+=n*(e-1);break;case 2:t.lines+=n*e;break;case 0:t.points+=n*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r);}}}}function gV(e,t){return e[0]-t[0]}function hV(e,t){return Math.abs(t[1])-Math.abs(e[1])}function iV(e){const t={},r=new Float32Array(8),n=[];for(let o=0;o<8;o++)n[o]=[o,0];return{update:function(o,i,a,s){const d=o.morphTargetInfluences,$=void 0===d?0:d.length;let c=t[i.id];if(void 0===c){c=[];for(let e=0;e<$;e++)c[e]=[e,0];t[i.id]=c}for(let e=0;e<$;e++){const t=c[e];t[0]=e,t[1]=d[e]}c.sort(hV);for(let e=0;e<8;e++)e<$&&c[e][1]?(n[e][0]=c[e][0],n[e][1]=c[e][1]):(n[e][0]=Number.MAX_SAFE_INTEGER,n[e][1]=0);n.sort(gV);const p=a.morphTargets&&i.morphAttributes.position,l=a.morphNormals&&i.morphAttributes.normal;let u=0;for(let e=0;e<8;e++){const t=n[e],o=t[0],a=t[1];o!==Number.MAX_SAFE_INTEGER&&a?(p&&i.getAttribute("morphTarget"+e)!==p[o]&&i.setAttribute("morphTarget"+e,p[o]),l&&i.getAttribute("morphNormal"+e)!==l[o]&&i.setAttribute("morphNormal"+e,l[o]),r[e]=a,u+=a):(p&&void 0!==i.getAttribute("morphTarget"+e)&&i.deleteAttribute("morphTarget"+e),l&&void 0!==i.getAttribute("morphNormal"+e)&&i.deleteAttribute("morphNormal"+e),r[e]=0)}const h=i.morphTargetsRelative?1:1-u;s.getUniforms().setValue(e,"morphTargetBaseInfluence",h),s.getUniforms().setValue(e,"morphTargetInfluences",r)}}}function jV(e,t,r,n){let o=new WeakMap;return{update:function(e){const i=n.render.frame,a=e.geometry,s=t.get(e,a);return o.get(s)!==i&&(a.isGeometry&&s.updateFromObject(e),t.update(s),o.set(s,i)),e.isInstancedMesh&&r.update(e.instanceMatrix,34962),s},dispose:function(){o=new WeakMap}}}function Zf(e,t,r,n,o,i,a,s,d,$){e=void 0!==e?e:[],t=void 0!==t?t:Rn,a=void 0!==a?a:Sd,$a.call(this,e,t,r,n,o,i,a,s,d,$),this.flipY=!1}function hl(e,t,r,n){$a.call(this,null),this.image={data:e||null,width:t||1,height:r||1,depth:n||1},this.magFilter=Gb,this.minFilter=Gb,this.wrapR=ec,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function il(e,t,r,n){$a.call(this,null),this.image={data:e||null,width:t||1,height:r||1,depth:n||1},this.magFilter=Gb,this.minFilter=Gb,this.wrapR=ec,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Xe.physical={uniforms:fc([Xe.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ca(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new ga(0)},transparency:{value:0}}]),vertexShader:Ea.meshphysical_vert,fragmentShader:Ea.meshphysical_frag},Zf.prototype=Object.create($a.prototype),Zf.prototype.constructor=Zf,Zf.prototype.isCubeTexture=!0,Object.defineProperty(Zf.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),hl.prototype=Object.create($a.prototype),hl.prototype.constructor=hl,hl.prototype.isDataTexture2DArray=!0,il.prototype=Object.create($a.prototype),il.prototype.constructor=il,il.prototype.isDataTexture3D=!0;const gA=new $a,kV=new hl,lV=new il,hA=new Zf,iA=[],jA=[],kA=new Float32Array(16),lA=new Float32Array(9),mA=new Float32Array(4);function Si(e,t,r){const n=e[0];if(n<=0||n>0)return e;let o=t*r,i=iA[o];if(void 0===i&&(i=new Float32Array(o),iA[o]=i),0!==t){n.toArray(i,0);for(let n=1,o=0;n!==t;++n)o+=r,e[n].toArray(i,o)}return i}function bd(e,t){if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Jc(e,t){for(let r=0,n=t.length;r<n;r++)e[r]=t[r]}function nA(e,t){let r=jA[t];void 0===r&&(r=new Int32Array(t),jA[t]=r);for(let n=0;n!==t;++n)r[n]=e.allocateTextureUnit();return r}function mV(e,t){const r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function nV(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(bd(r,t))return;e.uniform2fv(this.addr,t),Jc(r,t)}}function oV(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)r[0]===t.r&&r[1]===t.g&&r[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(bd(r,t))return;e.uniform3fv(this.addr,t),Jc(r,t)}}function pV(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z&&r[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(bd(r,t))return;e.uniform4fv(this.addr,t),Jc(r,t)}}function qV(e,t){const r=this.cache,n=t.elements;if(void 0===n){if(bd(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),Jc(r,t)}else{if(bd(r,n))return;mA.set(n),e.uniformMatrix2fv(this.addr,!1,mA),Jc(r,n)}}function rV(e,t){const r=this.cache,n=t.elements;if(void 0===n){if(bd(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),Jc(r,t)}else{if(bd(r,n))return;lA.set(n),e.uniformMatrix3fv(this.addr,!1,lA),Jc(r,n)}}function sV(e,t){const r=this.cache,n=t.elements;if(void 0===n){if(bd(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),Jc(r,t)}else{if(bd(r,n))return;kA.set(n),e.uniformMatrix4fv(this.addr,!1,kA),Jc(r,n)}}function tV(e,t,r){const n=this.cache,o=r.allocateTextureUnit();n[0]!==o&&(e.uniform1i(this.addr,o),n[0]=o),r.safeSetTexture2D(t||gA,o)}function uV(e,t,r){const n=this.cache,o=r.allocateTextureUnit();n[0]!==o&&(e.uniform1i(this.addr,o),n[0]=o),r.setTexture2DArray(t||kV,o)}function vV(e,t,r){const n=this.cache,o=r.allocateTextureUnit();n[0]!==o&&(e.uniform1i(this.addr,o),n[0]=o),r.setTexture3D(t||lV,o)}function wV(e,t,r){const n=this.cache,o=r.allocateTextureUnit();n[0]!==o&&(e.uniform1i(this.addr,o),n[0]=o),r.safeSetTextureCube(t||hA,o)}function xV(e,t){const r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function yV(e,t){const r=this.cache;bd(r,t)||(e.uniform2iv(this.addr,t),Jc(r,t))}function zV(e,t){const r=this.cache;bd(r,t)||(e.uniform3iv(this.addr,t),Jc(r,t))}function AV(e,t){const r=this.cache;bd(r,t)||(e.uniform4iv(this.addr,t),Jc(r,t))}function BV(e,t){const r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function CV(e){switch(e){case 5126:return mV;case 35664:return nV;case 35665:return oV;case 35666:return pV;case 35674:return qV;case 35675:return rV;case 35676:return sV;case 5124:case 35670:return xV;case 35667:case 35671:return yV;case 35668:case 35672:return zV;case 35669:case 35673:return AV;case 5125:return BV;case 35678:case 36198:case 36298:case 36306:case 35682:return tV;case 35679:case 36299:case 36307:return vV;case 35680:case 36300:case 36308:case 36293:return wV;case 36289:case 36303:case 36311:case 36292:return uV;}}function DV(e,t){e.uniform1fv(this.addr,t)}function EV(e,t){e.uniform1iv(this.addr,t)}function FV(e,t){e.uniform2iv(this.addr,t)}function GV(e,t){e.uniform3iv(this.addr,t)}function HV(e,t){e.uniform4iv(this.addr,t)}function IV(e,t){const r=Si(t,this.size,2);e.uniform2fv(this.addr,r)}function JV(e,t){const r=Si(t,this.size,3);e.uniform3fv(this.addr,r)}function KV(e,t){const r=Si(t,this.size,4);e.uniform4fv(this.addr,r)}function LV(e,t){const r=Si(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function MV(e,t){const r=Si(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function NV(e,t){const r=Si(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function OV(e,t,r){const n=t.length,o=nA(r,n);e.uniform1iv(this.addr,o);for(let i=0;i!==n;++i)r.safeSetTexture2D(t[i]||gA,o[i])}function PV(e,t,r){const n=t.length,o=nA(r,n);e.uniform1iv(this.addr,o);for(let i=0;i!==n;++i)r.safeSetTextureCube(t[i]||hA,o[i])}function QV(e){switch(e){case 5126:return DV;case 35664:return IV;case 35665:return JV;case 35666:return KV;case 35674:return LV;case 35675:return MV;case 35676:return NV;case 5124:case 35670:return EV;case 35667:case 35671:return FV;case 35668:case 35672:return GV;case 35669:case 35673:return HV;case 35678:case 36198:case 36298:case 36306:case 35682:return OV;case 35680:case 36300:case 36308:case 36293:return PV;}}function RV(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=CV(t.type)}function oA(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=QV(t.type)}function pA(e){this.id=e,this.seq=[],this.map={}}oA.prototype.updateCache=function(e){let t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Jc(t,e)},pA.prototype.setValue=function(e,t,r){const n=this.seq;for(let o=0,i=n.length;o!==i;++o){const i=n[o];i.setValue(e,t[i.id],r)}};const Rs=/([\w\d_]+)(\])?(\[|\.)?/g;function qA(e,t){e.seq.push(t),e.map[t.id]=t}function SV(e,t,r){const n=e.name,o=n.length;for(Rs.lastIndex=0;;){const i=Rs.exec(n),a=Rs.lastIndex;let s=i[1],d="]"===i[2],$=i[3];if(d&&(s|=0),void 0===$||"["===$&&a+2===o){qA(r,void 0===$?new RV(s,e,t):new oA(s,e,t));break}{let e=r.map[s];void 0===e&&qA(r,e=new pA(s)),r=e}}}function $f(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,35718);for(let n=0;n<r;++n){const r=e.getActiveUniform(t,n);SV(r,e.getUniformLocation(t,r.name),this)}}function rA(e,t,r){const n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}$f.prototype.setValue=function(e,t,r,n){const o=this.map[t];void 0!==o&&o.setValue(e,r,n)},$f.prototype.setOptional=function(e,t,r){const n=t[r];void 0!==n&&this.setValue(e,r,n)},$f.upload=function(e,t,r,n){for(let o=0,i=t.length;o!==i;++o){const i=t[o],a=r[i.id];!1!==a.needsUpdate&&i.setValue(e,a.value,n)}},$f.seqWithValue=function(e,t){const r=[];for(let n=0,o=e.length;n!==o;++n){const o=e[n];o.id in t&&r.push(o)}return r};let TV=0;function UV(e){const t=e.split("\n");for(let r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")}function sA(e){switch(e){case uc:return["Linear","( value )"];case vc:return["sRGB","( value )"];case os:return["RGBE","( value )"];case Qz:return["RGBM","( value, 7.0 )"];case Rz:return["RGBM","( value, 16.0 )"];case Sz:return["RGBD","( value, 256.0 )"];case ns:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case kS:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"];}}function tA(e,t,r){const n=e.getShaderParameter(t,35713),o=e.getShaderInfoLog(t).trim();return n&&""===o?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+r+"\n"+o+UV(e.getShaderSource(t))}function jl(e,t){const r=sA(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function VV(e,t){const r=sA(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function WV(e,t){let r;switch(t){case lR:r="Linear";break;case mR:r="Reinhard";break;case nR:r="OptimizedCineon";break;case oR:r="ACESFilmic";break;case pR:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear";}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function XV(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(kl).join("\n")}function YV(e){const t=[];for(const r in e){const n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}function ZV(e,t){const r={},n=e.getProgramParameter(t,35721);for(let o=0;o<n;o++){const n=e.getActiveAttrib(t,o).name;r[n]=e.getAttribLocation(t,n)}return r}function kl(e){return""!==e}function uA(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function vA(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const $V=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ss(e){return e.replace($V,_V)}function _V(e,t){const r=Ea[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return Ss(r)}const aW=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,bW=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function wA(e){return e.replace(bW,xA).replace(aW,cW)}function cW(e,t,r,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),xA(e,t,r,n)}function xA(e,t,r,n){let o="";for(let i=parseInt(t);i<parseInt(r);i++)o+=n.replace(/\[ i \]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return o}function yA(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function dW(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===wz?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===xz?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Rk&&(t="SHADOWMAP_TYPE_VSM"),t}function eW(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Rn:case is:t="ENVMAP_TYPE_CUBE";break;case Tk:case ks:t="ENVMAP_TYPE_CUBE_UV";break;case Dz:case js:t="ENVMAP_TYPE_EQUIREC";}return t}function fW(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case is:case js:t="ENVMAP_MODE_REFRACTION";}return t}function gW(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case Qn:t="ENVMAP_BLENDING_MULTIPLY";break;case jR:t="ENVMAP_BLENDING_MIX";break;case kR:t="ENVMAP_BLENDING_ADD";}return t}function hW(e,t,r,n){const o=e.getContext(),i=r.defines;let a=r.vertexShader,s=r.fragmentShader;const d=dW(r),$=eW(r),c=fW(r),p=gW(r),l=e.gammaFactor>0?e.gammaFactor:1,u=r.isWebGL2?"":XV(r),h=YV(i),f=o.createProgram();let m,x;if(r.isRawShaderMaterial?((m=[h].filter(kl).join("\n")).length>0&&(m+="\n"),(x=[u,h].filter(kl).join("\n")).length>0&&(x+="\n")):(m=[yA(r),"#define SHADER_NAME "+r.shaderName,h,r.instancing?"#define USE_INSTANCING":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+l,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+d:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(kl).join("\n"),x=[u,yA(r),"#define SHADER_NAME "+r.shaderName,h,r.alphaTest?"#define ALPHATEST "+r.alphaTest+(r.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+l,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+$:"",r.envMap?"#define "+c:"",r.envMap?"#define "+p:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.sheen?"#define USE_SHEEN":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+d:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==ti?"#define TONE_MAPPING":"",r.toneMapping!==ti?Ea.tonemapping_pars_fragment:"",r.toneMapping!==ti?WV("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",Ea.encodings_pars_fragment,r.map?jl("mapTexelToLinear",r.mapEncoding):"",r.matcap?jl("matcapTexelToLinear",r.matcapEncoding):"",r.envMap?jl("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMap?jl("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.lightMap?jl("lightMapTexelToLinear",r.lightMapEncoding):"",VV("linearToOutputTexel",r.outputEncoding),r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(kl).join("\n")),a=vA(a=uA(a=Ss(a),r),r),s=vA(s=uA(s=Ss(s),r),r),a=wA(a),s=wA(s),r.isWebGL2&&!r.isRawShaderMaterial){let e=!1;const t=/^\s*#version\s+300\s+es\s*\n/;r.isShaderMaterial&&null!==a.match(t)&&null!==s.match(t)&&(e=!0,a=a.replace(t,""),s=s.replace(t,"")),m=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,x=["#version 300 es\n","#define varying in",e?"":"out highp vec4 pc_fragColor;",e?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+x}const R=x+s,g=rA(o,35633,m+a),v=rA(o,35632,R);if(o.attachShader(f,g),o.attachShader(f,v),void 0!==r.index0AttributeName?o.bindAttribLocation(f,0,r.index0AttributeName):!0===r.morphTargets&&o.bindAttribLocation(f,0,"position"),o.linkProgram(f),e.debug.checkShaderErrors){const e=o.getProgramInfoLog(f).trim(),t=o.getShaderInfoLog(g).trim(),r=o.getShaderInfoLog(v).trim();let n=!0,i=!0;if(!1===o.getProgramParameter(f,35714)){n=!1;const t=tA(o,g,"vertex"),r=tA(o,v,"fragment");console.error("THREE.WebGLProgram: shader error: ",o.getError(),"35715",o.getProgramParameter(f,35715),"gl.getProgramInfoLog",e,t,r)}else""!==e?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",e):""!==t&&""!==r||(i=!1);i&&(this.diagnostics={runnable:n,programLog:e,vertexShader:{log:t,prefix:m},fragmentShader:{log:r,prefix:x}})}let q,K;return o.deleteShader(g),o.deleteShader(v),this.getUniforms=function(){return void 0===q&&(q=new $f(o,f)),q},this.getAttributes=function(){return void 0===K&&(K=ZV(o,f)),K},this.destroy=function(){n.releaseStatesOfProgram(this),o.deleteProgram(f),this.program=void 0},this.name=r.shaderName,this.id=TV++,this.cacheKey=t,this.usedTimes=1,this.program=f,this.vertexShader=g,this.fragmentShader=v,this}function iW(e,t,r,n){const o=[],i=r.isWebGL2,a=r.logarithmicDepthBuffer,s=r.floatVertexTextures,d=r.maxVertexUniforms,$=r.vertexTextures;let c=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},l=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function u(e){let t;return e?e.isTexture?t=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=uc,t}return{getParameters:function(n,o,l,h,f,m,x){const R=h.fog,g=n.isMeshStandardMaterial?h.environment:null,v=n.envMap||g,q=p[n.type],K=x.isSkinnedMesh?function(e){const t=e.skeleton.bones;if(s)return 1024;{const e=d,r=Math.floor((e-20)/4),n=Math.min(r,t.length);return n<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+n+"."),0):n}}(x):0;null!==n.precision&&(c=r.getMaxPrecision(n.precision))!==n.precision&&console.warn("THREE.WebGLProgram.getParameters:",n.precision,"not supported, using",c,"instead.");const y=function(e,t){let r;if(t){const n=Xe[t];r={name:e.name||e.type,uniforms:CS.clone(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader}}else r={name:e.name||e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};return r}(n,q);n.onBeforeCompile(y,e);const _=e.getRenderTarget();return{isWebGL2:i,shaderID:q,shaderName:y.name,uniforms:y.uniforms,vertexShader:y.vertexShader,fragmentShader:y.fragmentShader,defines:n.defines,isRawShaderMaterial:n.isRawShaderMaterial,isShaderMaterial:n.isShaderMaterial,precision:c,instancing:!0===x.isInstancedMesh,supportsVertexTextures:$,outputEncoding:null!==_?u(_.texture):e.outputEncoding,map:!!n.map,mapEncoding:u(n.map),matcap:!!n.matcap,matcapEncoding:u(n.matcap),envMap:!!v,envMapMode:v&&v.mapping,envMapEncoding:u(v),envMapCubeUV:!!v&&(v.mapping===Tk||v.mapping===ks),lightMap:!!n.lightMap,lightMapEncoding:u(n.lightMap),aoMap:!!n.aoMap,emissiveMap:!!n.emissiveMap,emissiveMapEncoding:u(n.emissiveMap),bumpMap:!!n.bumpMap,normalMap:!!n.normalMap,objectSpaceNormalMap:n.normalMapType===nS,tangentSpaceNormalMap:n.normalMapType===Zg,clearcoatMap:!!n.clearcoatMap,clearcoatRoughnessMap:!!n.clearcoatRoughnessMap,clearcoatNormalMap:!!n.clearcoatNormalMap,displacementMap:!!n.displacementMap,roughnessMap:!!n.roughnessMap,metalnessMap:!!n.metalnessMap,specularMap:!!n.specularMap,alphaMap:!!n.alphaMap,gradientMap:!!n.gradientMap,sheen:!!n.sheen,combine:n.combine,vertexTangents:n.normalMap&&n.vertexTangents,vertexColors:n.vertexColors,vertexUvs:!!(n.map||n.bumpMap||n.normalMap||n.specularMap||n.alphaMap||n.emissiveMap||n.roughnessMap||n.metalnessMap||n.clearcoatMap||n.clearcoatRoughnessMap||n.clearcoatNormalMap||n.displacementMap),uvsVertexOnly:!(n.map||n.bumpMap||n.normalMap||n.specularMap||n.alphaMap||n.emissiveMap||n.roughnessMap||n.metalnessMap||n.clearcoatNormalMap||!n.displacementMap),fog:!!R,useFog:n.fog,fogExp2:R&&R.isFogExp2,flatShading:n.flatShading,sizeAttenuation:n.sizeAttenuation,logarithmicDepthBuffer:a,skinning:n.skinning&&K>0,maxBones:K,useVertexTexture:s,morphTargets:n.morphTargets,morphNormals:n.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numClippingPlanes:f,numClipIntersection:m,dithering:n.dithering,shadowMapEnabled:e.shadowMap.enabled&&l.length>0,shadowMapType:e.shadowMap.type,toneMapping:n.toneMapped?e.toneMapping:ti,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:n.premultipliedAlpha,alphaTest:n.alphaTest,doubleSided:n.side===Pb,flipSided:n.side===Ob,depthPacking:void 0!==n.depthPacking&&n.depthPacking,index0AttributeName:n.index0AttributeName,extensionDerivatives:n.extensions&&n.extensions.derivatives,extensionFragDepth:n.extensions&&n.extensions.fragDepth,extensionDrawBuffers:n.extensions&&n.extensions.drawBuffers,extensionShaderTextureLOD:n.extensions&&n.extensions.shaderTextureLOD,rendererExtensionFragDepth:i||null!==t.get("EXT_frag_depth"),rendererExtensionDrawBuffers:i||null!==t.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:i||null!==t.get("EXT_shader_texture_lod"),customProgramCacheKey:n.customProgramCacheKey()}},getProgramCacheKey:function(t){const r=[];if(t.shaderID?r.push(t.shaderID):(r.push(t.fragmentShader),r.push(t.vertexShader)),void 0!==t.defines)for(const e in t.defines)r.push(e),r.push(t.defines[e]);if(void 0===t.isRawShaderMaterial){for(let e=0;e<l.length;e++)r.push(t[l[e]]);r.push(e.outputEncoding),r.push(e.gammaFactor)}return r.push(t.customProgramCacheKey),r.join()},acquireProgram:function(t,r){let i;for(let e=0,n=o.length;e<n;e++){const t=o[e];if(t.cacheKey===r){++(i=t).usedTimes;break}}return void 0===i&&(i=new hW(e,r,t,n),o.push(i)),i},releaseProgram:function(e){if(0==--e.usedTimes){const t=o.indexOf(e);o[t]=o[o.length-1],o.pop(),e.destroy()}},programs:o}}function jW(){let e=new WeakMap;return{get:function(t){let r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,n){e.get(t)[r]=n},dispose:function(){e=new WeakMap}}}function kW(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function lW(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function zA(){const e=[];let t=0;const r=[],n=[],o={id:-1};function i(r,n,i,a,s,d){let $=e[t];return void 0===$?($={id:r.id,object:r,geometry:n,material:i,program:i.program||o,groupOrder:a,renderOrder:r.renderOrder,z:s,group:d},e[t]=$):($.id=r.id,$.object=r,$.geometry=n,$.material=i,$.program=i.program||o,$.groupOrder=a,$.renderOrder=r.renderOrder,$.z=s,$.group=d),t++,$}return{opaque:r,transparent:n,init:function(){t=0,r.length=0,n.length=0},push:function(e,t,o,a,s,d){const $=i(e,t,o,a,s,d);(!0===o.transparent?n:r).push($)},unshift:function(e,t,o,a,s,d){const $=i(e,t,o,a,s,d);(!0===o.transparent?n:r).unshift($)},finish:function(){for(let r=t,n=e.length;r<n;r++){const t=e[r];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.program=null,t.group=null}},sort:function(e,t){r.length>1&&r.sort(e||kW),n.length>1&&n.sort(t||lW)}}}function mW(){let e=new WeakMap;function t(r){const n=r.target;n.removeEventListener("dispose",t),e.delete(n)}return{get:function(r,n){const o=e.get(r);let i;return void 0===o?(i=new zA,e.set(r,new WeakMap),e.get(r).set(n,i),r.addEventListener("dispose",t)):void 0===(i=o.get(n))&&(i=new zA,o.set(n,i)),i},dispose:function(){e=new WeakMap}}}function nW(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new ba,color:new ga};break;case"SpotLight":r={position:new ba,direction:new ba,color:new ga,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new ba,color:new ga,distance:0,decay:0};break;case"HemisphereLight":r={direction:new ba,skyColor:new ga,groundColor:new ga};break;case"RectAreaLight":r={color:new ga,position:new ba,halfWidth:new ba,halfHeight:new ba};}return e[t.id]=r,r}}}function oW(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ca};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ca,shadowCameraNear:1,shadowCameraFar:1e3};}return e[t.id]=r,r}}}let pW=0;function qW(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function rW(){const e=new nW,t=oW(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let a=0;a<9;a++)r.probe.push(new ba);const n=new ba,o=new fa,i=new fa;return{setup:function(a,s,d){let $=0,c=0,p=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let l=0,u=0,h=0,f=0,m=0,x=0,R=0,g=0;const v=d.matrixWorldInverse;a.sort(qW);for(let K=0,y=a.length;K<y;K++){const s=a[K],d=s.color,q=s.intensity,y=s.distance,_=s.shadow&&s.shadow.map?s.shadow.map.texture:null;if(s.isAmbientLight)$+=d.r*q,c+=d.g*q,p+=d.b*q;else if(s.isLightProbe)for(let e=0;e<9;e++)r.probe[e].addScaledVector(s.sh.coefficients[e],q);else if(s.isDirectionalLight){const o=e.get(s);if(o.color.copy(s.color).multiplyScalar(s.intensity),o.direction.setFromMatrixPosition(s.matrixWorld),n.setFromMatrixPosition(s.target.matrixWorld),o.direction.sub(n),o.direction.transformDirection(v),s.castShadow){const e=s.shadow,n=t.get(s);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,r.directionalShadow[l]=n,r.directionalShadowMap[l]=_,r.directionalShadowMatrix[l]=s.shadow.matrix,x++}r.directional[l]=o,l++}else if(s.isSpotLight){const o=e.get(s);if(o.position.setFromMatrixPosition(s.matrixWorld),o.position.applyMatrix4(v),o.color.copy(d).multiplyScalar(q),o.distance=y,o.direction.setFromMatrixPosition(s.matrixWorld),n.setFromMatrixPosition(s.target.matrixWorld),o.direction.sub(n),o.direction.transformDirection(v),o.coneCos=Math.cos(s.angle),o.penumbraCos=Math.cos(s.angle*(1-s.penumbra)),o.decay=s.decay,s.castShadow){const e=s.shadow,n=t.get(s);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,r.spotShadow[h]=n,r.spotShadowMap[h]=_,r.spotShadowMatrix[h]=s.shadow.matrix,g++}r.spot[h]=o,h++}else if(s.isRectAreaLight){const t=e.get(s);t.color.copy(d).multiplyScalar(q),t.position.setFromMatrixPosition(s.matrixWorld),t.position.applyMatrix4(v),i.identity(),o.copy(s.matrixWorld),o.premultiply(v),i.extractRotation(o),t.halfWidth.set(.5*s.width,0,0),t.halfHeight.set(0,.5*s.height,0),t.halfWidth.applyMatrix4(i),t.halfHeight.applyMatrix4(i),r.rectArea[f]=t,f++}else if(s.isPointLight){const n=e.get(s);if(n.position.setFromMatrixPosition(s.matrixWorld),n.position.applyMatrix4(v),n.color.copy(s.color).multiplyScalar(s.intensity),n.distance=s.distance,n.decay=s.decay,s.castShadow){const e=s.shadow,n=t.get(s);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,n.shadowCameraNear=e.camera.near,n.shadowCameraFar=e.camera.far,r.pointShadow[u]=n,r.pointShadowMap[u]=_,r.pointShadowMatrix[u]=s.shadow.matrix,R++}r.point[u]=n,u++}else if(s.isHemisphereLight){const t=e.get(s);t.direction.setFromMatrixPosition(s.matrixWorld),t.direction.transformDirection(v),t.direction.normalize(),t.skyColor.copy(s.color).multiplyScalar(q),t.groundColor.copy(s.groundColor).multiplyScalar(q),r.hemi[m]=t,m++}}r.ambient[0]=$,r.ambient[1]=c,r.ambient[2]=p;const q=r.hash;q.directionalLength===l&&q.pointLength===u&&q.spotLength===h&&q.rectAreaLength===f&&q.hemiLength===m&&q.numDirectionalShadows===x&&q.numPointShadows===R&&q.numSpotShadows===g||(r.directional.length=l,r.spot.length=h,r.rectArea.length=f,r.point.length=u,r.hemi.length=m,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=R,r.pointShadowMap.length=R,r.spotShadow.length=g,r.spotShadowMap.length=g,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=R,r.spotShadowMatrix.length=g,q.directionalLength=l,q.pointLength=u,q.spotLength=h,q.rectAreaLength=f,q.hemiLength=m,q.numDirectionalShadows=x,q.numPointShadows=R,q.numSpotShadows=g,r.version=pW++)},state:r}}function AA(){const e=new rW,t=[],r=[];return{init:function(){t.length=0,r.length=0},state:{lightsArray:t,shadowsArray:r,lights:e},setupLights:function(n){e.setup(t,r,n)},pushLight:function(e){t.push(e)},pushShadow:function(e){r.push(e)}}}function sW(){let e=new WeakMap;function t(r){const n=r.target;n.removeEventListener("dispose",t),e.delete(n)}return{get:function(r,n){let o;return!1===e.has(r)?(o=new AA,e.set(r,new WeakMap),e.get(r).set(n,o),r.addEventListener("dispose",t)):!1===e.get(r).has(n)?(o=new AA,e.get(r).set(n,o)):o=e.get(r).get(n),o},dispose:function(){e=new WeakMap}}}function ch(e){ua.call(this),this.type="MeshDepthMaterial",this.depthPacking=lS,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function dh(e){ua.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new ba,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}ch.prototype=Object.create(ua.prototype),ch.prototype.constructor=ch,ch.prototype.isMeshDepthMaterial=!0,ch.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},dh.prototype=Object.create(ua.prototype),dh.prototype.constructor=dh,dh.prototype.isMeshDistanceMaterial=!0,dh.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};var tW="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",uW="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function BA(e,t,r){let n=new gl;const o=new ca,i=new ca,a=new Ta,s=[],d=[],$={},c={0:Ob,1:Pe,2:Pb},p=new gc({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new ca},radius:{value:4}},vertexShader:uW,fragmentShader:tW}),l=p.clone();l.defines.HORIZONAL_PASS=1;const u=new ia;u.setAttribute("position",new pa(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const h=new Aa(u,p),f=this;function m(r,n){const o=t.update(h);p.uniforms.shadow_pass.value=r.map.texture,p.uniforms.resolution.value=r.mapSize,p.uniforms.radius.value=r.radius,e.setRenderTarget(r.mapPass),e.clear(),e.renderBufferDirect(n,null,o,p,h,null),l.uniforms.shadow_pass.value=r.mapPass.texture,l.uniforms.resolution.value=r.mapSize,l.uniforms.radius.value=r.radius,e.setRenderTarget(r.map),e.clear(),e.renderBufferDirect(n,null,o,l,h,null)}function x(e,t,r){const n=e<<0|t<<1|r<<2;let o=s[n];return void 0===o&&(o=new ch({depthPacking:mS,morphTargets:e,skinning:t}),s[n]=o),o}function R(e,t,r){const n=e<<0|t<<1|r<<2;let o=d[n];return void 0===o&&(o=new dh({morphTargets:e,skinning:t}),d[n]=o),o}function g(t,r,n,o,i,a,s){let d=null,p=x,l=t.customDepthMaterial;if(!0===o.isPointLight&&(p=R,l=t.customDistanceMaterial),void 0===l){let e=!1;!0===n.morphTargets&&(e=r.morphAttributes&&r.morphAttributes.position&&r.morphAttributes.position.length>0);let o=!1;!0===t.isSkinnedMesh&&(!0===n.skinning?o=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),d=p(e,o,!0===t.isInstancedMesh)}else d=l;if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){const e=d.uuid,t=n.uuid;let r=$[e];void 0===r&&(r={},$[e]=r);let o=r[t];void 0===o&&(o=d.clone(),r[t]=o),d=o}return d.visible=n.visible,d.wireframe=n.wireframe,d.side=s===Rk?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:c[n.side],d.clipShadows=n.clipShadows,d.clippingPlanes=n.clippingPlanes,d.clipIntersection=n.clipIntersection,d.wireframeLinewidth=n.wireframeLinewidth,d.linewidth=n.linewidth,!0===o.isPointLight&&!0===d.isMeshDistanceMaterial&&(d.referencePosition.setFromMatrixPosition(o.matrixWorld),d.nearDistance=i,d.farDistance=a),d}function v(r,o,i,a,s){if(!1===r.visible)return;if(r.layers.test(o.layers)&&(r.isMesh||r.isLine||r.isPoints)&&(r.castShadow||r.receiveShadow&&s===Rk)&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,r.matrixWorld);const n=t.update(r),o=r.material;if(Array.isArray(o)){const t=n.groups;for(let d=0,$=t.length;d<$;d++){const $=t[d],c=o[$.materialIndex];if(c&&c.visible){const t=g(r,n,c,a,i.near,i.far,s);e.renderBufferDirect(i,null,n,t,r,$)}}}else if(o.visible){const t=g(r,n,o,a,i.near,i.far,s);e.renderBufferDirect(i,null,n,t,r,null)}}const d=r.children;for(let e=0,t=d.length;e<t;e++)v(d[e],o,i,a,s)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=wz,this.render=function(t,s,d){if(!1===f.enabled)return;if(!1===f.autoUpdate&&!1===f.needsUpdate)return;if(0===t.length)return;const $=e.getRenderTarget(),c=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),l=e.state;l.setBlending(Nf),l.buffers.color.setClear(1,1,1,1),l.buffers.depth.setTest(!0),l.setScissorTest(!1);for(let u=0,h=t.length;u<h;u++){const $=t[u],c=$.shadow;if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;if(void 0===c){console.warn("THREE.WebGLShadowMap:",$,"has no shadow.");continue}o.copy(c.mapSize);const p=c.getFrameExtents();if(o.multiply(p),i.copy(c.mapSize),(o.x>r||o.y>r)&&(o.x>r&&(i.x=Math.floor(r/p.x),o.x=i.x*p.x,c.mapSize.x=i.x),o.y>r&&(i.y=Math.floor(r/p.y),o.y=i.y*p.y,c.mapSize.y=i.y)),null===c.map&&!c.isPointLightShadow&&this.type===Rk){const e={minFilter:Qb,magFilter:Qb,format:Gc};c.map=new ad(o.x,o.y,e),c.map.texture.name=$.name+".shadowMap",c.mapPass=new ad(o.x,o.y,e),c.camera.updateProjectionMatrix()}if(null===c.map){const e={minFilter:Gb,magFilter:Gb,format:Gc};c.map=new ad(o.x,o.y,e),c.map.texture.name=$.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const h=c.getViewportCount();for(let e=0;e<h;e++){const t=c.getViewport(e);a.set(i.x*t.x,i.y*t.y,i.x*t.z,i.y*t.w),l.viewport(a),c.updateMatrices($,e),n=c.getFrustum(),v(s,d,c.camera,$,this.type)}c.isPointLightShadow||this.type!==Rk||m(c,d),c.needsUpdate=!1}f.needsUpdate=!1,e.setRenderTarget($,c,p)}}function vW(e,t,r){const n=r.isWebGL2;const o=new function(){let t=!1;const r=new Ta;let n=null;const o=new Ta(0,0,0,0);return{setMask:function(r){n===r||t||(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,i,a,s){!0===s&&(t*=a,n*=a,i*=a),r.set(t,n,i,a),!1===o.equals(r)&&(e.clearColor(t,n,i,a),o.copy(r))},reset:function(){t=!1,n=null,o.set(-1,0,0,0)}}},i=new function(){let t=!1,r=null,n=null,o=null;return{setTest:function(e){e?C(2929):B(2929)},setMask:function(n){r===n||t||(e.depthMask(n),r=n)},setFunc:function(t){if(n!==t){if(t)switch(t){case cR:e.depthFunc(512);break;case dR:e.depthFunc(519);break;case eR:e.depthFunc(513);break;case hs:e.depthFunc(515);break;case fR:e.depthFunc(514);break;case gR:e.depthFunc(518);break;case hR:e.depthFunc(516);break;case iR:e.depthFunc(517);break;default:e.depthFunc(515);}else e.depthFunc(515);n=t}},setLocked:function(e){t=e},setClear:function(t){o!==t&&(e.clearDepth(t),o=t)},reset:function(){t=!1,r=null,n=null,o=null}}},a=new function(){let t=!1,r=null,n=null,o=null,i=null,a=null,s=null,d=null,$=null;return{setTest:function(e){t||(e?C(2960):B(2960))},setMask:function(n){r===n||t||(e.stencilMask(n),r=n)},setFunc:function(t,r,a){n===t&&o===r&&i===a||(e.stencilFunc(t,r,a),n=t,o=r,i=a)},setOp:function(t,r,n){a===t&&s===r&&d===n||(e.stencilOp(t,r,n),a=t,s=r,d=n)},setLocked:function(e){t=e},setClear:function(t){$!==t&&(e.clearStencil(t),$=t)},reset:function(){t=!1,r=null,n=null,o=null,i=null,a=null,s=null,d=null,$=null}}};let s={},d=null,$=null,c=null,p=null,l=null,u=null,h=null,f=null,m=null,x=!1,R=null,g=null,v=null,q=null,K=null;const y=e.getParameter(35661);let _=!1,b=0;const M=e.getParameter(7938);-1!==M.indexOf("WebGL")?(b=parseFloat(/^WebGL\ ([0-9])/.exec(M)[1]),_=b>=1):-1!==M.indexOf("OpenGL ES")&&(b=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(M)[1]),_=b>=2);let w=null,S={};const T=new Ta,A=new Ta;function E(t,r,n){const o=new Uint8Array(4),i=e.createTexture();e.bindTexture(t,i),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let a=0;a<n;a++)e.texImage2D(r+a,0,6408,1,1,0,6408,5121,o);return i}const L={};function C(t){!0!==s[t]&&(e.enable(t),s[t]=!0)}function B(t){!1!==s[t]&&(e.disable(t),s[t]=!1)}L[3553]=E(3553,3553,1),L[34067]=E(34067,34069,6),o.setClear(0,0,0,1),i.setClear(1),a.setClear(0),C(2929),i.setFunc(hs),I(!1),O(vz),C(2884),D(Nf);const P={[si]:32774,[TQ]:32778,[UQ]:32779};if(n){}else{const e=t.get("EXT_blend_minmax");null!==e&&e.MAX_EXT}const G={[VQ]:0,[WQ]:1,[XQ]:768,[Bz]:770,[bR]:776,[_Q]:774,[ZQ]:772,[YQ]:769,[Cz]:771,[aR]:775,[$Q]:773};function D(t,r,n,o,i,a,s,d){if(t!==Nf){if($||(C(3042),$=!0),t===SQ)i=i||r,a=a||n,s=s||o,r===p&&i===h||(e.blendEquationSeparate(P[r],P[i]),p=r,h=i),n===l&&o===u&&a===f&&s===m||(e.blendFuncSeparate(G[n],G[o],G[a],G[s]),l=n,u=o,f=a,m=s),c=t,x=null;else if(t!==c||d!==x){if(p===si&&h===si||(e.blendEquation(32774),p=si,h=si),d)switch(t){case Sk:e.blendFuncSeparate(1,771,1,771);break;case yz:e.blendFunc(1,1);break;case zz:e.blendFuncSeparate(0,0,769,771);break;case Az:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t);}else switch(t){case Sk:e.blendFuncSeparate(770,771,1,771);break;case yz:e.blendFunc(770,1);break;case zz:e.blendFunc(0,769);break;case Az:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t);}l=null,u=null,f=null,m=null,c=t,x=d}}else $&&(B(3042),$=!1)}function I(t){R!==t&&(t?e.frontFace(2304):e.frontFace(2305),R=t)}function O(t){t!==QQ?(C(2884),t!==g&&(t===vz?e.cullFace(1029):t===RQ?e.cullFace(1028):e.cullFace(1032))):B(2884),g=t}function F(t,r,n){t?(C(32823),q===r&&K===n||(e.polygonOffset(r,n),q=r,K=n)):B(32823)}function N(t){void 0===t&&(t=33984+y-1),w!==t&&(e.activeTexture(t),w=t)}return{buffers:{color:o,depth:i,stencil:a},enable:C,disable:B,useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:D,setMaterial:function(e,t){e.side===Pb?B(2884):C(2884);let r=e.side===Ob;t&&(r=!r),I(r),e.blending===Sk&&!1===e.transparent?D(Nf):D(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),i.setFunc(e.depthFunc),i.setTest(e.depthTest),i.setMask(e.depthWrite),o.setMask(e.colorWrite);const n=e.stencilWrite;a.setTest(n),n&&(a.setMask(e.stencilWriteMask),a.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),a.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),F(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:I,setCullFace:O,setLineWidth:function(t){t!==v&&(_&&e.lineWidth(t),v=t)},setPolygonOffset:F,setScissorTest:function(e){e?C(3089):B(3089)},activeTexture:N,bindTexture:function(t,r){null===w&&N();let n=S[w];void 0===n&&(n={type:void 0,texture:void 0},S[w]=n),n.type===t&&n.texture===r||(e.bindTexture(t,r||L[t]),n.type=t,n.texture=r)},unbindTexture:function(){const t=S[w];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===T.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),T.copy(t))},viewport:function(t){!1===A.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),A.copy(t))},reset:function(){s={},w=null,S={},d=null,c=null,R=null,g=null,o.reset(),i.reset(),a.reset()}}}function wW(e,t,r,n,o,i,a){const s=o.isWebGL2,d=o.maxTextures,$=o.maxCubemapSize,c=o.maxTextureSize,p=o.maxSamples,l=new WeakMap;let u,h=!1;try{h="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(O){}function f(e,t){return h?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function m(e,t,r,n){let o=1;if((e.width>n||e.height>n)&&(o=n/Math.max(e.width,e.height)),o<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const n=t?ta.floorPowerOfTwo:Math.floor,i=n(o*e.width),a=n(o*e.height);void 0===u&&(u=f(i,a));const s=r?f(i,a):u;return s.width=i,s.height=a,s.getContext("2d").drawImage(e,0,0,i,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+i+"x"+a+")."),s}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function x(e){return ta.isPowerOfTwo(e.width)&&ta.isPowerOfTwo(e.height)}function R(e,t){return e.generateMipmaps&&t&&e.minFilter!==Gb&&e.minFilter!==Qb}function g(t,r,o,i){e.generateMipmap(t),n.get(r).__maxMipLevel=Math.log(Math.max(o,i))*Math.LOG2E}function v(r,n,o){if(!1===s)return n;if(null!==r){if(void 0!==e[r])return e[r];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+r+"'")}let i=n;return 6403===n&&(5126===o&&(i=33326),5131===o&&(i=33325),5121===o&&(i=33321)),6407===n&&(5126===o&&(i=34837),5131===o&&(i=34843),5121===o&&(i=32849)),6408===n&&(5126===o&&(i=34836),5131===o&&(i=34842),5121===o&&(i=32856)),33325!==i&&33326!==i&&34842!==i&&34836!==i||t.get("EXT_color_buffer_float"),i}function q(e){return e===Gb||e===Uk||e===Vk?9728:9729}function K(t){const r=t.target;r.removeEventListener("dispose",K),function(t){const r=n.get(t);if(void 0===r.__webglInit)return;e.deleteTexture(r.__webglTexture),n.remove(t)}(r),r.isVideoTexture&&l.delete(r),a.memory.textures--}function y(t){const r=t.target;r.removeEventListener("dispose",y),function(t){const r=n.get(t),o=n.get(t.texture);if(!t)return;void 0!==o.__webglTexture&&e.deleteTexture(o.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let n=0;n<6;n++)e.deleteFramebuffer(r.__webglFramebuffer[n]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[n]);else e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&e.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer&&e.deleteRenderbuffer(r.__webglColorRenderbuffer),r.__webglDepthRenderbuffer&&e.deleteRenderbuffer(r.__webglDepthRenderbuffer);n.remove(t.texture),n.remove(t)}(r),a.memory.textures--}let _=0;function b(e,t){const o=n.get(e);if(e.isVideoTexture&&function(e){const t=a.render.frame;l.get(e)!==t&&(l.set(e,t),e.update())}(e),e.version>0&&o.__version!==e.version){const r=e.image;if(void 0===r)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==r.complete)return void L(o,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}r.activeTexture(33984+t),r.bindTexture(3553,o.__webglTexture)}function M(t,o){if(6!==t.image.length)return;const a=n.get(t);if(t.version>0&&a.__version!==t.version){E(a,t),r.activeTexture(33984+o),r.bindTexture(34067,a.__webglTexture),e.pixelStorei(37440,t.flipY);const n=t&&(t.isCompressedTexture||t.image[0].isCompressedTexture),d=t.image[0]&&t.image[0].isDataTexture,c=[];for(let e=0;e<6;e++)c[e]=n||d?d?t.image[e].image:t.image[e]:m(t.image[e],!1,!0,$);const p=c[0],l=x(p)||s,u=i.convert(t.format),h=i.convert(t.type),f=v(t.internalFormat,u,h);let q;if(A(34067,t,l),n){for(let e=0;e<6;e++){q=c[e].mipmaps;for(let n=0;n<q.length;n++){const o=q[n];t.format!==Gc&&t.format!==Sd?null!==u?r.compressedTexImage2D(34069+e,n,f,o.width,o.height,0,o.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(34069+e,n,f,o.width,o.height,0,u,h,o.data)}}a.__maxMipLevel=q.length-1}else{q=t.mipmaps;for(let e=0;e<6;e++)if(d){r.texImage2D(34069+e,0,f,c[e].width,c[e].height,0,u,h,c[e].data);for(let t=0;t<q.length;t++){const n=q[t].image[e].image;r.texImage2D(34069+e,t+1,f,n.width,n.height,0,u,h,n.data)}}else{r.texImage2D(34069+e,0,f,u,h,c[e]);for(let t=0;t<q.length;t++){const n=q[t];r.texImage2D(34069+e,t+1,f,u,h,n.image[e])}}a.__maxMipLevel=q.length}R(t,l)&&g(34067,t,p.width,p.height),a.__version=t.version,t.onUpdate&&t.onUpdate(t)}else r.activeTexture(33984+o),r.bindTexture(34067,a.__webglTexture)}function w(e,t){r.activeTexture(33984+t),r.bindTexture(34067,n.get(e).__webglTexture)}const S={[tc]:10497,[ec]:33071,[ui]:33648},T={[Gb]:9728,[Uk]:9984,[Vk]:9986,[Qb]:9729,[Sn]:9985,[Of]:9987};function A(r,i,a){a?(e.texParameteri(r,10242,S[i.wrapS]),e.texParameteri(r,10243,S[i.wrapT]),32879!==r&&35866!==r||e.texParameteri(r,32882,S[i.wrapR]),e.texParameteri(r,10240,T[i.magFilter]),e.texParameteri(r,10241,T[i.minFilter])):(e.texParameteri(r,10242,33071),e.texParameteri(r,10243,33071),32879!==r&&35866!==r||e.texParameteri(r,32882,33071),i.wrapS===ec&&i.wrapT===ec||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(r,10240,q(i.magFilter)),e.texParameteri(r,10241,q(i.minFilter)),i.minFilter!==Gb&&i.minFilter!==Qb&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const d=t.get("EXT_texture_filter_anisotropic");if(d){if(i.type===Pf&&null===t.get("OES_texture_float_linear"))return;if(i.type===Vn&&null===(s||t.get("OES_texture_half_float_linear")))return;(i.anisotropy>1||n.get(i).__currentAnisotropy)&&(e.texParameterf(r,d.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i.anisotropy,o.getMaxAnisotropy())),n.get(i).__currentAnisotropy=i.anisotropy)}}function E(t,r){void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",K),t.__webglTexture=e.createTexture(),a.memory.textures++)}function L(t,n,o){let a=3553;n.isDataTexture2DArray&&(a=35866),n.isDataTexture3D&&(a=32879),E(t,n),r.activeTexture(33984+o),r.bindTexture(a,t.__webglTexture),e.pixelStorei(37440,n.flipY),e.pixelStorei(37441,n.premultiplyAlpha),e.pixelStorei(3317,n.unpackAlignment);const d=function(e){return!s&&(e.wrapS!==ec||e.wrapT!==ec||e.minFilter!==Gb&&e.minFilter!==Qb)}(n)&&!1===x(n.image),$=m(n.image,d,!1,c),p=x($)||s,l=i.convert(n.format);let u,h=i.convert(n.type),f=v(n.internalFormat,l,h);A(a,n,p);const q=n.mipmaps;if(n.isDepthTexture)f=6402,s?f=n.type===Pf?36012:n.type===Un?33190:n.type===Xk?35056:33189:n.type===Pf&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),n.format===vi&&6402===f&&n.type!==Tn&&n.type!==Un&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=Tn,h=i.convert(n.type)),n.format===Yk&&6402===f&&(f=34041,n.type!==Xk&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=Xk,h=i.convert(n.type))),r.texImage2D(3553,0,f,$.width,$.height,0,l,h,null);else if(n.isDataTexture){if(q.length>0&&p){for(let e=0,t=q.length;e<t;e++)u=q[e],r.texImage2D(3553,e,f,u.width,u.height,0,l,h,u.data);n.generateMipmaps=!1,t.__maxMipLevel=q.length-1}else r.texImage2D(3553,0,f,$.width,$.height,0,l,h,$.data),t.__maxMipLevel=0;}else if(n.isCompressedTexture){for(let e=0,t=q.length;e<t;e++)u=q[e],n.format!==Gc&&n.format!==Sd?null!==l?r.compressedTexImage2D(3553,e,f,u.width,u.height,0,u.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(3553,e,f,u.width,u.height,0,l,h,u.data);t.__maxMipLevel=q.length-1}else if(n.isDataTexture2DArray)r.texImage3D(35866,0,f,$.width,$.height,$.depth,0,l,h,$.data),t.__maxMipLevel=0;else if(n.isDataTexture3D)r.texImage3D(32879,0,f,$.width,$.height,$.depth,0,l,h,$.data),t.__maxMipLevel=0;else if(q.length>0&&p){for(let e=0,t=q.length;e<t;e++)u=q[e],r.texImage2D(3553,e,f,l,h,u);n.generateMipmaps=!1,t.__maxMipLevel=q.length-1}else r.texImage2D(3553,0,f,l,h,$),t.__maxMipLevel=0;R(n,p)&&g(a,n,$.width,$.height),t.__version=n.version,n.onUpdate&&n.onUpdate(n)}function C(t,o,a,s){const d=i.convert(o.texture.format),$=i.convert(o.texture.type),c=v(o.texture.internalFormat,d,$);r.texImage2D(s,0,c,o.width,o.height,0,d,$,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,a,s,n.get(o.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function B(t,r,n){if(e.bindRenderbuffer(36161,t),r.depthBuffer&&!r.stencilBuffer){let o=33189;if(n){const t=r.depthTexture;t&&t.isDepthTexture&&(t.type===Pf?o=36012:t.type===Un&&(o=33190));const n=G(r);e.renderbufferStorageMultisample(36161,n,o,r.width,r.height)}else e.renderbufferStorage(36161,o,r.width,r.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(r.depthBuffer&&r.stencilBuffer){if(n){const t=G(r);e.renderbufferStorageMultisample(36161,t,35056,r.width,r.height)}else e.renderbufferStorage(36161,34041,r.width,r.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{const t=i.convert(r.texture.format),o=i.convert(r.texture.type),a=v(r.texture.internalFormat,t,o);if(n){const t=G(r);e.renderbufferStorageMultisample(36161,t,a,r.width,r.height)}else e.renderbufferStorage(36161,a,r.width,r.height)}e.bindRenderbuffer(36161,null)}function P(t){const r=n.get(t),o=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(o)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),b(r.depthTexture,0);const o=n.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===vi)e.framebufferTexture2D(36160,36096,3553,o,0);else{if(r.depthTexture.format!==Yk)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,o,0)}}(r.__webglFramebuffer,t)}else if(o){r.__webglDepthbuffer=[];for(let n=0;n<6;n++)e.bindFramebuffer(36160,r.__webglFramebuffer[n]),r.__webglDepthbuffer[n]=e.createRenderbuffer(),B(r.__webglDepthbuffer[n],t,!1)}else e.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),B(r.__webglDepthbuffer,t,!1);e.bindFramebuffer(36160,null)}function G(e){return s&&e.isWebGLMultisampleRenderTarget?Math.min(p,e.samples):0}let D=!1,I=!1;this.allocateTextureUnit=function(){const e=_;return e>=d&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+d),_+=1,e},this.resetTextureUnits=function(){_=0},this.setTexture2D=b,this.setTexture2DArray=function(e,t){const o=n.get(e);e.version>0&&o.__version!==e.version?L(o,e,t):(r.activeTexture(33984+t),r.bindTexture(35866,o.__webglTexture))},this.setTexture3D=function(e,t){const o=n.get(e);e.version>0&&o.__version!==e.version?L(o,e,t):(r.activeTexture(33984+t),r.bindTexture(32879,o.__webglTexture))},this.setTextureCube=M,this.setTextureCubeDynamic=w,this.setupRenderTarget=function(t){const o=n.get(t),d=n.get(t.texture);t.addEventListener("dispose",y),d.__webglTexture=e.createTexture(),a.memory.textures++;const $=!0===t.isWebGLCubeRenderTarget,c=!0===t.isWebGLMultisampleRenderTarget,p=x(t)||s;if(!s||t.texture.format!==Sd||t.texture.type!==Pf&&t.texture.type!==Vn||(t.texture.format=Gc,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),$){o.__webglFramebuffer=[];for(let t=0;t<6;t++)o.__webglFramebuffer[t]=e.createFramebuffer()}else if(o.__webglFramebuffer=e.createFramebuffer(),c)if(s){o.__webglMultisampledFramebuffer=e.createFramebuffer(),o.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,o.__webglColorRenderbuffer);const r=i.convert(t.texture.format),n=i.convert(t.texture.type),a=v(t.texture.internalFormat,r,n),s=G(t);e.renderbufferStorageMultisample(36161,s,a,t.width,t.height),e.bindFramebuffer(36160,o.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,o.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(o.__webglDepthRenderbuffer=e.createRenderbuffer(),B(o.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if($){r.bindTexture(34067,d.__webglTexture),A(34067,t.texture,p);for(let e=0;e<6;e++)C(o.__webglFramebuffer[e],t,36064,34069+e);R(t.texture,p)&&g(34067,t.texture,t.width,t.height),r.bindTexture(34067,null)}else r.bindTexture(3553,d.__webglTexture),A(3553,t.texture,p),C(o.__webglFramebuffer,t,36064,3553),R(t.texture,p)&&g(3553,t.texture,t.width,t.height),r.bindTexture(3553,null);t.depthBuffer&&P(t)},this.updateRenderTargetMipmap=function(e){const t=e.texture;if(R(t,x(e)||s)){const o=e.isWebGLCubeRenderTarget?34067:3553,i=n.get(t).__webglTexture;r.bindTexture(o,i),g(o,t,e.width,e.height),r.bindTexture(o,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(s){const r=n.get(t);e.bindFramebuffer(36008,r.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,r.__webglFramebuffer);const o=t.width,i=t.height;let a=16384;t.depthBuffer&&(a|=256),t.stencilBuffer&&(a|=1024),e.blitFramebuffer(0,0,o,i,0,0,o,i,a,9728),e.bindFramebuffer(36160,r.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===D&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),D=!0),e=e.texture),b(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===I&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),I=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?M(e,t):w(e,t)}}function xW(e,t,r){const n=r.isWebGL2;return{convert:function(e){let r;if(e===Wk)return 5121;if(e===tR)return 32819;if(e===uR)return 32820;if(e===vR)return 33635;if(e===qR)return 5120;if(e===rR)return 5122;if(e===Tn)return 5123;if(e===sR)return 5124;if(e===Un)return 5125;if(e===Pf)return 5126;if(e===Vn)return n?5131:null!==(r=t.get("OES_texture_half_float"))?r.HALF_FLOAT_OES:null;if(e===wR)return 6406;if(e===Sd)return 6407;if(e===Gc)return 6408;if(e===xR)return 6409;if(e===yR)return 6410;if(e===vi)return 6402;if(e===Yk)return 34041;if(e===AR)return 6403;if(e===BR)return 36244;if(e===CR)return 33319;if(e===DR)return 33320;if(e===ER)return 36248;if(e===FR)return 36249;if(e===Ez||e===Fz||e===Gz||e===Hz){if(null===(r=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===Ez)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Fz)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Gz)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Hz)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===Iz||e===Jz||e===Kz||e===Lz){if(null===(r=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===Iz)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Jz)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Kz)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Lz)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===GR)return null!==(r=t.get("WEBGL_compressed_texture_etc1"))?r.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===Mz||e===Nz)&&null!==(r=t.get("WEBGL_compressed_texture_etc"))){if(e===Mz)return r.COMPRESSED_RGB8_ETC2;if(e===Nz)return r.COMPRESSED_RGBA8_ETC2_EAC}return e===HR||e===IR||e===JR||e===KR||e===LR||e===MR||e===NR||e===OR||e===PR||e===QR||e===RR||e===SR||e===TR||e===UR||e===WR||e===XR||e===YR||e===ZR||e===$R||e===_R||e===aS||e===bS||e===cS||e===dS||e===eS||e===fS||e===gS||e===hS?null!==(r=t.get("WEBGL_compressed_texture_astc"))?e:null:e===VR?null!==(r=t.get("EXT_texture_compression_bptc"))?e:null:e===Xk?n?34042:null!==(r=t.get("WEBGL_depth_texture"))?r.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function Ts(e){zb.call(this),this.cameras=e||[]}function _f(){ja.call(this),this.type="Group"}function mo(){this._targetRay=null,this._grip=null}function CA(e,t){const r=this;let n=null,o=1,i=null,a="local-floor",s=null;const d=[],$=new Map,c=new zb;c.layers.enable(1),c.viewport=new Ta;const p=new zb;p.layers.enable(2),p.viewport=new Ta;const l=[c,p],u=new Ts;u.layers.enable(1),u.layers.enable(2);let h=null,f=null;function m(e){const t=$.get(e.inputSource);t&&t.dispatchEvent({type:e.type})}function x(){$.forEach(function(e,t){e.disconnect(t)}),$.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),_.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}function R(e){i=e,_.setContext(n),_.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}function g(e){const t=n.inputSources;for(let r=0;r<d.length;r++)$.set(t[r],d[r]);for(let r=0;r<e.removed.length;r++){const t=e.removed[r],n=$.get(t);n&&(n.dispatchEvent({type:"disconnected",data:t}),$.delete(t))}for(let r=0;r<e.added.length;r++){const t=e.added[r],n=$.get(t);n&&n.dispatchEvent({type:"connected",data:t})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=d[e];return void 0===t&&(t=new mo,d[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=d[e];return void 0===t&&(t=new mo,d[e]=t),t.getGripSpace()},this.setFramebufferScaleFactor=function(e){o=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){a=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return i},this.getSession=function(){return n},this.setSession=function(e){if(null!==(n=e)){n.addEventListener("select",m),n.addEventListener("selectstart",m),n.addEventListener("selectend",m),n.addEventListener("squeeze",m),n.addEventListener("squeezestart",m),n.addEventListener("squeezeend",m),n.addEventListener("end",x);const e=t.getContextAttributes();!0!==e.xrCompatible&&t.makeXRCompatible();const r={antialias:e.antialias,alpha:e.alpha,depth:e.depth,stencil:e.stencil,framebufferScaleFactor:o},i=new XRWebGLLayer(n,t,r);n.updateRenderState({baseLayer:i}),n.requestReferenceSpace(a).then(R),n.addEventListener("inputsourceschange",g)}};const v=new ba,q=new ba;function K(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}this.getCamera=function(e){u.near=p.near=c.near=e.near,u.far=p.far=c.far=e.far,h===u.near&&f===u.far||(n.updateRenderState({depthNear:u.near,depthFar:u.far}),h=u.near,f=u.far);const t=e.parent,r=u.cameras;K(u,t);for(let n=0;n<r.length;n++)K(r[n],t);e.matrixWorld.copy(u.matrixWorld);const o=e.children;for(let n=0,i=o.length;n<i;n++)o[n].updateMatrixWorld(!0);return 2===r.length?function(e,t,r){v.setFromMatrixPosition(t.matrixWorld),q.setFromMatrixPosition(r.matrixWorld);const n=v.distanceTo(q),o=t.projectionMatrix.elements,i=r.projectionMatrix.elements,a=o[14]/(o[10]-1),s=o[14]/(o[10]+1),d=(o[9]+1)/o[5],$=(o[9]-1)/o[5],c=(o[8]-1)/o[0],p=(i[8]+1)/i[0],l=a*c,u=a*p,h=n/(-c+p),f=h*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(f),e.translateZ(h),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);const m=a+h,x=s+h,R=l-f,g=u+(n-f),K=d*s/x*m,y=$*s/x*m;e.projectionMatrix.makePerspective(R,g,K,y,m,x)}(u,c,p):u.projectionMatrix.copy(c.projectionMatrix),u};let y=null;const _=new fA;_.setAnimationLoop(function(t,r){if(null!==(s=r.getViewerPose(i))){const t=s.views,r=n.renderState.baseLayer;e.setFramebuffer(r.framebuffer);let o=!1;t.length!==u.cameras.length&&(u.cameras.length=0,o=!0);for(let e=0;e<t.length;e++){const n=t[e],i=r.getViewport(n),a=l[e];a.matrix.fromArray(n.transform.matrix),a.projectionMatrix.fromArray(n.projectionMatrix),a.viewport.set(i.x,i.y,i.width,i.height),0===e&&u.matrix.copy(a.matrix),!0===o&&u.cameras.push(a)}}const o=n.inputSources;for(let e=0;e<d.length;e++){const t=d[e],n=o[e];t.update(n,r,i)}y&&y(t,r)}),this.setAnimationLoop=function(e){y=e},this.dispose=function(){}}function yW(e){function t(t,r,n){t.opacity.value=r.opacity,r.color&&t.diffuse.value.copy(r.color),r.emissive&&t.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(t.map.value=r.map),r.alphaMap&&(t.alphaMap.value=r.alphaMap),r.specularMap&&(t.specularMap.value=r.specularMap);const o=r.envMap||n;let i,a;o&&(t.envMap.value=o,t.flipEnvMap.value=o.isCubeTexture?-1:1,t.reflectivity.value=r.reflectivity,t.refractionRatio.value=r.refractionRatio,t.maxMipLevel.value=e.get(o).__maxMipLevel),r.lightMap&&(t.lightMap.value=r.lightMap,t.lightMapIntensity.value=r.lightMapIntensity),r.aoMap&&(t.aoMap.value=r.aoMap,t.aoMapIntensity.value=r.aoMapIntensity),r.map?i=r.map:r.specularMap?i=r.specularMap:r.displacementMap?i=r.displacementMap:r.normalMap?i=r.normalMap:r.bumpMap?i=r.bumpMap:r.roughnessMap?i=r.roughnessMap:r.metalnessMap?i=r.metalnessMap:r.alphaMap?i=r.alphaMap:r.emissiveMap&&(i=r.emissiveMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix)),r.aoMap?a=r.aoMap:r.lightMap&&(a=r.lightMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),t.uv2Transform.value.copy(a.matrix))}function r(e,t,r){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ob&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ob&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),(t.envMap||r)&&(e.envMapIntensity.value=t.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,n,o,i,a){n.isMeshBasicMaterial?t(e,n):n.isMeshLambertMaterial?(t(e,n),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,n)):n.isMeshToonMaterial?(t(e,n),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ob&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ob&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,n)):n.isMeshPhongMaterial?(t(e,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ob&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ob&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,n)):n.isMeshStandardMaterial?(t(e,n,o),n.isMeshPhysicalMaterial?function(e,t,n){r(e,t,n),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen),t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===Ob&&e.clearcoatNormalScale.value.negate()),e.transparency.value=t.transparency}(e,n,o):r(e,n,o)):n.isMeshMatcapMaterial?(t(e,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ob&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ob&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,n)):n.isMeshDepthMaterial?(t(e,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,n)):n.isMeshDistanceMaterial?(t(e,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,n)):n.isMeshNormalMaterial?(t(e,n),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ob&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ob&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,n)):n.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,n)):n.isPointsMaterial?function(e,t,r,n){let o;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*n,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.map?o=t.map:t.alphaMap&&(o=t.alphaMap),void 0!==o&&(!0===o.matrixAutoUpdate&&o.updateMatrix(),e.uvTransform.value.copy(o.matrix))}(e,n,i,a):n.isSpriteMaterial?function(e,t){let r;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.map?r=t.map:t.alphaMap&&(r=t.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,n):n.isShadowMaterial?(e.color.value.copy(n.color),e.opacity.value=n.opacity):n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)}}}function ll(e){const t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),r=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,o=void 0===e.depth||e.depth,i=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,d=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,$=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let p=null,l=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=uc,this.physicallyCorrectLights=!1,this.toneMapping=ti,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const u=this;let h=!1,f=null,m=0,x=0,R=null,g=null,v=-1,q=null,K=null;const y=new Ta,_=new Ta;let b=null,M=t.width,w=t.height,S=1,T=null,A=null;const E=new Ta(0,0,M,w),L=new Ta(0,0,M,w);let C=!1;const B=new gl,P=new bV;let G=!1,D=!1;const I=new fa,O=new ba,F={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function N(){return null===R?S:1}let V,U,H,z,k,W,j,X,Y,Z,J,Q,ee,te,re,ne,oe,ie,ae,se=r;function de(e,r){for(let n=0;n<e.length;n++){const o=e[n],i=t.getContext(o,r);if(null!==i)return i}return null}try{const e={alpha:n,depth:o,stencil:i,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:d,powerPreference:$,failIfMajorPerformanceCaveat:c};if(t.addEventListener("webglcontextlost",le,!1),t.addEventListener("webglcontextrestored",ue,!1),null===se){const t=["webgl2","webgl","experimental-webgl"];if(!0===u.isWebGL1Renderer&&t.shift(),null===(se=de(t,e)))throw de(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===se.getShaderPrecisionFormat&&(se.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ke){throw console.error("THREE.WebGLRenderer: "+Ke.message),Ke}function $e(){V=new cV(se),!1===(U=new aV(se,V,e)).isWebGL2&&(V.get("WEBGL_depth_texture"),V.get("OES_texture_float"),V.get("OES_texture_half_float"),V.get("OES_texture_half_float_linear"),V.get("OES_standard_derivatives"),V.get("OES_element_index_uint"),V.get("OES_vertex_array_object"),V.get("ANGLE_instanced_arrays")),V.get("OES_texture_float_linear"),ie=new xW(se,V,U),(H=new vW(se,V,U)).scissor(_.copy(L).multiplyScalar(S).floor()),H.viewport(y.copy(E).multiplyScalar(S).floor()),z=new fV(se),k=new jW,W=new wW(se,V,H,k,U,ie,z),j=new FS(se,U),ae=new $U(se,V,j,U),X=new dV(se,j,z,ae),Y=new jV(se,X,j,z),re=new iV(se),Z=new iW(u,V,U,ae),J=new yW(k),Q=new mW,ee=new sW,te=new ZU(u,H,Y,s),ne=new _U(se,V,z,U),oe=new eV(se,V,z,U),z.programs=Z.programs,u.capabilities=U,u.extensions=V,u.properties=k,u.renderLists=Q,u.state=H,u.info=z}$e();const ce=new CA(u,se);this.xr=ce;const pe=new BA(u,Y,U.maxTextureSize);function le(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),h=!0}function ue(){console.log("THREE.WebGLRenderer: Context Restored."),h=!1,$e()}function he(e){const t=e.target;t.removeEventListener("dispose",he),function(e){fe(e),k.remove(e)}(t)}function fe(e){const t=k.get(e).program;e.program=void 0,void 0!==t&&Z.releaseProgram(t)}this.shadowMap=pe,this.getContext=function(){return se},this.getContextAttributes=function(){return se.getContextAttributes()},this.forceContextLoss=function(){const e=V.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=V.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return S},this.setPixelRatio=function(e){void 0!==e&&(S=e,this.setSize(M,w,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new ca),e.set(M,w)},this.setSize=function(e,r,n){ce.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(M=e,w=r,t.width=Math.floor(e*S),t.height=Math.floor(r*S),!1!==n&&(t.style.width=e+"px",t.style.height=r+"px"),this.setViewport(0,0,e,r))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new ca),e.set(M*S,w*S).floor()},this.setDrawingBufferSize=function(e,r,n){M=e,w=r,S=n,t.width=Math.floor(e*n),t.height=Math.floor(r*n),this.setViewport(0,0,e,r)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new Ta),e.copy(y)},this.getViewport=function(e){return e.copy(E)},this.setViewport=function(e,t,r,n){e.isVector4?E.set(e.x,e.y,e.z,e.w):E.set(e,t,r,n),H.viewport(y.copy(E).multiplyScalar(S).floor())},this.getScissor=function(e){return e.copy(L)},this.setScissor=function(e,t,r,n){e.isVector4?L.set(e.x,e.y,e.z,e.w):L.set(e,t,r,n),H.scissor(_.copy(L).multiplyScalar(S).floor())},this.getScissorTest=function(){return C},this.setScissorTest=function(e){H.setScissorTest(C=e)},this.setOpaqueSort=function(e){T=e},this.setTransparentSort=function(e){A=e},this.getClearColor=function(){return te.getClearColor()},this.setClearColor=function(){te.setClearColor.apply(te,arguments)},this.getClearAlpha=function(){return te.getClearAlpha()},this.setClearAlpha=function(){te.setClearAlpha.apply(te,arguments)},this.clear=function(e,t,r){let n=0;(void 0===e||e)&&(n|=16384),(void 0===t||t)&&(n|=256),(void 0===r||r)&&(n|=1024),se.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",le,!1),t.removeEventListener("webglcontextrestored",ue,!1),Q.dispose(),ee.dispose(),k.dispose(),Y.dispose(),ae.dispose(),ce.dispose(),xe.stop()},this.renderBufferImmediate=function(e,t){ae.initAttributes();const r=k.get(e);e.hasPositions&&!r.position&&(r.position=se.createBuffer()),e.hasNormals&&!r.normal&&(r.normal=se.createBuffer()),e.hasUvs&&!r.uv&&(r.uv=se.createBuffer()),e.hasColors&&!r.color&&(r.color=se.createBuffer());const n=t.getAttributes();e.hasPositions&&(se.bindBuffer(34962,r.position),se.bufferData(34962,e.positionArray,35048),ae.enableAttribute(n.position),se.vertexAttribPointer(n.position,3,5126,!1,0,0)),e.hasNormals&&(se.bindBuffer(34962,r.normal),se.bufferData(34962,e.normalArray,35048),ae.enableAttribute(n.normal),se.vertexAttribPointer(n.normal,3,5126,!1,0,0)),e.hasUvs&&(se.bindBuffer(34962,r.uv),se.bufferData(34962,e.uvArray,35048),ae.enableAttribute(n.uv),se.vertexAttribPointer(n.uv,2,5126,!1,0,0)),e.hasColors&&(se.bindBuffer(34962,r.color),se.bufferData(34962,e.colorArray,35048),ae.enableAttribute(n.color),se.vertexAttribPointer(n.color,3,5126,!1,0,0)),ae.disableUnusedAttributes(),se.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,r,n,o,i){null===t&&(t=F);const a=o.isMesh&&o.matrixWorld.determinant()<0,s=qe(e,t,n,o);H.setMaterial(n,a);let d=r.index;const $=r.attributes.position;if(null===d){if(void 0===$||0===$.count)return}else if(0===d.count)return;let c,p=1;!0===n.wireframe&&(d=X.getWireframeAttribute(r),p=2),(n.morphTargets||n.morphNormals)&&re.update(o,r,n,s),ae.setup(o,n,s,r,d);let l=ne;null!==d&&(c=j.get(d),(l=oe).setIndex(c));const u=null!==d?d.count:$.count,h=r.drawRange.start*p,f=r.drawRange.count*p,m=null!==i?i.start*p:0,x=null!==i?i.count*p:1/0,R=Math.max(h,m),g=Math.min(u,h+f,m+x)-1,v=Math.max(0,g-R+1);if(0!==v){if(o.isMesh)!0===n.wireframe?(H.setLineWidth(n.wireframeLinewidth*N()),l.setMode(1)):l.setMode(4);else if(o.isLine){let e=n.linewidth;void 0===e&&(e=1),H.setLineWidth(e*N()),o.isLineSegments?l.setMode(1):o.isLineLoop?l.setMode(2):l.setMode(3)}else o.isPoints?l.setMode(0):o.isSprite&&l.setMode(4);if(o.isInstancedMesh)l.renderInstances(r,R,v,o.count);else if(r.isInstancedBufferGeometry){const e=Math.min(r.instanceCount,r._maxInstanceCount);l.renderInstances(r,R,v,e)}else l.render(R,v)}},this.compile=function(e,t){(l=ee.get(e,t)).init(),e.traverse(function(e){e.isLight&&(l.pushLight(e),e.castShadow&&l.pushShadow(e))}),l.setupLights(t);const r=new WeakMap;e.traverse(function(t){let n=t.material;if(n)if(Array.isArray(n))for(let o=0;o<n.length;o++){let i=n[o];!1===r.has(i)&&(ve(i,e,t),r.set(i))}else!1===r.has(n)&&(ve(n,e,t),r.set(n))})};let me=null;const xe=new fA;function Re(e,t,r){const n=!0===t.isScene?t.overrideMaterial:null;for(let o=0,i=e.length;o<i;o++){const i=e[o],a=i.object,s=i.geometry,d=null===n?i.material:n,$=i.group;if(r.isArrayCamera){K=r;const e=r.cameras;for(let r=0,n=e.length;r<n;r++){const n=e[r];a.layers.test(n.layers)&&(H.viewport(y.copy(n.viewport)),l.setupLights(n),ge(a,t,n,s,d,$))}}else K=null,ge(a,t,r,s,d,$)}}function ge(e,t,r,n,o,i){if(e.onBeforeRender(u,t,r,n,o,i),l=ee.get(t,K||r),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){const n=qe(r,t,o,e);H.setMaterial(o),ae.reset(),function(e,t){e.render(function(e){u.renderBufferImmediate(e,t)})}(e,n)}else u.renderBufferDirect(r,t,n,o,e,i);e.onAfterRender(u,t,r,n,o,i),l=ee.get(t,K||r)}function ve(e,t,r){!0!==t.isScene&&(t=F);const n=k.get(e),o=l.state.lights,i=l.state.shadowsArray,a=o.state.version,s=Z.getParameters(e,o.state,i,t,P.numPlanes,P.numIntersection,r),d=Z.getProgramCacheKey(s);let $=n.program,c=!0;if(void 0===$)e.addEventListener("dispose",he);else if($.cacheKey!==d)fe(e);else if(n.lightsStateVersion!==a)n.lightsStateVersion=a,c=!1;else{if(void 0!==s.shaderID)return;c=!1}c&&($=Z.acquireProgram(s,d),n.program=$,n.uniforms=s.uniforms,n.outputEncoding=s.outputEncoding,e.program=$);const p=$.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(let t=0;t<u.maxMorphTargets;t++)p["morphTarget"+t]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(let t=0;t<u.maxMorphNormals;t++)p["morphNormal"+t]>=0&&e.numSupportedMorphNormals++}const h=n.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=P.numPlanes,n.numIntersection=P.numIntersection,h.clippingPlanes=P.uniform),n.environment=e.isMeshStandardMaterial?t.environment:null,n.fog=t.fog,n.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),n.lightsStateVersion=a,n.needsLights&&(h.ambientLightColor.value=o.state.ambient,h.lightProbe.value=o.state.probe,h.directionalLights.value=o.state.directional,h.directionalLightShadows.value=o.state.directionalShadow,h.spotLights.value=o.state.spot,h.spotLightShadows.value=o.state.spotShadow,h.rectAreaLights.value=o.state.rectArea,h.pointLights.value=o.state.point,h.pointLightShadows.value=o.state.pointShadow,h.hemisphereLights.value=o.state.hemi,h.directionalShadowMap.value=o.state.directionalShadowMap,h.directionalShadowMatrix.value=o.state.directionalShadowMatrix,h.spotShadowMap.value=o.state.spotShadowMap,h.spotShadowMatrix.value=o.state.spotShadowMatrix,h.pointShadowMap.value=o.state.pointShadowMap,h.pointShadowMatrix.value=o.state.pointShadowMatrix);const f=n.program.getUniforms(),m=$f.seqWithValue(f.seq,h);n.uniformsList=m}function qe(e,t,r,n){!0!==t.isScene&&(t=F),W.resetTextureUnits();const o=t.fog,i=r.isMeshStandardMaterial?t.environment:null,a=null===R?u.outputEncoding:R.texture.encoding,s=k.get(r),d=l.state.lights;if(!0===G&&(!0===D||e!==q)){const t=e===q&&r.id===v;P.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,e,s,t)}r.version===s.__version?void 0===s.program?ve(r,t,n):r.fog&&s.fog!==o?ve(r,t,n):s.environment!==i?ve(r,t,n):s.needsLights&&s.lightsStateVersion!==d.state.version?ve(r,t,n):void 0===s.numClippingPlanes||s.numClippingPlanes===P.numPlanes&&s.numIntersection===P.numIntersection?s.outputEncoding!==a&&ve(r,t,n):ve(r,t,n):(ve(r,t,n),s.__version=r.version);let $=!1,c=!1,p=!1;const h=s.program,f=h.getUniforms(),m=s.uniforms;if(H.useProgram(h.program)&&($=!0,c=!0,p=!0),r.id!==v&&(v=r.id,c=!0),$||q!==e){if(f.setValue(se,"projectionMatrix",e.projectionMatrix),U.logarithmicDepthBuffer&&f.setValue(se,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),q!==e&&(q=e,c=!0,p=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){const t=f.map.cameraPosition;void 0!==t&&t.setValue(se,O.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&f.setValue(se,"isOrthographic",!0===e.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||r.skinning)&&f.setValue(se,"viewMatrix",e.matrixWorldInverse)}if(r.skinning){f.setOptional(se,n,"bindMatrix"),f.setOptional(se,n,"bindMatrixInverse");const e=n.skeleton;if(e){const t=e.bones;if(U.floatVertexTextures){if(void 0===e.boneTexture){let r=Math.sqrt(4*t.length);r=ta.ceilPowerOfTwo(r),r=Math.max(r,4);const n=new Float32Array(r*r*4);n.set(e.boneMatrices);const o=new Pi(n,r,r,Gc,Pf);e.boneMatrices=n,e.boneTexture=o,e.boneTextureSize=r}f.setValue(se,"boneTexture",e.boneTexture,W),f.setValue(se,"boneTextureSize",e.boneTextureSize)}else f.setOptional(se,e,"boneMatrices")}}var x,g;return(c||s.receiveShadow!==n.receiveShadow)&&(s.receiveShadow=n.receiveShadow,f.setValue(se,"receiveShadow",n.receiveShadow)),c&&(f.setValue(se,"toneMappingExposure",u.toneMappingExposure),s.needsLights&&(g=p,(x=m).ambientLightColor.needsUpdate=g,x.lightProbe.needsUpdate=g,x.directionalLights.needsUpdate=g,x.directionalLightShadows.needsUpdate=g,x.pointLights.needsUpdate=g,x.pointLightShadows.needsUpdate=g,x.spotLights.needsUpdate=g,x.spotLightShadows.needsUpdate=g,x.rectAreaLights.needsUpdate=g,x.hemisphereLights.needsUpdate=g),o&&r.fog&&J.refreshFogUniforms(m,o),J.refreshMaterialUniforms(m,r,i,S,w),void 0!==m.ltc_1&&(m.ltc_1.value=na.LTC_1),void 0!==m.ltc_2&&(m.ltc_2.value=na.LTC_2),$f.upload(se,s.uniformsList,m,W)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&($f.upload(se,s.uniformsList,m,W),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&f.setValue(se,"center",n.center),f.setValue(se,"modelViewMatrix",n.modelViewMatrix),f.setValue(se,"normalMatrix",n.normalMatrix),f.setValue(se,"modelMatrix",n.matrixWorld),h}xe.setAnimationLoop(function(e){ce.isPresenting||me&&me(e)}),"undefined"!=typeof window&&xe.setContext(window),this.setAnimationLoop=function(e){me=e,ce.setAnimationLoop(e),null===e?xe.stop():xe.start()},this.render=function(e,t){let r,n;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),r=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),n=arguments[3]),void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===h)return;ae.resetDefaultState(),v=-1,q=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===ce.enabled&&!0===ce.isPresenting&&(t=ce.getCamera(t)),!0===e.isScene&&e.onBeforeRender(u,e,t,r||R),(l=ee.get(e,t)).init(),I.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),B.setFromProjectionMatrix(I),D=this.localClippingEnabled,G=P.init(this.clippingPlanes,D,t),(p=Q.get(e,t)).init(),function e(t,r,n,o){if(!1===t.visible)return;const i=t.layers.test(r.layers);if(i)if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(r);else if(t.isLight)l.pushLight(t),t.castShadow&&l.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||B.intersectsSprite(t)){o&&O.setFromMatrixPosition(t.matrixWorld).applyMatrix4(I);const e=Y.update(t),r=t.material;r.visible&&p.push(t,e,r,n,O.z,null)}}else if(t.isImmediateRenderObject)o&&O.setFromMatrixPosition(t.matrixWorld).applyMatrix4(I),p.push(t,null,t.material,n,O.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==z.render.frame&&(t.skeleton.update(),t.skeleton.frame=z.render.frame),!t.frustumCulled||B.intersectsObject(t))){o&&O.setFromMatrixPosition(t.matrixWorld).applyMatrix4(I);const e=Y.update(t),r=t.material;if(Array.isArray(r)){const o=e.groups;for(let i=0,a=o.length;i<a;i++){const a=o[i],s=r[a.materialIndex];s&&s.visible&&p.push(t,e,s,n,O.z,a)}}else r.visible&&p.push(t,e,r,n,O.z,null)}const a=t.children;for(let s=0,d=a.length;s<d;s++)e(a[s],r,n,o)}(e,t,0,u.sortObjects),p.finish(),!0===u.sortObjects&&p.sort(T,A),!0===G&&P.beginShadows();const o=l.state.shadowsArray;pe.render(o,e,t),l.setupLights(t),!0===G&&P.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==r&&this.setRenderTarget(r),te.render(p,e,t,n);const i=p.opaque,a=p.transparent;i.length>0&&Re(i,e,t),a.length>0&&Re(a,e,t),!0===e.isScene&&e.onAfterRender(u,e,t),null!==R&&(W.updateRenderTargetMipmap(R),W.updateMultisampleRenderTarget(R)),H.buffers.depth.setTest(!0),H.buffers.depth.setMask(!0),H.buffers.color.setMask(!0),H.setPolygonOffset(!1),p=null,l=null},this.setFramebuffer=function(e){f!==e&&null===R&&se.bindFramebuffer(36160,e),f=e},this.getActiveCubeFace=function(){return m},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return R},this.setRenderTarget=function(e,t,r){R=e,m=t,x=r,e&&void 0===k.get(e).__webglFramebuffer&&W.setupRenderTarget(e);let n=f,o=!1;if(e){const r=k.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(n=r[t||0],o=!0):n=e.isWebGLMultisampleRenderTarget?k.get(e).__webglMultisampledFramebuffer:r,y.copy(e.viewport),_.copy(e.scissor),b=e.scissorTest}else y.copy(E).multiplyScalar(S).floor(),_.copy(L).multiplyScalar(S).floor(),b=C;if(g!==n&&(se.bindFramebuffer(36160,n),g=n),H.viewport(y),H.scissor(_),H.setScissorTest(b),o){const n=k.get(e.texture);se.framebufferTexture2D(36160,36064,34069+(t||0),n.__webglTexture,r||0)}},this.readRenderTargetPixels=function(e,t,r,n,o,i,a){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=k.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){let a=!1;s!==g&&(se.bindFramebuffer(36160,s),a=!0);try{const s=e.texture,d=s.format,$=s.type;if(d!==Gc&&ie.convert(d)!==se.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!($===Wk||ie.convert($)===se.getParameter(35738)||$===Pf&&(U.isWebGL2||V.get("OES_texture_float")||V.get("WEBGL_color_buffer_float"))||$===Vn&&(U.isWebGL2?V.get("EXT_color_buffer_float"):V.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===se.checkFramebufferStatus(36160)?t>=0&&t<=e.width-n&&r>=0&&r<=e.height-o&&se.readPixels(t,r,n,o,ie.convert(d),ie.convert($),i):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{a&&se.bindFramebuffer(36160,g)}}},this.copyFramebufferToTexture=function(e,t,r){void 0===r&&(r=0);const n=Math.pow(2,-r),o=Math.floor(t.image.width*n),i=Math.floor(t.image.height*n),a=ie.convert(t.format);W.setTexture2D(t,0),se.copyTexImage2D(3553,r,a,e.x,e.y,o,i,0),H.unbindTexture()},this.copyTextureToTexture=function(e,t,r,n){void 0===n&&(n=0);const o=t.image.width,i=t.image.height,a=ie.convert(r.format),s=ie.convert(r.type);W.setTexture2D(r,0),se.pixelStorei(37440,r.flipY),se.pixelStorei(37441,r.premultiplyAlpha),se.pixelStorei(3317,r.unpackAlignment),t.isDataTexture?se.texSubImage2D(3553,n,e.x,e.y,o,i,a,s,t.image.data):t.isCompressedTexture?se.compressedTexSubImage2D(3553,n,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,a,t.mipmaps[0].data):se.texSubImage2D(3553,n,e.x,e.y,a,s,t.image),0===n&&r.generateMipmaps&&se.generateMipmap(3553),H.unbindTexture()},this.initTexture=function(e){W.setTexture2D(e,0),H.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function DA(e){ll.call(this,e)}function Us(e,t){this.name="",this.color=new ga(e),this.density=void 0!==t?t:25e-5}function Vs(e,t,r){this.name="",this.color=new ga(e),this.near=void 0!==t?t:1,this.far=void 0!==r?r:1e3}function Kc(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Wn,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ta.generateUUID()}Ts.prototype=Object.assign(Object.create(zb.prototype),{constructor:Ts,isArrayCamera:!0}),_f.prototype=Object.assign(Object.create(ja.prototype),{constructor:_f,isGroup:!0}),Object.assign(mo.prototype,{constructor:mo,getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new _f,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new _f,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),this},update:function(e,t,r){let n=null,o=null;const i=this._targetRay,a=this._grip;return e&&(null!==i&&null!==(n=t.getPose(e.targetRaySpace,r))&&(i.matrix.fromArray(n.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale)),null!==a&&e.gripSpace&&null!==(o=t.getPose(e.gripSpace,r))&&(a.matrix.fromArray(o.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale))),null!==i&&(i.visible=null!==n),null!==a&&(a.visible=null!==o),this}}),Object.assign(CA.prototype,Qa.prototype),DA.prototype=Object.assign(Object.create(ll.prototype),{constructor:DA,isWebGL1Renderer:!0}),Object.assign(Us.prototype,{isFogExp2:!0,clone:function(){return new Us(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Vs.prototype,{isFog:!0,clone:function(){return new Vs(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Kc.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Kc.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,o=this.stride;n<o;n++)this.array[e+n]=t.array[r+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ta.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new Kc(new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ta.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const eh=new ba;function ag(e,t,r,n){this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=!0===n}function fh(e){ua.call(this),this.type="SpriteMaterial",this.color=new ga(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}let ml;Object.defineProperties(ag.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(ag.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(let t=0,r=this.data.count;t<r;t++)eh.x=this.getX(t),eh.y=this.getY(t),eh.z=this.getZ(t),eh.applyMatrix4(e),this.setXYZ(t,eh.x,eh.y,eh.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this},setXYZW:function(e,t,r,n,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=o,this},clone:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return new pa(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ag(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),fh.prototype=Object.create(ua.prototype),fh.prototype.constructor=fh,fh.prototype.isSpriteMaterial=!0,fh.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};const nl=new ba,Ti=new ba,Ui=new ba,Vi=new ca,ol=new ca,EA=new fa,no=new ba,pl=new ba,oo=new ba,FA=new ca,Ws=new ca,GA=new ca;function Xs(e){if(ja.call(this),this.type="Sprite",void 0===ml){ml=new ia;const e=new Kc(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);ml.setIndex([0,1,2,0,2,3]),ml.setAttribute("position",new ag(e,3,0,!1)),ml.setAttribute("uv",new ag(e,2,3,!1))}this.geometry=ml,this.material=void 0!==e?e:new fh,this.center=new ca(.5,.5)}function po(e,t,r,n,o,i){Vi.subVectors(e,r).addScalar(.5).multiply(n),void 0!==o?(ol.x=i*Vi.x-o*Vi.y,ol.y=o*Vi.x+i*Vi.y):ol.copy(Vi),e.copy(t),e.x+=ol.x,e.y+=ol.y,e.applyMatrix4(EA)}Xs.prototype=Object.assign(Object.create(ja.prototype),{constructor:Xs,isSprite:!0,raycast:function(e,t){null===e.camera&&console.error("THREE.Sprite: \"Raycaster.camera\" needs to be set in order to raycast against sprites."),Ti.setFromMatrixScale(this.matrixWorld),EA.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ui.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ti.multiplyScalar(-Ui.z);const r=this.material.rotation;let n,o;0!==r&&(o=Math.cos(r),n=Math.sin(r));const i=this.center;po(no.set(-.5,-.5,0),Ui,i,Ti,n,o),po(pl.set(.5,-.5,0),Ui,i,Ti,n,o),po(oo.set(.5,.5,0),Ui,i,Ti,n,o),FA.set(0,0),Ws.set(1,0),GA.set(1,1);let a=e.ray.intersectTriangle(no,pl,oo,!1,nl);if(null===a&&(po(pl.set(-.5,.5,0),Ui,i,Ti,n,o),Ws.set(0,1),null===(a=e.ray.intersectTriangle(no,oo,pl,!1,nl))))return;const s=e.ray.origin.distanceTo(nl);s<e.near||s>e.far||t.push({distance:s,point:nl.clone(),uv:ac.getUV(nl,no,pl,oo,FA,Ws,GA,new ca),face:null,object:this})},copy:function(e){return ja.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}});const qo=new ba,HA=new ba;function ro(){ja.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function so(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Aa.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new fa,this.bindMatrixInverse=new fa}ro.prototype=Object.assign(Object.create(ja.prototype),{constructor:ro,isLOD:!0,copy:function(e){ja.prototype.copy.call(this,e,!1);const t=e.levels;for(let r=0,n=t.length;r<n;r++){const e=t[r];this.addLevel(e.object.clone(),e.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);const r=this.levels;let n;for(n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){const t=this.levels;if(t.length>0){let r,n;for(r=1,n=t.length;r<n&&!(e<t[r].distance);r++);return t[r-1].object}return null},raycast:function(e,t){if(this.levels.length>0){qo.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(qo);this.getObjectForDistance(r).raycast(e,t)}},update:function(e){const t=this.levels;if(t.length>1){qo.setFromMatrixPosition(e.matrixWorld),HA.setFromMatrixPosition(this.matrixWorld);const r=qo.distanceTo(HA)/e.zoom;let n,o;for(t[0].object.visible=!0,n=1,o=t.length;n<o&&r>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<o;n++)t[n].object.visible=!1}},toJSON:function(e){const t=ja.prototype.toJSON.call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let n=0,o=r.length;n<o;n++){const e=r[n];t.object.levels.push({object:e.object.uuid,distance:e.distance})}return t}}),so.prototype=Object.assign(Object.create(Aa.prototype),{constructor:so,isSkinnedMesh:!0,copy:function(e){return Aa.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const e=new Ta,t=this.geometry.attributes.skinWeight;for(let r=0,n=t.count;r<n;r++){e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.w=t.getW(r);const n=1/e.manhattanLength();n!==1/0?e.multiplyScalar(n):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Aa.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){const e=new ba,t=new Ta,r=new Ta,n=new ba,o=new fa;return function(i,a){const s=this.skeleton,d=this.geometry;t.fromBufferAttribute(d.attributes.skinIndex,i),r.fromBufferAttribute(d.attributes.skinWeight,i),e.fromBufferAttribute(d.attributes.position,i).applyMatrix4(this.bindMatrix),a.set(0,0,0);for(let $=0;$<4;$++){const i=r.getComponent($);if(0!==i){const r=t.getComponent($);o.multiplyMatrices(s.bones[r].matrixWorld,s.boneInverses[r]),a.addScaledVector(n.copy(e).applyMatrix4(o),i)}}return a.applyMatrix4(this.bindMatrixInverse)}}()});const IA=new fa,zW=new fa;function to(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new fa)}}function Ys(){ja.call(this),this.type="Bone"}Object.assign(to.prototype,{calculateInverses:function(){this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++){const t=new fa;this.bones[e]&&t.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(t)}},pose:function(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.getInverse(this.boneInverses[e])}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}},update:function(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let o=0,i=e.length;o<i;o++){const n=e[o]?e[o].matrixWorld:zW;IA.multiplyMatrices(n,t[o]),IA.toArray(r,16*o)}void 0!==n&&(n.needsUpdate=!0)},clone:function(){return new to(this.bones,this.boneInverses)},getBoneByName:function(e){for(let t=0,r=this.bones.length;t<r;t++){const r=this.bones[t];if(r.name===e)return r}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Ys.prototype=Object.assign(Object.create(ja.prototype),{constructor:Ys,isBone:!0});const JA=new fa,KA=new fa,uo=[],ql=new Aa;function Zs(e,t,r){Aa.call(this,e,t),this.instanceMatrix=new pa(new Float32Array(16*r),16),this.count=r,this.frustumCulled=!1}function ob(e){ua.call(this),this.type="LineBasicMaterial",this.color=new ga(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}Zs.prototype=Object.assign(Object.create(Aa.prototype),{constructor:Zs,isInstancedMesh:!0,copy:function(e){return Aa.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),this.count=e.count,this},getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){const r=this.matrixWorld,n=this.count;if(ql.geometry=this.geometry,ql.material=this.material,void 0!==ql.material)for(let o=0;o<n;o++){this.getMatrixAt(o,JA),KA.multiplyMatrices(r,JA),ql.matrixWorld=KA,ql.raycast(e,uo);for(let e=0,r=uo.length;e<r;e++){const r=uo[e];r.instanceId=o,r.object=this,t.push(r)}uo.length=0}},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),ob.prototype=Object.create(ua.prototype),ob.prototype.constructor=ob,ob.prototype.isLineBasicMaterial=!0,ob.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};const LA=new ba,MA=new ba,NA=new fa,vo=new Di,wo=new Td;function Lc(e,t,r){1===r&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),ja.call(this),this.type="Line",this.geometry=void 0!==e?e:new ia,this.material=void 0!==t?t:new ob,this.updateMorphTargets()}Lc.prototype=Object.assign(Object.create(ja.prototype),{constructor:Lc,isLine:!0,copy:function(e){return ja.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){const e=this.geometry;if(e.isBufferGeometry){if(null===e.index){const t=e.attributes.position,r=[0];for(let e=1,n=t.count;e<n;e++)LA.fromBufferAttribute(t,e-1),MA.fromBufferAttribute(t,e),r[e]=r[e-1],r[e]+=LA.distanceTo(MA);e.setAttribute("lineDistance",new ma(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");}else if(e.isGeometry){const t=e.vertices,r=e.lineDistances;r[0]=0;for(let e=1,n=t.length;e<n;e++)r[e]=r[e-1],r[e]+=t[e-1].distanceTo(t[e])}return this},raycast:function(e,t){const r=this.geometry,n=this.matrixWorld,o=e.params.Line.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),wo.copy(r.boundingSphere),wo.applyMatrix4(n),wo.radius+=o,!1===e.ray.intersectsSphere(wo))return;NA.getInverse(n),vo.copy(e.ray).applyMatrix4(NA);const i=o/((this.scale.x+this.scale.y+this.scale.z)/3),a=i*i,s=new ba,d=new ba,$=new ba,c=new ba,p=this&&this.isLineSegments?2:1;if(r.isBufferGeometry){const n=r.index,o=r.attributes.position.array;if(null!==n){const r=n.array;for(let n=0,i=r.length-1;n<i;n+=p){const i=r[n],p=r[n+1];if(s.fromArray(o,3*i),d.fromArray(o,3*p),vo.distanceSqToSegment(s,d,c,$)>a)continue;c.applyMatrix4(this.matrixWorld);const l=e.ray.origin.distanceTo(c);l<e.near||l>e.far||t.push({distance:l,point:$.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else for(let r=0,i=o.length/3-1;r<i;r+=p){if(s.fromArray(o,3*r),d.fromArray(o,3*r+3),vo.distanceSqToSegment(s,d,c,$)>a)continue;c.applyMatrix4(this.matrixWorld);const n=e.ray.origin.distanceTo(c);n<e.near||n>e.far||t.push({distance:n,point:$.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}else if(r.isGeometry){const n=r.vertices,o=n.length;for(let r=0;r<o-1;r+=p){if(vo.distanceSqToSegment(n[r],n[r+1],c,$)>a)continue;c.applyMatrix4(this.matrixWorld);const o=e.ray.origin.distanceTo(c);o<e.near||o>e.far||t.push({distance:o,point:$.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const e=t[r[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,r=e.length;t<r;t++){const r=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const xo=new ba,yo=new ba;function ub(e,t){Lc.call(this,e,t),this.type="LineSegments"}function zo(e,t){Lc.call(this,e,t),this.type="LineLoop"}function bg(e){ua.call(this),this.type="PointsMaterial",this.color=new ga(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}ub.prototype=Object.assign(Object.create(Lc.prototype),{constructor:ub,isLineSegments:!0,computeLineDistances:function(){const e=this.geometry;if(e.isBufferGeometry){if(null===e.index){const t=e.attributes.position,r=[];for(let e=0,n=t.count;e<n;e+=2)xo.fromBufferAttribute(t,e),yo.fromBufferAttribute(t,e+1),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+xo.distanceTo(yo);e.setAttribute("lineDistance",new ma(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");}else if(e.isGeometry){const t=e.vertices,r=e.lineDistances;for(let e=0,n=t.length;e<n;e+=2)xo.copy(t[e]),yo.copy(t[e+1]),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+xo.distanceTo(yo)}return this}}),zo.prototype=Object.assign(Object.create(Lc.prototype),{constructor:zo,isLineLoop:!0}),bg.prototype=Object.create(ua.prototype),bg.prototype.constructor=bg,bg.prototype.isPointsMaterial=!0,bg.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};const OA=new fa,$s=new Di,Ao=new Td,Bo=new ba;function Co(e,t){ja.call(this),this.type="Points",this.geometry=void 0!==e?e:new ia,this.material=void 0!==t?t:new bg,this.updateMorphTargets()}function _s(e,t,r,n,o,i,a){const s=$s.distanceSqToPoint(e);if(s<r){const r=new ba;$s.closestPointToPoint(e,r),r.applyMatrix4(n);const d=o.ray.origin.distanceTo(r);if(d<o.near||d>o.far)return;i.push({distance:d,distanceToRay:Math.sqrt(s),point:r,index:t,face:null,object:a})}}function PA(e,t,r,n,o,i,a,s,d){$a.call(this,e,t,r,n,o,i,a,s,d),this.format=void 0!==a?a:Sd,this.minFilter=void 0!==i?i:Qb,this.magFilter=void 0!==o?o:Qb,this.generateMipmaps=!1}function rl(e,t,r,n,o,i,a,s,d,$,c,p){$a.call(this,null,i,a,s,d,$,n,o,c,p),this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function sl(e,t,r,n,o,i,a,s,d){$a.call(this,e,t,r,n,o,i,a,s,d),this.needsUpdate=!0}function Do(e,t,r,n,o,i,a,s,d,$){if(($=void 0!==$?$:vi)!==vi&&$!==Yk)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&$===vi&&(r=Tn),void 0===r&&$===Yk&&(r=Xk),$a.call(this,null,n,o,i,a,s,$,r,d),this.image={width:e,height:t},this.magFilter=void 0!==a?a:Gb,this.minFilter=void 0!==s?s:Gb,this.flipY=!1,this.generateMipmaps=!1}function Eo(e){ia.call(this),this.type="WireframeGeometry";const t=[],r=[0,0],n={},o=["a","b","c"];if(e&&e.isGeometry){const i=e.faces;for(let e=0,t=i.length;e<t;e++){const t=i[e];for(let e=0;e<3;e++){const i=t[o[e]],a=t[o[(e+1)%3]];r[0]=Math.min(i,a),r[1]=Math.max(i,a);const s=r[0]+","+r[1];void 0===n[s]&&(n[s]={index1:r[0],index2:r[1]})}}for(const r in n){const o=n[r];let i=e.vertices[o.index1];t.push(i.x,i.y,i.z),i=e.vertices[o.index2],t.push(i.x,i.y,i.z)}}else if(e&&e.isBufferGeometry){let o=new ba;if(null!==e.index){const i=e.attributes.position,a=e.index;let s=e.groups;0===s.length&&(s=[{start:0,count:a.count,materialIndex:0}]);for(let e=0,t=s.length;e<t;++e){const t=s[e],o=t.start;for(let e=o,i=o+t.count;e<i;e+=3)for(let t=0;t<3;t++){const o=a.getX(e+t),i=a.getX(e+(t+1)%3);r[0]=Math.min(o,i),r[1]=Math.max(o,i);const s=r[0]+","+r[1];void 0===n[s]&&(n[s]={index1:r[0],index2:r[1]})}}for(const e in n){const r=n[e];o.fromBufferAttribute(i,r.index1),t.push(o.x,o.y,o.z),o.fromBufferAttribute(i,r.index2),t.push(o.x,o.y,o.z)}}else{const r=e.attributes.position;for(let e=0,n=r.count/3;e<n;e++)for(let i=0;i<3;i++){const n=3*e+i;o.fromBufferAttribute(r,n),t.push(o.x,o.y,o.z);const a=3*e+(i+1)%3;o.fromBufferAttribute(r,a),t.push(o.x,o.y,o.z)}}}this.setAttribute("position",new ma(t,3))}function Fo(e,t,r){oa.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:r},this.fromBufferGeometry(new tl(e,t,r)),this.mergeVertices()}function tl(e,t,r){ia.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:r};const n=[],o=[],i=[],a=[],s=new ba,d=new ba,$=new ba,c=new ba,p=new ba;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const l=t+1;for(let u=0;u<=r;u++){const n=u/r;for(let r=0;r<=t;r++){const l=r/t;e(l,n,d),o.push(d.x,d.y,d.z),l-1e-5>=0?(e(l-1e-5,n,$),c.subVectors(d,$)):(e(l+1e-5,n,$),c.subVectors($,d)),n-1e-5>=0?(e(l,n-1e-5,$),p.subVectors(d,$)):(e(l,n+1e-5,$),p.subVectors($,d)),s.crossVectors(c,p).normalize(),i.push(s.x,s.y,s.z),a.push(l,n)}}for(let u=0;u<r;u++)for(let e=0;e<t;e++){const t=u*l+e,r=u*l+e+1,o=(u+1)*l+e+1,i=(u+1)*l+e;n.push(t,r,i),n.push(r,o,i)}this.setIndex(n),this.setAttribute("position",new ma(o,3)),this.setAttribute("normal",new ma(i,3)),this.setAttribute("uv",new ma(a,2))}function Go(e,t,r,n){oa.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},this.fromBufferGeometry(new Mc(e,t,r,n)),this.mergeVertices()}function Mc(e,t,r,n){ia.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},r=r||1;const o=[],i=[];function a(e,t,r,n){const o=Math.pow(2,n),i=[];for(let a=0;a<=o;a++){i[a]=[];const n=e.clone().lerp(r,a/o),s=t.clone().lerp(r,a/o),d=o-a;for(let e=0;e<=d;e++)i[a][e]=0===e&&a===o?n:n.clone().lerp(s,e/d)}for(let a=0;a<o;a++)for(let e=0;e<2*(o-a)-1;e++){const t=Math.floor(e/2);e%2==0?(s(i[a][t+1]),s(i[a+1][t]),s(i[a][t])):(s(i[a][t+1]),s(i[a+1][t+1]),s(i[a+1][t]))}}function s(e){o.push(e.x,e.y,e.z)}function d(t,r){const n=3*t;r.x=e[n+0],r.y=e[n+1],r.z=e[n+2]}function $(e,t,r,n){n<0&&1===e.x&&(i[t]=e.x-1),0===r.x&&0===r.z&&(i[t]=n/2/Math.PI+.5)}function c(e){return Math.atan2(e.z,-e.x)}!function(e){const r=new ba,n=new ba,o=new ba;for(let i=0;i<t.length;i+=3)d(t[i+0],r),d(t[i+1],n),d(t[i+2],o),a(r,n,o,e)}(n=n||0),function(e){const t=new ba;for(let r=0;r<o.length;r+=3)t.x=o[r+0],t.y=o[r+1],t.z=o[r+2],t.normalize().multiplyScalar(e),o[r+0]=t.x,o[r+1]=t.y,o[r+2]=t.z}(r),function(){const e=new ba;for(let r=0;r<o.length;r+=3){e.x=o[r+0],e.y=o[r+1],e.z=o[r+2];const n=c(e)/2/Math.PI+.5,a=(t=e,Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5);i.push(n,1-a)}var t;(function(){const e=new ba,t=new ba,r=new ba,n=new ba,a=new ca,s=new ca,d=new ca;for(let p=0,l=0;p<o.length;p+=9,l+=6){e.set(o[p+0],o[p+1],o[p+2]),t.set(o[p+3],o[p+4],o[p+5]),r.set(o[p+6],o[p+7],o[p+8]),a.set(i[l+0],i[l+1]),s.set(i[l+2],i[l+3]),d.set(i[l+4],i[l+5]),n.copy(e).add(t).add(r).divideScalar(3);const u=c(n);$(a,l+0,e,u),$(s,l+2,t,u),$(d,l+4,r,u)}})(),function(){for(let e=0;e<i.length;e+=6){const t=i[e+0],r=i[e+2],n=i[e+4],o=Math.max(t,r,n),a=Math.min(t,r,n);o>.9&&a<.1&&(t<.2&&(i[e+0]+=1),r<.2&&(i[e+2]+=1),n<.2&&(i[e+4]+=1))}}()}(),this.setAttribute("position",new ma(o,3)),this.setAttribute("normal",new ma(o.slice(),3)),this.setAttribute("uv",new ma(i,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function Ho(e,t){oa.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ul(e,t)),this.mergeVertices()}function ul(e,t){Mc.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Io(e,t){oa.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Wi(e,t)),this.mergeVertices()}function Wi(e,t){Mc.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Jo(e,t){oa.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new vl(e,t)),this.mergeVertices()}function vl(e,t){const r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1];Mc.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ko(e,t){oa.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new wl(e,t)),this.mergeVertices()}function wl(e,t){const r=(1+Math.sqrt(5))/2,n=1/r,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n];Mc.call(this,o,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Lo(e,t,r,n,o,i){oa.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:o},void 0!==i&&console.warn("THREE.TubeGeometry: taper has been removed.");const a=new Xi(e,t,r,n,o);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Xi(e,t,r,n,o){ia.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:o},t=t||64,r=r||1,n=n||8,o=o||!1;const i=e.computeFrenetFrames(t,o);this.tangents=i.tangents,this.normals=i.normals,this.binormals=i.binormals;const a=new ba,s=new ba,d=new ca;let $=new ba;const c=[],p=[],l=[],u=[];function h(o){$=e.getPointAt(o/t,$);const d=i.normals[o],l=i.binormals[o];for(let e=0;e<=n;e++){const t=e/n*Math.PI*2,o=Math.sin(t),i=-Math.cos(t);s.x=i*d.x+o*l.x,s.y=i*d.y+o*l.y,s.z=i*d.z+o*l.z,s.normalize(),p.push(s.x,s.y,s.z),a.x=$.x+r*s.x,a.y=$.y+r*s.y,a.z=$.z+r*s.z,c.push(a.x,a.y,a.z)}}!function(){for(let e=0;e<t;e++)h(e);h(!1===o?t:0),function(){for(let e=0;e<=t;e++)for(let r=0;r<=n;r++)d.x=e/t,d.y=r/n,l.push(d.x,d.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=n;t++){const r=(n+1)*(e-1)+(t-1),o=(n+1)*e+(t-1),i=(n+1)*e+t,a=(n+1)*(e-1)+t;u.push(r,o,a),u.push(o,i,a)}}()}(),this.setIndex(u),this.setAttribute("position",new ma(c,3)),this.setAttribute("normal",new ma(p,3)),this.setAttribute("uv",new ma(l,2))}function Mo(e,t,r,n,o,i,a){oa.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:o,q:i},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new xl(e,t,r,n,o,i)),this.mergeVertices()}function xl(e,t,r,n,o,i){ia.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:o,q:i},e=e||1,t=t||.4,r=Math.floor(r)||64,n=Math.floor(n)||8,o=o||2,i=i||3;const a=[],s=[],d=[],$=[],c=new ba,p=new ba,l=new ba,u=new ba,h=new ba,f=new ba,m=new ba;for(let R=0;R<=r;++R){const a=R/r*o*Math.PI*2;x(a,o,i,e,l),x(a+.01,o,i,e,u),f.subVectors(u,l),m.addVectors(u,l),h.crossVectors(f,m),m.crossVectors(h,f),h.normalize(),m.normalize();for(let e=0;e<=n;++e){const o=e/n*Math.PI*2,i=-t*Math.cos(o),a=t*Math.sin(o);c.x=l.x+(i*m.x+a*h.x),c.y=l.y+(i*m.y+a*h.y),c.z=l.z+(i*m.z+a*h.z),s.push(c.x,c.y,c.z),p.subVectors(c,l).normalize(),d.push(p.x,p.y,p.z),$.push(R/r),$.push(e/n)}}for(let R=1;R<=r;R++)for(let e=1;e<=n;e++){const t=(n+1)*(R-1)+(e-1),r=(n+1)*R+(e-1),o=(n+1)*R+e,i=(n+1)*(R-1)+e;a.push(t,r,i),a.push(r,o,i)}function x(e,t,r,n,o){const i=Math.cos(e),a=Math.sin(e),s=r/t*e,d=Math.cos(s);o.x=n*(2+d)*.5*i,o.y=n*(2+d)*a*.5,o.z=n*Math.sin(s)*.5}this.setIndex(a),this.setAttribute("position",new ma(s,3)),this.setAttribute("normal",new ma(d,3)),this.setAttribute("uv",new ma($,2))}function No(e,t,r,n,o){oa.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:o},this.fromBufferGeometry(new yl(e,t,r,n,o)),this.mergeVertices()}function yl(e,t,r,n,o){ia.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:o},e=e||1,t=t||.4,r=Math.floor(r)||8,n=Math.floor(n)||6,o=o||2*Math.PI;const i=[],a=[],s=[],d=[],$=new ba,c=new ba,p=new ba;for(let l=0;l<=r;l++)for(let i=0;i<=n;i++){const u=i/n*o,h=l/r*Math.PI*2;c.x=(e+t*Math.cos(h))*Math.cos(u),c.y=(e+t*Math.cos(h))*Math.sin(u),c.z=t*Math.sin(h),a.push(c.x,c.y,c.z),$.x=e*Math.cos(u),$.y=e*Math.sin(u),p.subVectors(c,$).normalize(),s.push(p.x,p.y,p.z),d.push(i/n),d.push(l/r)}for(let l=1;l<=r;l++)for(let e=1;e<=n;e++){const t=(n+1)*l+e-1,r=(n+1)*(l-1)+e-1,o=(n+1)*(l-1)+e,a=(n+1)*l+e;i.push(t,r,a),i.push(r,o,a)}this.setIndex(i),this.setAttribute("position",new ma(a,3)),this.setAttribute("normal",new ma(s,3)),this.setAttribute("uv",new ma(d,2))}Co.prototype=Object.assign(Object.create(ja.prototype),{constructor:Co,isPoints:!0,copy:function(e){return ja.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,t){const r=this.geometry,n=this.matrixWorld,o=e.params.Points.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),Ao.copy(r.boundingSphere),Ao.applyMatrix4(n),Ao.radius+=o,!1===e.ray.intersectsSphere(Ao))return;OA.getInverse(n),$s.copy(e.ray).applyMatrix4(OA);const i=o/((this.scale.x+this.scale.y+this.scale.z)/3),a=i*i;if(r.isBufferGeometry){const o=r.index,i=r.attributes.position.array;if(null!==o){const r=o.array;for(let o=0,s=r.length;o<s;o++){const s=r[o];Bo.fromArray(i,3*s),_s(Bo,s,a,n,e,t,this)}}else for(let r=0,s=i.length/3;r<s;r++)Bo.fromArray(i,3*r),_s(Bo,r,a,n,e,t,this)}else{const o=r.vertices;for(let r=0,i=o.length;r<i;r++)_s(o[r],r,a,n,e,t,this)}},updateMorphTargets:function(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const e=t[r[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,r=e.length;t<r;t++){const r=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),PA.prototype=Object.assign(Object.create($a.prototype),{constructor:PA,isVideoTexture:!0,update:function(){const e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),rl.prototype=Object.create($a.prototype),rl.prototype.constructor=rl,rl.prototype.isCompressedTexture=!0,sl.prototype=Object.create($a.prototype),sl.prototype.constructor=sl,sl.prototype.isCanvasTexture=!0,Do.prototype=Object.create($a.prototype),Do.prototype.constructor=Do,Do.prototype.isDepthTexture=!0,Eo.prototype=Object.create(ia.prototype),Eo.prototype.constructor=Eo,Fo.prototype=Object.create(oa.prototype),Fo.prototype.constructor=Fo,tl.prototype=Object.create(ia.prototype),tl.prototype.constructor=tl,Go.prototype=Object.create(oa.prototype),Go.prototype.constructor=Go,Mc.prototype=Object.create(ia.prototype),Mc.prototype.constructor=Mc,Ho.prototype=Object.create(oa.prototype),Ho.prototype.constructor=Ho,ul.prototype=Object.create(Mc.prototype),ul.prototype.constructor=ul,Io.prototype=Object.create(oa.prototype),Io.prototype.constructor=Io,Wi.prototype=Object.create(Mc.prototype),Wi.prototype.constructor=Wi,Jo.prototype=Object.create(oa.prototype),Jo.prototype.constructor=Jo,vl.prototype=Object.create(Mc.prototype),vl.prototype.constructor=vl,Ko.prototype=Object.create(oa.prototype),Ko.prototype.constructor=Ko,wl.prototype=Object.create(Mc.prototype),wl.prototype.constructor=wl,Lo.prototype=Object.create(oa.prototype),Lo.prototype.constructor=Lo,Xi.prototype=Object.create(ia.prototype),Xi.prototype.constructor=Xi,Xi.prototype.toJSON=function(){const e=ia.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},Mo.prototype=Object.create(oa.prototype),Mo.prototype.constructor=Mo,xl.prototype=Object.create(ia.prototype),xl.prototype.constructor=xl,No.prototype=Object.create(oa.prototype),No.prototype.constructor=No,yl.prototype=Object.create(ia.prototype),yl.prototype.constructor=yl;const AW={triangulate:function(e,t,r){r=r||2;let n,o,i,a,s,d,$,c=t&&t.length,p=c?t[0]*r:e.length,l=QA(e,0,p,r,!0),u=[];if(!l||l.next===l.prev)return u;if(c&&(l=FW(e,t,l,r)),e.length>80*r){n=i=e[0],o=a=e[1];for(let t=r;t<p;t+=r)(s=e[t])<n&&(n=s),(d=e[t+1])<o&&(o=d),s>i&&(i=s),d>a&&(a=d);$=0!==($=Math.max(i-n,a-o))?1/$:0}return zl(l,u,r,n,o,$),u}};function QA(e,t,r,n,o){let i,a;if(o===QW(e,t,r,n)>0)for(i=t;i<r;i+=n)a=TA(i,e[i],e[i+1],a);else for(i=r-n;i>=t;i-=n)a=TA(i,e[i],e[i+1],a);return a&&Oo(a,a.next)&&(Bl(a),a=a.next),a}function cg(e,t){if(!e)return e;t||(t=e);let r,n=e;do{if(r=!1,n.steiner||!Oo(n,n.next)&&0!==pb(n.prev,n,n.next))n=n.next;else{if(Bl(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function zl(e,t,r,n,o,i,a){if(!e)return;!a&&i&&KW(e,n,o,i);let s,d,$=e;for(;e.prev!==e.next;)if(s=e.prev,d=e.next,i?CW(e,n,o,i):BW(e))t.push(s.i/r),t.push(e.i/r),t.push(d.i/r),Bl(e),e=d.next,$=d.next;else if((e=d)===$){a?1===a?zl(e=DW(cg(e),t,r),t,r,n,o,i,2):2===a&&EW(e,t,r,n,o,i):zl(cg(e),t,r,n,o,i,1);break}}function BW(e){let t=e.prev,r=e,n=e.next;if(pb(t,r,n)>=0)return!1;let o=e.next.next;for(;o!==e.prev;){if(Yi(t.x,t.y,r.x,r.y,n.x,n.y,o.x,o.y)&&pb(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function CW(e,t,r,n){let o=e.prev,i=e,a=e.next;if(pb(o,i,a)>=0)return!1;let s=o.x<i.x?o.x<a.x?o.x:a.x:i.x<a.x?i.x:a.x,d=o.y<i.y?o.y<a.y?o.y:a.y:i.y<a.y?i.y:a.y,$=o.x>i.x?o.x>a.x?o.x:a.x:i.x>a.x?i.x:a.x,c=o.y>i.y?o.y>a.y?o.y:a.y:i.y>a.y?i.y:a.y,p=at(s,d,t,r,n),l=at($,c,t,r,n),u=e.prevZ,h=e.nextZ;for(;u&&u.z>=p&&h&&h.z<=l;){if(u!==e.prev&&u!==e.next&&Yi(o.x,o.y,i.x,i.y,a.x,a.y,u.x,u.y)&&pb(u.prev,u,u.next)>=0)return!1;if(u=u.prevZ,h!==e.prev&&h!==e.next&&Yi(o.x,o.y,i.x,i.y,a.x,a.y,h.x,h.y)&&pb(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;u&&u.z>=p;){if(u!==e.prev&&u!==e.next&&Yi(o.x,o.y,i.x,i.y,a.x,a.y,u.x,u.y)&&pb(u.prev,u,u.next)>=0)return!1;u=u.prevZ}for(;h&&h.z<=l;){if(h!==e.prev&&h!==e.next&&Yi(o.x,o.y,i.x,i.y,a.x,a.y,h.x,h.y)&&pb(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function DW(e,t,r){let n=e;do{let o=n.prev,i=n.next.next;!Oo(o,i)&&RA(o,n,n.next,i)&&Al(o,i)&&Al(i,o)&&(t.push(o.i/r),t.push(n.i/r),t.push(i.i/r),Bl(n),Bl(n.next),n=e=i),n=n.next}while(n!==e);return cg(n)}function EW(e,t,r,n,o,i){let a=e;do{let e=a.next.next;for(;e!==a.prev;){if(a.i!==e.i&&NW(a,e)){let s=SA(a,e);return a=cg(a,a.next),s=cg(s,s.next),zl(a,t,r,n,o,i),void zl(s,t,r,n,o,i)}e=e.next}a=a.next}while(a!==e)}function FW(e,t,r,n){let o,i,a,s,d,$=[];for(o=0,i=t.length;o<i;o++)(d=QA(e,a=t[o]*n,s=o<i-1?t[o+1]*n:e.length,n,!1))===d.next&&(d.steiner=!0),$.push(MW(d));for($.sort(GW),o=0;o<$.length;o++)HW($[o],r),r=cg(r,r.next);return r}function GW(e,t){return e.x-t.x}function HW(e,t){if(t=IW(e,t)){const r=SA(t,e);cg(t,t.next),cg(r,r.next)}}function IW(e,t){let r,n=t,o=e.x,i=e.y,a=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){let e=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=o&&e>a){if(a=e,e===o){if(i===n.y)return n;if(i===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(o===a)return r;let s,d=r,$=r.x,c=r.y,p=1/0;n=r;do{o>=n.x&&n.x>=$&&o!==n.x&&Yi(i<c?o:a,i,$,c,i<c?a:o,i,n.x,n.y)&&(s=Math.abs(i-n.y)/(o-n.x),Al(n,e)&&(s<p||s===p&&(n.x>r.x||n.x===r.x&&JW(r,n)))&&(r=n,p=s)),n=n.next}while(n!==d);return r}function JW(e,t){return pb(e.prev,e,t.prev)<0&&pb(t.next,e,e.next)<0}function KW(e,t,r,n){let o=e;do{null===o.z&&(o.z=at(o.x,o.y,t,r,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,LW(o)}function LW(e){let t,r,n,o,i,a,s,d,$=1;do{for(r=e,e=null,i=null,a=0;r;){for(a++,n=r,s=0,t=0;t<$&&(s++,n=n.nextZ);t++);for(d=$;s>0||d>0&&n;)0!==s&&(0===d||!n||r.z<=n.z)?(o=r,r=r.nextZ,s--):(o=n,n=n.nextZ,d--),i?i.nextZ=o:e=o,o.prevZ=i,i=o;r=n}i.nextZ=null,$*=2}while(a>1);return e}function at(e,t,r,n,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*o)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*o)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function MW(e){let t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Yi(e,t,r,n,o,i,a,s){return(o-a)*(t-s)-(e-a)*(i-s)>=0&&(e-a)*(n-s)-(r-a)*(t-s)>=0&&(r-a)*(i-s)-(o-a)*(n-s)>=0}function NW(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!OW(e,t)&&(Al(e,t)&&Al(t,e)&&PW(e,t)&&(pb(e.prev,e,t.prev)||pb(e,t.prev,t))||Oo(e,t)&&pb(e.prev,e,e.next)>0&&pb(t.prev,t,t.next)>0)}function pb(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Oo(e,t){return e.x===t.x&&e.y===t.y}function RA(e,t,r,n){const o=Qo(pb(e,t,r)),i=Qo(pb(e,t,n)),a=Qo(pb(r,n,e)),s=Qo(pb(r,n,t));return o!==i&&a!==s||!(0!==o||!Po(e,r,t))||!(0!==i||!Po(e,n,t))||!(0!==a||!Po(r,e,n))||!(0!==s||!Po(r,t,n))}function Po(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Qo(e){return e>0?1:e<0?-1:0}function OW(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&RA(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Al(e,t){return pb(e.prev,e,e.next)<0?pb(e,t,e.next)>=0&&pb(e,e.prev,t)>=0:pb(e,t,e.prev)<0||pb(e,e.next,t)<0}function PW(e,t){let r=e,n=!1,o=(e.x+t.x)/2,i=(e.y+t.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&o<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}function SA(e,t){let r=new bt(e.i,e.x,e.y),n=new bt(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,r.next=o,o.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function TA(e,t,r,n){const o=new bt(e,t,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Bl(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function bt(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function QW(e,t,r,n){let o=0;for(let i=t,a=r-n;i<r;i+=n)o+=(e[a]-e[i])*(e[i+1]+e[a+1]),a=i;return o}const dg={area:function(e){const t=e.length;let r=0;for(let n=t-1,o=0;o<t;n=o++)r+=e[n].x*e[o].y-e[o].x*e[n].y;return .5*r},isClockWise:function(e){return dg.area(e)<0},triangulateShape:function(e,t){const r=[],n=[],o=[];UA(e),VA(r,e);let i=e.length;t.forEach(UA);for(let s=0;s<t.length;s++)n.push(i),i+=t[s].length,VA(r,t[s]);const a=AW.triangulate(r,n);for(let s=0;s<a.length;s+=3)o.push(a.slice(s,s+3));return o}};function UA(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function VA(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}function Zi(e,t){oa.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Ye(e,t)),this.mergeVertices()}function Ye(e,t){ia.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,n=[],o=[];for(let a=0,s=e.length;a<s;a++){i(e[a])}function i(e){const i=[],a=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1;let d=void 0!==t.depth?t.depth:100,$=void 0===t.bevelEnabled||t.bevelEnabled,c=void 0!==t.bevelThickness?t.bevelThickness:6,p=void 0!==t.bevelSize?t.bevelSize:c-2,l=void 0!==t.bevelOffset?t.bevelOffset:0,u=void 0!==t.bevelSegments?t.bevelSegments:3;const h=t.extrudePath,f=void 0!==t.UVGenerator?t.UVGenerator:RW;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),d=t.amount);let m,x,R,g,v,q=!1;h&&(m=h.getSpacedPoints(s),q=!0,$=!1,x=h.computeFrenetFrames(s,!1),R=new ba,g=new ba,v=new ba),$||(u=0,c=0,p=0,l=0);const K=e.extractPoints(a);let y=K.shape;const _=K.holes;if(!dg.isClockWise(y)){y=y.reverse();for(let e=0,t=_.length;e<t;e++){const t=_[e];dg.isClockWise(t)&&(_[e]=t.reverse())}}const b=dg.triangulateShape(y,_),M=y;for(let t=0,r=_.length;t<r;t++){const e=_[t];y=y.concat(e)}function w(e,t,r){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(r).add(e)}const S=y.length,T=b.length;function A(e,t,r){let n,o,i;const a=e.x-t.x,s=e.y-t.y,d=r.x-e.x,$=r.y-e.y,c=a*a+s*s,p=a*$-s*d;if(Math.abs(p)>Number.EPSILON){const p=Math.sqrt(c),l=Math.sqrt(d*d+$*$),u=t.x-s/p,h=t.y+a/p,f=((r.x-$/l-u)*$-(r.y+d/l-h)*d)/(a*$-s*d),m=(n=u+a*f-e.x)*n+(o=h+s*f-e.y)*o;if(m<=2)return new ca(n,o);i=Math.sqrt(m/2)}else{let e=!1;a>Number.EPSILON?d>Number.EPSILON&&(e=!0):a<-Number.EPSILON?d<-Number.EPSILON&&(e=!0):Math.sign(s)===Math.sign($)&&(e=!0),e?(n=-s,o=a,i=Math.sqrt(c)):(n=a,o=s,i=Math.sqrt(c/2))}return new ca(n/i,o/i)}const E=[];for(let t=0,r=M.length,n=r-1,o=t+1;t<r;t++,n++,o++)n===r&&(n=0),o===r&&(o=0),E[t]=A(M[t],M[n],M[o]);const L=[];let C,B=E.concat();for(let t=0,r=_.length;t<r;t++){const e=_[t];C=[];for(let t=0,r=e.length,n=r-1,o=t+1;t<r;t++,n++,o++)n===r&&(n=0),o===r&&(o=0),C[t]=A(e[t],e[n],e[o]);L.push(C),B=B.concat(C)}for(let t=0;t<u;t++){const e=t/u,r=c*Math.cos(e*Math.PI/2),n=p*Math.sin(e*Math.PI/2)+l;for(let t=0,o=M.length;t<o;t++){const e=w(M[t],E[t],n);D(e.x,e.y,-r)}for(let t=0,o=_.length;t<o;t++){const e=_[t];C=L[t];for(let t=0,o=e.length;t<o;t++){const o=w(e[t],C[t],n);D(o.x,o.y,-r)}}}const P=p+l;for(let t=0;t<S;t++){const e=$?w(y[t],B[t],P):y[t];q?(g.copy(x.normals[0]).multiplyScalar(e.x),R.copy(x.binormals[0]).multiplyScalar(e.y),v.copy(m[0]).add(g).add(R),D(v.x,v.y,v.z)):D(e.x,e.y,0)}for(let t=1;t<=s;t++)for(let e=0;e<S;e++){const r=$?w(y[e],B[e],P):y[e];q?(g.copy(x.normals[t]).multiplyScalar(r.x),R.copy(x.binormals[t]).multiplyScalar(r.y),v.copy(m[t]).add(g).add(R),D(v.x,v.y,v.z)):D(r.x,r.y,d/s*t)}for(let t=u-1;t>=0;t--){const e=t/u,r=c*Math.cos(e*Math.PI/2),n=p*Math.sin(e*Math.PI/2)+l;for(let t=0,o=M.length;t<o;t++){const e=w(M[t],E[t],n);D(e.x,e.y,d+r)}for(let t=0,o=_.length;t<o;t++){const e=_[t];C=L[t];for(let t=0,o=e.length;t<o;t++){const o=w(e[t],C[t],n);q?D(o.x,o.y+m[s-1].y,m[s-1].x+r):D(o.x,o.y,d+r)}}}function G(e,t){let r=e.length;for(;--r>=0;){const n=r;let o=r-1;o<0&&(o=e.length-1);for(let e=0,r=s+2*u;e<r;e++){const r=S*e,i=S*(e+1);O(t+n+r,t+o+r,t+o+i,t+n+i)}}}function D(e,t,r){i.push(e),i.push(t),i.push(r)}function I(e,t,o){F(e),F(t),F(o);const i=n.length/3,a=f.generateTopUV(r,n,i-3,i-2,i-1);N(a[0]),N(a[1]),N(a[2])}function O(e,t,o,i){F(e),F(t),F(i),F(t),F(o),F(i);const a=n.length/3,s=f.generateSideWallUV(r,n,a-6,a-3,a-2,a-1);N(s[0]),N(s[1]),N(s[3]),N(s[1]),N(s[2]),N(s[3])}function F(e){n.push(i[3*e+0]),n.push(i[3*e+1]),n.push(i[3*e+2])}function N(e){o.push(e.x),o.push(e.y)}!function(){const e=n.length/3;if($){let e=0,t=S*e;for(let r=0;r<T;r++){const e=b[r];I(e[2]+t,e[1]+t,e[0]+t)}t=S*(e=s+2*u);for(let r=0;r<T;r++){const e=b[r];I(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<T;e++){const t=b[e];I(t[2],t[1],t[0])}for(let e=0;e<T;e++){const t=b[e];I(t[0]+S*s,t[1]+S*s,t[2]+S*s)}}r.addGroup(e,n.length/3-e,0)}(),function(){const e=n.length/3;let t=0;G(M,t),t+=M.length;for(let r=0,n=_.length;r<n;r++){const e=_[r];G(e,t),t+=e.length}r.addGroup(e,n.length/3-e,1)}()}this.setAttribute("position",new ma(n,3)),this.setAttribute("uv",new ma(o,2)),this.computeVertexNormals()}Zi.prototype=Object.create(oa.prototype),Zi.prototype.constructor=Zi,Zi.prototype.toJSON=function(){const e=oa.prototype.toJSON.call(this);return WA(this.parameters.shapes,this.parameters.options,e)},Ye.prototype=Object.create(ia.prototype),Ye.prototype.constructor=Ye,Ye.prototype.toJSON=function(){const e=ia.prototype.toJSON.call(this);return WA(this.parameters.shapes,this.parameters.options,e)};const RW={generateTopUV:function(e,t,r,n,o){const i=t[3*r],a=t[3*r+1],s=t[3*n],d=t[3*n+1],$=t[3*o],c=t[3*o+1];return[new ca(i,a),new ca(s,d),new ca($,c)]},generateSideWallUV:function(e,t,r,n,o,i){const a=t[3*r],s=t[3*r+1],d=t[3*r+2],$=t[3*n],c=t[3*n+1],p=t[3*n+2],l=t[3*o],u=t[3*o+1],h=t[3*o+2],f=t[3*i],m=t[3*i+1],x=t[3*i+2];return Math.abs(s-c)<.01?[new ca(a,1-d),new ca($,1-p),new ca(l,1-h),new ca(f,1-x)]:[new ca(s,1-d),new ca(c,1-p),new ca(u,1-h),new ca(m,1-x)]}};function WA(e,t,r){if(r.shapes=[],Array.isArray(e))for(let n=0,o=e.length;n<o;n++){const t=e[n];r.shapes.push(t.uuid)}else r.shapes.push(e.uuid);return void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON()),r}function Ro(e,t){oa.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Cl(e,t)),this.mergeVertices()}function Cl(e,t){const r=(t=t||{}).font;if(!r||!r.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new oa;const n=r.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Ye.call(this,n,t),this.type="TextBufferGeometry"}function Dl(e,t,r,n,o,i,a){oa.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:o,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new $i(e,t,r,n,o,i,a)),this.mergeVertices()}function $i(e,t,r,n,o,i,a){ia.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:o,thetaStart:i,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),r=Math.max(2,Math.floor(r)||6),n=void 0!==n?n:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?i:0,a=void 0!==a?a:Math.PI;const s=Math.min(i+a,Math.PI);let d=0;const $=[],c=new ba,p=new ba,l=[],u=[],h=[],f=[];for(let m=0;m<=r;m++){const l=[],x=m/r;let R=0;0==m&&0==i?R=.5/t:m==r&&s==Math.PI&&(R=-.5/t);for(let r=0;r<=t;r++){const s=r/t;c.x=-e*Math.cos(n+s*o)*Math.sin(i+x*a),c.y=e*Math.cos(i+x*a),c.z=e*Math.sin(n+s*o)*Math.sin(i+x*a),u.push(c.x,c.y,c.z),p.copy(c).normalize(),h.push(p.x,p.y,p.z),f.push(s+R,1-x),l.push(d++)}$.push(l)}for(let m=0;m<r;m++)for(let e=0;e<t;e++){const t=$[m][e+1],n=$[m][e],o=$[m+1][e],a=$[m+1][e+1];(0!==m||i>0)&&l.push(t,n,a),(m!==r-1||s<Math.PI)&&l.push(n,o,a)}this.setIndex(l),this.setAttribute("position",new ma(u,3)),this.setAttribute("normal",new ma(h,3)),this.setAttribute("uv",new ma(f,2))}function So(e,t,r,n,o,i){oa.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:o,thetaLength:i},this.fromBufferGeometry(new El(e,t,r,n,o,i)),this.mergeVertices()}function El(e,t,r,n,o,i){ia.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:o,thetaLength:i},e=e||.5,t=t||1,o=void 0!==o?o:0,i=void 0!==i?i:2*Math.PI,r=void 0!==r?Math.max(3,r):8;const a=[],s=[],d=[],$=[];let c=e;const p=(t-e)/(n=void 0!==n?Math.max(1,n):1),l=new ba,u=new ca;for(let h=0;h<=n;h++){for(let e=0;e<=r;e++){const n=o+e/r*i;l.x=c*Math.cos(n),l.y=c*Math.sin(n),s.push(l.x,l.y,l.z),d.push(0,0,1),u.x=(l.x/t+1)/2,u.y=(l.y/t+1)/2,$.push(u.x,u.y)}c+=p}for(let h=0;h<n;h++){const e=h*(r+1);for(let t=0;t<r;t++){const n=t+e,o=n,i=n+r+1,s=n+r+2,d=n+1;a.push(o,i,d),a.push(i,s,d)}}this.setIndex(a),this.setAttribute("position",new ma(s,3)),this.setAttribute("normal",new ma(d,3)),this.setAttribute("uv",new ma($,2))}function To(e,t,r,n){oa.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},this.fromBufferGeometry(new Fl(e,t,r,n)),this.mergeVertices()}function Fl(e,t,r,n){ia.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Math.floor(t)||12,r=r||0,n=n||2*Math.PI,n=ta.clamp(n,0,2*Math.PI);const o=[],i=[],a=[],s=1/t,d=new ba,$=new ca;for(let c=0;c<=t;c++){const o=r+c*s*n,p=Math.sin(o),l=Math.cos(o);for(let r=0;r<=e.length-1;r++)d.x=e[r].x*p,d.y=e[r].y,d.z=e[r].x*l,i.push(d.x,d.y,d.z),$.x=c/t,$.y=r/(e.length-1),a.push($.x,$.y)}for(let c=0;c<t;c++)for(let t=0;t<e.length-1;t++){const r=t+c*e.length,n=r,i=r+e.length,a=r+e.length+1,s=r+1;o.push(n,i,s),o.push(i,a,s)}if(this.setIndex(o),this.setAttribute("position",new ma(i,3)),this.setAttribute("uv",new ma(a,2)),this.computeVertexNormals(),n===2*Math.PI){const r=this.attributes.normal.array,n=new ba,o=new ba,i=new ba,a=t*e.length*3;for(let t=0,s=0;t<e.length;t++,s+=3)n.x=r[s+0],n.y=r[s+1],n.z=r[s+2],o.x=r[a+s+0],o.y=r[a+s+1],o.z=r[a+s+2],i.addVectors(n,o).normalize(),r[s+0]=r[a+s+0]=i.x,r[s+1]=r[a+s+1]=i.y,r[s+2]=r[a+s+2]=i.z}}function cd(e,t){oa.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new _i(e,t)),this.mergeVertices()}function _i(e,t){ia.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;const r=[],n=[],o=[],i=[];let a=0,s=0;if(!1===Array.isArray(e))d(e);else for(let $=0;$<e.length;$++)d(e[$]),this.addGroup(a,s,$),a+=s,s=0;function d(e){const a=n.length/3,d=e.extractPoints(t);let $=d.shape;const c=d.holes;!1===dg.isClockWise($)&&($=$.reverse());for(let t=0,r=c.length;t<r;t++){const e=c[t];!0===dg.isClockWise(e)&&(c[t]=e.reverse())}const p=dg.triangulateShape($,c);for(let t=0,r=c.length;t<r;t++){const e=c[t];$=$.concat(e)}for(let t=0,r=$.length;t<r;t++){const e=$[t];n.push(e.x,e.y,0),o.push(0,0,1),i.push(e.x,e.y)}for(let t=0,n=p.length;t<n;t++){const e=p[t],n=e[0]+a,o=e[1]+a,i=e[2]+a;r.push(n,o,i),s+=3}}this.setIndex(r),this.setAttribute("position",new ma(n,3)),this.setAttribute("normal",new ma(o,3)),this.setAttribute("uv",new ma(i,2))}function XA(e,t){if(t.shapes=[],Array.isArray(e))for(let r=0,n=e.length;r<n;r++){const n=e[r];t.shapes.push(n.uuid)}else t.shapes.push(e.uuid);return t}function gh(e,t){ia.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;const r=[],n=Math.cos(ta.DEG2RAD*t),o=[0,0],i={};let a,s,d;const $=["a","b","c"];let c;e.isBufferGeometry?(c=new oa).fromBufferGeometry(e):c=e.clone(),c.mergeVertices(),c.computeFaceNormals();const p=c.vertices,l=c.faces;for(let u=0,h=l.length;u<h;u++){const e=l[u];for(let t=0;t<3;t++)a=e[$[t]],s=e[$[(t+1)%3]],o[0]=Math.min(a,s),o[1]=Math.max(a,s),void 0===i[d=o[0]+","+o[1]]?i[d]={index1:o[0],index2:o[1],face1:u,face2:void 0}:i[d].face2=u}for(d in i){const e=i[d];if(void 0===e.face2||l[e.face1].normal.dot(l[e.face2].normal)<=n){let t=p[e.index1];r.push(t.x,t.y,t.z),t=p[e.index2],r.push(t.x,t.y,t.z)}}this.setAttribute("position",new ma(r,3))}function aj(e,t,r,n,o,i,a,s){oa.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:o,openEnded:i,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new eg(e,t,r,n,o,i,a,s)),this.mergeVertices()}function eg(e,t,r,n,o,i,a,s){ia.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:o,openEnded:i,thetaStart:a,thetaLength:s};const d=this;e=void 0!==e?e:1,t=void 0!==t?t:1,r=r||1,n=Math.floor(n)||8,o=Math.floor(o)||1,i=void 0!==i&&i,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;const $=[],c=[],p=[],l=[];let u=0;const h=[],f=r/2;let m=0;function x(r){let o,i;const h=new ca,x=new ba;let R=0;const g=!0===r?e:t,v=!0===r?1:-1;o=u;for(let e=1;e<=n;e++)c.push(0,f*v,0),p.push(0,v,0),l.push(.5,.5),u++;i=u;for(let e=0;e<=n;e++){const t=e/n*s+a,r=Math.cos(t),o=Math.sin(t);x.x=g*o,x.y=f*v,x.z=g*r,c.push(x.x,x.y,x.z),p.push(0,v,0),h.x=.5*r+.5,h.y=.5*o*v+.5,l.push(h.x,h.y),u++}for(let e=0;e<n;e++){const t=o+e,n=i+e;!0===r?$.push(n,n+1,t):$.push(n+1,n,t),R+=3}d.addGroup(m,R,!0===r?1:2),m+=R}!function(){const i=new ba,x=new ba;let R=0;const g=(t-e)/r;for(let d=0;d<=o;d++){const $=[],m=d/o,R=m*(t-e)+e;for(let e=0;e<=n;e++){const t=e/n,o=t*s+a,d=Math.sin(o),h=Math.cos(o);x.x=R*d,x.y=-m*r+f,x.z=R*h,c.push(x.x,x.y,x.z),i.set(d,g,h).normalize(),p.push(i.x,i.y,i.z),l.push(t,1-m),$.push(u++)}h.push($)}for(let e=0;e<n;e++)for(let t=0;t<o;t++){const r=h[t][e],n=h[t+1][e],o=h[t+1][e+1],i=h[t][e+1];$.push(r,n,i),$.push(n,o,i),R+=6}d.addGroup(m,R,0),m+=R}(),!1===i&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex($),this.setAttribute("position",new ma(c,3)),this.setAttribute("normal",new ma(p,3)),this.setAttribute("uv",new ma(l,2))}function Uo(e,t,r,n,o,i,a){aj.call(this,0,e,t,r,n,o,i,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:o,thetaStart:i,thetaLength:a}}function Vo(e,t,r,n,o,i,a){eg.call(this,0,e,t,r,n,o,i,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:o,thetaStart:i,thetaLength:a}}function Wo(e,t,r,n){oa.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},this.fromBufferGeometry(new Gl(e,t,r,n)),this.mergeVertices()}function Gl(e,t,r,n){ia.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},e=e||1,t=void 0!==t?Math.max(3,t):8,r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;const o=[],i=[],a=[],s=[],d=new ba,$=new ca;i.push(0,0,0),a.push(0,0,1),s.push(.5,.5);for(let c=0,p=3;c<=t;c++,p+=3){const o=r+c/t*n;d.x=e*Math.cos(o),d.y=e*Math.sin(o),i.push(d.x,d.y,d.z),a.push(0,0,1),$.x=(i[p]/e+1)/2,$.y=(i[p+1]/e+1)/2,s.push($.x,$.y)}for(let c=1;c<=t;c++)o.push(c,c+1,0);this.setIndex(o),this.setAttribute("position",new ma(i,3)),this.setAttribute("normal",new ma(a,3)),this.setAttribute("uv",new ma(s,2))}Ro.prototype=Object.create(oa.prototype),Ro.prototype.constructor=Ro,Cl.prototype=Object.create(Ye.prototype),Cl.prototype.constructor=Cl,Dl.prototype=Object.create(oa.prototype),Dl.prototype.constructor=Dl,$i.prototype=Object.create(ia.prototype),$i.prototype.constructor=$i,So.prototype=Object.create(oa.prototype),So.prototype.constructor=So,El.prototype=Object.create(ia.prototype),El.prototype.constructor=El,To.prototype=Object.create(oa.prototype),To.prototype.constructor=To,Fl.prototype=Object.create(ia.prototype),Fl.prototype.constructor=Fl,cd.prototype=Object.create(oa.prototype),cd.prototype.constructor=cd,cd.prototype.toJSON=function(){const e=oa.prototype.toJSON.call(this);return XA(this.parameters.shapes,e)},_i.prototype=Object.create(ia.prototype),_i.prototype.constructor=_i,_i.prototype.toJSON=function(){const e=ia.prototype.toJSON.call(this);return XA(this.parameters.shapes,e)},gh.prototype=Object.create(ia.prototype),gh.prototype.constructor=gh,aj.prototype=Object.create(oa.prototype),aj.prototype.constructor=aj,eg.prototype=Object.create(ia.prototype),eg.prototype.constructor=eg,Uo.prototype=Object.create(aj.prototype),Uo.prototype.constructor=Uo,Vo.prototype=Object.create(eg.prototype),Vo.prototype.constructor=Vo,Wo.prototype=Object.create(oa.prototype),Wo.prototype.constructor=Wo,Gl.prototype=Object.create(ia.prototype),Gl.prototype.constructor=Gl;var oc=Object.freeze({__proto__:null,WireframeGeometry:Eo,ParametricGeometry:Fo,ParametricBufferGeometry:tl,TetrahedronGeometry:Ho,TetrahedronBufferGeometry:ul,OctahedronGeometry:Io,OctahedronBufferGeometry:Wi,IcosahedronGeometry:Jo,IcosahedronBufferGeometry:vl,DodecahedronGeometry:Ko,DodecahedronBufferGeometry:wl,PolyhedronGeometry:Go,PolyhedronBufferGeometry:Mc,TubeGeometry:Lo,TubeBufferGeometry:Xi,TorusKnotGeometry:Mo,TorusKnotBufferGeometry:xl,TorusGeometry:No,TorusBufferGeometry:yl,TextGeometry:Ro,TextBufferGeometry:Cl,SphereGeometry:Dl,SphereBufferGeometry:$i,RingGeometry:So,RingBufferGeometry:El,PlaneGeometry:lo,PlaneBufferGeometry:Ri,LatheGeometry:To,LatheBufferGeometry:Fl,ShapeGeometry:cd,ShapeBufferGeometry:_i,ExtrudeGeometry:Zi,ExtrudeBufferGeometry:Ye,EdgesGeometry:gh,ConeGeometry:Uo,ConeBufferGeometry:Vo,CylinderGeometry:aj,CylinderBufferGeometry:eg,CircleGeometry:Wo,CircleBufferGeometry:Gl,BoxGeometry:BS,BoxBufferGeometry:Yf});function bj(e){ua.call(this),this.type="ShadowMaterial",this.color=new ga(0),this.transparent=!0,this.setValues(e)}function fg(e){gc.call(this,e),this.type="RawShaderMaterial"}function Hb(e){ua.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ga(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ga(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Zg,this.normalScale=new ca(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}function hh(e){Hb.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ca(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(e)}function ih(e){ua.call(this),this.type="MeshPhongMaterial",this.color=new ga(16777215),this.specular=new ga(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ga(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Zg,this.normalScale=new ca(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Qn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function cj(e){ua.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ga(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ga(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Zg,this.normalScale=new ca(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function dj(e){ua.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Zg,this.normalScale=new ca(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ej(e){ua.call(this),this.type="MeshLambertMaterial",this.color=new ga(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ga(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Qn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function fj(e){ua.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ga(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Zg,this.normalScale=new ca(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function gj(e){ob.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}bj.prototype=Object.create(ua.prototype),bj.prototype.constructor=bj,bj.prototype.isShadowMaterial=!0,bj.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.color.copy(e.color),this},fg.prototype=Object.create(gc.prototype),fg.prototype.constructor=fg,fg.prototype.isRawShaderMaterial=!0,Hb.prototype=Object.create(ua.prototype),Hb.prototype.constructor=Hb,Hb.prototype.isMeshStandardMaterial=!0,Hb.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},hh.prototype=Object.create(Hb.prototype),hh.prototype.constructor=hh,hh.prototype.isMeshPhysicalMaterial=!0,hh.prototype.copy=function(e){return Hb.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new ga).copy(e.sheen):this.sheen=null,this.transparency=e.transparency,this},ih.prototype=Object.create(ua.prototype),ih.prototype.constructor=ih,ih.prototype.isMeshPhongMaterial=!0,ih.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},cj.prototype=Object.create(ua.prototype),cj.prototype.constructor=cj,cj.prototype.isMeshToonMaterial=!0,cj.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},dj.prototype=Object.create(ua.prototype),dj.prototype.constructor=dj,dj.prototype.isMeshNormalMaterial=!0,dj.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ej.prototype=Object.create(ua.prototype),ej.prototype.constructor=ej,ej.prototype.isMeshLambertMaterial=!0,ej.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},fj.prototype=Object.create(ua.prototype),fj.prototype.constructor=fj,fj.prototype.isMeshMatcapMaterial=!0,fj.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},gj.prototype=Object.create(ob.prototype),gj.prototype.constructor=gj,gj.prototype.isLineDashedMaterial=!0,gj.prototype.copy=function(e){return ob.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var SW=Object.freeze({__proto__:null,ShadowMaterial:bj,SpriteMaterial:fh,RawShaderMaterial:fg,ShaderMaterial:gc,PointsMaterial:bg,MeshPhysicalMaterial:hh,MeshStandardMaterial:Hb,MeshPhongMaterial:ih,MeshToonMaterial:cj,MeshNormalMaterial:dj,MeshLambertMaterial:ej,MeshDepthMaterial:ch,MeshDistanceMaterial:dh,MeshBasicMaterial:kb,MeshMatcapMaterial:fj,LineDashedMaterial:gj,LineBasicMaterial:ob,Material:ua});const qb={arraySlice:function(e,t,r){return qb.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==r?r:e.length)):e.slice(t,r)},convertArray:function(e,t,r){return!e||!r&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){const t=e.length,r=new Array(t);for(let n=0;n!==t;++n)r[n]=n;return r.sort(function(t,r){return e[t]-e[r]}),r},sortedArray:function(e,t,r){const n=e.length,o=new e.constructor(n);for(let i=0,a=0;a!==n;++i){const n=r[i]*t;for(let r=0;r!==t;++r)o[a++]=e[n+r]}return o},flattenJSON:function(e,t,r,n){let o=1,i=e[0];for(;void 0!==i&&void 0===i[n];)i=e[o++];if(void 0===i)return;let a=i[n];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=i[n])&&(t.push(i.time),r.push.apply(r,a)),i=e[o++]}while(void 0!==i);else if(void 0!==a.toArray)do{void 0!==(a=i[n])&&(t.push(i.time),a.toArray(r,r.length)),i=e[o++]}while(void 0!==i);else do{void 0!==(a=i[n])&&(t.push(i.time),r.push(a)),i=e[o++]}while(void 0!==i)},subclip:function(e,t,r,n,o){o=o||30;const i=e.clone();i.name=t;const a=[];for(let d=0;d<i.tracks.length;++d){const e=i.tracks[d],t=e.getValueSize(),s=[],$=[];for(let i=0;i<e.times.length;++i){const a=e.times[i]*o;if(!(a<r||a>=n)){s.push(e.times[i]);for(let r=0;r<t;++r)$.push(e.values[i*t+r])}}0!==s.length&&(e.times=qb.convertArray(s,e.times.constructor),e.values=qb.convertArray($,e.values.constructor),a.push(e))}i.tracks=a;let s=1/0;for(let d=0;d<i.tracks.length;++d)s>i.tracks[d].times[0]&&(s=i.tracks[d].times[0]);for(let d=0;d<i.tracks.length;++d)i.tracks[d].shift(-1*s);return i.resetDuration(),i},makeClipAdditive:function(e,t,r,n){void 0===t&&(t=0),void 0===r&&(r=e),(void 0===n||n<=0)&&(n=30);const o=e.tracks.length,i=t/n;for(let a=0;a<o;++a){const t=r.tracks[a],n=t.ValueTypeName;if("bool"===n||"string"===n)continue;const o=e.tracks.find(function(e){return e.name===t.name&&e.ValueTypeName===n});if(void 0===o)continue;const s=t.getValueSize(),d=t.times.length-1;let $;if(i<=t.times[0])$=qb.arraySlice(t.values,0,t.valueSize);else if(i>=t.times[d]){const e=d*s;$=qb.arraySlice(t.values,e)}else{const e=t.createInterpolant();e.evaluate(i),$=e.resultBuffer}if("quaternion"===n){new yb($[0],$[1],$[2],$[3]).normalize().conjugate().toArray($)}const c=o.times.length;for(let e=0;e<c;++e){const t=e*s;if("quaternion"===n)yb.multiplyQuaternionsFlat(o.values,t,$,0,o.values,t);else for(let e=0;e<s;++e)o.values[t+e]-=$[e]}}return e.blendMode=2501,e}};function yc(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r}function ct(e,t,r,n){yc.call(this,e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Xo(e,t,r,n){yc.call(this,e,t,r,n)}function dt(e,t,r,n){yc.call(this,e,t,r,n)}function hc(e,t,r,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=qb.convertArray(t,this.TimeBufferType),this.values=qb.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function et(e,t,r){hc.call(this,e,t,r)}function ft(e,t,r,n){hc.call(this,e,t,r,n)}function hj(e,t,r,n){hc.call(this,e,t,r,n)}function gt(e,t,r,n){yc.call(this,e,t,r,n)}function Hl(e,t,r,n){hc.call(this,e,t,r,n)}function ht(e,t,r,n){hc.call(this,e,t,r,n)}function ij(e,t,r,n){hc.call(this,e,t,r,n)}function dd(e,t,r,n){this.name=e,this.tracks=r,this.duration=void 0!==t?t:-1,this.blendMode=void 0!==n?n:ms,this.uuid=ta.generateUUID(),this.duration<0&&this.resetDuration()}function TW(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return hj;case"vector":case"vector2":case"vector3":case"vector4":return ij;case"color":return ft;case"quaternion":return Hl;case"bool":case"boolean":return et;case"string":return ht;}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function UW(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=TW(e.type);if(void 0===e.times){const t=[],r=[];qb.flattenJSON(e.keys,t,r,"value"),e.times=t,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(yc.prototype,{evaluate:function(e){let t=this.parameterPositions,r=this._cachedIndex,n=t[r],o=t[r-1];e:{t:{let i;r:{n:if(!(e<n)){for(let i=r+2;;){if(void 0===n){if(e<o)break n;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,o)}if(r===i)break;if(o=n,e<(n=t[++r]))break t}i=t.length;break r}if(e>=o)break e;{const a=t[1];e<a&&(r=2,o=a);for(let i=r-2;;){if(void 0===o)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===i)break;if(n=o,e>=(o=t[--r-1]))break t}i=r,r=0}}for(;r<i;){const n=r+i>>>1;e<t[n]?i=n:r=n+1}if(n=t[r],void 0===(o=t[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,o,e)}this._cachedIndex=r,this.intervalChanged_(r,o,n)}return this.interpolate_(r,o,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){const t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,o=e*n;for(let i=0;i!==n;++i)t[i]=r[o+i];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(yc.prototype,{beforeStart_:yc.prototype.copySampleValue_,afterEnd_:yc.prototype.copySampleValue_}),ct.prototype=Object.assign(Object.create(yc.prototype),{constructor:ct,DefaultSettings_:{endingStart:wi,endingEnd:wi},intervalChanged_:function(e,t,r){let n=this.parameterPositions,o=e-2,i=e+1,a=n[o],s=n[i];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:o=e,a=2*t-r;break;case 2402:a=t+n[o=n.length-2]-n[o+1];break;default:o=e,a=r;}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:i=e,s=2*r-t;break;case 2402:i=1,s=r+n[1]-n[0];break;default:i=e-1,s=t;}const d=.5*(r-t),$=this.valueSize;this._weightPrev=d/(t-a),this._weightNext=d/(s-r),this._offsetPrev=o*$,this._offsetNext=i*$},interpolate_:function(e,t,r,n){const o=this.resultBuffer,i=this.sampleValues,a=this.valueSize,s=e*a,d=s-a,$=this._offsetPrev,c=this._offsetNext,p=this._weightPrev,l=this._weightNext,u=(r-t)/(n-t),h=u*u,f=h*u,m=-p*f+2*p*h-p*u,x=(1+p)*f+(-1.5-2*p)*h+(-.5+p)*u+1,R=(-1-l)*f+(1.5+l)*h+.5*u,g=l*f-l*h;for(let v=0;v!==a;++v)o[v]=m*i[$+v]+x*i[d+v]+R*i[s+v]+g*i[c+v];return o}}),Xo.prototype=Object.assign(Object.create(yc.prototype),{constructor:Xo,interpolate_:function(e,t,r,n){const o=this.resultBuffer,i=this.sampleValues,a=this.valueSize,s=e*a,d=s-a,$=(r-t)/(n-t),c=1-$;for(let p=0;p!==a;++p)o[p]=i[d+p]*c+i[s+p]*$;return o}}),dt.prototype=Object.assign(Object.create(yc.prototype),{constructor:dt,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(hc,{toJSON:function(e){const t=e.constructor;let r;if(void 0!==t.toJSON)r=t.toJSON(e);else{r={name:e.name,times:qb.convertArray(e.times,Array),values:qb.convertArray(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(r.interpolation=t)}return r.type=e.ValueTypeName,r}}),Object.assign(hc.prototype,{constructor:hc,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new dt(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Xo(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new ct(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth;}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302;}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e){const t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this},scale:function(e){if(1!==e){const t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this},trim:function(e,t){const r=this.times,n=r.length;let o=0,i=n-1;for(;o!==n&&r[o]<e;)++o;for(;-1!==i&&r[i]>t;)--i;if(++i,0!==o||i!==n){o>=i&&(o=(i=Math.max(i,1))-1);const e=this.getValueSize();this.times=qb.arraySlice(r,o,i),this.values=qb.arraySlice(this.values,o*e,i*e)}return this},validate:function(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,n=this.values,o=r.length;0===o&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let i=null;for(let a=0;a!==o;a++){const t=r[a];if("number"==typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,t),e=!1;break}if(null!==i&&i>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,t,i),e=!1;break}i=t}if(void 0!==n&&qb.isTypedArray(n))for(let a=0,s=n.length;a!==s;++a){const t=n[a];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,t),e=!1;break}}return e},optimize:function(){const e=qb.arraySlice(this.times),t=qb.arraySlice(this.values),r=this.getValueSize(),n=2302===this.getInterpolation(),o=e.length-1;let i=1;for(let a=1;a<o;++a){let o=!1;const s=e[a];if(s!==e[a+1]&&(1!==a||s!==s[0]))if(n)o=!0;else{const e=a*r,n=e-r,i=e+r;for(let a=0;a!==r;++a){const r=t[e+a];if(r!==t[n+a]||r!==t[i+a]){o=!0;break}}}if(o){if(a!==i){e[i]=e[a];const n=a*r,o=i*r;for(let e=0;e!==r;++e)t[o+e]=t[n+e]}++i}}if(o>0){e[i]=e[o];for(let e=o*r,n=i*r,a=0;a!==r;++a)t[n+a]=t[e+a];++i}return i!==e.length?(this.times=qb.arraySlice(e,0,i),this.values=qb.arraySlice(t,0,i*r)):(this.times=e,this.values=t),this},clone:function(){const e=qb.arraySlice(this.times,0),t=qb.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}),et.prototype=Object.assign(Object.create(hc.prototype),{constructor:et,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ft.prototype=Object.assign(Object.create(hc.prototype),{constructor:ft,ValueTypeName:"color"}),hj.prototype=Object.assign(Object.create(hc.prototype),{constructor:hj,ValueTypeName:"number"}),gt.prototype=Object.assign(Object.create(yc.prototype),{constructor:gt,interpolate_:function(e,t,r,n){const o=this.resultBuffer,i=this.sampleValues,a=this.valueSize,s=(r-t)/(n-t);let d=e*a;for(let $=d+a;d!==$;d+=4)yb.slerpFlat(o,0,i,d-a,i,d,s);return o}}),Hl.prototype=Object.assign(Object.create(hc.prototype),{constructor:Hl,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new gt(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),ht.prototype=Object.assign(Object.create(hc.prototype),{constructor:ht,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ij.prototype=Object.assign(Object.create(hc.prototype),{constructor:ij,ValueTypeName:"vector"}),Object.assign(dd,{parse:function(e){const t=[],r=e.tracks,n=1/(e.fps||1);for(let o=0,i=r.length;o!==i;++o)t.push(UW(r[o]).scale(n));return new dd(e.name,e.duration,t,e.blendMode)},toJSON:function(e){const t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,i=r.length;o!==i;++o)t.push(hc.toJSON(r[o]));return n},CreateFromMorphTargetSequence:function(e,t,r,n){const o=t.length,i=[];for(let a=0;a<o;a++){let e=[],s=[];e.push((a+o-1)%o,a,(a+1)%o),s.push(0,1,0);const d=qb.getKeyframeOrder(e);e=qb.sortedArray(e,1,d),s=qb.sortedArray(s,1,d),n||0!==e[0]||(e.push(o),s.push(s[0])),i.push(new hj(".morphTargetInfluences["+t[a].name+"]",e,s).scale(1/r))}return new dd(e,-1,i)},findByName:function(e,t){let r=e;if(!Array.isArray(e)){const t=e;r=t.geometry&&t.geometry.animations||t.animations}for(let n=0;n<r.length;n++)if(r[n].name===t)return r[n];return null},CreateClipsFromMorphTargetSequences:function(e,t,r){const n={},o=/^([\w-]*?)([\d]+)$/;for(let a=0,s=e.length;a<s;a++){const t=e[a],r=t.name.match(o);if(r&&r.length>1){const e=r[1];let o=n[e];o||(n[e]=o=[]),o.push(t)}}const i=[];for(const a in n)i.push(dd.CreateFromMorphTargetSequence(a,n[a],t,r));return i},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(e,t,r,n,o){if(0!==r.length){const i=[],a=[];qb.flattenJSON(r,i,a,n),0!==i.length&&o.push(new e(t,i,a))}},n=[],o=e.name||"default",i=e.fps||30,a=e.blendMode;let s=e.length||-1;const d=e.hierarchy||[];for(let $=0;$<d.length;$++){const e=d[$].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let r;for(r=0;r<e.length;r++)if(e[r].morphTargets)for(let n=0;n<e[r].morphTargets.length;n++)t[e[r].morphTargets[n]]=-1;for(const o in t){const t=[],i=[];for(let n=0;n!==e[r].morphTargets.length;++n){const n=e[r];t.push(n.time),i.push(n.morphTarget===o?1:0)}n.push(new hj(".morphTargetInfluence["+o+"]",t,i))}s=t.length*(i||1)}else{const o=".bones["+t[$].name+"]";r(ij,o+".position",e,"pos",n),r(Hl,o+".quaternion",e,"rot",n),r(ij,o+".scale",e,"scl",n)}}return 0===n.length?null:new dd(o,s,n,a)}}),Object.assign(dd.prototype,{resetDuration:function(){let e=0;for(let t=0,r=this.tracks.length;t!==r;++t){const r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new dd(this.name,this.duration,e,this.blendMode)}});const jj={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function YA(e,t,r){const n=this;let o=!1,i=0,a=0,s=void 0;const d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){a++,!1===o&&void 0!==n.onStart&&n.onStart(e,i,a),o=!0},this.itemEnd=function(e){i++,void 0!==n.onProgress&&n.onProgress(e,i,a),i===a&&(o=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return d.push(e,t),this},this.removeHandler=function(e){const t=d.indexOf(e);return-1!==t&&d.splice(t,2),this},this.getHandler=function(e){for(let t=0,r=d.length;t<r;t+=2){const r=d[t],n=d[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return n}return null}}const VW=new YA;function Pa(e){this.manager=void 0!==e?e:VW,this.crossOrigin="anonymous",this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Pa.prototype,{load:function(){},loadAsync:function(e,t){const r=this;return new Promise(function(n,o){r.load(e,n,t,o)})},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});const Bd={};function ed(e){Pa.call(this,e)}function ZA(e){Pa.call(this,e)}function $A(e){Pa.call(this,e)}function _A(e){Pa.call(this,e)}function Il(e){Pa.call(this,e)}function it(e){Pa.call(this,e)}function Wd(e){Pa.call(this,e)}function qa(){this.type="Curve",this.arcLengthDivisions=200}function fd(e,t,r,n,o,i,a,s){qa.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=r||1,this.yRadius=n||1,this.aStartAngle=o||0,this.aEndAngle=i||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Jl(e,t,r,n,o,i){fd.call(this,e,t,r,r,n,o,i),this.type="ArcCurve"}function jt(){let e=0,t=0,r=0,n=0;function o(o,i,a,s){e=o,t=a,r=-3*o+3*i-2*a-s,n=2*o-2*i+a+s}return{initCatmullRom:function(e,t,r,n,i){o(t,r,i*(r-e),i*(n-t))},initNonuniformCatmullRom:function(e,t,r,n,i,a,s){let d=(t-e)/i-(r-e)/(i+a)+(r-t)/a,$=(r-t)/a-(n-t)/(a+s)+(n-r)/s;o(t,r,d*=a,$*=a)},calc:function(o){const i=o*o;return e+t*o+r*i+n*(i*o)}}}ed.prototype=Object.assign(Object.create(Pa.prototype),{constructor:ed,load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,i=jj.get(e);if(void 0!==i)return o.manager.itemStart(e),setTimeout(function(){t&&t(i),o.manager.itemEnd(e)},0),i;if(void 0!==Bd[e])return void Bd[e].push({onLoad:t,onProgress:r,onError:n});const a=e.match(/^data:(.*?)(;base64)?,(.*)$/);let s;if(a){const r=a[1],i=!!a[2];let s=a[3];s=decodeURIComponent(s),i&&(s=atob(s));try{let i;const a=(this.responseType||"").toLowerCase();switch(a){case"arraybuffer":case"blob":const e=new Uint8Array(s.length);for(let r=0;r<s.length;r++)e[r]=s.charCodeAt(r);i="blob"===a?new Blob([e.buffer],{type:r}):e.buffer;break;case"document":const t=new DOMParser;i=t.parseFromString(s,r);break;case"json":i=JSON.parse(s);break;default:i=s;}setTimeout(function(){t&&t(i),o.manager.itemEnd(e)},0)}catch(d){setTimeout(function(){n&&n(d),o.manager.itemError(e),o.manager.itemEnd(e)},0)}}else{Bd[e]=[],Bd[e].push({onLoad:t,onProgress:r,onError:n}),(s=new XMLHttpRequest).open("GET",e,!0),s.addEventListener("load",function(t){const r=this.response,n=Bd[e];if(delete Bd[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),jj.add(e,r);for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onLoad&&t.onLoad(r)}o.manager.itemEnd(e)}else{for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}o.manager.itemError(e),o.manager.itemEnd(e)}},!1),s.addEventListener("progress",function(t){const r=Bd[e];for(let e=0,n=r.length;e<n;e++){const n=r[e];n.onProgress&&n.onProgress(t)}},!1),s.addEventListener("error",function(t){const r=Bd[e];delete Bd[e];for(let e=0,n=r.length;e<n;e++){const n=r[e];n.onError&&n.onError(t)}o.manager.itemError(e),o.manager.itemEnd(e)},!1),s.addEventListener("abort",function(t){const r=Bd[e];delete Bd[e];for(let e=0,n=r.length;e<n;e++){const n=r[e];n.onError&&n.onError(t)}o.manager.itemError(e),o.manager.itemEnd(e)},!1),void 0!==this.responseType&&(s.responseType=this.responseType),void 0!==this.withCredentials&&(s.withCredentials=this.withCredentials),s.overrideMimeType&&s.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const e in this.requestHeader)s.setRequestHeader(e,this.requestHeader[e]);s.send(null)}return o.manager.itemStart(e),s},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this}}),ZA.prototype=Object.assign(Object.create(Pa.prototype),{constructor:ZA,load:function(e,t,r,n){const o=this,i=new ed(o.manager);i.setPath(o.path),i.load(e,function(r){try{t(o.parse(JSON.parse(r)))}catch(i){n?n(i):console.error(i),o.manager.itemError(e)}},r,n)},parse:function(e){const t=[];for(let r=0;r<e.length;r++){const n=dd.parse(e[r]);t.push(n)}return t}}),$A.prototype=Object.assign(Object.create(Pa.prototype),{constructor:$A,load:function(e,t,r,n){const o=this,i=[],a=new rl;a.image=i;const s=new ed(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer");let d=0;function $($){s.load(e[$],function(e){const r=o.parse(e,!0);i[$]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(d+=1)&&(1===r.mipmapCount&&(a.minFilter=Qb),a.format=r.format,a.needsUpdate=!0,t&&t(a))},r,n)}if(Array.isArray(e))for(let c=0,p=e.length;c<p;++c)$(c);else s.load(e,function(e){const r=o.parse(e,!0);if(r.isCubemap){const e=r.mipmaps.length/r.mipmapCount;for(let t=0;t<e;t++){i[t]={mipmaps:[]};for(let e=0;e<r.mipmapCount;e++)i[t].mipmaps.push(r.mipmaps[t*r.mipmapCount+e]),i[t].format=r.format,i[t].width=r.width,i[t].height=r.height}}else a.image.width=r.width,a.image.height=r.height,a.mipmaps=r.mipmaps;1===r.mipmapCount&&(a.minFilter=Qb),a.format=r.format,a.needsUpdate=!0,t&&t(a)},r,n);return a}}),_A.prototype=Object.assign(Object.create(Pa.prototype),{constructor:_A,load:function(e,t,r,n){const o=this,i=new Pi,a=new ed(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(e,function(e){const r=o.parse(e);r&&(void 0!==r.image?i.image=r.image:void 0!==r.data&&(i.image.width=r.width,i.image.height=r.height,i.image.data=r.data),i.wrapS=void 0!==r.wrapS?r.wrapS:ec,i.wrapT=void 0!==r.wrapT?r.wrapT:ec,i.magFilter=void 0!==r.magFilter?r.magFilter:Qb,i.minFilter=void 0!==r.minFilter?r.minFilter:Qb,i.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.format&&(i.format=r.format),void 0!==r.type&&(i.type=r.type),void 0!==r.mipmaps&&(i.mipmaps=r.mipmaps,i.minFilter=Of),1===r.mipmapCount&&(i.minFilter=Qb),i.needsUpdate=!0,t&&t(i,r))},r,n),i}}),Il.prototype=Object.assign(Object.create(Pa.prototype),{constructor:Il,load:function(e,t,r,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,i=jj.get(e);if(void 0!==i)return o.manager.itemStart(e),setTimeout(function(){t&&t(i),o.manager.itemEnd(e)},0),i;const a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",d,!1),jj.add(e,this),t&&t(this),o.manager.itemEnd(e)}function d(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",d,!1),n&&n(t),o.manager.itemError(e),o.manager.itemEnd(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",d,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),o.manager.itemStart(e),a.src=e,a}}),it.prototype=Object.assign(Object.create(Pa.prototype),{constructor:it,load:function(e,t,r,n){const o=new Zf,i=new Il(this.manager);i.setCrossOrigin(this.crossOrigin),i.setPath(this.path);let a=0;function s(r){i.load(e[r],function(e){o.images[r]=e,6===++a&&(o.needsUpdate=!0,t&&t(o))},void 0,n)}for(let d=0;d<e.length;++d)s(d);return o}}),Wd.prototype=Object.assign(Object.create(Pa.prototype),{constructor:Wd,load:function(e,t,r,n){const o=new $a,i=new Il(this.manager);return i.setCrossOrigin(this.crossOrigin),i.setPath(this.path),i.load(e,function(r){o.image=r;const n=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);o.format=n?Sd:Gc,o.needsUpdate=!0,void 0!==t&&t(o)},r,n),o}}),Object.assign(qa.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)},getPoints:function(e){void 0===e&&(e=5);const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t},getLength:function(){const e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,n=this.getPoint(0),o=0;t.push(0);for(let i=1;i<=e;i++)o+=(r=this.getPoint(i/e)).distanceTo(n),t.push(o),n=r;return this.cacheArcLengths=t,t},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){const r=this.getLengths();let n,o=0,i=r.length;n=t||e*r[i-1];let a,s=0,d=i-1;for(;s<=d;)if((a=r[o=Math.floor(s+(d-s)/2)]-n)<0)s=o+1;else{if(!(a>0)){d=o;break}d=o-1}if(r[o=d]===n)return o/(i-1);const $=r[o];return(o+(n-$)/(r[o+1]-$))/(i-1)},getTangent:function(e,t){let r=e-1e-4,n=e+1e-4;r<0&&(r=0),n>1&&(n=1);const o=this.getPoint(r),i=this.getPoint(n),a=t||(o.isVector2?new ca:new ba);return a.copy(i).sub(o).normalize(),a},getTangentAt:function(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)},computeFrenetFrames:function(e,t){const r=new ba,n=[],o=[],i=[],a=new ba,s=new fa;for(let l=0;l<=e;l++){const t=l/e;n[l]=this.getTangentAt(t,new ba),n[l].normalize()}o[0]=new ba,i[0]=new ba;let d=Number.MAX_VALUE;const $=Math.abs(n[0].x),c=Math.abs(n[0].y),p=Math.abs(n[0].z);$<=d&&(d=$,r.set(1,0,0)),c<=d&&(d=c,r.set(0,1,0)),p<=d&&r.set(0,0,1),a.crossVectors(n[0],r).normalize(),o[0].crossVectors(n[0],a),i[0].crossVectors(n[0],o[0]);for(let l=1;l<=e;l++){if(o[l]=o[l-1].clone(),i[l]=i[l-1].clone(),a.crossVectors(n[l-1],n[l]),a.length()>Number.EPSILON){a.normalize();const e=Math.acos(ta.clamp(n[l-1].dot(n[l]),-1,1));o[l].applyMatrix4(s.makeRotationAxis(a,e))}i[l].crossVectors(n[l],o[l])}if(!0===t){let t=Math.acos(ta.clamp(o[0].dot(o[e]),-1,1));t/=e,n[0].dot(a.crossVectors(o[0],o[e]))>0&&(t=-t);for(let r=1;r<=e;r++)o[r].applyMatrix4(s.makeRotationAxis(n[r],t*r)),i[r].crossVectors(n[r],o[r])}return{tangents:n,normals:o,binormals:i}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),fd.prototype=Object.create(qa.prototype),fd.prototype.constructor=fd,fd.prototype.isEllipseCurve=!0,fd.prototype.getPoint=function(e,t){const r=t||new ca,n=2*Math.PI;let o=this.aEndAngle-this.aStartAngle;const i=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=n;for(;o>n;)o-=n;o<Number.EPSILON&&(o=i?0:n),!0!==this.aClockwise||i||(o===n?o=-n:o-=n);const a=this.aStartAngle+e*o;let s=this.aX+this.xRadius*Math.cos(a),d=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),r=s-this.aX,n=d-this.aY;s=r*e-n*t+this.aX,d=r*t+n*e+this.aY}return r.set(s,d)},fd.prototype.copy=function(e){return qa.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},fd.prototype.toJSON=function(){const e=qa.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},fd.prototype.fromJSON=function(e){return qa.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Jl.prototype=Object.create(fd.prototype),Jl.prototype.constructor=Jl,Jl.prototype.isArcCurve=!0;const Yo=new ba,kt=new jt,lt=new jt,mt=new jt;function Cd(e,t,r,n){qa.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=r||"centripetal",this.tension=n||.5}function aB(e,t,r,n,o){const i=.5*(n-t),a=.5*(o-r),s=e*e;return(2*r-2*n+i+a)*(e*s)+(-3*r+3*n-2*i-a)*s+i*e+r}function WW(e,t){const r=1-e;return r*r*t}function XW(e,t){return 2*(1-e)*e*t}function YW(e,t){return e*e*t}function Kl(e,t,r,n){return WW(e,t)+XW(e,r)+YW(e,n)}function ZW(e,t){const r=1-e;return r*r*r*t}function $W(e,t){const r=1-e;return 3*r*r*e*t}function _W(e,t){return 3*(1-e)*e*e*t}function aX(e,t){return e*e*e*t}function Ll(e,t,r,n,o){return ZW(e,t)+$W(e,r)+_W(e,n)+aX(e,o)}function Xd(e,t,r,n){qa.call(this),this.type="CubicBezierCurve",this.v0=e||new ca,this.v1=t||new ca,this.v2=r||new ca,this.v3=n||new ca}function Ze(e,t,r,n){qa.call(this),this.type="CubicBezierCurve3",this.v0=e||new ba,this.v1=t||new ba,this.v2=r||new ba,this.v3=n||new ba}function Nc(e,t){qa.call(this),this.type="LineCurve",this.v1=e||new ca,this.v2=t||new ca}function Yd(e,t){qa.call(this),this.type="LineCurve3",this.v1=e||new ba,this.v2=t||new ba}function Zd(e,t,r){qa.call(this),this.type="QuadraticBezierCurve",this.v0=e||new ca,this.v1=t||new ca,this.v2=r||new ca}function _e(e,t,r){qa.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new ba,this.v1=t||new ba,this.v2=r||new ba}function $d(e){qa.call(this),this.type="SplineCurve",this.points=e||[]}Cd.prototype=Object.create(qa.prototype),Cd.prototype.constructor=Cd,Cd.prototype.isCatmullRomCurve3=!0,Cd.prototype.getPoint=function(e,t){const r=t||new ba,n=this.points,o=n.length,i=(o-(this.closed?0:1))*e;let a,s,d,$,c=Math.floor(i),p=i-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/o)+1)*o:0===p&&c===o-1&&(c=o-2,p=1),this.closed||c>0?a=n[(c-1)%o]:(Yo.subVectors(n[0],n[1]).add(n[0]),a=Yo),s=n[c%o],d=n[(c+1)%o],this.closed||c+2<o?$=n[(c+2)%o]:(Yo.subVectors(n[o-1],n[o-2]).add(n[o-1]),$=Yo),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(a.distanceToSquared(s),e),r=Math.pow(s.distanceToSquared(d),e),n=Math.pow(d.distanceToSquared($),e);r<1e-4&&(r=1),t<1e-4&&(t=r),n<1e-4&&(n=r),kt.initNonuniformCatmullRom(a.x,s.x,d.x,$.x,t,r,n),lt.initNonuniformCatmullRom(a.y,s.y,d.y,$.y,t,r,n),mt.initNonuniformCatmullRom(a.z,s.z,d.z,$.z,t,r,n)}else"catmullrom"===this.curveType&&(kt.initCatmullRom(a.x,s.x,d.x,$.x,this.tension),lt.initCatmullRom(a.y,s.y,d.y,$.y,this.tension),mt.initCatmullRom(a.z,s.z,d.z,$.z,this.tension));return r.set(kt.calc(p),lt.calc(p),mt.calc(p)),r},Cd.prototype.copy=function(e){qa.prototype.copy.call(this,e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Cd.prototype.toJSON=function(){const e=qa.prototype.toJSON.call(this);e.points=[];for(let t=0,r=this.points.length;t<r;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Cd.prototype.fromJSON=function(e){qa.prototype.fromJSON.call(this,e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push(new ba().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Xd.prototype=Object.create(qa.prototype),Xd.prototype.constructor=Xd,Xd.prototype.isCubicBezierCurve=!0,Xd.prototype.getPoint=function(e,t){const r=t||new ca,n=this.v0,o=this.v1,i=this.v2,a=this.v3;return r.set(Ll(e,n.x,o.x,i.x,a.x),Ll(e,n.y,o.y,i.y,a.y)),r},Xd.prototype.copy=function(e){return qa.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Xd.prototype.toJSON=function(){const e=qa.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Xd.prototype.fromJSON=function(e){return qa.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Ze.prototype=Object.create(qa.prototype),Ze.prototype.constructor=Ze,Ze.prototype.isCubicBezierCurve3=!0,Ze.prototype.getPoint=function(e,t){const r=t||new ba,n=this.v0,o=this.v1,i=this.v2,a=this.v3;return r.set(Ll(e,n.x,o.x,i.x,a.x),Ll(e,n.y,o.y,i.y,a.y),Ll(e,n.z,o.z,i.z,a.z)),r},Ze.prototype.copy=function(e){return qa.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Ze.prototype.toJSON=function(){const e=qa.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Ze.prototype.fromJSON=function(e){return qa.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Nc.prototype=Object.create(qa.prototype),Nc.prototype.constructor=Nc,Nc.prototype.isLineCurve=!0,Nc.prototype.getPoint=function(e,t){const r=t||new ca;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},Nc.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Nc.prototype.getTangent=function(e,t){const r=t||new ca;return r.copy(this.v2).sub(this.v1).normalize(),r},Nc.prototype.copy=function(e){return qa.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Nc.prototype.toJSON=function(){const e=qa.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Nc.prototype.fromJSON=function(e){return qa.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Yd.prototype=Object.create(qa.prototype),Yd.prototype.constructor=Yd,Yd.prototype.isLineCurve3=!0,Yd.prototype.getPoint=function(e,t){const r=t||new ba;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},Yd.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Yd.prototype.copy=function(e){return qa.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Yd.prototype.toJSON=function(){const e=qa.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Yd.prototype.fromJSON=function(e){return qa.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Zd.prototype=Object.create(qa.prototype),Zd.prototype.constructor=Zd,Zd.prototype.isQuadraticBezierCurve=!0,Zd.prototype.getPoint=function(e,t){const r=t||new ca,n=this.v0,o=this.v1,i=this.v2;return r.set(Kl(e,n.x,o.x,i.x),Kl(e,n.y,o.y,i.y)),r},Zd.prototype.copy=function(e){return qa.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Zd.prototype.toJSON=function(){const e=qa.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Zd.prototype.fromJSON=function(e){return qa.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},_e.prototype=Object.create(qa.prototype),_e.prototype.constructor=_e,_e.prototype.isQuadraticBezierCurve3=!0,_e.prototype.getPoint=function(e,t){const r=t||new ba,n=this.v0,o=this.v1,i=this.v2;return r.set(Kl(e,n.x,o.x,i.x),Kl(e,n.y,o.y,i.y),Kl(e,n.z,o.z,i.z)),r},_e.prototype.copy=function(e){return qa.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},_e.prototype.toJSON=function(){const e=qa.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},_e.prototype.fromJSON=function(e){return qa.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},$d.prototype=Object.create(qa.prototype),$d.prototype.constructor=$d,$d.prototype.isSplineCurve=!0,$d.prototype.getPoint=function(e,t){const r=t||new ca,n=this.points,o=(n.length-1)*e,i=Math.floor(o),a=o-i,s=n[0===i?i:i-1],d=n[i],$=n[i>n.length-2?n.length-1:i+1],c=n[i>n.length-3?n.length-1:i+2];return r.set(aB(a,s.x,d.x,$.x,c.x),aB(a,s.y,d.y,$.y,c.y)),r},$d.prototype.copy=function(e){qa.prototype.copy.call(this,e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push(r.clone())}return this},$d.prototype.toJSON=function(){const e=qa.prototype.toJSON.call(this);e.points=[];for(let t=0,r=this.points.length;t<r;t++){const r=this.points[t];e.points.push(r.toArray())}return e},$d.prototype.fromJSON=function(e){qa.prototype.fromJSON.call(this,e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push(new ca().fromArray(r))}return this};var nt=Object.freeze({__proto__:null,ArcCurve:Jl,CatmullRomCurve3:Cd,CubicBezierCurve:Xd,CubicBezierCurve3:Ze,EllipseCurve:fd,LineCurve:Nc,LineCurve3:Yd,QuadraticBezierCurve:Zd,QuadraticBezierCurve3:_e,SplineCurve:$d});function gg(){qa.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Dd(e){gg.call(this),this.type="Path",this.currentPoint=new ca,e&&this.setFromPoints(e)}function Oc(e){Dd.call(this,e),this.uuid=ta.generateUUID(),this.type="Shape",this.holes=[]}function eb(e,t){ja.call(this),this.type="Light",this.color=new ga(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Zo(e,t,r){eb.call(this,e,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(ja.DefaultUp),this.updateMatrix(),this.groundColor=new ga(t)}function af(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new ca(512,512),this.map=null,this.mapPass=null,this.matrix=new fa,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new gl,this._frameExtents=new ca(1,1),this._viewportCount=1,this._viewports=[new Ta(0,0,1,1)]}function ot(){af.call(this,new zb(50,1,.5,500))}function $o(e,t,r,n,o,i){eb.call(this,e,t),this.type="SpotLight",this.position.copy(ja.DefaultUp),this.updateMatrix(),this.target=new ja,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==r?r:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==o?o:0,this.decay=void 0!==i?i:1,this.shadow=new ot}function pt(){af.call(this,new zb(90,1,.5,500)),this._frameExtents=new ca(4,2),this._viewportCount=6,this._viewports=[new Ta(2,1,1,1),new Ta(0,1,1,1),new Ta(3,1,1,1),new Ta(1,1,1,1),new Ta(3,0,1,1),new Ta(1,0,1,1)],this._cubeDirections=[new ba(1,0,0),new ba(-1,0,0),new ba(0,0,1),new ba(0,0,-1),new ba(0,1,0),new ba(0,-1,0)],this._cubeUps=[new ba(0,1,0),new ba(0,1,0),new ba(0,1,0),new ba(0,1,0),new ba(0,0,1),new ba(0,0,-1)]}function _o(e,t,r,n){eb.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==r?r:0,this.decay=void 0!==n?n:1,this.shadow=new pt}function kj(e,t,r,n,o,i){We.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==r?r:1,this.bottom=void 0!==n?n:-1,this.near=void 0!==o?o:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix()}function qt(){af.call(this,new kj(-5,5,5,-5,.5,500))}function Ml(e,t){eb.call(this,e,t),this.type="DirectionalLight",this.position.copy(ja.DefaultUp),this.updateMatrix(),this.target=new ja,this.shadow=new qt}function ap(e,t){eb.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function rt(e,t,r,n){eb.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==r?r:10,this.height=void 0!==n?n:10}function st(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ba)}function Ed(e,t){eb.call(this,void 0,t),this.type="LightProbe",this.sh=void 0!==e?e:new st}function tt(e){Pa.call(this,e),this.textures={}}gg.prototype=Object.assign(Object.create(qa.prototype),{constructor:gg,add:function(e){this.curves.push(e)},closePath:function(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Nc(t,e))},getPoint:function(e){const t=e*this.getLength(),r=this.getCurveLengths();let n=0;for(;n<r.length;){if(r[n]>=t){const e=r[n]-t,o=this.curves[n],i=o.getLength(),a=0===i?0:1-e/i;return o.getPointAt(a)}n++}return null},getLength:function(){const e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;const t=[];let r;for(let n=0,o=this.curves;n<o.length;n++){const i=o[n],a=i&&i.isEllipseCurve?2*e:i&&(i.isLineCurve||i.isLineCurve3)?1:i&&i.isSplineCurve?e*i.points.length:e,s=i.getPoints(a);for(let e=0;e<s.length;e++){const n=s[e];r&&r.equals(n)||(t.push(n),r=n)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t},copy:function(e){qa.prototype.copy.call(this,e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){const e=qa.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e},fromJSON:function(e){qa.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const r=e.curves[t];this.curves.push(new nt[r.type]().fromJSON(r))}return this}}),Dd.prototype=Object.assign(Object.create(gg.prototype),{constructor:Dd,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){const r=new Nc(this.currentPoint.clone(),new ca(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,r,n){const o=new Zd(this.currentPoint.clone(),new ca(e,t),new ca(r,n));return this.curves.push(o),this.currentPoint.set(r,n),this},bezierCurveTo:function(e,t,r,n,o,i){const a=new Xd(this.currentPoint.clone(),new ca(e,t),new ca(r,n),new ca(o,i));return this.curves.push(a),this.currentPoint.set(o,i),this},splineThru:function(e){const t=new $d([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,r,n,o,i){const a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+a,t+s,r,n,o,i),this},absarc:function(e,t,r,n,o,i){return this.absellipse(e,t,r,r,n,o,i),this},ellipse:function(e,t,r,n,o,i,a,s){const d=this.currentPoint.x,$=this.currentPoint.y;return this.absellipse(e+d,t+$,r,n,o,i,a,s),this},absellipse:function(e,t,r,n,o,i,a,s){const d=new fd(e,t,r,n,o,i,a,s);if(this.curves.length>0){const e=d.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(d);const $=d.getPoint(1);return this.currentPoint.copy($),this},copy:function(e){return gg.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){const e=gg.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return gg.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Oc.prototype=Object.assign(Object.create(Dd.prototype),{constructor:Oc,getPointsHoles:function(e){const t=[];for(let r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Dd.prototype.copy.call(this,e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const r=e.holes[t];this.holes.push(r.clone())}return this},toJSON:function(){const e=Dd.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e},fromJSON:function(e){Dd.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const r=e.holes[t];this.holes.push(new Dd().fromJSON(r))}return this}}),eb.prototype=Object.assign(Object.create(ja.prototype),{constructor:eb,isLight:!0,copy:function(e){return ja.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){const t=ja.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Zo.prototype=Object.assign(Object.create(eb.prototype),{constructor:Zo,isHemisphereLight:!0,copy:function(e){return eb.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(af.prototype,{_projScreenMatrix:new fa,_lightPositionWorld:new ba,_lookTarget:new ba,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){const t=this.camera,r=this.matrix,n=this._projScreenMatrix,o=this._lookTarget,i=this._lightPositionWorld;i.setFromMatrixPosition(e.matrixWorld),t.position.copy(i),o.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(o),t.updateMatrixWorld(),n.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),ot.prototype=Object.assign(Object.create(af.prototype),{constructor:ot,isSpotLightShadow:!0,updateMatrices:function(e){const t=this.camera,r=2*ta.RAD2DEG*e.angle,n=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;r===t.fov&&n===t.aspect&&o===t.far||(t.fov=r,t.aspect=n,t.far=o,t.updateProjectionMatrix()),af.prototype.updateMatrices.call(this,e)}}),$o.prototype=Object.assign(Object.create(eb.prototype),{constructor:$o,isSpotLight:!0,copy:function(e){return eb.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),pt.prototype=Object.assign(Object.create(af.prototype),{constructor:pt,isPointLightShadow:!0,updateMatrices:function(e,t){void 0===t&&(t=0);const r=this.camera,n=this.matrix,o=this._lightPositionWorld,i=this._lookTarget,a=this._projScreenMatrix;o.setFromMatrixPosition(e.matrixWorld),r.position.copy(o),i.copy(r.position),i.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(i),r.updateMatrixWorld(),n.makeTranslation(-o.x,-o.y,-o.z),a.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a)}}),_o.prototype=Object.assign(Object.create(eb.prototype),{constructor:_o,isPointLight:!0,copy:function(e){return eb.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),kj.prototype=Object.assign(Object.create(We.prototype),{constructor:kj,isOrthographicCamera:!0,copy:function(e,t){return We.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,r,n,o,i){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=o,this.view.height=i,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let o=r-e,i=r+e,a=n+t,s=n-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i=(o+=e*this.view.offsetX)+e*this.view.width,s=(a-=t*this.view.offsetY)-t*this.view.height}this.projectionMatrix.makeOrthographic(o,i,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){const t=ja.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),qt.prototype=Object.assign(Object.create(af.prototype),{constructor:qt,isDirectionalLightShadow:!0,updateMatrices:function(e){af.prototype.updateMatrices.call(this,e)}}),Ml.prototype=Object.assign(Object.create(eb.prototype),{constructor:Ml,isDirectionalLight:!0,copy:function(e){return eb.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),ap.prototype=Object.assign(Object.create(eb.prototype),{constructor:ap,isAmbientLight:!0}),rt.prototype=Object.assign(Object.create(eb.prototype),{constructor:rt,isRectAreaLight:!0,copy:function(e){return eb.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){const t=eb.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Object.assign(st.prototype,{isSphericalHarmonics3:!0,set:function(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){const r=e.x,n=e.y,o=e.z,i=this.coefficients;return t.copy(i[0]).multiplyScalar(.282095),t.addScaledVector(i[1],.488603*n),t.addScaledVector(i[2],.488603*o),t.addScaledVector(i[3],.488603*r),t.addScaledVector(i[4],r*n*1.092548),t.addScaledVector(i[5],n*o*1.092548),t.addScaledVector(i[6],.315392*(3*o*o-1)),t.addScaledVector(i[7],r*o*1.092548),t.addScaledVector(i[8],.546274*(r*r-n*n)),t},getIrradianceAt:function(e,t){const r=e.x,n=e.y,o=e.z,i=this.coefficients;return t.copy(i[0]).multiplyScalar(.886227),t.addScaledVector(i[1],1.023328*n),t.addScaledVector(i[2],1.023328*o),t.addScaledVector(i[3],1.023328*r),t.addScaledVector(i[4],.858086*r*n),t.addScaledVector(i[5],.858086*n*o),t.addScaledVector(i[6],.743125*o*o-.247708),t.addScaledVector(i[7],.858086*r*o),t.addScaledVector(i[8],.429043*(r*r-n*n)),t},add:function(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},addScaledSH:function(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this},scale:function(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this},equals:function(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(e,t){void 0===t&&(t=0);const r=this.coefficients;for(let n=0;n<9;n++)r[n].fromArray(e,t+3*n);return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);const r=this.coefficients;for(let n=0;n<9;n++)r[n].toArray(e,t+3*n);return e}}),Object.assign(st,{getBasisAt:function(e,t){const r=e.x,n=e.y,o=e.z;t[0]=.282095,t[1]=.488603*n,t[2]=.488603*o,t[3]=.488603*r,t[4]=1.092548*r*n,t[5]=1.092548*n*o,t[6]=.315392*(3*o*o-1),t[7]=1.092548*r*o,t[8]=.546274*(r*r-n*n)}}),Ed.prototype=Object.assign(Object.create(eb.prototype),{constructor:Ed,isLightProbe:!0,copy:function(e){return eb.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){const t=eb.prototype.toJSON.call(this,e);return t.object.sh=this.sh.toArray(),t}}),tt.prototype=Object.assign(Object.create(Pa.prototype),{constructor:tt,load:function(e,t,r,n){const o=this,i=new ed(o.manager);i.setPath(o.path),i.load(e,function(r){try{t(o.parse(JSON.parse(r)))}catch(i){n?n(i):console.error(i),o.manager.itemError(e)}},r,n)},parse:function(e){const t=this.textures;function r(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const n=new SW[e.type];if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.sheen&&(n.sheen=new ga().setHex(e.sheen)),void 0!==e.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&n.specular.setHex(e.specular),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearcoat&&(n.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(n.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.flatShading&&(n.flatShading=e.flatShading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.combine&&(n.combine=e.combine),void 0!==e.side&&(n.side=e.side),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(n.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(n.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(n.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(n.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(n.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(n.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(n.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(n.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(n.rotation=e.rotation),1!==e.linewidth&&(n.linewidth=e.linewidth),void 0!==e.dashSize&&(n.dashSize=e.dashSize),void 0!==e.gapSize&&(n.gapSize=e.gapSize),void 0!==e.scale&&(n.scale=e.scale),void 0!==e.polygonOffset&&(n.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(n.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(n.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(n.skinning=e.skinning),void 0!==e.morphTargets&&(n.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(n.morphNormals=e.morphNormals),void 0!==e.dithering&&(n.dithering=e.dithering),void 0!==e.vertexTangents&&(n.vertexTangents=e.vertexTangents),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.toneMapped&&(n.toneMapped=e.toneMapped),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?n.vertexColors=e.vertexColors>0:n.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const o in e.uniforms){const t=e.uniforms[o];switch(n.uniforms[o]={},t.type){case"t":n.uniforms[o].value=r(t.value);break;case"c":n.uniforms[o].value=new ga().setHex(t.value);break;case"v2":n.uniforms[o].value=new ca().fromArray(t.value);break;case"v3":n.uniforms[o].value=new ba().fromArray(t.value);break;case"v4":n.uniforms[o].value=new Ta().fromArray(t.value);break;case"m3":n.uniforms[o].value=new nc().fromArray(t.value);case"m4":n.uniforms[o].value=new fa().fromArray(t.value);break;default:n.uniforms[o].value=t.value;}}if(void 0!==e.defines&&(n.defines=e.defines),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const o in e.extensions)n.extensions[o]=e.extensions[o];if(void 0!==e.shading&&(n.flatShading=1===e.shading),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=r(e.map)),void 0!==e.matcap&&(n.matcap=r(e.matcap)),void 0!==e.alphaMap&&(n.alphaMap=r(e.alphaMap)),void 0!==e.bumpMap&&(n.bumpMap=r(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=r(e.normalMap)),void 0!==e.normalMapType&&(n.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),n.normalScale=new ca().fromArray(t)}return void 0!==e.displacementMap&&(n.displacementMap=r(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=r(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=r(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=r(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=r(e.specularMap)),void 0!==e.envMap&&(n.envMap=r(e.envMap)),void 0!==e.envMapIntensity&&(n.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(n.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(n.lightMap=r(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=r(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=r(e.gradientMap)),void 0!==e.clearcoatMap&&(n.clearcoatMap=r(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(n.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(n.clearcoatNormalMap=r(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(n.clearcoatNormalScale=new ca().fromArray(e.clearcoatNormalScale)),n},setTextures:function(e){return this.textures=e,this}});const jh={decodeText:function(e){if("undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);let t="";for(let n=0,o=e.length;n<o;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(r){return t}},extractUrlBase:function(e){const t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function bp(){ia.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function ut(e,t,r,n){"number"==typeof r&&(n=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),pa.call(this,e,t,r),this.meshPerAttribute=n||1}function vt(e){Pa.call(this,e)}bp.prototype=Object.assign(Object.create(ia.prototype),{constructor:bp,isInstancedBufferGeometry:!0,copy:function(e){return ia.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const e=ia.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),ut.prototype=Object.assign(Object.create(pa.prototype),{constructor:ut,isInstancedBufferAttribute:!0,copy:function(e){return pa.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){const e=pa.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),vt.prototype=Object.assign(Object.create(Pa.prototype),{constructor:vt,load:function(e,t,r,n){const o=this,i=new ed(o.manager);i.setPath(o.path),i.load(e,function(r){try{t(o.parse(JSON.parse(r)))}catch(i){n?n(i):console.error(i),o.manager.itemError(e)}},r,n)},parse:function(e){const t={},r={};function n(e,n){if(void 0!==t[n])return t[n];const o=e.interleavedBuffers[n],i=function(e,t){if(void 0!==r[t])return r[t];const n=e.arrayBuffers[t],o=new Uint32Array(n).buffer;return r[t]=o,o}(e,o.buffer),a=new Kc(new cp[o.type](i),o.stride);return a.uuid=o.uuid,t[n]=a,a}const o=e.isInstancedBufferGeometry?new bp:new ia,i=e.data.index;if(void 0!==i){const e=new cp[i.type](i.array);o.setIndex(new pa(e,1))}const a=e.data.attributes;for(const c in a){const t=a[c];let r;if(t.isInterleavedBufferAttribute){r=new ag(n(e.data,t.data),t.itemSize,t.offset,t.normalized)}else{const e=new cp[t.type](t.array);r=new(t.isInstancedBufferAttribute?ut:pa)(e,t.itemSize,t.normalized)}void 0!==t.name&&(r.name=t.name),o.setAttribute(c,r)}const s=e.data.morphAttributes;if(s)for(const c in s){const t=s[c],r=[];for(let o=0,i=t.length;o<i;o++){const i=t[o];let a;if(i.isInterleavedBufferAttribute){a=new ag(n(e.data,i.data),i.itemSize,i.offset,i.normalized)}else{a=new pa(new cp[i.type](i.array),i.itemSize,i.normalized)}void 0!==i.name&&(a.name=i.name),r.push(a)}o.morphAttributes[c]=r}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const d=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==d)for(let c=0,p=d.length;c!==p;++c){const e=d[c];o.addGroup(e.start,e.count,e.materialIndex)}const $=e.data.boundingSphere;if(void 0!==$){const e=new ba;void 0!==$.center&&e.fromArray($.center),o.boundingSphere=new Td(e,$.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}});const cp={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function wt(e){Pa.call(this,e)}wt.prototype=Object.assign(Object.create(Pa.prototype),{constructor:wt,load:function(e,t,r,n){const o=this,i=""===this.path?jh.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const a=new ed(o.manager);a.setPath(this.path),a.load(e,function(r){let i=null;try{i=JSON.parse(r)}catch(s){return void 0!==n&&n(s),void console.error("THREE:ObjectLoader: Can't parse "+e+".",s.message)}const a=i.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?o.parse(i,t):console.error("THREE.ObjectLoader: Can't load "+e)},r,n)},parse:function(e,t){const r=this.parseShape(e.shapes),n=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){void 0!==t&&t(s)}),i=this.parseTextures(e.textures,o),a=this.parseMaterials(e.materials,i),s=this.parseObject(e.object,n,a);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){const t={};if(void 0!==e)for(let r=0,n=e.length;r<n;r++){const n=new Oc().fromJSON(e[r]);t[n.uuid]=n}return t},parseGeometries:function(e,t){const r={};let n;if(void 0!==e){const o=new vt;for(let i=0,a=e.length;i<a;i++){let a;const s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new oc[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new oc[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new oc[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new oc[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new oc[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new oc[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new oc[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new oc[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new oc[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new oc[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new oc[s.type](new nt[s.path.type]().fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new oc[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new oc[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":n=[];for(let r=0,o=s.shapes.length;r<o;r++){const e=t[s.shapes[r]];n.push(e)}a=new oc[s.type](n,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":n=[];for(let r=0,o=s.shapes.length;r<o;r++){const e=t[s.shapes[r]];n.push(e)}const e=s.options.extrudePath;void 0!==e&&(s.options.extrudePath=new nt[e.type]().fromJSON(e)),a=new oc[s.type](n,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":a=o.parse(s);break;case"Geometry":console.error("THREE.ObjectLoader: Loading \"Geometry\" is not supported anymore.");break;default:console.warn("THREE.ObjectLoader: Unsupported geometry type \""+s.type+"\"");continue;}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),r[s.uuid]=a}}return r},parseMaterials:function(e,t){const r={},n={};if(void 0!==e){const o=new tt;o.setTextures(t);for(let t=0,i=e.length;t<i;t++){const i=e[t];if("MultiMaterial"===i.type){const e=[];for(let t=0;t<i.materials.length;t++){const n=i.materials[t];void 0===r[n.uuid]&&(r[n.uuid]=o.parse(n)),e.push(r[n.uuid])}n[i.uuid]=e}else void 0===r[i.uuid]&&(r[i.uuid]=o.parse(i)),n[i.uuid]=r[i.uuid]}}return n},parseAnimations:function(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r],o=dd.parse(n);void 0!==n.uuid&&(o.uuid=n.uuid),t.push(o)}return t},parseImages:function(e,t){const r=this,n={};let o;function i(e){return r.manager.itemStart(e),o.load(e,function(){r.manager.itemEnd(e)},void 0,function(){r.manager.itemError(e),r.manager.itemEnd(e)})}if(void 0!==e&&e.length>0){const a=new YA(t);(o=new Il(a)).setCrossOrigin(this.crossOrigin);for(let t=0,o=e.length;t<o;t++){const o=e[t],a=o.url;if(Array.isArray(a)){n[o.uuid]=[];for(let e=0,t=a.length;e<t;e++){const t=a[e],s=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t;n[o.uuid].push(i(s))}}else{const e=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o.url)?o.url:r.resourcePath+o.url;n[o.uuid]=i(e)}}}return n},parseTextures:function(e,t){function r(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const n={};if(void 0!==e)for(let o=0,i=e.length;o<i;o++){const i=e[o];let a;void 0===i.image&&console.warn("THREE.ObjectLoader: No \"image\" specified for",i.uuid),void 0===t[i.image]&&console.warn("THREE.ObjectLoader: Undefined image",i.image),(a=Array.isArray(t[i.image])?new Zf(t[i.image]):new $a(t[i.image])).needsUpdate=!0,a.uuid=i.uuid,void 0!==i.name&&(a.name=i.name),void 0!==i.mapping&&(a.mapping=r(i.mapping,bX)),void 0!==i.offset&&a.offset.fromArray(i.offset),void 0!==i.repeat&&a.repeat.fromArray(i.repeat),void 0!==i.center&&a.center.fromArray(i.center),void 0!==i.rotation&&(a.rotation=i.rotation),void 0!==i.wrap&&(a.wrapS=r(i.wrap[0],bB),a.wrapT=r(i.wrap[1],bB)),void 0!==i.format&&(a.format=i.format),void 0!==i.type&&(a.type=i.type),void 0!==i.encoding&&(a.encoding=i.encoding),void 0!==i.minFilter&&(a.minFilter=r(i.minFilter,cB)),void 0!==i.magFilter&&(a.magFilter=r(i.magFilter,cB)),void 0!==i.anisotropy&&(a.anisotropy=i.anisotropy),void 0!==i.flipY&&(a.flipY=i.flipY),void 0!==i.premultiplyAlpha&&(a.premultiplyAlpha=i.premultiplyAlpha),void 0!==i.unpackAlignment&&(a.unpackAlignment=i.unpackAlignment),n[i.uuid]=a}return n},parseObject:function(e,t,r){let n,o,i;function a(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function s(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let n=0,o=e.length;n<o;n++){const o=e[n];void 0===r[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(r[o])}return t}return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),r[e]}}switch(e.type){case"Scene":n=new $g,void 0!==e.background&&Number.isInteger(e.background)&&(n.background=new ga(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?n.fog=new Vs(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(n.fog=new Us(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":n=new zb(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(n.focus=e.focus),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.filmGauge&&(n.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(n.filmOffset=e.filmOffset),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"OrthographicCamera":n=new kj(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"AmbientLight":n=new ap(e.color,e.intensity);break;case"DirectionalLight":n=new Ml(e.color,e.intensity);break;case"PointLight":n=new _o(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":n=new rt(e.color,e.intensity,e.width,e.height);break;case"SpotLight":n=new $o(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":n=new Zo(e.color,e.groundColor,e.intensity);break;case"LightProbe":n=new Ed().fromJSON(e);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":n=new Aa(o=a(e.geometry),i=s(e.material));break;case"InstancedMesh":o=a(e.geometry),i=s(e.material);const t=e.count,r=e.instanceMatrix;(n=new Zs(o,i,t)).instanceMatrix=new pa(new Float32Array(r.array),16);break;case"LOD":n=new ro;break;case"Line":n=new Lc(a(e.geometry),s(e.material),e.mode);break;case"LineLoop":n=new zo(a(e.geometry),s(e.material));break;case"LineSegments":n=new ub(a(e.geometry),s(e.material));break;case"PointCloud":case"Points":n=new Co(a(e.geometry),s(e.material));break;case"Sprite":n=new Xs(s(e.material));break;case"Group":n=new _f;break;default:n=new ja;}if(n.uuid=e.uuid,void 0!==e.name&&(n.name=e.name),void 0!==e.matrix?(n.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(n.matrixAutoUpdate=e.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==e.position&&n.position.fromArray(e.position),void 0!==e.rotation&&n.rotation.fromArray(e.rotation),void 0!==e.quaternion&&n.quaternion.fromArray(e.quaternion),void 0!==e.scale&&n.scale.fromArray(e.scale)),void 0!==e.castShadow&&(n.castShadow=e.castShadow),void 0!==e.receiveShadow&&(n.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(n.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(n.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(n.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&n.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(n.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.frustumCulled&&(n.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(n.renderOrder=e.renderOrder),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.layers&&(n.layers.mask=e.layers),void 0!==e.children){const o=e.children;for(let e=0;e<o.length;e++)n.add(this.parseObject(o[e],t,r))}if("LOD"===e.type){void 0!==e.autoUpdate&&(n.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const r=t[e],o=n.getObjectByProperty("uuid",r.object);void 0!==o&&n.addLevel(o,r.distance)}}return n}});const bX={UVMapping:300,CubeReflectionMapping:Rn,CubeRefractionMapping:is,EquirectangularReflectionMapping:Dz,EquirectangularRefractionMapping:js,CubeUVReflectionMapping:Tk,CubeUVRefractionMapping:ks},bB={RepeatWrapping:tc,ClampToEdgeWrapping:ec,MirroredRepeatWrapping:ui},cB={NearestFilter:Gb,NearestMipmapNearestFilter:Uk,NearestMipmapLinearFilter:Vk,LinearFilter:Qb,LinearMipmapNearestFilter:Sn,LinearMipmapLinearFilter:Of};function xt(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Pa.call(this,e),this.options={premultiplyAlpha:"none"}}function dB(){this.type="ShapePath",this.color=new ga,this.subPaths=[],this.currentPath=null}function eB(e){this.type="Font",this.data=e}function cX(e,t,r){const n=Array.from?Array.from(e):String(e).split(""),o=t/r.resolution,i=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*o,a=[];let s=0,d=0;for(let $=0;$<n.length;$++){const e=n[$];if("\n"===e)s=0,d-=i;else{const t=dX(e,o,s,d,r);s+=t.offsetX,a.push(t.path)}}return a}function dX(e,t,r,n,o){const i=o.glyphs[e]||o.glyphs["?"];if(!i)return void console.error("THREE.Font: character \""+e+"\" does not exists in font family "+o.familyName+".");const a=new dB;let s,d,$,c,p,l,u,h;if(i.o){const e=i._cachedOutline||(i._cachedOutline=i.o.split(" "));for(let o=0,i=e.length;o<i;){switch(e[o++]){case"m":s=e[o++]*t+r,d=e[o++]*t+n,a.moveTo(s,d);break;case"l":s=e[o++]*t+r,d=e[o++]*t+n,a.lineTo(s,d);break;case"q":$=e[o++]*t+r,c=e[o++]*t+n,p=e[o++]*t+r,l=e[o++]*t+n,a.quadraticCurveTo(p,l,$,c);break;case"b":$=e[o++]*t+r,c=e[o++]*t+n,p=e[o++]*t+r,l=e[o++]*t+n,u=e[o++]*t+r,h=e[o++]*t+n,a.bezierCurveTo(p,l,u,h,$,c);}}}return{offsetX:i.ha*t,path:a}}function fB(e){Pa.call(this,e)}let gB;xt.prototype=Object.assign(Object.create(Pa.prototype),{constructor:xt,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,i=jj.get(e);if(void 0!==i)return o.manager.itemStart(e),setTimeout(function(){t&&t(i),o.manager.itemEnd(e)},0),i;fetch(e).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,o.options)}).then(function(r){jj.add(e,r),t&&t(r),o.manager.itemEnd(e)}).catch(function(t){n&&n(t),o.manager.itemError(e),o.manager.itemEnd(e)}),o.manager.itemStart(e)}}),Object.assign(dB.prototype,{moveTo:function(e,t){return this.currentPath=new Dd,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,r,n){return this.currentPath.quadraticCurveTo(e,t,r,n),this},bezierCurveTo:function(e,t,r,n,o,i){return this.currentPath.bezierCurveTo(e,t,r,n,o,i),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function r(e){const t=[];for(let r=0,n=e.length;r<n;r++){const n=e[r],o=new Oc;o.curves=n.curves,t.push(o)}return t}function n(e,t){const r=t.length;let n=!1;for(let o=r-1,i=0;i<r;o=i++){let r=t[o],a=t[i],s=a.x-r.x,d=a.y-r.y;if(Math.abs(d)>Number.EPSILON){if(d<0&&(r=t[i],s=-s,a=t[o],d=-d),e.y<r.y||e.y>a.y)continue;if(e.y===r.y){if(e.x===r.x)return!0}else{const t=d*(e.x-r.x)-s*(e.y-r.y);if(0===t)return!0;if(t<0)continue;n=!n}}else{if(e.y!==r.y)continue;if(a.x<=e.x&&e.x<=r.x||r.x<=e.x&&e.x<=a.x)return!0}}return n}const o=dg.isClockWise,i=this.subPaths;if(0===i.length)return[];if(!0===t)return r(i);let a,s,d,$=[];if(1===i.length)return s=i[0],(d=new Oc).curves=s.curves,$.push(d),$;let c=!o(i[0].getPoints());c=e?!c:c;const p=[],l=[];let u,h,f=[],m=0;l[m]=void 0,f[m]=[];for(let x=0,R=i.length;x<R;x++)a=o(u=(s=i[x]).getPoints()),(a=e?!a:a)?(!c&&l[m]&&m++,l[m]={s:new Oc,p:u},l[m].s.curves=s.curves,c&&m++,f[m]=[]):f[m].push({h:s,p:u[0]});if(!l[0])return r(i);if(l.length>1){let e=!1;const t=[];for(let r=0,n=l.length;r<n;r++)p[r]=[];for(let r=0,o=l.length;r<o;r++){const o=f[r];for(let i=0;i<o.length;i++){const a=o[i];let s=!0;for(let o=0;o<l.length;o++)n(a.p,l[o].p)&&(r!==o&&t.push({froms:r,tos:o,hole:i}),s?(s=!1,p[o].push(a)):e=!0);s&&p[r].push(a)}}t.length>0&&(e||(f=p))}for(let x=0,R=l.length;x<R;x++){d=l[x].s,$.push(d);for(let e=0,t=(h=f[x]).length;e<t;e++)d.holes.push(h[e].h)}return $}}),Object.assign(eB.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);const r=[],n=cX(e,t,this.data);for(let o=0,i=n.length;o<i;o++)Array.prototype.push.apply(r,n[o].toShapes());return r}}),fB.prototype=Object.assign(Object.create(Pa.prototype),{constructor:fB,load:function(e,t,r,n){const o=this,i=new ed(this.manager);i.setPath(this.path),i.load(e,function(e){let r;try{r=JSON.parse(e)}catch(i){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(e.substring(65,e.length-2))}const n=o.parse(r);t&&t(n)},r,n)},parse:function(e){return new eB(e)}});const hB={getContext:function(){return void 0===gB&&(gB=new(window.AudioContext||window.webkitAudioContext)),gB},setContext:function(e){gB=e}};function yt(e){Pa.call(this,e)}function iB(e,t,r){Ed.call(this,void 0,r);const n=new ga().set(e),o=new ga().set(t),i=new ba(n.r,n.g,n.b),a=new ba(o.r,o.g,o.b),s=Math.sqrt(Math.PI),d=s*Math.sqrt(.75);this.sh.coefficients[0].copy(i).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(i).sub(a).multiplyScalar(d)}function jB(e,t){Ed.call(this,void 0,t);const r=new ga().set(e);this.sh.coefficients[0].set(r.r,r.g,r.b).multiplyScalar(2*Math.sqrt(Math.PI))}yt.prototype=Object.assign(Object.create(Pa.prototype),{constructor:yt,load:function(e,t,r,n){const o=this,i=new ed(o.manager);i.setResponseType("arraybuffer"),i.setPath(o.path),i.load(e,function(r){try{const a=r.slice(0);hB.getContext().decodeAudioData(a,function(e){t(e)})}catch(i){n?n(i):console.error(i),o.manager.itemError(e)}},r,n)}}),iB.prototype=Object.assign(Object.create(Ed.prototype),{constructor:iB,isHemisphereLightProbe:!0,copy:function(e){return Ed.prototype.copy.call(this,e),this},toJSON:function(e){return Ed.prototype.toJSON.call(this,e)}}),jB.prototype=Object.assign(Object.create(Ed.prototype),{constructor:jB,isAmbientLightProbe:!0,copy:function(e){return Ed.prototype.copy.call(this,e),this},toJSON:function(e){return Ed.prototype.toJSON.call(this,e)}});const kB=new fa,lB=new fa;function eX(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new zb,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new zb,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function mB(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(eX.prototype,{update:function(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;const r=e.projectionMatrix.clone(),n=t.eyeSep/2,o=n*t.near/t.focus,i=t.near*Math.tan(ta.DEG2RAD*t.fov*.5)/t.zoom;let a,s;lB.elements[12]=-n,kB.elements[12]=n,a=-i*t.aspect+o,s=i*t.aspect+o,r.elements[0]=2*t.near/(s-a),r.elements[8]=(s+a)/(s-a),this.cameraL.projectionMatrix.copy(r),a=-i*t.aspect-o,s=i*t.aspect-o,r.elements[0]=2*t.near/(s-a),r.elements[8]=(s+a)/(s-a),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(lB),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(kB)}}),Object.assign(mB.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});const kh=new ba,nB=new yb,fX=new ba,lh=new ba;function oB(){ja.call(this),this.type="AudioListener",this.context=hB.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new mB}function Nl(e){ja.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._progress=0,this.filters=[]}oB.prototype=Object.assign(Object.create(ja.prototype),{constructor:oB,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){ja.prototype.updateMatrixWorld.call(this,e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(kh,nB,fX),lh.set(0,0,-1).applyQuaternion(nB),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(kh.x,e),t.positionY.linearRampToValueAtTime(kh.y,e),t.positionZ.linearRampToValueAtTime(kh.z,e),t.forwardX.linearRampToValueAtTime(lh.x,e),t.forwardY.linearRampToValueAtTime(lh.y,e),t.forwardZ.linearRampToValueAtTime(lh.z,e),t.upX.linearRampToValueAtTime(r.x,e),t.upY.linearRampToValueAtTime(r.y,e),t.upZ.linearRampToValueAtTime(r.z,e)}else t.setPosition(kh.x,kh.y,kh.z),t.setOrientation(lh.x,lh.y,lh.z,r.x,r.y,r.z)}}),Nl.prototype=Object.assign(Object.create(ja.prototype),{constructor:Nl,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(void 0===e&&(e=0),!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});const mh=new ba,pB=new yb,gX=new ba,nh=new ba;function qB(e){Nl.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function rB(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function sB(e,t,r){let n,o,i;switch(this.binding=e,this.valueSize=r,t){case"quaternion":n=this._slerp,o=this._slerpAdditive,i=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":n=this._select,o=this._select,i=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:n=this._lerp,o=this._lerpAdditive,i=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r);}this._mixBufferRegion=n,this._mixBufferRegionAdditive=o,this._setIdentity=i,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}qB.prototype=Object.assign(Object.create(Nl.prototype),{constructor:qB,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this},updateMatrixWorld:function(e){if(ja.prototype.updateMatrixWorld.call(this,e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(mh,pB,gX),nh.set(0,0,1).applyQuaternion(pB);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(mh.x,e),t.positionY.linearRampToValueAtTime(mh.y,e),t.positionZ.linearRampToValueAtTime(mh.z,e),t.orientationX.linearRampToValueAtTime(nh.x,e),t.orientationY.linearRampToValueAtTime(nh.y,e),t.orientationZ.linearRampToValueAtTime(nh.z,e)}else t.setPosition(mh.x,mh.y,mh.z),t.setOrientation(nh.x,nh.y,nh.z)}}),Object.assign(rB.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}),Object.assign(sB.prototype,{accumulate:function(e,t){const r=this.buffer,n=this.valueSize,o=e*n+n;let i=this.cumulativeWeight;if(0===i){for(let e=0;e!==n;++e)r[o+e]=r[e];i=t}else{const e=t/(i+=t);this._mixBufferRegion(r,o,0,e,n)}this.cumulativeWeight=i},accumulateAdditive:function(e){const t=this.buffer,r=this.valueSize,n=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,n,0,e,r),this.cumulativeWeightAdditive+=e},apply:function(e){const t=this.valueSize,r=this.buffer,n=e*t+t,o=this.cumulativeWeight,i=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const e=t*this._origIndex;this._mixBufferRegion(r,n,e,1-o,t)}i>0&&this._mixBufferRegionAdditive(r,n,this._addIndex*t,1,t);for(let s=t,d=t+t;s!==d;++s)if(r[s]!==r[s+t]){a.setValue(r,n);break}},saveOriginalState:function(){const e=this.binding,t=this.buffer,r=this.valueSize,n=r*this._origIndex;e.getValue(t,n);for(let o=r,i=n;o!==i;++o)t[o]=t[n+o%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_setAdditiveIdentityNumeric:function(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]},_select:function(e,t,r,n,o){if(n>=.5)for(let i=0;i!==o;++i)e[t+i]=e[r+i]},_slerp:function(e,t,r,n){yb.slerpFlat(e,t,e,t,e,r,n)},_slerpAdditive:function(e,t,r,n,o){const i=this._workIndex*o;yb.multiplyQuaternionsFlat(e,i,e,t,e,r),yb.slerpFlat(e,t,e,t,e,i,n)},_lerp:function(e,t,r,n,o){const i=1-n;for(let a=0;a!==o;++a){const o=t+a;e[o]=e[o]*i+e[r+a]*n}},_lerpAdditive:function(e,t,r,n,o){for(let i=0;i!==o;++i){const o=t+i;e[o]=e[o]+e[r+i]*n}}});const hX=new RegExp("[\\[\\]\\.:\\/]","g"),iX="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",jX=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),kX=/(WCOD+)?/.source.replace("WCOD",iX),lX=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),mX=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),nX=new RegExp("^"+jX+kX+lX+mX+"$"),oX=["material","materials","bones"];function tB(e,t,r){const n=r||Ib.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function Ib(e,t,r){this.path=t,this.parsedPath=r||Ib.parseTrackName(t),this.node=Ib.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function pX(){this.uuid=ta.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,n=arguments.length;r!==n;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}function uB(e,t,r,n){this._mixer=e,this._clip=t,this._localRoot=r||null,this.blendMode=n||t.blendMode;const o=t.tracks,i=o.length,a=new Array(i),s={endingStart:wi,endingEnd:wi};for(let d=0;d!==i;++d){const e=o[d].createInterpolant(null);a[d]=e,e.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=iS,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function vB(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function zt(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function wB(e,t,r){Kc.call(this,e,t),this.meshPerAttribute=r||1}function At(e,t,r,n){this.ray=new Di(e,t),this.near=r||0,this.far=n||1/0,this.camera=null,this.layers=new rs,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function xB(e,t){return e.distance-t.distance}function Bt(e,t,r,n){if(e.layers.test(t.layers)&&e.raycast(t,r),!0===n){const n=e.children;for(let e=0,o=n.length;e<o;e++)Bt(n[e],t,r,!0)}}function Ct(e,t,r){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==r?r:0,this}function qX(e,t,r){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==r?r:0,this}Object.assign(tB.prototype,{getValue:function(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){const r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,o=r.length;n!==o;++n)r[n].setValue(e,t)},bind:function(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()},unbind:function(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}),Object.assign(Ib,{Composite:tB,create:function(e,t,r){return e&&e.isAnimationObjectGroup?new Ib.Composite(e,t,r):new Ib(e,t,r)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(hX,"")},parseTrackName:function(e){const t=nX.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){const e=r.nodeName.substring(n+1);-1!==oX.indexOf(e)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=e)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){const r=function(e){for(let n=0;n<e.length;n++){const o=e[n];if(o.name===t||o.uuid===t)return o;const i=r(o.children);if(i)return i}return null},n=r(e.children);if(n)return n}return null}}),Object.assign(Ib.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){const r=this.resolvedProperty;for(let n=0,o=r.length;n!==o;++n)e[t++]=r[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){const r=this.resolvedProperty;for(let n=0,o=r.length;n!==o;++n)r[n]=e[t++]},function(e,t){const r=this.resolvedProperty;for(let n=0,o=r.length;n!==o;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){const r=this.resolvedProperty;for(let n=0,o=r.length;n!==o;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){let e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,o=t.propertyIndex;if(e||(e=Ib.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let n=t.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===n){n=t;break}break;default:if(void 0===e[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r];}if(void 0!==n){if(void 0===e[n])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[n]}}const i=e[n];if(void 0===i){const r=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+r+"."+n+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[o]&&(o=e.morphTargetDictionary[o])}s=this.BindingType.ArrayElement,this.resolvedProperty=i,this.propertyIndex=o}else void 0!==i.fromArray&&void 0!==i.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=i):Array.isArray(i)?(s=this.BindingType.EntireArray,this.resolvedProperty=i):this.propertyName=n;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][a]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Ib.prototype,{_getValue_unbound:Ib.prototype.getValue,_setValue_unbound:Ib.prototype.setValue}),Object.assign(pX.prototype,{isAnimationObjectGroup:!0,add:function(){const e=this._objects,t=this._indicesByUUID,r=this._paths,n=this._parsedPaths,o=this._bindings,i=o.length;let a=void 0,s=e.length,d=this.nCachedObjects_;for(let $=0,c=arguments.length;$!==c;++$){const c=arguments[$],p=c.uuid;let l=t[p];if(void 0===l){l=s++,t[p]=l,e.push(c);for(let e=0,t=i;e!==t;++e)o[e].push(new Ib(c,r[e],n[e]))}else if(l<d){a=e[l];const s=--d,$=e[s];t[$.uuid]=l,e[l]=$,t[p]=s,e[s]=c;for(let e=0,t=i;e!==t;++e){const t=o[e],i=t[s];let a=t[l];t[l]=i,void 0===a&&(a=new Ib(c,r[e],n[e])),t[s]=a}}else e[l]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=d},remove:function(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,n=r.length;let o=this.nCachedObjects_;for(let i=0,a=arguments.length;i!==a;++i){const a=arguments[i],s=a.uuid,d=t[s];if(void 0!==d&&d>=o){const i=o++,$=e[i];t[$.uuid]=d,e[d]=$,t[s]=i,e[i]=a;for(let e=0,t=n;e!==t;++e){const t=r[e],n=t[i],o=t[d];t[d]=n,t[i]=o}}}this.nCachedObjects_=o},uncache:function(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,n=r.length;let o=this.nCachedObjects_,i=e.length;for(let a=0,s=arguments.length;a!==s;++a){const s=arguments[a].uuid,d=t[s];if(void 0!==d)if(delete t[s],d<o){const a=--o,s=e[a],$=--i,c=e[$];t[s.uuid]=d,e[d]=s,t[c.uuid]=a,e[a]=c,e.pop();for(let e=0,t=n;e!==t;++e){const t=r[e],n=t[a],o=t[$];t[d]=n,t[a]=o,t.pop()}}else{const o=--i,a=e[o];t[a.uuid]=d,e[d]=a,e.pop();for(let e=0,t=n;e!==t;++e){const t=r[e];t[d]=t[o],t.pop()}}}this.nCachedObjects_=o},subscribe_:function(e,t){let r=this._bindingsIndicesByPath,n=r[e],o=this._bindings;if(void 0!==n)return o[n];const i=this._paths,a=this._parsedPaths,s=this._objects,d=s.length,$=this.nCachedObjects_,c=new Array(d);n=o.length,r[e]=n,i.push(e),a.push(t),o.push(c);for(let p=$,l=s.length;p!==l;++p){const r=s[p];c[p]=new Ib(r,e,t)}return c},unsubscribe_:function(e){const t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){const n=this._paths,o=this._parsedPaths,i=this._bindings,a=i.length-1,s=i[a];t[e[a]]=r,i[r]=s,i.pop(),o[r]=o[a],o.pop(),n[r]=n[a],n.pop()}}}),Object.assign(uB.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const r=this._clip.duration,n=e._clip.duration,o=n/r,i=r/n;e.warp(1,o,t),this.warp(i,1,t)}return this},crossFadeTo:function(e,t,r){return e.crossFadeFrom(this,t,r)},stopFading:function(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,r){const n=this._mixer,o=n.time,i=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);const s=a.parameterPositions,d=a.sampleValues;return s[0]=o,s[1]=o+r,d[0]=e/i,d[1]=t/i,this},stopWarping:function(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,r,n){if(!this.enabled)return void this._updateWeight(e);const o=this._startTime;if(null!==o){const n=(e-o)*r;if(n<0||0===r)return;this._startTime=null,t=r*n}t*=this._updateTimeScale(e);const i=this._updateTime(t),a=this._updateWeight(e);if(a>0){const e=this._interpolants,t=this._propertyBindings;switch(this.blendMode){case 2501:for(let r=0,n=e.length;r!==n;++r)e[r].evaluate(i),t[r].accumulateAdditive(a);break;case ms:default:for(let r=0,o=e.length;r!==o;++r)e[r].evaluate(i),t[r].accumulate(n,a);}}},_updateWeight:function(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(null!==r){const n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(null!==r){t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t},_updateTime:function(e){const t=this._clip.duration,r=this.loop;let n=this.time+e,o=this._loopCount;const i=2202===r;if(0===e)return-1===o?n:i&&1==(1&o)?t-n:n;if(2200===r){-1===o&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else{if(!(n<0)){this.time=n;break e}n=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===o&&(e>=0?(o=0,this._setEndings(!0,0===this.repetitions,i)):this._setEndings(0===this.repetitions,!0,i)),n>=t||n<0){const r=Math.floor(n/t);n-=t*r,o+=Math.abs(r);const a=this.repetitions-o;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?t:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===a){const t=e<0;this._setEndings(t,!t,i)}else this._setEndings(!1,!1,i);this._loopCount=o,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:r})}}else this.time=n;if(i&&1==(1&o))return t-n}return n},_setEndings:function(e,t,r){const n=this._interpolantSettings;r?(n.endingStart=2401,n.endingEnd=2401):(n.endingStart=e?this.zeroSlopeAtStart?2401:wi:2402,n.endingEnd=t?this.zeroSlopeAtEnd?2401:wi:2402)},_scheduleFading:function(e,t,r){const n=this._mixer,o=n.time;let i=this._weightInterpolant;null===i&&(i=n._lendControlInterpolant(),this._weightInterpolant=i);const a=i.parameterPositions,s=i.sampleValues;return a[0]=o,s[0]=t,a[1]=o+e,s[1]=r,this}}),vB.prototype=Object.assign(Object.create(Qa.prototype),{constructor:vB,_bindAction:function(e,t){const r=e._localRoot||this._root,n=e._clip.tracks,o=n.length,i=e._propertyBindings,a=e._interpolants,s=r.uuid,d=this._bindingsByRootAndName;let $=d[s];void 0===$&&($={},d[s]=$);for(let c=0;c!==o;++c){const e=n[c],o=e.name;let d=$[o];if(void 0!==d)i[c]=d;else{if(void 0!==(d=i[c])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,o));continue}const n=t&&t._propertyBindings[c].binding.parsedPath;++(d=new sB(Ib.create(r,o,n),e.ValueTypeName,e.getValueSize())).referenceCount,this._addInactiveBinding(d,s,o),i[c]=d}a[c].resultBuffer=d.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,r){const n=this._actions,o=this._actionsByClip;let i=o[t];if(void 0===i)i={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[t]=i;else{const t=i.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=n.length,n.push(e),i.actionByRoot[r]=e},_removeInactiveAction:function(e){const t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;const o=e._clip.uuid,i=this._actionsByClip,a=i[o],s=a.knownActions,d=s[s.length-1],$=e._byClipCacheIndex;d._byClipCacheIndex=$,s[$]=d,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete i[o],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){const t=e._propertyBindings;for(let r=0,n=t.length;r!==n;++r){const e=t[r];0==--e.referenceCount&&this._removeInactiveBinding(e)}},_lendAction:function(e){const t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,o=t[n];e._cacheIndex=n,t[n]=e,o._cacheIndex=r,t[r]=o},_takeBackAction:function(e){const t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,o=t[n];e._cacheIndex=n,t[n]=e,o._cacheIndex=r,t[r]=o},_addInactiveBinding:function(e,t,r){const n=this._bindingsByRootAndName,o=this._bindings;let i=n[t];void 0===i&&(i={},n[t]=i),i[r]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){const t=this._bindings,r=e.binding,n=r.rootNode.uuid,o=r.path,i=this._bindingsByRootAndName,a=i[n],s=t[t.length-1],d=e._cacheIndex;s._cacheIndex=d,t[d]=s,t.pop(),delete a[o],0===Object.keys(a).length&&delete i[n]},_lendBinding:function(e){const t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,o=t[n];e._cacheIndex=n,t[n]=e,o._cacheIndex=r,t[r]=o},_takeBackBinding:function(e){const t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,o=t[n];e._cacheIndex=n,t[n]=e,o._cacheIndex=r,t[r]=o},_lendControlInterpolant:function(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return void 0===r&&((r=new Xo(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=r),r},_takeBackControlInterpolant:function(e){const t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,o=t[n];e.__cacheIndex=n,t[n]=e,o.__cacheIndex=r,t[r]=o},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t,r){const n=t||this._root,o=n.uuid;let i="string"==typeof e?dd.findByName(n,e):e;const a=null!==i?i.uuid:e;let s=this._actionsByClip[a],d=null;if(void 0===r&&(r=null!==i?i.blendMode:ms),void 0!==s){const e=s.actionByRoot[o];if(void 0!==e&&e.blendMode===r)return e;d=s.knownActions[0],null===i&&(i=d._clip)}if(null===i)return null;const $=new uB(this,i,t,r);return this._bindAction($,d),this._addInactiveAction($,a,o),$},existingAction:function(e,t){const r=t||this._root,n=r.uuid,o="string"==typeof e?dd.findByName(r,e):e,i=o?o.uuid:e,a=this._actionsByClip[i];return void 0!==a&&a.actionByRoot[n]||null},stopAllAction:function(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this},update:function(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,n=this.time+=e,o=Math.sign(e),i=this._accuIndex^=1;for(let d=0;d!==r;++d){t[d]._update(n,e,o,i)}const a=this._bindings,s=this._nActiveBindings;for(let d=0;d!==s;++d)a[d].apply(i);return this},setTime:function(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){const t=this._actions,r=e.uuid,n=this._actionsByClip,o=n[r];if(void 0!==o){const e=o.knownActions;for(let r=0,n=e.length;r!==n;++r){const n=e[r];this._deactivateAction(n);const o=n._cacheIndex,i=t[t.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,i._cacheIndex=o,t[o]=i,t.pop(),this._removeInactiveBindingsForAction(n)}delete n[r]}},uncacheRoot:function(e){const t=e.uuid,r=this._actionsByClip;for(const o in r){const e=r[o].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const n=this._bindingsByRootAndName[t];if(void 0!==n)for(const o in n){const e=n[o];e.restoreOriginalState(),this._removeInactiveBinding(e)}},uncacheAction:function(e,t){const r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}),zt.prototype.clone=function(){return new zt(void 0===this.value.clone?this.value:this.value.clone())},wB.prototype=Object.assign(Object.create(Kc.prototype),{constructor:wB,isInstancedInterleavedBuffer:!0,copy:function(e){return Kc.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){const t=Kc.prototype.clone.call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t},toJSON:function(e){const t=Kc.prototype.toJSON.call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}),Object.assign(At.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,r){const n=r||[];return Bt(e,this,n,t),n.sort(xB),n},intersectObjects:function(e,t,r){const n=r||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(let o=0,i=e.length;o<i;o++)Bt(e[o],this,n,t);return n.sort(xB),n}}),Object.assign(Ct.prototype,{set:function(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(ta.clamp(t/this.radius,-1,1))),this}}),Object.assign(qX.prototype,{set:function(e,t,r){return this.radius=e,this.theta=t,this.y=r,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}});const yB=new ca;function zB(e,t){this.min=void 0!==e?e:new ca(1/0,1/0),this.max=void 0!==t?t:new ca(-1/0,-1/0)}Object.assign(zB.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){const r=yB.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new ca),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new ca),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new ca),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new ca),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return yB.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});const AB=new ba,dp=new ba;function BB(e,t){this.start=void 0!==e?e:new ba,this.end=void 0!==t?t:new ba}function ep(e){ja.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Object.assign(BB.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new ba),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new ba),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new ba),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){AB.subVectors(e,this.start),dp.subVectors(this.end,this.start);const r=dp.dot(dp);let n=dp.dot(AB)/r;return t&&(n=ta.clamp(n,0,1)),n},closestPointToPoint:function(e,t,r){const n=this.closestPointToPointParameter(e,t);return void 0===r&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),r=new ba),this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),ep.prototype=Object.create(ja.prototype),ep.prototype.constructor=ep,ep.prototype.isImmediateRenderObject=!0;const CB=new ba;function Ol(e,t){ja.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const r=new ia,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let i=0,a=1,s=32;i<s;i++,a++){const e=i/s*Math.PI*2,t=a/s*Math.PI*2;n.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}r.setAttribute("position",new ma(n,3));const o=new ob({fog:!1,toneMapped:!1});this.cone=new ub(r,o),this.add(this.cone),this.update()}Ol.prototype=Object.create(ja.prototype),Ol.prototype.constructor=Ol,Ol.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Ol.prototype.update=function(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),CB.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(CB),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};const hg=new ba,fp=new fa,Dt=new fa;function DB(e){const t=[];e&&e.isBone&&t.push(e);for(let r=0;r<e.children.length;r++)t.push.apply(t,DB(e.children[r]));return t}function lj(e){const t=DB(e),r=new ia,n=[],o=[],i=new ga(0,0,1),a=new ga(0,1,0);for(let d=0;d<t.length;d++){const e=t[d];e.parent&&e.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),o.push(i.r,i.g,i.b),o.push(a.r,a.g,a.b))}r.setAttribute("position",new ma(n,3)),r.setAttribute("color",new ma(o,3));const s=new ob({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});ub.call(this,r,s),this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Pl(e,t,r){this.light=e,this.light.updateMatrixWorld(),this.color=r;const n=new $i(t,4,2),o=new kb({wireframe:!0,fog:!1,toneMapped:!1});Aa.call(this,n,o),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}lj.prototype=Object.create(ub.prototype),lj.prototype.constructor=lj,lj.prototype.isSkeletonHelper=!0,lj.prototype.updateMatrixWorld=function(e){const t=this.bones,r=this.geometry,n=r.getAttribute("position");Dt.getInverse(this.root.matrixWorld);for(let o=0,i=0;o<t.length;o++){const e=t[o];e.parent&&e.parent.isBone&&(fp.multiplyMatrices(Dt,e.matrixWorld),hg.setFromMatrixPosition(fp),n.setXYZ(i,hg.x,hg.y,hg.z),fp.multiplyMatrices(Dt,e.parent.matrixWorld),hg.setFromMatrixPosition(fp),n.setXYZ(i+1,hg.x,hg.y,hg.z),i+=2)}r.getAttribute("position").needsUpdate=!0,ja.prototype.updateMatrixWorld.call(this,e)},Pl.prototype=Object.create(Aa.prototype),Pl.prototype.constructor=Pl,Pl.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Pl.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};const rX=new ba,EB=new ga,FB=new ga;function Ql(e,t,r){ja.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r;const n=new Wi(t);n.rotateY(.5*Math.PI),this.material=new kb({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const o=n.getAttribute("position"),i=new Float32Array(3*o.count);n.setAttribute("color",new pa(i,3)),this.add(new Aa(n,this.material)),this.update()}function Rl(e,t,r,n){e=e||10,t=t||10,r=new ga(void 0!==r?r:4473924),n=new ga(void 0!==n?n:8947848);const o=t/2,i=e/t,a=e/2,s=[],d=[];for(let p=0,l=0,u=-a;p<=t;p++,u+=i){s.push(-a,0,u,a,0,u),s.push(u,0,-a,u,0,a);const e=p===o?r:n;e.toArray(d,l),l+=3,e.toArray(d,l),l+=3,e.toArray(d,l),l+=3,e.toArray(d,l),l+=3}const $=new ia;$.setAttribute("position",new ma(s,3)),$.setAttribute("color",new ma(d,3));const c=new ob({vertexColors:!0,toneMapped:!1});ub.call(this,$,c),this.type="GridHelper"}function Et(e,t,r,n,o,i){e=e||10,t=t||16,r=r||8,n=n||64,o=new ga(void 0!==o?o:4473924),i=new ga(void 0!==i?i:8947848);const a=[],s=[];for(let c=0;c<=t;c++){const r=c/t*(2*Math.PI),n=Math.sin(r)*e,d=Math.cos(r)*e;a.push(0,0,0),a.push(n,0,d);const $=1&c?o:i;s.push($.r,$.g,$.b),s.push($.r,$.g,$.b)}for(let c=0;c<=r;c++){const t=1&c?o:i,d=e-e/r*c;for(let e=0;e<n;e++){let r=e/n*(2*Math.PI),o=Math.sin(r)*d,i=Math.cos(r)*d;a.push(o,0,i),s.push(t.r,t.g,t.b),r=(e+1)/n*(2*Math.PI),o=Math.sin(r)*d,i=Math.cos(r)*d,a.push(o,0,i),s.push(t.r,t.g,t.b)}}const d=new ia;d.setAttribute("position",new ma(a,3)),d.setAttribute("color",new ma(s,3));const $=new ob({vertexColors:!0,toneMapped:!1});ub.call(this,d,$),this.type="PolarGridHelper"}Ql.prototype=Object.create(ja.prototype),Ql.prototype.constructor=Ql,Ql.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Ql.prototype.update=function(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");EB.copy(this.light.color),FB.copy(this.light.groundColor);for(let e=0,r=t.count;e<r;e++){const n=e<r/2?EB:FB;t.setXYZ(e,n.r,n.g,n.b)}t.needsUpdate=!0}e.lookAt(rX.setFromMatrixPosition(this.light.matrixWorld).negate())},Rl.prototype=Object.assign(Object.create(ub.prototype),{constructor:Rl,copy:function(e){return ub.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return new this.constructor().copy(this)}}),Et.prototype=Object.create(ub.prototype),Et.prototype.constructor=Et;const GB=new ba,gp=new ba,HB=new ba;function Sl(e,t,r){ja.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===t&&(t=1);let n=new ia;n.setAttribute("position",new ma([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const o=new ob({fog:!1,toneMapped:!1});this.lightPlane=new Lc(n,o),this.add(this.lightPlane),(n=new ia).setAttribute("position",new ma([0,0,0,0,0,1],3)),this.targetLine=new Lc(n,o),this.add(this.targetLine),this.update()}Sl.prototype=Object.create(ja.prototype),Sl.prototype.constructor=Sl,Sl.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Sl.prototype.update=function(){GB.setFromMatrixPosition(this.light.matrixWorld),gp.setFromMatrixPosition(this.light.target.matrixWorld),HB.subVectors(gp,GB),this.lightPlane.lookAt(gp),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(gp),this.targetLine.scale.z=HB.length()};const hp=new ba,vb=new We;function ip(e){const t=new ia,r=new ob({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],o=[],i={},a=new ga(16755200),s=new ga(16711680),d=new ga(43775),$=new ga(16777215),c=new ga(3355443);function p(e,t,r){l(e,r),l(t,r)}function l(e,t){n.push(0,0,0),o.push(t.r,t.g,t.b),void 0===i[e]&&(i[e]=[]),i[e].push(n.length/3-1)}p("n1","n2",a),p("n2","n4",a),p("n4","n3",a),p("n3","n1",a),p("f1","f2",a),p("f2","f4",a),p("f4","f3",a),p("f3","f1",a),p("n1","f1",a),p("n2","f2",a),p("n3","f3",a),p("n4","f4",a),p("p","n1",s),p("p","n2",s),p("p","n3",s),p("p","n4",s),p("u1","u2",d),p("u2","u3",d),p("u3","u1",d),p("c","t",$),p("p","c",c),p("cn1","cn2",c),p("cn3","cn4",c),p("cf1","cf2",c),p("cf3","cf4",c),t.setAttribute("position",new ma(n,3)),t.setAttribute("color",new ma(o,3)),ub.call(this,t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=i,this.update()}function Ab(e,t,r,n,o,i,a){hp.set(o,i,a).unproject(n);const s=t[e];if(void 0!==s){const e=r.getAttribute("position");for(let t=0,r=s.length;t<r;t++)e.setXYZ(s[t],hp.x,hp.y,hp.z)}}ip.prototype=Object.create(ub.prototype),ip.prototype.constructor=ip,ip.prototype.update=function(){const e=this.geometry,t=this.pointMap;vb.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ab("c",t,e,vb,0,0,-1),Ab("t",t,e,vb,0,0,1),Ab("n1",t,e,vb,-1,-1,-1),Ab("n2",t,e,vb,1,-1,-1),Ab("n3",t,e,vb,-1,1,-1),Ab("n4",t,e,vb,1,1,-1),Ab("f1",t,e,vb,-1,-1,1),Ab("f2",t,e,vb,1,-1,1),Ab("f3",t,e,vb,-1,1,1),Ab("f4",t,e,vb,1,1,1),Ab("u1",t,e,vb,.7,1.1,-1),Ab("u2",t,e,vb,-.7,1.1,-1),Ab("u3",t,e,vb,0,2,-1),Ab("cf1",t,e,vb,-1,0,1),Ab("cf2",t,e,vb,1,0,1),Ab("cf3",t,e,vb,0,-1,1),Ab("cf4",t,e,vb,0,1,1),Ab("cn1",t,e,vb,-1,0,-1),Ab("cn2",t,e,vb,1,0,-1),Ab("cn3",t,e,vb,0,-1,-1),Ab("cn4",t,e,vb,0,1,-1),e.getAttribute("position").needsUpdate=!0};const jp=new wc;function oh(e,t){this.object=e,void 0===t&&(t=16776960);const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),o=new ia;o.setIndex(new pa(r,1)),o.setAttribute("position",new pa(n,3)),ub.call(this,o,new ob({color:t,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function kp(e,t){this.type="Box3Helper",this.box=e,t=t||16776960;const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new ia;n.setIndex(new pa(r,1)),n.setAttribute("position",new ma([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),ub.call(this,n,new ob({color:t,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function lp(e,t,r){this.plane=e,this.size=void 0===t?1:t;const n=void 0!==r?r:16776960,o=new ia;o.setAttribute("position",new ma([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),o.computeBoundingSphere(),Lc.call(this,o,new ob({color:n,toneMapped:!1})),this.type="PlaneHelper";const i=new ia;i.setAttribute("position",new ma([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),i.computeBoundingSphere(),this.add(new Aa(i,new kb({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}oh.prototype=Object.create(ub.prototype),oh.prototype.constructor=oh,oh.prototype.update=function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&jp.setFromObject(this.object),jp.isEmpty())return;const t=jp.min,r=jp.max,n=this.geometry.attributes.position,o=n.array;o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=t.x,o[4]=r.y,o[5]=r.z,o[6]=t.x,o[7]=t.y,o[8]=r.z,o[9]=r.x,o[10]=t.y,o[11]=r.z,o[12]=r.x,o[13]=r.y,o[14]=t.z,o[15]=t.x,o[16]=r.y,o[17]=t.z,o[18]=t.x,o[19]=t.y,o[20]=t.z,o[21]=r.x,o[22]=t.y,o[23]=t.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()},oh.prototype.setFromObject=function(e){return this.object=e,this.update(),this},oh.prototype.copy=function(e){return ub.prototype.copy.call(this,e),this.object=e.object,this},oh.prototype.clone=function(){return new this.constructor().copy(this)},kp.prototype=Object.create(ub.prototype),kp.prototype.constructor=kp,kp.prototype.updateMatrixWorld=function(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),ja.prototype.updateMatrixWorld.call(this,e))},lp.prototype=Object.create(Lc.prototype),lp.prototype.constructor=lp,lp.prototype.updateMatrixWorld=function(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?Ob:Pe,this.lookAt(this.plane.normal),ja.prototype.updateMatrixWorld.call(this,e)};const IB=new ba;let JB,sX;function ig(e,t,r,n,o,i){ja.call(this),this.type="ArrowHelper",void 0===e&&(e=new ba(0,0,1)),void 0===t&&(t=new ba(0,0,0)),void 0===r&&(r=1),void 0===n&&(n=16776960),void 0===o&&(o=.2*r),void 0===i&&(i=.2*o),void 0===JB&&((JB=new ia).setAttribute("position",new ma([0,0,0,0,1,0],3)),(sX=new eg(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Lc(JB,new ob({color:n,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Aa(sX,new kb({color:n,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,o,i)}function Tl(e){const t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new ia;r.setAttribute("position",new ma(t,3)),r.setAttribute("color",new ma([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));const n=new ob({vertexColors:!0,toneMapped:!1});ub.call(this,r,n),this.type="AxesHelper"}ig.prototype=Object.create(ja.prototype),ig.prototype.constructor=ig,ig.prototype.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{IB.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(IB,t)}},ig.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e),void 0===r&&(r=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()},ig.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},ig.prototype.copy=function(e){return ja.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},ig.prototype.clone=function(){return new this.constructor().copy(this)},Tl.prototype=Object.create(ub.prototype),Tl.prototype.constructor=Tl;const mj=4,jg=8,_d=Math.pow(2,jg),KB=[.125,.215,.35,.446,.526,.582],LB=jg-mj+1+KB.length,nj=20,be={[uc]:0,[vc]:1,[os]:2,[Qz]:3,[Rz]:4,[Sz]:5,[ns]:6},Ft=new kj,{_lodPlanes:Ul,_sizeLods:MB,_sigmas:mp}=vX();let tX=null;const ph=(1+Math.sqrt(5))/2,oj=1/ph,NB=[new ba(1,1,1),new ba(-1,1,1),new ba(1,1,-1),new ba(-1,1,-1),new ba(0,ph,oj),new ba(0,ph,-oj),new ba(oj,0,ph),new ba(-oj,0,ph),new ba(ph,oj,0),new ba(-ph,oj,0)];function OB(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=wX(nj),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function uX(e){return void 0!==e&&e.type===Wk&&(e.encoding===uc||e.encoding===vc||e.encoding===ns)}function vX(){const e=[],t=[],r=[];let n=jg;for(let o=0;o<LB;o++){const i=Math.pow(2,n);t.push(i);let a=1/i;o>jg-mj?a=KB[o-jg+mj-1]:0==o&&(a=0),r.push(a);const s=1/(i-1),d=-s/2,$=1+s/2,c=[d,d,$,d,$,$,d,d,$,$,d,$],p=6,l=6,u=3,h=2,f=1,m=new Float32Array(u*l*p),x=new Float32Array(h*l*p),R=new Float32Array(f*l*p);for(let e=0;e<p;e++){const t=e%3*2/3-1,r=e>2?0:-1,n=[t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0];m.set(n,u*l*e),x.set(c,h*l*e);const o=[e,e,e,e,e,e];R.set(o,f*l*e)}const g=new ia;g.setAttribute("position",new pa(m,u)),g.setAttribute("uv",new pa(x,h)),g.setAttribute("faceIndex",new pa(R,f)),e.push(g),n>mj&&n--}return{_lodPlanes:e,_sizeLods:t,_sigmas:r}}function PB(e){const t=new ad(3*_d,3*_d,e);return t.texture.mapping=Tk,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function np(e,t,r,n,o){e.viewport.set(t,r,n,o),e.scissor.set(t,r,n,o)}function wX(e){return new fg({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:new Float32Array(e)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new ba(0,1,0)},inputEncoding:{value:be[uc]},outputEncoding:{value:be[uc]}},vertexShader:Gt(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n${Ht()}\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:Nf,depthTest:!1,depthWrite:!1})}function QB(){return new fg({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new ca(1,1)},inputEncoding:{value:be[uc]},outputEncoding:{value:be[uc]}},vertexShader:Gt(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n${Ht()}\n\n#include <common>\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv = equirectUv( outputDirection );\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:Nf,depthTest:!1,depthWrite:!1})}function RB(){return new fg({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:be[uc]},outputEncoding:{value:be[uc]}},vertexShader:Gt(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n${Ht()}\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:Nf,depthTest:!1,depthWrite:!1})}function Gt(){return"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\n\n// RH coordinate system; PMREM face-indexing convention\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\t} else if (face == 2.0) {\n\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\t} else if (face == 5.0) {\n\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\t}\n\treturn direction;\n}\n\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t"}function Ht(){return"\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t"}OB.prototype={constructor:OB,fromScene:function(e,t=0,r=.1,n=100){tX=this._renderer.getRenderTarget();const o=this._allocateTargets();return this._sceneToCubeUV(e,r,n,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o},fromEquirectangular:function(e){return this._fromTexture(e)},fromCubemap:function(e){return this._fromTexture(e)},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=RB(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=QB(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<Ul.length;e++)Ul[e].dispose()},_cleanup:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(tX),e.scissorTest=!1,np(e,0,0,e.width,e.height)},_fromTexture:function(e){tX=this._renderer.getRenderTarget();const t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t},_allocateTargets:function(e){const t={magFilter:Gb,minFilter:Gb,generateMipmaps:!1,type:Wk,format:zR,encoding:uX(e)?e.encoding:os,depthBuffer:!1,stencilBuffer:!1},r=PB(t);return r.depthBuffer=!e,this._pingPongRenderTarget=PB(t),r},_compileMaterial:function(e){const t=new Aa(Ul[0],e);this._renderer.compile(t,Ft)},_sceneToCubeUV:function(e,t,r,n){const o=new zb(90,1,t,r),i=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],s=this._renderer,d=s.outputEncoding,$=s.toneMapping,c=s.getClearColor(),p=s.getClearAlpha();s.toneMapping=ti,s.outputEncoding=uc;let l=e.background;if(l&&l.isColor){l.convertSRGBToLinear();const t=Math.max(l.r,l.g,l.b),r=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);l=l.multiplyScalar(Math.pow(2,-r));const n=(r+128)/255;s.setClearColor(l,n),e.background=null}for(let u=0;u<6;u++){const t=u%3;0==t?(o.up.set(0,i[u],0),o.lookAt(a[u],0,0)):1==t?(o.up.set(0,0,i[u]),o.lookAt(0,a[u],0)):(o.up.set(0,i[u],0),o.lookAt(0,0,a[u])),np(n,t*_d,u>2?_d:0,_d,_d),s.setRenderTarget(n),s.render(e,o)}s.toneMapping=$,s.outputEncoding=d,s.setClearColor(c,p)},_textureToCubeUV:function(e,t){const r=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=RB()):null==this._equirectShader&&(this._equirectShader=QB());const n=e.isCubeTexture?this._cubemapShader:this._equirectShader,o=new Aa(Ul[0],n),i=n.uniforms;i.envMap.value=e,e.isCubeTexture||i.texelSize.value.set(1/e.image.width,1/e.image.height),i.inputEncoding.value=be[e.encoding],i.outputEncoding.value=be[t.texture.encoding],np(t,0,0,3*_d,2*_d),r.setRenderTarget(t),r.render(o,Ft)},_applyPMREM:function(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let n=1;n<LB;n++){const t=Math.sqrt(mp[n]*mp[n]-mp[n-1]*mp[n-1]),r=NB[(n-1)%NB.length];this._blur(e,n-1,n,t,r)}t.autoClear=r},_blur:function(e,t,r,n,o){const i=this._pingPongRenderTarget;this._halfBlur(e,i,t,r,n,"latitudinal",o),this._halfBlur(i,e,r,r,n,"longitudinal",o)},_halfBlur:function(e,t,r,n,o,i,a){const s=this._renderer,d=this._blurMaterial;"latitudinal"!==i&&"longitudinal"!==i&&console.error("blur direction must be either latitudinal or longitudinal!");const $=new Aa(Ul[n],d),c=d.uniforms,p=MB[r]-1,l=isFinite(o)?Math.PI/(2*p):2*Math.PI/(2*nj-1),u=o/l,h=isFinite(o)?1+Math.floor(3*u):nj;h>nj&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${h} samples when the maximum is set to ${nj}`);const f=[];let m=0;for(let R=0;R<nj;++R){const e=R/u,t=Math.exp(-e*e/2);f.push(t),0==R?m+=t:R<h&&(m+=2*t)}for(let R=0;R<f.length;R++)f[R]=f[R]/m;c.envMap.value=e.texture,c.samples.value=h,c.weights.value=f,c.latitudinal.value="latitudinal"===i,a&&(c.poleAxis.value=a),c.dTheta.value=l,c.mipInt.value=jg-r,c.inputEncoding.value=be[e.texture.encoding],c.outputEncoding.value=be[e.texture.encoding];const x=MB[n];np(t,3*Math.max(0,_d-2*x),(0===n?0:2*_d)+2*x*(n>jg-mj?n-jg+mj:0),3*x,2*x),s.setRenderTarget(t),s.render($,Ft)}};function SB(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Cd.call(this,e),this.type="catmullrom"}qa.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(qa.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(gg.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=new oa;for(let r=0,n=e.length;r<n;r++){const n=e[r];t.vertices.push(new ba(n.x,n.y,n.z||0))}return t}}),Object.assign(Dd.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),SB.prototype=Object.create(Cd.prototype),Object.assign(SB.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Rl.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},lj.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Pa.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),jh.extractUrlBase(e)}}),Pa.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(wt.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(zB.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(wc.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Td.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),gl.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},BB.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(ta,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),ta.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),ta.ceilPowerOfTwo(e)}}),Object.assign(nc.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(fa.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new ba().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,r,n,o,i){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,n,r,o,i)}}),xc.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},yb.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Di.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(ac.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(ac,{barycoordFromPoint:function(e,t,r,n,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ac.getBarycoord(e,t,r,n,o)},normal:function(e,t,r,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ac.getNormal(e,t,r,n)}}),Object.assign(Oc.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Zi(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new cd(this,e)}}),Object.assign(ca.prototype,{fromAttribute:function(e,t,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ba.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ta.prototype,{fromAttribute:function(e,t,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(oa.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(ja.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(ja.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Aa.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Aa.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(ro.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(to.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),so.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(qa.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),zb.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(eb.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(pa.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Zk},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Zk)}}}),Object.assign(pa.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Zk:Wn),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(ia.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new pa(arguments[1],arguments[2])))},addDrawCall:function(e,t,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(ia.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(bp.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(At.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(Kc.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Zk},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(Kc.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Zk:Wn),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Ye.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(zt.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(ua.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ga}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(ih.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(gc.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(ll.prototype,{clearTarget:function(e,t,r,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,r,n)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(ll.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?vc:uc}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(BA.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ad.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(Nl.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return new yt().load(e,function(e){t.setBuffer(e)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),rB.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ni.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};Qf.crossOrigin=void 0,Qf.loadTexture=function(e,t,r,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const o=new Wd;o.setCrossOrigin(this.crossOrigin);const i=o.load(e,r,void 0,n);return t&&(i.mapping=t),i},Qf.loadTextureCube=function(e,t,r,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const o=new it;o.setCrossOrigin(this.crossOrigin);const i=o.load(e,r,void 0,n);return t&&(i.mapping=t),i},Qf.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Qf.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"118"}}));var TB="ACTION_EVENT";var rb="DELETED_EVENT";var Va="MOVED_EVENT";var pj="REDRAW_EVENT";var Vl="NEW_EVENT";var Wl="LOADED_EVENT";var xX="LOADING_EVENT";var Fd="UPDATED_EVENT";var gd="CHANGED_EVENT";var UB="GLTF_READY_EVENT";var op="EXTERNAL_FLOORPLAN_LOADED_EVENT";var It="NEW_ITEM_EVENT";var yX="ITEM_LOADING_EVENT";var VB="ITEM_LOADED_EVENT";var zX="ITEM_REMOVED_EVENT";var Xl="ITEM_SELECTED_EVENT";var WB="ITEM_MOVED_EVENT";var XB="ITEM_MOVED_FINISH_EVENT";var AX="ITEM_HOVERON_EVENT";var BX="ITEM_HOVEROFF_EVENT";var pp="ITEM_NO_SELECTED_EVENT";var qp="MODE_RESET_EVENT";var rp="WALL_CLICKED_EVENT";var sp="ROOM_CLICKED_EVENT";var CX="CHANGED_ROOM_NAME_EVENT";var Jt="ADDED_NEW_ROOMS_EVENT";var kg="CORNER_ATTRIBUTES_CHANGED_EVENT";var YB="WALL_ATTRIBUTES_CHANGED_EVENT";var lg="ROOM_ATTRIBUTES_CHANGED_EVENT";var Kt="CORNER_CLICKED_2D_EVENT";var Lt="WALL_CLICKED_2D_EVENT";var Mt="ROOM_CLICKED_2D_EVENT";var DX="UNSELECTED_2D_EVENT";var Yl="SELECTED_2D_EVENT";var Nt="NOTHING_2D_SELECTED_EVENT";var qj="KEY_PRESSED_EVENT";var rj="KEY_RELEASED_EVENT";var sj="UPDATE_TEXTURES_EVENT";var tp="PARAMETRIC_GEOMETRY_UPATED_EVENT";var wb="dimUnit";var up="wallHeight";var ZB="wallThickness";var EX="systemUI";var FX="scale";var tj="gridSpacing";var bf="snapToGrid";var Ot="directionalDrag";var uj="dragOnlyX";var vj="dragOnlyY";var Wa="snapTolerance";var $B="boundsX";var _B="boundsY";var aC={dimUnit:Rd,wallHeight:250,wallThickness:20,systemUI:!1,scale:1,snapToGrid:!0,dragOnlyX:!1,dragOnlyY:!1,snapTolerance:25,gridSpacing:50,directionalDrag:!0,boundsX:500,boundsY:500};var Pt=20;var ha=function(e){JQ(r,Qa);var t=LQ(r);function r(){return HQ(this,r),t.call(this)}return IQ(r,null,[{key:"getInstance",value:function(){return void 0===this.__instance&&(this.__instance=new r),this.__instance}},{key:"getData",value:function(){return aC}},{key:"setValue",value:function(e,t){aC[e]=t,r.getInstance().dispatchEvent({type:gd,item:r.getInstance(),key:e,value:t})}},{key:"getStringValue",value:function(e){switch(e){case wb:return String(r.getData()[e]);default:throw new Error("Invalid string configuration parameter: "+e);}}},{key:"getNumericValue",value:function(e){switch(e){case EX:case up:case ZB:case FX:case Wa:case tj:case $B:case _B:return Number(r.getData()[e]);default:throw new Error("Invalid numeric configuration parameter: "+e);}}},{key:"getBooleanValue",value:function(e){switch(e){case bf:case Ot:case uj:case vj:return Boolean(r.getData()[e]);default:throw new Error("Invalid Boolean configuration parameter: "+e);}}}]),r}();function GX(t){return(GX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HX(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bC(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function IX(t,e,r){return e&&bC(t.prototype,e),r&&bC(t,r),t}function JX(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&KX(t,e)}function KX(t,e){return(KX=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function LX(t){var e=OX();return function(){var r,o=cC(t);if(e){var a=cC(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return MX(this,r)}}function MX(t,e){return!e||"object"!==GX(e)&&"function"!=typeof e?NX(t):e}function NX(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function OX(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function cC(t){return(cC=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function PX(e){return(PX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dC(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function RX(e,t,r){return t&&dC(e.prototype,t),r&&dC(e,r),e}function SX(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TX(e,t)}function TX(e,t){return(TX=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function UX(e){var t=WX();return function(){var r,o=eC(e);if(t){var n=eC(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return VX(this,r)}}function VX(e,t){return!t||"object"!==PX(t)&&"function"!=typeof t?wj(e):t}function wj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WX(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function eC(e){return(eC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qt(r,e){return $X(r)||ZX(r,e)||YX(r,e)||XX()}function XX(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function YX(r,e){if(r){if("string"==typeof r)return fC(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fC(r,e):void 0}}function fC(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function ZX(r,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r)){var n=[],t=!0,o=!1,a=void 0;try{for(var i,u=r[Symbol.iterator]();!(t=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);t=!0);}catch(l){o=!0,a=l}finally{try{t||null==u.return||u.return()}finally{if(o)throw a}}return n}}function $X(r){if(Array.isArray(r))return r}function gC(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function hC(r,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function iC(r,e,n){return e&&hC(r.prototype,e),n&&hC(r,n),r}var _X=vp("colinear"),aY=vp("parallel"),bY=vp("none");function cY($,e,r,t,j,n,c,a){var i=(a-n)*(r-$)-(c-j)*(t-e),s=(c-j)*(e-n)-(a-n)*($-j),v=(r-$)*(e-n)-(t-e)*($-j);if(0==i)return 0==s&&0==v?_X:aY;var X=s/i,o=v/i;return X>=0&&X<=1&&o>=0&&o<=1?dY({x:$+X*(r-$),y:e+X*(t-e)}):bY}function dY($){var e=vp("intersecting");return e.point=$,e}function vp($){return{type:$}}var va=function(){function r(){gC(this,r)}return iC(r,null,[{key:"pointDistanceFromLine",value:function(e,n,t){var o=r.closestPointOnLine(e,n,t),a=e.x-o.x,i=e.y-o.y;return Math.sqrt(a*a+i*i)}},{key:"closestPointOnLine",value:function(r,e,n){var t,o,a=r.x-e.x,i=r.y-e.y,u=n.x-e.x,l=n.y-e.y,s=(a*u+i*l)/(u*u+l*l);return s<0||e.x===n.x&&e.y===n.y?(t=e.x,o=e.y):s>1?(t=n.x,o=n.y):(t=e.x+s*u,o=e.y+s*l),new ca(t,o)}},{key:"distance",value:function(r,e){return Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2))}},{key:"angle",value:function(r,e){var n=r.x*e.x+r.y*e.y,t=r.x*e.y-r.y*e.x;return-Math.atan2(t,n)}},{key:"angle2pi",value:function(e,n){var t=r.angle(e,n);return t<0&&(t+=2*Math.PI),t}},{key:"getCyclicOrder",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;n||(n=new ca(0,0));for(var t=[],o=0;o<e.length;o++){var a=e[o].clone().sub(n),i=Math.atan2(a.y,a.x),u=ta.radToDeg(i);u=u>0?u:(u+360)%360,t.push(u)}var l=r.argsort(t),s=[],y=[];for(o=0;o<l.length;o++)s.push(t[l[o]]),y.push(e[l[o]]);return{indices:l,angles:s,points:y}}},{key:"argsort",value:function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Array.from(new Array(r.length),function(r,e){return e}).map(function(e,n){return[r[n],e]}).sort(function(r,n){return(Qt(r,1)[0]-Qt(n,1)[0])*e}).map(function(r){return Qt(r,2)[1]})}},{key:"isClockwise",value:function(e){for(var n=Math.min(0,Math.min.apply(null,r.map(e,function(r){return r.x}))),t=Math.min(0,Math.min.apply(null,r.map(e,function(r){return r.x}))),o=r.map(e,function(r){return{x:r.x-n,y:r.y-t}}),a=0,i=0;i<o.length;i++){var u,l=o[i];a+=((u=i===o.length-1?o[0]:o[i+1]).x-l.x)*(u.y+l.y)}return a>=0}},{key:"guide",value:function(){var r=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r()}},{key:"polygonPolygonIntersect",value:function(e,n){for(var t=0;t<e.length;t++){var o,a=e[t];if(o=t===e.length-1?e[0]:e[t+1],r.linePolygonIntersect(a.x,a.y,o.x,o.y,n))return!0}return!1}},{key:"linePolygonIntersect",value:function(e,n,t){for(var o=0;o<t.length;o++){var a,i=t[o];if(a=o===t.length-1?t[0]:t[o+1],r.lineLineIntersect(e,n,{x:i.x,y:i.y},{x:a.x,y:a.y}))return!0}return!1}},{key:"lineLineIntersectPoint",value:function(r,e,n,t){var o=cY(r.x,r.y,e.x,e.y,n.x,n.y,t.x,t.y);if(o.point)return new ca(o.point.x,o.point.y)}},{key:"lineLineIntersect",value:function(r,e,n,t){function o(r,e,n){var t=r.x,o=r.y,a=e.x,i=e.y,u=n.x;return(n.y-o)*(a-t)>(i-o)*(u-t)}var a=r,i=e,u=n,l=t;return o(a,u,l)!=o(i,u,l)&&o(a,i,u)!=o(a,i,l)}},{key:"pointInPolygon2",value:function(r,e){for(var n=r.x,t=r.y,o=!1,a=0,i=e.length-1;a<e.length;i=a++){(e[a].y<=t&&t<e[i].y||e[i].y<=t&&t<e[a].y)&&n<(e[i].x-e[a].x)*(t-e[a].y)/(e[i].y-e[a].y)+e[a].x&&(o=!o)}return o}},{key:"pointInPolygon",value:function(e,n,t){var o=(t=t||new ca(0,0)).x||0,a=t.y||0,i=0,u=0,l=0;if(void 0===o||void 0===a){for(l=0;l<n.length;l++)i=Math.min(i,n[l].x),u=Math.min(i,n[l].y);o=i-10,a=u-10}var s=0;for(l=0;l<n.length;l++){var y,c=n[l];y=l===n.length-1?n[0]:n[l+1],r.lineLineIntersect(t,e,c.x,c.y,y.x,y.y)&&s++}return s%2==1}},{key:"polygonInsidePolygon",value:function(e,n,t){t.x=t.x||0,t.y=t.y||0;for(var o=0;o<e.length;o++)if(!r.pointInPolygon(e[o].x,e[o].y,n,t))return!1;return!0}},{key:"polygonOutsidePolygon",value:function(e,n,t){t.x=t.x||0,t.y=t.y||0;for(var o=0;o<e.length;o++)if(r.pointInPolygon(e[o].x,e[o].y,n,t))return!1;return!0}},{key:"forEach",value:function(r,e){for(var n=0;n<r.length;n++)e(r[n])}},{key:"forEachIndexed",value:function(r,e){for(var n=0;n<r.length;n++)e(n,r[n])}},{key:"map",value:function(r,e){var n=[];return r.forEach(function(r){n.push(e(r))}),n}},{key:"removeIf",value:function(r,e){var n=[];return r.forEach(function(r){e(r)||n.push(r)}),n}},{key:"cycle",value:function(r,e){for(var n=r.slice(0),t=0;t<e;t++){var o=n.shift();n.push(o)}return n}},{key:"unique",value:function(r,e){for(var n=[],t={},o=0;o<r.length;o++)t.hasOwnProperty(r[o])||(n.push(r[o]),t[e(r[o])]=!0);return n}},{key:"removeValue",value:function(r,e){for(var n=r.length-1;n>=0;n--)if(r[n]===e)return r.splice(n,1),n}},{key:"hasValue",value:function(r,e){for(var n=0;n<r.length;n++)if(r[n]===e)return!0;return!1}},{key:"subtract",value:function(e,n){return r.removeIf(e,function(e){return r.hasValue(n,e)})}},{key:"point2Dto3D",value:function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new ba(r.x,e,r.y)}},{key:"point3Dto2D",value:function(r){return new ca(r.x,r.z)}},{key:"barycentricFromCartesian",value:function(r,e){var n=r[1].clone().sub(r[0]),t=r[2].clone().sub(r[0]),o=e.clone().sub(r[0]),a=n.dot(n),i=t.dot(t),u=t.dot(n),l=o.dot(n),s=o.dot(t),y=a*i-u*u,c=(i*l-u*s)/y,$=(a*s-u*l)/y;return new ba(1-c-$,c,$)}},{key:"cartesianFromBarycenter",value:function(r,e){var n=r[0].clone(),t=r[1].clone(),o=r[2].clone();return n.multiplyScalar(e.x).add(t.multiplyScalar(e.y).add(o.multiplyScalar(e.z)))}}]),r}();var eY=function(){function r(e){gC(this,r),this.points=e||[],this.length=e.length}return iC(r,[{key:"area",value:function(){var r,e,n,t,o=0;for(r=0,e=this.length-1;r<this.length;e=r,r+=1)n=this.points[r],t=this.points[e],o+=n.x*t.y,o-=n.y*t.x;return o*=.5,o}},{key:"centroid",value:function(){var r,e,n,t,o,a=0,i=0;for(r=0,e=this.length-1;r<this.length;e=r,r+=1)t=this.points[r],o=this.points[e],n=t.x*o.y-o.x*t.y,a+=(t.x+o.x)*n,i+=(t.y+o.y)*n;return n=6*this.area(),new ca(a/n,i/n)}}]),r}();function fY(e,$){if(!(e instanceof $))throw new TypeError("Cannot call a class as a function")}function jC(e,$){for(var r=0;r<$.length;r++){var t=$[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function gY(e,$,r){return $&&jC(e.prototype,$),r&&jC(e,r),e}var Oa=1e3;var Rt=.5;var kC=1/Rt;var ka=function(){function e(){fY(this,e)}return gY(e,null,[{key:"cmToPixelVector2D",value:function($){return new ca(e.cmToPixel($.x),e.cmToPixel($.y))}},{key:"cmToPixelVector3D",value:function($){return new ba(e.cmToPixel($.x),e.cmToPixel($.y),e.cmToPixel($.z))}},{key:"pixelToCmVector2D",value:function($){return new ca(e.cmToPixel($.x),e.cmToPixel($.y))}},{key:"pixelToCmVector3D",value:function($){return new ba(e.cmToPixel($.x),e.cmToPixel($.y),e.cmToPixel($.z))}},{key:"cmToPixel",value:function(e){return!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?e*Rt*ha.getNumericValue("scale"):e*Rt}},{key:"pixelToCm",value:function(e){return!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?e*kC*(1/ha.getNumericValue("scale")):e*kC}},{key:"roundOff",value:function(e,$){return Math.round($*e)/$}},{key:"cmFromMeasureRaw",value:function(e){switch(ha.getStringValue(wb)){case Jf:return Math.round(Oa*(30.480016459203096*e))/Oa;case If:return Math.round(Oa*(2.540001371600258*e))/Oa;case Kf:return Math.round(Oa*(.10000005400001015*e))/Oa;case Rd:return e;case Oe:default:return Math.round(100*Oa*e)/Oa;}}},{key:"cmFromMeasure",value:function(e){switch(ha.getStringValue(wb)){case Jf:return Math.round(Oa*(30.480016459203096*e))/Oa+"cm";case If:return Math.round(Oa*(2.540001371600258*e))/Oa+"cm";case Kf:return Math.round(Oa*(.10000005400001015*e))/Oa+"cm";case Rd:return e;case Oe:default:return Math.round(100*Oa*e)/Oa+"cm";}}},{key:"cmToMeasureRaw",value:function(e){var $=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;switch(ha.getStringValue(wb)){case Jf:return e*Math.pow(.03280841666667,$);case If:return Math.round(Oa*(e*Math.pow(.3937,$)))/Oa;case Kf:return Math.round(Oa*(e*Math.pow(10,$)))/Oa;case Rd:return Math.round(Oa*e)/Oa;case Oe:default:return Math.round(Oa*(e*Math.pow(.01,$)))/Oa;}}},{key:"cmToMeasure",value:function(e){var $=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;switch(ha.getStringValue(wb)){case Jf:var r=e*Math.pow(.03280841666667,$),t=Math.floor(r),i=r-t;return t+"'"+Math.round(12*i);case If:return Math.round(Oa*(e*Math.pow(.3937,$)))/Oa+"'";case Kf:return Math.round(Oa*(e*Math.pow(10,$)))/Oa+"mm";case Rd:return Math.round(Oa*e)/Oa+"cm";case Oe:default:return Math.round(Oa*(e*Math.pow(.01,$)))/Oa+"m";}}}]),e}();function hY(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function lC(e,n){for(var r=0;r<n.length;r++){var a=n[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function iY(e,n,r){return n&&lC(e.prototype,n),r&&lC(e,r),e}var St=function(){function e(){hY(this,e)}return iY(e,null,[{key:"isVersionHigherThan",value:function(e,n){if(null!=e){n=n.replace(/[^\d.-]/g,"").split(".");var r=e.replace(/[^\d.-]/g,"").split("."),a=!0;if(n.length!=r.length)return!1;for(var t=0;t<n.length;t++){a&=parseInt(n[t])>=parseInt(r[t])}return a}return!1}},{key:"getInformalVersion",value:function(){return"2.0.1a"}},{key:"getTechnicalVersion",value:function(){return"2.0.1a"}}]),e}();function jY(t){return(jY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mC(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function lY(t,e,r){return e&&mC(t.prototype,e),r&&mC(t,r),t}function mY(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nY(t,e)}function nY(t,e){return(nY=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function oY(t){var e=qY();return function(){var r,n=nC(t);if(e){var i=nC(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return pY(this,r)}}function pY(t,e){return!e||"object"!==jY(e)&&"function"!=typeof e?Zl(t):e}function Zl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qY(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function nC(t){return(nC=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wp=function(t){mY(r,Qa);var e=oY(r);function r(t,n,i){var o;return kY(this,r),(o=e.call(this)).min=null,o.max=null,o.center=null,o.room=t||null,o.wall=n,o.name=va.guide("Edge"),o.next=null,o.prev=null,o.offset=0,o.height=0,o.__plane=null,o.__exteriorPlane=null,o.interiorTransform=new fa,o.invInteriorTransform=new fa,o.exteriorTransform=new fa,o.invExteriorTransform=new fa,o.redrawCallbacks=null,o.__isOrphan=!1,o.front=i||!1,o.__vertices=null,o.__normal=null,o.__mathPlane=null,o.offset=n.thickness/2,o.height=n.height,o.__wallMovedEvent=o.__wallMoved.bind(Zl(o)),o.__wallUpdatedEvent=o.__wallUpdated.bind(Zl(o)),o.front?o.wall.frontEdge=Zl(o):o.wall.backEdge=Zl(o),o.wall.addEventListener(Va,o.__wallMovedEvent),o.wall.addEventListener(Fd,o.__wallUpdatedEvent),o}return lY(r,[{key:"__wallMoved",value:function(t){this.generatePlane(),this.dispatchEvent({type:pj,item:this})}},{key:"__wallUpdated",value:function(t){this.offset=.5*this.wall.thickness,this.generatePlane(),this.dispatchEvent({type:pj,item:this})}},{key:"getTexture",value:function(){return this.front?this.wall.frontTexture:this.wall.backTexture}},{key:"setTextureMaps",value:function(t){t.color||(t.color="#FFFFFF"),t.repeat||(t.repeat=Yg),this.front?this.wall.frontTexture=t:this.wall.backTexture=t,this.dispatchEvent({type:sj,item:this})}},{key:"setTexture",value:function(t,e,r){var n={url:t,stretch:e,scale:r};this.front?this.wall.frontTexture=n:this.wall.backTexture=n,this.dispatchEvent({type:pj,item:this})}},{key:"dispatchRedrawEvent",value:function(){this.dispatchEvent({type:pj,item:this})}},{key:"transformCorner",value:function(t){return new ba(t.x,0,t.y)}},{key:"generatePlane",value:function(){this.__plane=this.__generateEdgePlane(!0,this.__plane)}},{key:"__generateEdgePlane",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new oa,n=null,i=null;t?(n=this.transformCorner(this.interiorEnd()),i=this.transformCorner(this.interiorStart())):(n=this.transformCorner(this.exteriorStart()),i=this.transformCorner(this.exteriorEnd()));var o,l=i.clone(),a=n.clone(),s=null;l.y=this.wall.startElevation,a.y=this.wall.endElevation,s=i.clone().sub(n),o=l.clone().sub(n),this.__vertices=[n,i,l,a],this.__normal=s.cross(o).normalize(),this.__mathPlane=new xc,this.__mathPlane.setFromNormalAndCoplanarPoint(this.__normal.clone(),this.__vertices[0].clone()),r.vertices=[n,i,l,a],r.faces.push(new aa(0,1,2)),r.faces.push(new aa(0,2,3)),r.computeFaceNormals(),r.computeBoundingBox(),e?(e.geometry.dispose(),e.geometry=new ia().fromGeometry(r)):e=new Aa(new ia().fromGeometry(r),new kb({visible:!0})),e.visible=!0,e.edge=this,e.wall=this.wall,e.geometry.computeBoundingBox(),e.geometry.computeFaceNormals(),this.computeTransforms(this.interiorTransform,this.invInteriorTransform,this.interiorStart(),this.interiorEnd()),this.computeTransforms(this.exteriorTransform,this.invExteriorTransform,this.exteriorStart(),this.exteriorEnd());var c=new wc;return c.setFromObject(e),this.min=c.min.clone(),this.max=c.max.clone(),this.center=this.max.clone().sub(this.min).multiplyScalar(.5).add(this.min),e}},{key:"computeTransforms",value:function(t,e,r,n){var i=r,o=n,l=va.angle(new ca(1,0),new ca(o.x-i.x,o.y-i.y)),a=new fa,s=new fa;a.makeTranslation(-i.x,0,-i.y),s.makeRotationY(-l),t.multiplyMatrices(s,a),e.getInverse(t)}},{key:"distanceTo",value:function(t,e){if(this.wall.wallType===za.STRAIGHT)return va.pointDistanceFromLine(new ca(t,e),this.interiorStart(),this.interiorEnd());if(this.wall.wallType===za.CURVED){var r=this._bezier.project({x:t,y:e});return new ca(r.x,r.y).distanceTo(new ca(t,e))}return-1}},{key:"getStart",value:function(){return this.front?this.wall.getStart():this.wall.getEnd()}},{key:"getEnd",value:function(){return this.front?this.wall.getEnd():this.wall.getStart()}},{key:"getOppositeEdge",value:function(){return this.front?this.wall.backEdge:this.wall.frontEdge}},{key:"interiorCenter",value:function(){if(this.wall.wallType===za.STRAIGHT)return new ca((this.interiorStart().x+this.interiorEnd().x)/2,(this.interiorStart().y+this.interiorEnd().y)/2);if(this.wall.wallType===za.CURVED){var t=this.wall.bezier.get(.5);return new ca(t.x,t.y)}return new ca((this.interiorStart().x+this.interiorEnd().x)/2,(this.interiorStart().y+this.interiorEnd().y)/2)}},{key:"interiorDistance",value:function(){var t=this.interiorStart(),e=this.interiorEnd();return this.wall.wallType===za.STRAIGHT?va.distance(t,e):this.wall.wallType===za.CURVED?this.wall.bezier.length():va.distance(t,e)}},{key:"interiorStart",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&(console.log("*************************"),console.log("CALCULATE INTERIOR START"));var e=this.interiorPointByEdges(this.prev,this,t);return e=e.multiplyScalar(.5),this.getStart().location.clone().add(e)}},{key:"interiorEnd",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&(console.log("*************************"),console.log("CALCULATE INTERIOR END"));var e=this.interiorPointByEdges(this,this.next,t);return e=e.multiplyScalar(.5),this.getEnd().location.clone().add(e)}},{key:"exteriorStart",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this.interiorPointByEdges(this.prev,this);return t=t.multiplyScalar(-.5),this.getStart().location.clone().add(t)}},{key:"exteriorEnd",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this.interiorPointByEdges(this,this.next);return t=t.multiplyScalar(-.5),this.getEnd().location.clone().add(t)}},{key:"exteriorCenter",value:function(){if(this.wall.wallType===za.STRAIGHT)return new ca((this.exteriorStart().x+this.exteriorEnd().x)/2,(this.exteriorStart().y+this.exteriorEnd().y)/2);if(this.wall.wallType===za.CURVED){var t=this.wall.bezier.get(.5);return new ca(t.x,t.y)}return new ca((this.exteriorStart().x+this.exteriorEnd().x)/2,(this.exteriorStart().y+this.exteriorEnd().y)/2)}},{key:"exteriorDistance",value:function(){var t=this.exteriorStart(),e=this.exteriorEnd();return this.wall.wallType===za.STRAIGHT?va.distance(t,e):this.wall.wallType===za.CURVED?this.wall.bezier.length():va.distance(t,e)}},{key:"corners",value:function(){return[this.interiorStart(),this.interiorEnd(),this.exteriorEnd(),this.exteriorStart()]}},{key:"interiorPointByEdges",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t||!e)return console.warn("Need a valid next or previous edge"),this.halfAngleVector(t,e).multiplyScalar(2);var n,i,o=null,l=null,a=null,s=null;if(o=t.getEnd().location.clone().sub(t.getStart().location).normalize(),l=e.getEnd().location.clone().sub(e.getStart().location).normalize(),(i=o.dot(l))>1-1e-6||i<1e-6-1){var c=o.clone().normalize().multiplyScalar(Math.min(e.wall.thickness,t.wall.thickness));return c=c.rotateAround(new ca(0,0),.5*Math.PI),r&&console.log("VECTOR ADDITION W LENGTH :: ",c.length()),c}return o=o.multiplyScalar(e.wall.thickness),l=l.multiplyScalar(t.wall.thickness),a=o.clone().add(l),s=new ba(o.x,o.y,0),n=new ba(l.x,l.y,0),new ba(a.x,a.y,0),s.clone().cross(n).z<0?(l=l.multiplyScalar(-1),a=o.clone().add(l)):a=(o=o.multiplyScalar(-1)).clone().add(l),r&&(console.log("=============================================="),console.log("F :: ",o),console.log("G :: ",l),console.log("F FORCE :: ",o.length()),console.log("G FORCE :: ",l.length()),console.log("DOT PRODUCT VALUE  :: ",i),console.log("ANGLE BETWEEN F AND G  :: ",180*Math.acos(i)/Math.PI),console.log("VECTOR ADDITION W LENGTH :: ",a.length()),console.log("----------------------------------------------")),a}},{key:"interiorPointByEdges_V2",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t||!e)return this.halfAngleVector(t,e).multiplyScalar(2);var n,i,o,l,a,s,c,$=null,u=null,h=null,p=null,m=null,y=null;if($=t.getEnd().location.clone().sub(t.getStart().location).normalize(),u=e.getEnd().location.clone().sub(e.getStart().location).normalize(),h=$.clone(),p=u.clone(),l=-(o=$.dot(u)),o>1-1e-6||o<1e-6-1)return m=(m=$.clone().normalize().multiplyScalar(Math.min(e.wall.thickness,t.wall.thickness))).rotateAround(new ca(0,0),.5*-Math.PI),r&&console.log("DOT PRODUCT TRIGGER ",o),m;if(y=new ba($.x,$.y,0),n=new ba(u.x,u.y,0),i=y.clone().cross(n),$=$.multiplyScalar(e.wall.thickness),u=u.multiplyScalar(t.wall.thickness),h=h.multiplyScalar(e.wall.thickness),p=p.multiplyScalar(t.wall.thickness),Math.acos(o),a=Math.acos(l),s=Math.pow(Math.pow($.length(),2)+Math.pow(u.length(),2)+2*$.length()*u.length()*l,.5),c=Math.asin(u.length()*Math.sin(a)/s),m=$.clone().rotateAround(new ca,-c).normalize().multiplyScalar(s),r){var g=y.clone().add(n).angleTo(y);console.log("=============================================="),console.log("F :: ",$),console.log("G :: ",u),console.log("F FORCE :: ",$.length()),console.log("G FORCE :: ",u.length()),console.log("DOT PRODUCT VALUE  :: ",o),console.log("ABS DOT PRODUCT VALUE  :: ",l),console.log("ANGLE ::: ",180*g/Math.PI),console.log("ANGLE3 (sum f + g) ",180*c/Math.PI),console.log("CROSS AXIS :: ",i),console.log("MAGNITUDE VALUE : ",s),console.log("VECTOR ADDITION W LENGTH :: ",m.length()),console.log("----------------------------------------------")}return m}},{key:"interiorPointByEdgesOLD",value:function(t,e){var r=null;if(!t||!e)return t?e||(r=(r=(r=this.getStart().location.clone().sub(this.getEnd().location).normalize()).multiplyScalar(this.wall.thickness)).rotateAround(new ca,.785398)):r=(r=(r=this.getEnd().location.clone().sub(this.getStart().location).normalize()).multiplyScalar(this.wall.thickness)).rotateAround(new ca,-.785398),r;var n,i=null,o=null;if(i=t.getEnd().location.clone().sub(t.getStart().location).normalize(),o=e.getStart().location.clone().sub(e.getEnd().location).normalize(),(n=i.dot(o))>1-1e-6||n<1e-6-1){var l=Math.max(t.wall.thickness,e.wall.thickness);i=i.multiplyScalar(l),o=o.multiplyScalar(l)}else i=i.multiplyScalar(e.wall.thickness),o=o.multiplyScalar(t.wall.thickness);return i.add(o)}},{key:"interiorPoint",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=null,n=null;return t?(e?(n=this.getEnd().location.clone().sub(this.getStart().location).normalize(),r=t.getStart().location.clone().sub(t.getEnd().location).normalize()):(n=this.getStart().location.clone().sub(this.getEnd().location).normalize(),r=t.getEnd().location.clone().sub(t.getStart().location).normalize()),r=r.multiplyScalar(this.wall.thickness),(n=n.multiplyScalar(t.wall.thickness)).add(r)):n=e?(n=(n=this.getEnd().location.clone().sub(this.getStart().location).normalize()).multiplyScalar(this.wall.thickness)).rotateAround(new ca,-.785398):(n=(n=this.getStart().location.clone().sub(this.getEnd().location).normalize()).multiplyScalar(this.wall.thickness)).rotateAround(new ca,.785398)}},{key:"halfAngleVector",value:function(t,e){var r=0,n=0,i=0,o=0,l=0,a=0,s=0,c=0;t?(r=t.getStart().x,n=t.getStart().y,i=t.getEnd().x,o=t.getEnd().y):(r=e.getStart().x-(e.getEnd().x-e.getStart().x),n=e.getStart().y-(e.getEnd().y-e.getStart().y),i=e.getStart().x,o=e.getStart().y),e?(l=e.getStart().x,a=e.getStart().y,s=e.getEnd().x,c=e.getEnd().y):(l=t.getEnd().x,a=t.getEnd().y,s=t.getEnd().x+(t.getEnd().x-t.getStart().x),c=t.getEnd().y+(t.getEnd().y-t.getStart().y));var $=va.angle2pi(new ca(r-i,n-o),new ca(s-i,c-o)),u=Math.cos($/2),h=Math.sin($/2),p=s-l,m=c-a,y=p*u-m*h,g=p*h+m*u,d=va.distance(new ca(0,0),new ca(y,g)),f=.5*this.wall.thickness/h/d,E=new ca(y*f,g*f);return E}},{key:"destroy",value:function(){this.__plane=null,this.__isOrphan=!0,this.wall.removeEventListener(Va,this.__wallMovedEvent),this.wall.removeEventListener(Fd,this.__wallUpdatedEvent),this.dispatchEvent({type:rb,edge:this})}},{key:"vertices",get:function(){return this.__vertices}},{key:"normal",get:function(){return this.__normal}},{key:"isOrphan",get:function(){return this.__isOrphan}},{key:"plane",get:function(){return this.__plane}},{key:"exteriorPlane",get:function(){return this.__exteriorPlane}}]),r}();function rY(t){return(rY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oC(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function tY(t,e,o){return e&&oC(t.prototype,e),o&&oC(t,o),t}function uY(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vY(t,e)}function vY(t,e){return(vY=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wY(t){var e=zY();return function(){var o,a=pC(t);if(e){var r=pC(this).constructor;o=Reflect.construct(a,arguments,r)}else o=a.apply(this,arguments);return xY(this,o)}}function xY(t,e){return!e||"object"!==rY(e)&&"function"!=typeof e?yY(t):e}function yY(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zY(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function pC(t){return(pC=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Tt=function(t){uY(o,Qa);var e=wY(o);function o(t,a,r,n){var i;return sY(this,o),(i=e.call(this)).id=n||va.guide(),i.wallStarts=[],i.wallEnds=[],i.moved_callbacks=null,i.deleted_callbacks=null,i.action_callbacks=null,i.floorplan=t,i._x=a,i._y=r,i._co=new ca(i._x,i._y),i._elevation=ha.getNumericValue(up),i.attachedRooms=[],i.__hasBeenRemoved=!1,i._angles=[],i._angleDirections=[],i._startAngles=[],i._endAngles=[],i._cyclicNeighbors=[],i._hasChanged=!1,i.__isLocked=!1,i}return tY(o,[{key:"attachRoom",value:function(t){t&&this.attachedRooms.push(t)}},{key:"getAttachedRooms",value:function(){return this.attachedRooms}},{key:"clearAttachedRooms",value:function(){this.attachedRooms=[]}},{key:"fireOnMove",value:function(t){this.moved_callbacks.add(t)}},{key:"fireOnDelete",value:function(t){this.deleted_callbacks.add(t)}},{key:"fireOnAction",value:function(t){this.action_callbacks.add(t)}},{key:"fireAction",value:function(t){this.dispatchEvent({type:TB,item:this,action:t})}},{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"snapToAxis",value:function(t){var e={x:!1,y:!1},o=this;return this.adjacentCorners().forEach(function(a){Math.abs(a.x-o.x)<t&&(o.x=a.x,e.x=!0),Math.abs(a.y-o.y)<t&&(o.y=a.y,e.y=!0)}),e}},{key:"move",value:function(t,e){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._x=t,this._y=e,this._co.x=t,this._co.y=e,o&&(this.mergeWithIntersected(),this.floorplan.rooms.length<10&&this.updateAttachedRooms(!0)),this.wallStarts.forEach(function(t){t.fireMoved()}),this.wallEnds.forEach(function(t){t.fireMoved()}),this.dispatchEvent({type:Va,item:this,position:new ca(t,e)})}},{key:"relativeMove",value:function(t,e){this.move(this.x+t,this.y+e)}},{key:"remove",value:function(){this.__hasBeenRemoved=!0,this.dispatchEvent({type:rb,item:this})}},{key:"removeAll",value:function(){var t=0;for(t=0;t<this.wallStarts.length;t++)this.wallStarts[t].remove();for(t=0;t<this.wallEnds.length;t++)this.wallEnds[t].remove();this.remove()}},{key:"closestAngle",value:function(t){for(var e=this.adjacentCorners(),o=999999,a=0,r=new ca,n=0;n<e.length;n++){if(this.wallToOrFrom(e[n]).wallType!==za.CURVED){var i=e[n].location.clone().sub(this.location).angle();i=180*i/Math.PI;var s=Math.abs(t-i);s<o&&(o=s,r.x=e[n].location.x,r.y=e[n].location.y,a=i)}}return{angle:a,point:r}}},{key:"updateAngles",value:function(){var t=this.adjacentCorners();if(this._angles=[],this._angleDirections=[],this._startAngles=[],this._endAngles=[],this._cyclicNeighbors=[],!(t.length<2)){for(var e=this.location.clone(),o=[],a=0;a<t.length;a++)o.push(t[a].location);for(var r=va.getCyclicOrder(o,e),n=r.indices,i=r.angles,s=n.length<3?1:n.length,l=0;l<s;l++){var h=(l+1)%n.length,c=n[l],p=n[h],u=this.wallToOrFrom(t[c]),$=this.wallToOrFrom(t[p]);if(null==u||null==$||u.wallType!==za.CURVED&&$.wallType!==za.CURVED){var f=o[c].clone().sub(e).normalize(),d=o[p].clone().sub(e).normalize(),v=f.add(d).multiplyScalar(20),y=Math.abs(i[h]-i[l]);y=y>180?360-y:y,y=Math.round(10*y)/10,this._startAngles.push(i[l]),this._endAngles.push(i[h]),this._angles.push(y),this._angleDirections.push(v),this._cyclicNeighbors.push(t[n[l]])}else this._startAngles.push(0),this._endAngles.push(0),this._angles.push(0),this._angleDirections.push(new ca(0,0)),this._cyclicNeighbors.push(t[n[l]])}}}},{key:"updateAttachedRooms",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(this._hasChanged||t)&&(this.attachedRooms.forEach(function(t){t.updateArea()}),this._hasChanged=!1)}},{key:"adjacentCorners",value:function(){var t=[],e=0;for(e=0;e<this.wallStarts.length;e++)t.push(this.wallStarts[e].getEnd());for(e=0;e<this.wallEnds.length;e++)t.push(this.wallEnds[e].getStart());return t}},{key:"isWallConnected",value:function(t){var e=0;for(e=0;e<this.wallStarts.length;e++)if(this.wallStarts[e]===t)return!0;for(e=0;e<this.wallEnds.length;e++)if(this.wallEnds[e]===t)return!0;return!1}},{key:"distanceFrom",value:function(t){return va.distance(t,new ca(this.x,this.y))}},{key:"distanceFromWall",value:function(t){var e=new ca(this.x,this.y);if(t.wallType===za.STRAIGHT)return t.distanceFrom(e);if(t.wallType===za.CURVED){var o=t.bezier.project(e);return new ca(o.x,o.y).distanceTo(e)}}},{key:"distanceFromCorner",value:function(t){return this.distanceFrom(new ca(t.x,t.y))}},{key:"detachWall",value:function(t){va.removeValue(this.wallStarts,t),va.removeValue(this.wallEnds,t),0!==this.wallStarts.length||0!==this.wallEnds.length||this.__hasBeenRemoved||this.remove()}},{key:"attachStart",value:function(t){this.wallStarts.push(t)}},{key:"attachEnd",value:function(t){this.wallEnds.push(t)}},{key:"wallTo",value:function(t){for(var e=0;e<this.wallStarts.length;e++)if(this.wallStarts[e].getEnd()===t)return this.wallStarts[e];return null}},{key:"wallFrom",value:function(t){for(var e=0;e<this.wallEnds.length;e++)if(this.wallEnds[e].getStart()===t)return this.wallEnds[e];return null}},{key:"wallToOrFrom",value:function(t){return this.wallTo(t)||this.wallFrom(t)}},{key:"combineWithCorner",value:function(t){var e=0;for(this.move(t.x,t.y,!1),e=t.wallStarts.length-1;e>=0;e--)t.wallStarts[e].setStart(this);for(e=t.wallEnds.length-1;e>=0;e--)t.wallEnds[e].setEnd(this);var o=t.getAttachedRooms();for(e=0;e<o.length;e++){var a=o[e],r=this.floorplan.metaroomsdata[a.roomByCornersId];if(r){var n=a.roomByCornersId,i=n.replace(t.id,this.id);this.floorplan.metaroomsdata[i]={},this.floorplan.metaroomsdata[i].name=r.name,delete this.floorplan.metaroomsdata[n]}}t.removeAll(),this.removeDuplicateWalls(),this.floorplan.update()}},{key:"mergeWithIntersected",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=0;for(e=0;e<this.floorplan.getCorners().length;e++){var o=this.floorplan.getCorners()[e];if(this.distanceFromCorner(o)<Pt&&o!==this)return this.combineWithCorner(o),!0}for(e=0;e<this.floorplan.getWalls().length;e++){var a=this.floorplan.getWalls()[e];if(this.distanceFromWall(a)<Pt&&!this.isWallConnected(a)){var r=void 0;if(a.wallType===za.STRAIGHT?r=va.closestPointOnLine(new ca(this.x,this.y),a.getStart(),a.getEnd()):a.wallType===za.CURVED&&(r=a.bezier.project(new ca(this.x,this.y))),a.wallType===za.STRAIGHT){var n=this.floorplan.newWall(this,a.getEnd());a.setEnd(this),n.clearAttachedRooms(),a.clearAttachedRooms()}else if(a.wallType===za.CURVED){var i=this.floorplan.newWall(this,a.getEnd());a.setEnd(this),i.clearAttachedRooms(),a.clearAttachedRooms()}return this.move(r.x,r.y,!1,t),this.floorplan.update(),!0}}return!1}},{key:"removeDuplicateWalls",value:function(){var t=0,e={},o={};for(t=this.wallStarts.length-1;t>=0;t--)this.wallStarts[t].getEnd()===this?this.wallStarts[t].remove():this.wallStarts[t].getEnd().id in e?this.wallStarts[t].remove():e[this.wallStarts[t].getEnd().id]=!0;for(t=this.wallEnds.length-1;t>=0;t--)this.wallEnds[t].getStart()===this?this.wallEnds[t].remove():this.wallEnds[t].getStart().id in o?this.wallEnds[t].remove():o[this.wallEnds[t].getStart().id]=!0}},{key:"isLocked",set:function(t){this.__isLocked=t},get:function(){return this.__isLocked}},{key:"uuid",get:function(){return this.id}},{key:"startAngles",get:function(){return this._startAngles}},{key:"endAngles",get:function(){return this._endAngles}},{key:"angles",get:function(){return this._angles}},{key:"angleDirections",get:function(){return this._angleDirections}},{key:"location",get:function(){return this._co},set:function(t){this._co.x=t.x,this._co.y=t.y,this.x=t.x,this.y=t.y}},{key:"x",get:function(){return this._x},set:function(t){var e=this._x;Math.abs(t-this._x)>1e-6&&(this._hasChanged=!0),this._x=t,this._hasChanged&&(this._co.x=this._x,this.updateAttachedRooms(),this.dispatchEvent({type:kg,item:this,info:{from:e,to:this._x}}))}},{key:"y",get:function(){return this._y},set:function(t){var e=this._y;Math.abs(t-this._y)>1e-6&&(this._hasChanged=!0),this._y=t,this._hasChanged&&(this._co.y=this._y,this.updateAttachedRooms(),this.dispatchEvent({type:kg,item:this,info:{from:e,to:this._y}}))}},{key:"elevation",set:function(t){var e=this._elevation;t-this._elevation>1e-6&&(this._hasChanged=!0),this._elevation=Number(t),this._hasChanged&&this.dispatchEvent({type:kg,item:this,info:{from:e,to:this._elevation}})},get:function(){return this._elevation}}]),o}();function AY(t){return(AY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function BY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qC(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function CY(t,e,i){return e&&qC(t.prototype,e),i&&qC(t,i),t}function DY(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&EY(t,e)}function EY(t,e){return(EY=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function FY(t){var e=HY();return function(){var i,n=rC(t);if(e){var o=rC(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return GY(this,i)}}function GY(t,e){return!e||"object"!==AY(e)&&"function"!=typeof e?xj(t):e}function xj(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function HY(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function rC(t){return(rC=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var IY={};var sC,JY=false;function tC(){if(JY)return;JY=true;sC={};!function(){var r=Math.abs,n=Math.cos,t=Math.sin,i=Math.acos,e=Math.atan2,a=Math.sqrt,x=Math.pow,u=function(r){return r<0?-x(-r,1/3):x(r,1/3)},o=Math.PI,f=2*o,y=o/2,c=Number.MAX_SAFE_INTEGER||9007199254740991,l=Number.MIN_SAFE_INTEGER||-9007199254740991,m={x:0,y:0,z:0},s={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(r,n){var t=n(r),i=t.x*t.x+t.y*t.y;return void 0!==t.z&&(i+=t.z*t.z),a(i)},compute:function(r,n,t){if(0===r)return n[0];var i=n.length-1;if(1===r)return n[i];var e=n,a=1-r;if(0===i)return n[0];if(1===i)return l={x:a*e[0].x+r*e[1].x,y:a*e[0].y+r*e[1].y},t&&(l.z=a*e[0].z+r*e[1].z),l;if(i<4){var x,u,o,f=a*a,y=r*r,c=0;2===i?(e=[e[0],e[1],e[2],m],x=f,u=a*r*2,o=y):3===i&&(x=f*a,u=f*r*3,o=a*y*3,c=r*y);var l={x:x*e[0].x+u*e[1].x+o*e[2].x+c*e[3].x,y:x*e[0].y+u*e[1].y+o*e[2].y+c*e[3].y};return t&&(l.z=x*e[0].z+u*e[1].z+o*e[2].z+c*e[3].z),l}for(var s=JSON.parse(JSON.stringify(n));s.length>1;){for(var z=0;z<s.length-1;z++)s[z]={x:s[z].x+(s[z+1].x-s[z].x)*r,y:s[z].y+(s[z+1].y-s[z].y)*r},void 0!==s[z].z&&(s[z]=s[z].z+(s[z+1].z-s[z].z)*r);s.splice(s.length-1,1)}return s[0]},computeWithRatios:function(r,n,t,i){var e,a=1-r,x=t,u=n,o=x[0],f=x[1],y=x[2],c=x[3];return o*=a,f*=r,2===u.length?(e=o+f,{x:(o*u[0].x+f*u[1].x)/e,y:(o*u[0].y+f*u[1].y)/e,z:!!i&&(o*u[0].z+f*u[1].z)/e}):(o*=a,f*=2*a,y*=r*r,3===u.length?(e=o+f+y,{x:(o*u[0].x+f*u[1].x+y*u[2].x)/e,y:(o*u[0].y+f*u[1].y+y*u[2].y)/e,z:!!i&&(o*u[0].z+f*u[1].z+y*u[2].z)/e}):(o*=a,f*=1.5*a,y*=3*a,c*=r*r*r,4===u.length?(e=o+f+y+c,{x:(o*u[0].x+f*u[1].x+y*u[2].x+c*u[3].x)/e,y:(o*u[0].y+f*u[1].y+y*u[2].y+c*u[3].y)/e,z:!!i&&(o*u[0].z+f*u[1].z+y*u[2].z+c*u[3].z)/e}):void 0))},derive:function(r,n){for(var t=[],i=r,e=i.length,a=e-1;e>1;e--,a--){for(var x,u=[],o=0;o<a;o++)x={x:a*(i[o+1].x-i[o].x),y:a*(i[o+1].y-i[o].y)},n&&(x.z=a*(i[o+1].z-i[o].z)),u.push(x);t.push(u),i=u}return t},between:function(r,n,t){return n<=r&&r<=t||s.approximately(r,n)||s.approximately(r,t)},approximately:function(n,t,i){return r(n-t)<=(i||1e-6)},length:function(r){var n,t,i=0,e=s.Tvalues.length;for(n=0;n<e;n++)t=.5*s.Tvalues[n]+.5,i+=s.Cvalues[n]*s.arcfn(t,r);return .5*i},map:function(r,n,t,i,e){return i+(e-i)*((r-n)/(t-n))},lerp:function(r,n,t){var i={x:n.x+r*(t.x-n.x),y:n.y+r*(t.y-n.y)};return n.z&&t.z&&(i.z=n.z+r*(t.z-n.z)),i},pointToString:function(r){var n=r.x+"/"+r.y;return void 0!==r.z&&(n+="/"+r.z),n},pointsToString:function(r){return"["+r.map(s.pointToString).join(", ")+"]"},copy:function(r){return JSON.parse(JSON.stringify(r))},angle:function(r,n,t){var i=n.x-r.x,a=n.y-r.y,x=t.x-r.x,u=t.y-r.y;return e(i*u-a*x,i*x+a*u)},round:function(r,n){var t=""+r,i=t.indexOf(".");return parseFloat(t.substring(0,i+1+n))},dist:function(r,n){var t=r.x-n.x,i=r.y-n.y;return a(t*t+i*i)},closest:function(r,n){var t,i,e=x(2,63);return r.forEach(function(r,a){(i=s.dist(n,r))<e&&(e=i,t=a)}),{mdist:e,mpos:t}},abcratio:function(n,t){if(2!==t&&3!==t)return!1;if(void 0===n)n=.5;else if(0===n||1===n)return n;var i=x(n,t)+x(1-n,t);return r((i-1)/i)},projectionratio:function(r,n){if(2!==n&&3!==n)return!1;if(void 0===r)r=.5;else if(0===r||1===r)return r;var t=x(1-r,n);return t/(x(r,n)+t)},lli8:function(r,n,t,i,e,a,x,u){var o=(r-t)*(a-u)-(n-i)*(e-x);return 0!=o&&{x:((r*i-n*t)*(e-x)-(r-t)*(e*u-a*x))/o,y:((r*i-n*t)*(a-u)-(n-i)*(e*u-a*x))/o}},lli4:function(r,n,t,i){var e=r.x,a=r.y,x=n.x,u=n.y,o=t.x,f=t.y,y=i.x,c=i.y;return s.lli8(e,a,x,u,o,f,y,c)},lli:function(r,n){return s.lli4(r,r.c,n,n.c)},makeline:function(r,n){var t=(wC(),vC),i=r.x,e=r.y,a=n.x,x=n.y,u=(a-i)/3,o=(x-e)/3;return new t(i,e,i+u,e+o,i+2*u,e+2*o,a,x)},findbbox:function(r){var n=c,t=c,i=l,e=l;return r.forEach(function(r){var a=r.bbox();n>a.x.min&&(n=a.x.min),t>a.y.min&&(t=a.y.min),i<a.x.max&&(i=a.x.max),e<a.y.max&&(e=a.y.max)}),{x:{min:n,mid:(n+i)/2,max:i,size:i-n},y:{min:t,mid:(t+e)/2,max:e,size:e-t}}},shapeintersections:function(r,n,t,i,e){if(!s.bboxoverlap(n,i))return[];var a=[],x=[r.startcap,r.forward,r.back,r.endcap],u=[t.startcap,t.forward,t.back,t.endcap];return x.forEach(function(n){n.virtual||u.forEach(function(i){if(!i.virtual){var x=n.intersects(i,e);x.length>0&&(x.c1=n,x.c2=i,x.s1=r,x.s2=t,a.push(x))}})}),a},makeshape:function(r,n,t){var i=n.points.length,e=r.points.length,a=s.makeline(n.points[i-1],r.points[0]),x=s.makeline(r.points[e-1],n.points[0]),u={startcap:a,forward:r,back:n,endcap:x,bbox:s.findbbox([a,r,n,x])},o=s;return u.intersections=function(r){return o.shapeintersections(u,u.bbox,r,r.bbox,t)},u},getminmax:function(r,n,t){if(!t)return{min:0,max:0};var i,e,a=c,x=l;-1===t.indexOf(0)&&(t=[0].concat(t)),-1===t.indexOf(1)&&t.push(1);for(var u=0,o=t.length;u<o;u++)i=t[u],(e=r.get(i))[n]<a&&(a=e[n]),e[n]>x&&(x=e[n]);return{min:a,mid:(a+x)/2,max:x,size:x-a}},align:function(r,i){var a=i.p1.x,x=i.p1.y,u=-e(i.p2.y-x,i.p2.x-a);return r.map(function(r){return{x:(r.x-a)*n(u)-(r.y-x)*t(u),y:(r.x-a)*t(u)+(r.y-x)*n(u)}})},roots:function(r,t){t=t||{p1:{x:0,y:0},p2:{x:1,y:0}};var e=r.length-1,x=s.align(r,t),o=function(r){return 0<=r&&r<=1};if(2===e){if(0!==(p=(v=x[0].y)-2*(h=x[1].y)+(g=x[2].y))){var y=-a(h*h-v*g),c=-v+h;return[-(y+c)/p,-(-y+c)/p].filter(o)}return h!==g&&0===p?[(2*h-g)/(2*h-2*g)].filter(o):[]}var l=x[0].y,m=x[1].y,z=x[2].y,p=3*m-l-3*z+x[3].y,v=3*l-6*m+3*z,h=-3*l+3*m,g=l;if(s.approximately(p,0)){if(s.approximately(v,0))return s.approximately(h,0)?[]:[-g/h].filter(o);var b=2*v;return[((d=a(h*h-4*v*g))-h)/b,(-h-d)/b].filter(o)}var d,k,E=(x=(3*(h/=p)-(v/=p)*v)/3)/3,M=(d=(2*v*v*v-9*v*h+27*(g/=p))/27)/2,O=M*M+E*E*E;if(O<0){var S=-x/3,N=a(S*S*S),T=-d/(2*N),_=i(T<-1?-1:T>1?1:T),w=2*u(N);return[w*n(_/3)-v/3,w*n((_+f)/3)-v/3,w*n((_+2*f)/3)-v/3].filter(o)}if(0===O)return[2*(k=M<0?u(-M):-u(M))-v/3,-k-v/3].filter(o);var $=a(O);return[(k=u(-M+$))-u(M+$)-v/3].filter(o)},droots:function(r){if(3===r.length){var n=r[0],t=r[1],i=r[2],e=n-2*t+i;if(0!==e){var x=-a(t*t-n*i),u=-n+t;return[-(x+u)/e,-(-x+u)/e]}return t!==i&&0===e?[(2*t-i)/(2*(t-i))]:[]}if(2===r.length)return(n=r[0])!==(t=r[1])?[n/(n-t)]:[]},curvature:function(n,t,i,e){var u,o,f,y,c,l,m=s.derive(t),z=m[0],p=m[1],v=s.compute(n,z),h=s.compute(n,p),g=v.x*v.x+v.y*v.y;if(i?(u=a(x(v.y*h.z-h.y*v.z,2)+x(v.z*h.x-h.z*v.x,2)+x(v.x*h.y-h.x*v.y,2)),o=x(g+v.z*v.z,1.5)):(u=v.x*h.y-v.y*h.x,o=x(g,1.5)),0===u||0===o)return{k:0,r:0};if(c=u/o,l=o/u,!e){var b=s.curvature(n-.001,t,i,!0).k,d=s.curvature(n+.001,t,i,!0).k;y=(d-c+(c-b))/2,f=(r(d-c)+r(c-b))/2}return{k:c,r:l,dk:y,adk:f}},inflections:function(r){if(r.length<4)return[];var n=s.align(r,{p1:r[0],p2:r.slice(-1)[0]}),t=n[2].x*n[1].y,i=n[3].x*n[1].y,e=n[1].x*n[2].y,a=18*(-3*t+2*i+3*e-(c=n[3].x*n[2].y)),x=18*(3*t-i-3*e),u=18*(e-t);if(s.approximately(a,0)){if(!s.approximately(x,0)){var o=-u/x;if(0<=o&&o<=1)return[o]}return[]}var f=x*x-4*a*u,y=Math.sqrt(f),c=2*a;return s.approximately(c,0)?[]:[(y-x)/c,-(x+y)/c].filter(function(r){return 0<=r&&r<=1})},bboxoverlap:function(n,t){var i,e,a,x,u,o=["x","y"],f=o.length;for(i=0;i<f;i++)if(a=n[e=o[i]].mid,x=t[e].mid,u=(n[e].size+t[e].size)/2,r(a-x)>=u)return!1;return!0},expandbox:function(r,n){n.x.min<r.x.min&&(r.x.min=n.x.min),n.y.min<r.y.min&&(r.y.min=n.y.min),n.z&&n.z.min<r.z.min&&(r.z.min=n.z.min),n.x.max>r.x.max&&(r.x.max=n.x.max),n.y.max>r.y.max&&(r.y.max=n.y.max),n.z&&n.z.max>r.z.max&&(r.z.max=n.z.max),r.x.mid=(r.x.min+r.x.max)/2,r.y.mid=(r.y.min+r.y.max)/2,r.z&&(r.z.mid=(r.z.min+r.z.max)/2),r.x.size=r.x.max-r.x.min,r.y.size=r.y.max-r.y.min,r.z&&(r.z.size=r.z.max-r.z.min)},pairiteration:function(r,n,t){var i=r.bbox(),e=n.bbox(),a=1e5,x=t||.5;if(i.x.size+i.y.size<x&&e.x.size+e.y.size<x)return[(a*(r._t1+r._t2)/2|0)/a+"/"+(a*(n._t1+n._t2)/2|0)/a];var u=r.split(.5),o=n.split(.5),f=[{left:u.left,right:o.left},{left:u.left,right:o.right},{left:u.right,right:o.right},{left:u.right,right:o.left}];f=f.filter(function(r){return s.bboxoverlap(r.left.bbox(),r.right.bbox())});var y=[];return 0===f.length?y:(f.forEach(function(r){y=y.concat(s.pairiteration(r.left,r.right,x))}),y=y.filter(function(r,n){return y.indexOf(r)===n}))},getccenter:function(r,i,a){var x,u=i.x-r.x,o=i.y-r.y,c=a.x-i.x,l=a.y-i.y,m=u*n(y)-o*t(y),z=u*t(y)+o*n(y),p=c*n(y)-l*t(y),v=c*t(y)+l*n(y),h=(r.x+i.x)/2,g=(r.y+i.y)/2,b=(i.x+a.x)/2,d=(i.y+a.y)/2,k=h+m,E=g+z,M=b+p,O=d+v,S=s.lli8(h,g,k,E,b,d,M,O),N=s.dist(S,r),T=e(r.y-S.y,r.x-S.x),_=e(i.y-S.y,i.x-S.x),w=e(a.y-S.y,a.x-S.x);return T<w?((T>_||_>w)&&(T+=f),T>w&&(x=w,w=T,T=x)):w<_&&_<T?(x=w,w=T,T=x):w+=f,S.s=T,S.e=w,S.r=N,S},numberSort:function(r,n){return r-n}};sC=s}()}var KY,LY=false;function MY(){if(LY)return;LY=true;KY={};!function(){var t=(tC(),sC),n=function(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)};n.prototype={valueOf:function(){return this.toString()},toString:function(){return"["+this.curves.map(function(n){return t.pointsToString(n.points)}).join(", ")+"]"},addCurve:function(t){this.curves.push(t),this._3d=this._3d||t._3d},length:function(){return this.curves.map(function(t){return t.length()}).reduce(function(t,n){return t+n})},curve:function(t){return this.curves[t]},bbox:function(){for(var n=this.curves,r=n[0].bbox(),u=1;u<n.length;u++)t.expandbox(r,n[u].bbox());return r},offset:function(t){var r=[];return this.curves.forEach(function(n){r=r.concat(n.offset(t))}),new n(r)}},KY=n}()}var NY,OY=false;function PY(e){var r,i,o,l,f,a,s=(e=e.replace(/,/g," ").replace(/-/g," - ").replace(/-\s+/g,"-").replace(/([a-zA-Z])/g," $1 ")).replace(/([a-zA-Z])\s?/g,"|$1").split("|"),t=s.length,n=[],p=0,$=0,c=0,u=0,g=0,j=0,m=0,h=0,v="";for(r=1;r<t;r++)if(l=(o=(i=s[r]).substring(0,1)).toLowerCase(),f=(n=(n=i.replace(o,"").trim().split(" ")).filter(function(e){return""!==e}).map(parseFloat)).length,"m"===l){if(v+="M ","m"===o?(c+=n[0],u+=n[1]):(c=n[0],u=n[1]),p=c,$=u,v+=c+" "+u+" ",f>2)for(a=0;a<f;a+=2)"m"===o?(c+=n[a],u+=n[a+1]):(c=n[a],u=n[a+1]),v+=["L",c,u,""].join(" ")}else if("l"===l)for(a=0;a<f;a+=2)"l"===o?(c+=n[a],u+=n[a+1]):(c=n[a],u=n[a+1]),v+=["L",c,u,""].join(" ");else if("h"===l)for(a=0;a<f;a++)"h"===o?c+=n[a]:c=n[a],v+=["L",c,u,""].join(" ");else if("v"===l)for(a=0;a<f;a++)"v"===o?u+=n[a]:u=n[a],v+=["L",c,u,""].join(" ");else if("q"===l)for(a=0;a<f;a+=4)"q"===o?(g=c+n[a],j=u+n[a+1],c+=n[a+2],u+=n[a+3]):(g=n[a],j=n[a+1],c=n[a+2],u=n[a+3]),v+=["Q",g,j,c,u,""].join(" ");else if("t"===l)for(a=0;a<f;a+=2)g=c+(c-g),j=u+(u-j),"t"===o?(c+=n[a],u+=n[a+1]):(c=n[a],u=n[a+1]),v+=["Q",g,j,c,u,""].join(" ");else if("c"===l)for(a=0;a<f;a+=6)"c"===o?(g=c+n[a],j=u+n[a+1],m=c+n[a+2],h=u+n[a+3],c+=n[a+4],u+=n[a+5]):(g=n[a],j=n[a+1],m=n[a+2],h=n[a+3],c=n[a+4],u=n[a+5]),v+=["C",g,j,m,h,c,u,""].join(" ");else if("s"===l)for(a=0;a<f;a+=4)g=c+(c-m),j=u+(u-h),"s"===o?(m=c+n[a],h=u+n[a+1],c+=n[a+2],u+=n[a+3]):(m=n[a],h=n[a+1],c=n[a+2],u=n[a+3]),v+=["C",g,j,m,h,c,u,""].join(" ");else"z"===l&&(v+="Z ",c=p,u=$);return v.trim()}function QY(){if(OY)return;OY=true;NY={};NY=PY}var RY,SY,uC,TY=false;function UY($,r,e){if("Z"!==r){if("M"!==r){var s=[!1,uC.x,uC.y].concat(e),a=new($.bind.apply($,s)),n=e.slice(-2);return uC={x:n[0],y:n[1]},a}uC={x:e[0],y:e[1]}}}function VY($,r){for(var e,s,a=SY(r).split(" "),n=new RegExp("[MLCQZ]",""),v=[],i={C:6,Q:4,L:2,M:2};a.length;)e=a.splice(0,1)[0],n.test(e)&&(s=UY($,e,a.splice(0,i[e]).map(parseFloat)))&&v.push(s);return new $.PolyBezier(v)}function WY(){if(TY)return;TY=true;RY={};SY=(QY(),NY);uC={x:!1,y:!1};RY=VY}var vC,XY=false;function wC(){if(XY)return;XY=true;vC={};!function(){var t=Math.abs,i=Math.min,r=Math.max,n=Math.cos,e=Math.sin,s=Math.acos,o=Math.sqrt,h=Math.PI,u={x:0,y:0,z:0},a=(tC(),sC),c=(MY(),KY),f=function(i){var r=i&&i.forEach?i:[].slice.call(arguments),n=!1;if("object"==typeof r[0]){n=r.length;var e=[];r.forEach(function(t){["x","y","z"].forEach(function(i){void 0!==t[i]&&e.push(t[i])})}),r=e}var s=!1,o=r.length;if(n){if(n>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(6!==o&&8!==o&&9!==o&&12!==o&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");var h=!s&&(9===o||12===o)||i&&i[0]&&void 0!==i[0].z;this._3d=h;for(var u=[],c=0,f=h?3:2;c<o;c+=f){var l={x:r[c],y:r[c+1]};h&&(l.z=r[c+2]),u.push(l)}this.order=u.length-1,this.points=u;var p=["x","y"];h&&p.push("z"),this.dims=p,this.dimlen=p.length,function(i){for(var r=i.order,n=i.points,e=a.align(n,{p1:n[0],p2:n[r]}),s=0;s<e.length;s++)if(t(e[s].y)>1e-4)return void(i._linear=!1);i._linear=!0}(this),this._t1=0,this._t2=1,this.update()},l=(WY(),RY);function p(t,i,r,n,e){void 0===e&&(e=.5);var s=a.projectionratio(e,t),o=1-s,h={x:s*i.x+o*n.x,y:s*i.y+o*n.y},u=a.abcratio(e,t);return{A:{x:r.x+(r.x-h.x)/u,y:r.y+(r.y-h.y)/u},B:r,C:h}}f.SVGtoBeziers=function(t){return l(f,t)},f.quadraticFromPoints=function(t,i,r,n){if(void 0===n&&(n=.5),0===n)return new f(i,i,r);if(1===n)return new f(t,i,i);var e=p(2,t,i,r,n);return new f(t,e.A,r)},f.cubicFromPoints=function(t,i,r,n,e){void 0===n&&(n=.5);var s=p(3,t,i,r,n);void 0===e&&(e=a.dist(i,s.C));var o=e*(1-n)/n,h=a.dist(t,r),u=(r.x-t.x)/h,c=(r.y-t.y)/h,l=e*u,x=e*c,v=o*u,y=o*c,d=i.x-l,g=i.y-x,_=i.x+v,m=i.y+y,z=s.A,w=z.x+(d-z.x)/(1-n),b=z.y+(g-z.y)/(1-n),E=z.x+(_-z.x)/n,O=z.y+(m-z.y)/n,$={x:t.x+(w-t.x)/n,y:t.y+(b-t.y)/n},M={x:r.x+(E-r.x)/(1-n),y:r.y+(O-r.y)/(1-n)};return new f(t,$,M,r)};var x=function(){return a};f.getUtils=x,f.PolyBezier=c,f.prototype={getUtils:x,valueOf:function(){return this.toString()},toString:function(){return a.pointsToString(this.points)},toSVG:function(t){if(this._3d)return!1;for(var i=this.points,r=["M",i[0].x,i[0].y,2===this.order?"Q":"C"],n=1,e=i.length;n<e;n++)r.push(i[n].x),r.push(i[n].y);return r.join(" ")},setRatios:function(t){if(t.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=t,this._lut=[]},verify:function(){var t=this.coordDigest();t!==this._print&&(this._print=t,this.update())},coordDigest:function(){return this.points.map(function(t,i){return""+i+t.x+t.y+(t.z?t.z:0)}).join("")},update:function(t){this._lut=[],this.dpoints=a.derive(this.points,this._3d),this.computedirection()},computedirection:function(){var t=this.points,i=a.angle(t[0],t[this.order],t[1]);this.clockwise=i>0},length:function(){return a.length(this.derivative.bind(this))},_lut:[],getLUT:function(t){if(this.verify(),t=t||100,this._lut.length===t)return this._lut;this._lut=[],t--;for(var i=0;i<=t;i++)this._lut.push(this.compute(i/t));return this._lut},on:function(t,i){i=i||5;for(var r,n=this.getLUT(),e=[],s=0,o=0;o<n.length;o++)r=n[o],a.dist(r,t)<i&&(e.push(r),s+=o/n.length);return!!e.length&&s/e.length},project:function(t){var i,r,n,e,s=this.getLUT(),o=s.length-1,h=a.closest(s,t),u=h.mdist,c=h.mpos,f=(c+1)/o,l=.1/o;for(u+=1,i=r=(c-1)/o;r<f+l;r+=l)n=this.compute(r),(e=a.dist(t,n))<u&&(u=e,i=r);return(n=this.compute(i)).t=i,n.d=u,n},get:function(t){return this.compute(t)},point:function(t){return this.points[t]},compute:function(t){return this.ratios?a.computeWithRatios(t,this.points,this.ratios,this._3d):a.compute(t,this.points,this._3d,this.ratios)},raise:function(){for(var t,i,r=this.points,n=[r[0]],e=r.length,s=1;s<e;s++)t=r[s],i=r[s-1],n[s]={x:(e-s)/e*t.x+s/e*i.x,y:(e-s)/e*t.y+s/e*i.y};return n[e]=r[e-1],new f(n)},derivative:function(t){var i,r,n=1-t,e=0,s=this.dpoints[0];2===this.order&&(s=[s[0],s[1],u],i=n,r=t),3===this.order&&(i=n*n,r=n*t*2,e=t*t);var o={x:i*s[0].x+r*s[1].x+e*s[2].x,y:i*s[0].y+r*s[1].y+e*s[2].y};return this._3d&&(o.z=i*s[0].z+r*s[1].z+e*s[2].z),o},curvature:function(t){return a.curvature(t,this.points,this._3d)},inflections:function(){return a.inflections(this.points)},normal:function(t){return this._3d?this.__normal3(t):this.__normal2(t)},__normal2:function(t){var i=this.derivative(t),r=o(i.x*i.x+i.y*i.y);return{x:-i.y/r,y:i.x/r}},__normal3:function(t){var i=this.derivative(t),r=this.derivative(t+.01),n=o(i.x*i.x+i.y*i.y+i.z*i.z),e=o(r.x*r.x+r.y*r.y+r.z*r.z);i.x/=n,i.y/=n,i.z/=n,r.x/=e,r.y/=e,r.z/=e;var s={x:r.y*i.z-r.z*i.y,y:r.z*i.x-r.x*i.z,z:r.x*i.y-r.y*i.x},h=o(s.x*s.x+s.y*s.y+s.z*s.z);s.x/=h,s.y/=h,s.z/=h;var u=[s.x*s.x,s.x*s.y-s.z,s.x*s.z+s.y,s.x*s.y+s.z,s.y*s.y,s.y*s.z-s.x,s.x*s.z-s.y,s.y*s.z+s.x,s.z*s.z];return{x:u[0]*i.x+u[1]*i.y+u[2]*i.z,y:u[3]*i.x+u[4]*i.y+u[5]*i.z,z:u[6]*i.x+u[7]*i.y+u[8]*i.z}},hull:function(t){var i,r=this.points,n=[],e=[],s=0,o=0,h=0;for(e[s++]=r[0],e[s++]=r[1],e[s++]=r[2],3===this.order&&(e[s++]=r[3]);r.length>1;){for(n=[],o=0,h=r.length-1;o<h;o++)i=a.lerp(t,r[o],r[o+1]),e[s++]=i,n.push(i);r=n}return e},split:function(t,i){if(0===t&&i)return this.split(i).left;if(1===i)return this.split(t).right;var r=this.hull(t),n={left:2===this.order?new f([r[0],r[3],r[5]]):new f([r[0],r[4],r[7],r[9]]),right:2===this.order?new f([r[5],r[4],r[2]]):new f([r[9],r[8],r[6],r[3]]),span:r};return n.left._t1=a.map(0,0,1,this._t1,this._t2),n.left._t2=a.map(t,0,1,this._t1,this._t2),n.right._t1=a.map(t,0,1,this._t1,this._t2),n.right._t2=a.map(1,0,1,this._t1,this._t2),i?(i=a.map(i,t,1,0,1),n.right.split(i).left):n},extrema:function(){var t,i,r=this.dims,n={},e=[];return r.forEach(function(r){i=function(t){return t[r]},t=this.dpoints[0].map(i),n[r]=a.droots(t),3===this.order&&(t=this.dpoints[1].map(i),n[r]=n[r].concat(a.droots(t))),n[r]=n[r].filter(function(t){return t>=0&&t<=1}),e=e.concat(n[r].sort(a.numberSort))}.bind(this)),e=e.sort(a.numberSort).filter(function(t,i){return e.indexOf(t)===i}),n.values=e,n},bbox:function(){var t=this.extrema(),i={};return this.dims.forEach(function(r){i[r]=a.getminmax(this,r,t[r])}.bind(this)),i},overlaps:function(t){var i=this.bbox(),r=t.bbox();return a.bboxoverlap(i,r)},offset:function(t,i){if(void 0!==i){var r=this.get(t),n=this.normal(t),e={c:r,n:n,x:r.x+n.x*i,y:r.y+n.y*i};return this._3d&&(e.z=r.z+n.z*i),e}if(this._linear){var s=this.normal(0),o=this.points.map(function(i){var r={x:i.x+t*s.x,y:i.y+t*s.y};return i.z&&n.z&&(r.z=i.z+t*s.z),r});return[new f(o)]}return this.reduce().map(function(i){return i._linear?i.offset(t)[0]:i.scale(t)})},simple:function(){if(3===this.order){var i=a.angle(this.points[0],this.points[3],this.points[1]),r=a.angle(this.points[0],this.points[3],this.points[2]);if(i>0&&r<0||i<0&&r>0)return!1}var n=this.normal(0),e=this.normal(1),o=n.x*e.x+n.y*e.y;return this._3d&&(o+=n.z*e.z),t(s(o))<h/3},reduce:function(){var i,r,n=0,e=0,s=[],o=[],h=this.extrema().values;for(-1===h.indexOf(0)&&(h=[0].concat(h)),-1===h.indexOf(1)&&h.push(1),n=h[0],i=1;i<h.length;i++)e=h[i],(r=this.split(n,e))._t1=n,r._t2=e,s.push(r),n=e;return s.forEach(function(i){for(n=0,e=0;e<=1;)for(e=n+.01;e<=1.01;e+=.01)if(!(r=i.split(n,e)).simple()){if(t(n-(e-=.01))<.01)return[];(r=i.split(n,e))._t1=a.map(n,0,1,i._t1,i._t2),r._t2=a.map(e,0,1,i._t1,i._t2),o.push(r),n=e;break}n<1&&((r=i.split(n,1))._t1=a.map(n,0,1,i._t1,i._t2),r._t2=i._t2,o.push(r))}),o},scale:function(t){var i=this.order,r=!1;if("function"==typeof t&&(r=t),r&&2===i)return this.raise().scale(r);var n=this.clockwise,e=r?r(0):t,s=r?r(1):t,h=[this.offset(0,10),this.offset(1,10)],u=a.lli4(h[0],h[0].c,h[1],h[1].c);if(!u)throw new Error("cannot scale this curve. Try reducing it first.");var c=this.points,l=[];return[0,1].forEach(function(t){var r=l[t*i]=a.copy(c[t*i]);r.x+=(t?s:e)*h[t].n.x,r.y+=(t?s:e)*h[t].n.y}.bind(this)),r?([0,1].forEach(function(e){if(2!==this.order||!e){var s=c[e+1],h={x:s.x-u.x,y:s.y-u.y},a=r?r((e+1)/i):t;r&&!n&&(a=-a);var f=o(h.x*h.x+h.y*h.y);h.x/=f,h.y/=f,l[e+1]={x:s.x+a*h.x,y:s.y+a*h.y}}}.bind(this)),new f(l)):([0,1].forEach(function(t){if(2!==this.order||!t){var r=l[t*i],n=this.derivative(t),e={x:r.x+n.x,y:r.y+n.y};l[t+1]=a.lli4(r,e,u,c[t+1])}}.bind(this)),new f(l))},outline:function(t,i,r,n){i=void 0===i?t:i;var e,s=this.reduce(),o=s.length,h=[],u=[],f=0,l=this.length(),p=void 0!==r&&void 0!==n;function x(t,i,r,n,e){return function(s){var o=n/r,h=(n+e)/r,u=i-t;return a.map(s,0,1,t+o*u,t+h*u)}}s.forEach(function(e){w=e.length(),p?(h.push(e.scale(x(t,r,l,f,w))),u.push(e.scale(x(-i,-n,l,f,w)))):(h.push(e.scale(t)),u.push(e.scale(-i))),f+=w}),u=u.map(function(t){return(e=t.points)[3]?t.points=[e[3],e[2],e[1],e[0]]:t.points=[e[2],e[1],e[0]],t}).reverse();var v=h[0].points[0],y=h[o-1].points[h[o-1].points.length-1],d=u[o-1].points[u[o-1].points.length-1],g=u[0].points[0],_=a.makeline(d,v),m=a.makeline(y,g),z=[_].concat(h).concat([m]).concat(u),w=z.length;return new c(z)},outlineshapes:function(t,i,r){i=i||t;for(var n=this.outline(t,i).curves,e=[],s=1,o=n.length;s<o/2;s++){var h=a.makeshape(n[s],n[o-s],r);h.startcap.virtual=s>1,h.endcap.virtual=s<o/2-1,e.push(h)}return e},intersects:function(t,i){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof f&&(t=t.reduce()),this.curveintersects(this.reduce(),t,i)):this.selfintersects(i)},lineIntersects:function(t){var n=i(t.p1.x,t.p2.x),e=i(t.p1.y,t.p2.y),s=r(t.p1.x,t.p2.x),o=r(t.p1.y,t.p2.y),h=this;return a.roots(this.points,t).filter(function(t){var i=h.get(t);return a.between(i.x,n,s)&&a.between(i.y,e,o)})},selfintersects:function(t){var i,r,n,e,s=this.reduce(),o=s.length-2,h=[];for(i=0;i<o;i++)n=s.slice(i,i+1),e=s.slice(i+2),r=this.curveintersects(n,e,t),h=h.concat(r);return h},curveintersects:function(t,i,r){var n=[];t.forEach(function(t){i.forEach(function(i){t.overlaps(i)&&n.push({left:t,right:i})})});var e=[];return n.forEach(function(t){var i=a.pairiteration(t.left,t.right,r);i.length>0&&(e=e.concat(i))}),e},arcs:function(t){t=t||.5;return this._iterate(t,[])},_error:function(i,r,n,e){var s=(e-n)/4,o=this.get(n+s),h=this.get(e-s),u=a.dist(i,r),c=a.dist(i,o),f=a.dist(i,h);return t(c-u)+t(f-u)},_iterate:function(t,i){var r,s=0,o=1;do{r=0,o=1;var h,u,c,f,l,p=this.get(s),x=!1,v=!1,y=o,d=1;do{if(v=x,f=c,y=(s+o)/2,0,h=this.get(y),u=this.get(o),(c=a.getccenter(p,h,u)).interval={start:s,end:o},x=this._error(c,p,s,o)<=t,(l=v&&!x)||(d=o),x){if(o>=1){if(c.interval.end=d=1,f=c,o>1){var g={x:c.x+c.r*n(c.e),y:c.y+c.r*e(c.e)};c.e+=a.angle({x:c.x,y:c.y},g,this.get(1))}break}o+=(o-s)/2}else o=y}while(!l&&r++<100);if(r>=100)break;f=f||c,i.push(f),s=d}while(o<1);return i}},vC=f}()}IY=(wC(),vC);function YY(t){return(YY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ZY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xC(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $Y(t,e,o){return e&&xC(t.prototype,e),o&&xC(t,o),t}function _Y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&aZ(t,e)}function aZ(t,e){return(aZ=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bZ(t){var e=eZ();return function(){var o,r=yC(t);if(e){var n=yC(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return cZ(this,o)}}function cZ(t,e){return!e||"object"!==YY(e)&&"function"!=typeof e?dZ(t):e}function dZ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eZ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function yC(t){return(yC=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fZ(t){return(fZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gZ(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function zC(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hZ(t,n,e){return n&&zC(t.prototype,n),e&&zC(t,e),t}function AC(t,n,e){return(AC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,n,e){var r=iZ(t,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(e):o.value}})(t,n,e||t)}function iZ(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=$l(t)););return t}function jZ(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&kZ(t,n)}function kZ(t,n){return(kZ=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function lZ(t){var n=oZ();return function(){var e,r=$l(t);if(n){var o=$l(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return mZ(this,e)}}function mZ(t,n){return!n||"object"!==fZ(n)&&"function"!=typeof n?nZ(t):n}function nZ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oZ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function $l(t){return($l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pZ(t){return(pZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BC(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function rZ(t,e,i){return e&&BC(t.prototype,e),i&&BC(t,i),t}function sZ(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tZ(t,e)}function tZ(t,e){return(tZ=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function uZ(t){var e=wZ();return function(){var i,a=CC(t);if(e){var r=CC(this).constructor;i=Reflect.construct(a,arguments,r)}else i=a.apply(this,arguments);return vZ(this,i)}}function vZ(t,e){return!e||"object"!==pZ(e)&&"function"!=typeof e?xp(t):e}function xp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wZ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function CC(t){return(CC=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xZ(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function DC(t,r){for(var $=0;$<r.length;$++){var E=r[$];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(t,E.key,E)}}function yZ(t,r,$){return r&&DC(t.prototype,r),$&&DC(t,$),t}function zZ(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function EC(r,e){for(var $=0;$<e.length;$++){var a=e[$];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,a.key,a)}}function AZ(r,e,$){return e&&EC(r.prototype,e),$&&EC(r,$),r}function BZ(e){return(BZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FC(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function DZ(e,t,r){return t&&FC(e.prototype,t),r&&FC(e,r),e}function EZ(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FZ(e,t)}function FZ(e,t){return(FZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GZ(e){var t=JZ();return function(){var r,o=GC(e);if(t){var i=GC(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return HZ(this,r)}}function HZ(e,t){return!t||"object"!==BZ(t)&&"function"!=typeof t?IZ(e):t}function IZ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JZ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function GC(e){return(GC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function KZ(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function HC(e,a){for(var r=0;r<a.length;r++){var t=a[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function LZ(e,a,r){return a&&HC(e.prototype,a),r&&HC(e,r),e}var MZ=[new ba(-3.019268035888672,-.2780601382255554,-3.2815840244293213),new ba(-4.254585266113281,-.29421406984329224,-1.3319121599197388),new ba(-4.349547386169434,-.30718207359313965,.9742341041564941),new ba(-3.278707265853882,-.31348931789398193,3.018923282623291),new ba(-1.3289966583251953,-.31144583225250244,4.254283905029297),new ba(.9771613478660583,-.3015991449356079,4.349301815032959),new ba(3.021834135055542,-.286587655544281,3.278517007827759),new ba(4.257152080535889,-.2704337537288666,1.3288456201553345),new ba(4.352114677429199,-.2574657201766968,-.9772998094558716),new ba(3.2812767028808594,-.2511584162712097,-3.0219900608062744),new ba(1.331566333770752,-.2532019019126892,-4.257351398468018),new ba(-.974591851234436,-.26304861903190613,-4.3523712158203125),new ba(-2.9022715091705322,-1.9589225053787231,-3.1718835830688477),new ba(-4.092833042144775,-1.974491000175476,-1.2928534746170044),new ba(-4.184355735778809,-1.986989140510559,.9297359585762024),new ba(-3.152317523956299,-1.993067741394043,2.900343418121338),new ba(-1.2732502222061157,-1.9910985231399536,4.090946197509766),new ba(.9493513703346252,-1.9816086292266846,4.18252420425415),new ba(2.919942855834961,-1.967141032218933,3.150538682937622),new ba(4.1105055809021,-1.951572299003601,1.271509051322937),new ba(4.202029228210449,-1.9390742778778076,-.9510802030563354),new ba(3.169992446899414,-1.9329954385757446,-2.9216883182525635),new ba(1.2909256219863892,-1.9349647760391235,-4.112292766571045),new ba(-.9316755533218384,-1.9444547891616821,-4.2038726806640625),new ba(.0012834301451221108,-.2823238968849182,-.0015340081881731749),new ba(-1.446112036705017,-1.9612153768539429,-1.5906234979629517),new ba(-2.0411462783813477,-1.9689966440200806,-.6514983773231506),new ba(-2.086888313293457,-1.9752429723739624,.4593351483345032),new ba(-1.5710833072662354,-1.9782811403274536,1.4442298412322998),new ba(-.6319396495819092,-1.9772969484329224,2.0392844676971436),new ba(.4788999557495117,-1.9725537300109863,2.085054397583008),new ba(1.4637869596481323,-1.9653233289718628,1.569275975227356),new ba(2.058821439743042,-1.957542061805725,.6301507949829102),new ba(2.104564666748047,-1.9512957334518433,-.4806825816631317),new ba(1.5887597799301147,-1.948257327079773,-1.4655778408050537),new ba(.6496162414550781,-1.9492419958114624,-2.0606329441070557),new ba(-.4612230658531189,-1.9539846181869507,-2.1064038276672363),new ba(-1.4407693147659302,-3.1500906944274902,-1.5970885753631592),new ba(-2.0358033180236816,-3.1578714847564697,-.6579633355140686),new ba(-2.081545829772949,-3.1641180515289307,.45287013053894043),new ba(-1.5657404661178589,-3.167156457901001,1.4377648830413818),new ba(-.6265968084335327,-3.1661722660064697,2.0328197479248047),new ba(.4842427968978882,-3.1614291667938232,2.07858943939209),new ba(1.4691299200057983,-3.154198169708252,1.5628106594085693),new ba(2.064164400100708,-3.1464171409606934,.6236858367919922),new ba(2.109907627105713,-3.1401708126068115,-.4871475398540497),new ba(1.5941027402877808,-3.137132167816162,-1.4720429182052612),new ba(.6549590229988098,-3.1381168365478516,-2.0670981407165527),new ba(-.4558802545070648,-3.142859697341919,-2.1128687858581543),new ba(-1.4456579685211182,-2.062270164489746,-1.5911731719970703),new ba(-2.04069185256958,-2.0700509548187256,-.652047872543335),new ba(-2.0864343643188477,-2.0762977600097656,.4587855637073517),new ba(-1.5706290006637573,-2.0793356895446777,1.4436802864074707),new ba(-.6314853429794312,-2.0783514976501465,2.0387349128723145),new ba(.47935420274734497,-2.0736083984375,2.0845048427581787),new ba(1.4642411470413208,-2.066377639770508,1.5687263011932373),new ba(2.0592758655548096,-2.058596611022949,.629601240158081),new ba(2.1050186157226562,-2.0523500442504883,-.48123201727867126),new ba(1.5892138481140137,-2.049312114715576,-1.4661273956298828),new ba(.6500704288482666,-2.0502963066101074,-2.061182737350464),new ba(-.4607689082622528,-2.055039167404175,-2.1069533824920654),new ba(-1.2161787748336792,-3.150407552719116,-1.3532028198242188),new ba(-1.7193611860275269,-3.1569876670837402,-.5590437650680542),new ba(-1.758042573928833,-3.1622700691223145,.3803180158138275),new ba(-1.3218590021133423,-3.164839029312134,1.2131813764572144),new ba(-.5276843905448914,-3.1640067100524902,1.716381549835205),new ba(.4116826355457306,-3.1599960327148438,1.7550861835479736),new ba(1.2445393800735474,-3.153881072998047,1.3189250230789185),new ba(1.7477223873138428,-3.147301435470581,.5247660875320435),new ba(1.7864046096801758,-3.142019271850586,-.41459566354751587),new ba(1.350221037864685,-3.1394500732421875,-1.2474594116210938),new ba(.5560466051101685,-3.140282154083252,-1.7506601810455322),new ba(-.3833201825618744,-3.1442928314208984,-1.789365530014038),new ba(-1.8521819114685059,-.9611732363700867,-.5855358242988586),new ba(-1.3133114576339722,-.9541265964508057,-1.4360202550888062),new ba(-1.8936067819595337,-.9668300151824951,.42045003175735474),new ba(-1.4264869689941406,-.9695814251899719,1.3123842477798462),new ba(-.5759854912757874,-.968690037727356,1.8512736558914185),new ba(.43000587821006775,-.9643946886062622,1.892723560333252),new ba(1.3219326734542847,-.957846462726593,1.42562735080719),new ba(1.8608040809631348,-.9507997632026672,.5751430988311768),new ba(1.902229905128479,-.945142924785614,-.43084266781806946),new ba(1.4351099729537964,-.9423915147781372,-1.3227771520614624),new ba(.5846087336540222,-.9432829022407532,-1.8616670370101929),new ba(-.42138242721557617,-.9475781321525574,-1.9031176567077637),new ba(-1.2051070928573608,-2.431209087371826,-1.3337433338165283),new ba(-1.7024338245391846,-2.4377129077911377,-.5488271713256836),new ba(-1.7406648397445679,-2.4429333209991455,.3796020746231079),new ba(-1.3095574378967285,-2.445472478866577,1.2027722597122192),new ba(-.5246255993843079,-2.4446499347686768,1.7001159191131592),new ba(.40380871295928955,-2.440685749053955,1.7383700609207153),new ba(1.2269724607467651,-2.4346423149108887,1.3072850704193115),new ba(1.724299430847168,-2.4281392097473145,.5223689079284668),new ba(1.7625315189361572,-2.4229183197021484,-.40606021881103516),new ba(1.3314241170883179,-2.4203789234161377,-1.2292308807373047),new ba(.5464925169944763,-2.421201705932617,-1.7265751361846924),new ba(-.38194164633750916,-2.4251656532287598,-1.7648299932479858),new ba(-1.18931245803833,-5.945982456207275,-1.3528573513031006),new ba(-1.6866391897201538,-5.952486038208008,-.5679412484169006),new ba(-1.7248703241348267,-5.957706451416016,.36048808693885803),new ba(-1.2937626838684082,-5.960245609283447,1.1836583614349365),new ba(-.5088310241699219,-5.959423065185547,1.6810020208358765),new ba(.4196033775806427,-5.955458641052246,1.7192561626434326),new ba(1.242767095565796,-5.949415683746338,1.2881710529327393),new ba(1.7400939464569092,-5.9429121017456055,.5032548904418945),new ba(1.778326153755188,-5.9376912117004395,-.4251742362976074),new ba(1.3472188711166382,-5.935152053833008,-1.2483447790145874),new ba(.5622872114181519,-5.935974597930908,-1.7456891536712646),new ba(-.3661470115184784,-5.939938545227051,-1.7839438915252686),new ba(-1.1835092306137085,-7.237382411956787,-1.3598802089691162),new ba(-1.6808357238769531,-7.243884563446045,-.5749640464782715),new ba(-1.7190667390823364,-7.249105930328369,.35346516966819763),new ba(-1.2879595756530762,-7.251645088195801,1.1766353845596313),new ba(-.5030277371406555,-7.250823020935059,1.6739791631698608),new ba(.42540663480758667,-7.246857643127441,1.7122331857681274),new ba(1.2485703229904175,-7.240814685821533,1.281148076057434),new ba(1.7458972930908203,-7.234311103820801,.4962320327758789),new ba(1.7841293811798096,-7.229091167449951,-.43219709396362305),new ba(1.3530220985412598,-7.226551532745361,-1.2553677558898926),new ba(.5680904984474182,-7.227374076843262,-1.7527120113372803),new ba(-.3603437542915344,-7.2313385009765625,-1.7909668684005737),new ba(12.573517799377441,-6.936495780944824,-.6631232500076294),new ba(12.688243865966797,-6.874354839324951,-.35207703709602356),new ba(12.73995590209961,-6.840461730957031,.18020184338092804),new ba(12.714801788330078,-6.843896389007568,.7910898923873901),new ba(12.61951732635498,-6.883739471435547,1.3169001340866089),new ba(12.47963809967041,-6.949316024780273,1.6167418956756592),new ba(12.418614387512207,-6.165295600891113,-.6511046886444092),new ba(12.533339500427246,-6.103155612945557,-.34005850553512573),new ba(12.585052490234375,-6.069262504577637,.1922205090522766),new ba(12.559896469116211,-6.07269811630249,.8031083941459656),new ba(12.464613914489746,-6.1125407218933105,1.3289188146591187),new ba(12.324734687805176,-6.178117275238037,1.628760576248169),new ba(13.694042205810547,-1.9821431636810303,-.6400278210639954),new ba(13.45047378540039,-1.8987802267074585,-.6495885848999023),new ba(13.766084671020508,-1.8310067653656006,-.3302387297153473),new ba(13.793155670166016,-1.7457325458526611,.2013142704963684),new ba(13.767997741699219,-1.7491679191589355,.8122023344039917),new ba(13.697357177734375,-1.840392827987671,1.3387384414672852),new ba(13.600160598754883,-1.9949644804000854,1.639837384223938),new ba(13.356593132019043,-1.9116017818450928,1.6302766799926758),new ba(13.522516250610352,-1.7476449012756348,-.33979952335357666),new ba(13.549588203430176,-1.662369966506958,.1917535960674286),new ba(13.524431228637695,-1.665805697441101,.8026416301727295),new ba(13.453790664672852,-1.757030725479126,1.3291776180267334),new ba(.03253093361854553,-7.239100933074951,-.039367612451314926)];var NZ=[new aa(24,0,1,null,255,3),new aa(24,1,2,null,255,3),new aa(24,2,3,null,255,3),new aa(24,3,4,null,255,3),new aa(24,4,5,null,255,3),new aa(24,5,6,null,255,3),new aa(24,6,7,null,255,3),new aa(24,7,8,null,255,3),new aa(24,8,9,null,255,3),new aa(24,9,10,null,255,3),new aa(24,10,11,null,255,3),new aa(11,0,24,null,255,3),new aa(0,12,13),new aa(0,13,1),new aa(1,13,14),new aa(1,14,2),new aa(2,14,15),new aa(2,15,3),new aa(3,15,16),new aa(3,16,4),new aa(4,16,17),new aa(4,17,5),new aa(5,17,18),new aa(5,18,6),new aa(6,18,19),new aa(6,19,7),new aa(7,19,20),new aa(7,20,8),new aa(8,20,21),new aa(8,21,9),new aa(9,21,22),new aa(9,22,10),new aa(10,22,23),new aa(10,23,11),new aa(12,0,11),new aa(12,11,23),new aa(13,12,25),new aa(13,25,26),new aa(14,13,26),new aa(14,26,27),new aa(15,14,27),new aa(15,27,28),new aa(16,15,28),new aa(16,28,29),new aa(17,16,29),new aa(17,29,30),new aa(18,17,30),new aa(18,30,31),new aa(19,18,31),new aa(19,31,32),new aa(20,19,32),new aa(20,32,33),new aa(21,20,33),new aa(21,33,34),new aa(22,21,34),new aa(22,34,35),new aa(23,22,35),new aa(23,35,36),new aa(12,23,36),new aa(12,36,25),new aa(25,49,50),new aa(25,50,26),new aa(49,37,38),new aa(49,38,50),new aa(26,50,51),new aa(26,51,27),new aa(50,38,39),new aa(50,39,51),new aa(27,51,52),new aa(27,52,28),new aa(51,39,40),new aa(51,40,52),new aa(28,52,53),new aa(28,53,29),new aa(52,40,41),new aa(52,41,53),new aa(29,53,54),new aa(29,54,30),new aa(53,41,42),new aa(53,42,54),new aa(30,54,55),new aa(30,55,31),new aa(54,42,43),new aa(54,43,55),new aa(31,55,56),new aa(31,56,32),new aa(55,43,44),new aa(55,44,56),new aa(32,56,57),new aa(32,57,33),new aa(56,44,45),new aa(56,45,57),new aa(33,57,58),new aa(33,58,34),new aa(57,45,46),new aa(57,46,58),new aa(34,58,59),new aa(34,59,35),new aa(58,46,47),new aa(58,47,59),new aa(35,59,60),new aa(35,60,36),new aa(59,47,48),new aa(59,48,60),new aa(36,60,49),new aa(36,49,25),new aa(60,48,37),new aa(60,37,49),new aa(38,37,61),new aa(38,61,62),new aa(39,38,62),new aa(39,62,63),new aa(40,39,63),new aa(40,63,64),new aa(41,40,64),new aa(41,64,65),new aa(42,41,65),new aa(42,65,66),new aa(43,42,66),new aa(43,66,67),new aa(44,43,67),new aa(44,67,68),new aa(45,44,68),new aa(45,68,69),new aa(46,45,69),new aa(46,69,70),new aa(47,46,70),new aa(47,70,71),new aa(48,47,71),new aa(48,71,72),new aa(37,48,72),new aa(37,72,61),new aa(62,61,74),new aa(62,74,73),new aa(63,62,73),new aa(63,73,75),new aa(64,63,75),new aa(64,75,76),new aa(65,64,76),new aa(65,76,77),new aa(66,65,77),new aa(66,77,78),new aa(67,66,78),new aa(67,78,79),new aa(68,67,79),new aa(68,79,80),new aa(69,68,80),new aa(69,80,81),new aa(70,69,81),new aa(70,81,82),new aa(71,70,82),new aa(71,82,83),new aa(72,71,83),new aa(72,83,84),new aa(61,72,84),new aa(61,84,74),new aa(86,85,97),new aa(86,97,98),new aa(87,86,98),new aa(87,98,99),new aa(88,87,99),new aa(88,99,100),new aa(89,88,100),new aa(89,100,101),new aa(90,89,101),new aa(90,101,102),new aa(91,90,102),new aa(91,102,103),new aa(92,91,103),new aa(92,103,104),new aa(93,92,104),new aa(93,104,105),new aa(94,93,105),new aa(94,105,106),new aa(95,94,106),new aa(95,106,107),new aa(96,95,107),new aa(96,107,108),new aa(97,85,96),new aa(97,96,108),new aa(98,97,109),new aa(98,109,110),new aa(99,98,110),new aa(99,110,111),new aa(100,99,111),new aa(100,111,112),new aa(101,100,112),new aa(101,112,113),new aa(102,101,113),new aa(102,113,114),new aa(108,107,119),new aa(108,119,120),new aa(108,120,109),new aa(108,109,97),new aa(119,107,127),new aa(119,127,121),new aa(118,119,121),new aa(118,121,122),new aa(117,118,122),new aa(117,122,123),new aa(116,117,123),new aa(116,123,124),new aa(115,116,124),new aa(115,124,125),new aa(114,115,125),new aa(114,125,126),new aa(102,114,126),new aa(102,126,132),new aa(107,106,128),new aa(107,128,127),new aa(106,105,129),new aa(106,129,128),new aa(105,104,130),new aa(105,130,129),new aa(104,103,131),new aa(104,131,130),new aa(103,102,132),new aa(103,132,131),new aa(121,127,134),new aa(121,134,133),new aa(122,121,133),new aa(122,133,135),new aa(123,122,135),new aa(123,135,136),new aa(124,123,136),new aa(124,136,137),new aa(125,124,137),new aa(125,137,138),new aa(126,125,138),new aa(126,138,139),new aa(132,126,139),new aa(132,139,140),new aa(127,128,141),new aa(127,141,134),new aa(128,129,142),new aa(128,142,141),new aa(129,130,143),new aa(129,143,142),new aa(130,131,144),new aa(130,144,143),new aa(131,132,140),new aa(131,140,144),new aa(138,144,140),new aa(138,140,139),new aa(137,143,144),new aa(137,144,138),new aa(136,142,143),new aa(136,143,137),new aa(135,141,142),new aa(135,142,136),new aa(133,134,141),new aa(133,141,135),new aa(110,109,145,null,255,3),new aa(111,110,145,null,255,3),new aa(112,111,145,null,255,3),new aa(113,112,145,null,255,3),new aa(114,113,145,null,255,3),new aa(115,114,145,null,255,3),new aa(116,115,145,null,255,3),new aa(117,116,145,null,255,3),new aa(118,117,145,null,255,3),new aa(119,118,145,null,255,3),new aa(120,119,145,null,255,3),new aa(109,120,145,null,255,3)];var OZ=[new ba(-3.019268035888672,-.2780601382255554,-3.2815840244293213),new ba(-4.254585266113281,-.29421406984329224,-1.3319121599197388),new ba(-4.349547386169434,-.30718207359313965,.9742341041564941),new ba(-3.278707265853882,-.31348931789398193,3.018923282623291),new ba(-1.3289966583251953,-.31144583225250244,4.254283905029297),new ba(.9771613478660583,-.3015991449356079,4.349301815032959),new ba(3.021834135055542,-.286587655544281,3.278517007827759),new ba(4.257152080535889,-.2704337537288666,1.3288456201553345),new ba(4.352114677429199,-.2574657201766968,-.9772998094558716),new ba(3.2812767028808594,-.2511584162712097,-3.0219900608062744),new ba(1.331566333770752,-.2532019019126892,-4.257351398468018),new ba(-.974591851234436,-.26304861903190613,-4.3523712158203125),new ba(-2.9022715091705322,-1.9589225053787231,-3.1718835830688477),new ba(-4.092833042144775,-1.974491000175476,-1.2928534746170044),new ba(-4.184355735778809,-1.986989140510559,.9297359585762024),new ba(-3.152317523956299,-1.993067741394043,2.900343418121338),new ba(-1.2732502222061157,-1.9910985231399536,4.090946197509766),new ba(.9493513703346252,-1.9816086292266846,4.18252420425415),new ba(2.919942855834961,-1.967141032218933,3.150538682937622),new ba(4.1105055809021,-1.951572299003601,1.271509051322937),new ba(4.202029228210449,-1.9390742778778076,-.9510802030563354),new ba(3.169992446899414,-1.9329954385757446,-2.9216883182525635),new ba(1.2909256219863892,-1.9349647760391235,-4.112292766571045),new ba(-.9316755533218384,-1.9444547891616821,-4.2038726806640625),new ba(.0012834301451221108,-.5668943524360657,-.0015340081881731749),new ba(-1.446112036705017,-1.9612153768539429,-1.5906234979629517),new ba(-2.0411462783813477,-1.9689966440200806,-.6514983773231506),new ba(-2.086888313293457,-1.9752429723739624,.4593351483345032),new ba(-1.5710833072662354,-1.9782811403274536,1.4442298412322998),new ba(-.6319396495819092,-1.9772969484329224,2.0392844676971436),new ba(.4788999557495117,-1.9725537300109863,2.085054397583008),new ba(1.4637869596481323,-1.9653233289718628,1.569275975227356),new ba(2.058821439743042,-1.957542061805725,.6301507949829102),new ba(2.104564666748047,-1.9512957334518433,-.4806825816631317),new ba(1.5887597799301147,-1.948257327079773,-1.4655778408050537),new ba(.6496162414550781,-1.9492419958114624,-2.0606329441070557),new ba(-.4612230658531189,-1.9539846181869507,-2.1064038276672363),new ba(-1.4407693147659302,-3.1500906944274902,-1.5970885753631592),new ba(-2.0358033180236816,-3.1578714847564697,-.6579633355140686),new ba(-2.081545829772949,-3.1641180515289307,.45287013053894043),new ba(-1.5657404661178589,-3.167156457901001,1.4377648830413818),new ba(-.6265968084335327,-3.1661722660064697,2.0328197479248047),new ba(.4842427968978882,-3.1614291667938232,2.07858943939209),new ba(1.4691299200057983,-3.154198169708252,1.5628106594085693),new ba(2.064164400100708,-3.1464171409606934,.6236858367919922),new ba(2.109907627105713,-3.1401708126068115,-.4871475398540497),new ba(1.5941027402877808,-3.137132167816162,-1.4720429182052612),new ba(.6549590229988098,-3.1381168365478516,-2.0670981407165527),new ba(-.4558802545070648,-3.142859697341919,-2.1128687858581543),new ba(-1.4456579685211182,-2.062270164489746,-1.5911731719970703),new ba(-2.04069185256958,-2.0700509548187256,-.652047872543335),new ba(-2.0864343643188477,-2.0762977600097656,.4587855637073517),new ba(-1.5706290006637573,-2.0793356895446777,1.4436802864074707),new ba(-.6314853429794312,-2.0783514976501465,2.0387349128723145),new ba(.47935420274734497,-2.0736083984375,2.0845048427581787),new ba(1.4642411470413208,-2.066377639770508,1.5687263011932373),new ba(2.0592758655548096,-2.058596611022949,.629601240158081),new ba(2.1050186157226562,-2.0523500442504883,-.48123201727867126),new ba(1.5892138481140137,-2.049312114715576,-1.4661273956298828),new ba(.6500704288482666,-2.0502963066101074,-2.061182737350464),new ba(-.4607689082622528,-2.055039167404175,-2.1069533824920654),new ba(-.846520721912384,-3.267390727996826,-.9529860615730286),new ba(-1.1987367868423462,-3.27199649810791,-.397093266248703),new ba(-1.2258127927780151,-3.275693893432617,.26043808460235596),new ba(-.9204944372177124,-3.277492046356201,.8434229493141174),new ba(-.36459070444107056,-3.276909589767456,1.1956512928009033),new ba(.2929442524909973,-3.274102210998535,1.2227436304092407),new ba(.8759246468544006,-3.269821882247925,.9174410104751587),new ba(1.2281408309936523,-3.265216112136841,.3615483343601227),new ba(1.2552175521850586,-3.261518955230713,-.2959829568862915),new ba(.9498993158340454,-3.2597203254699707,-.8789681792259216),new ba(.3939957320690155,-3.260303020477295,-1.2311969995498657),new ba(-.2635391354560852,-3.263110399246216,-1.2582899332046509),new ba(-1.6618385314941406,-4.475956916809082,-1.847565770149231),new ba(-2.3491361141204834,-4.4849443435668945,-.7628244161605835),new ba(-2.4019711017608643,-4.492159366607666,.5202495455741882),new ba(-1.8061872720718384,-4.495668411254883,1.6578571796417236),new ba(-.7214244604110718,-4.494532108306885,2.3451778888702393),new ba(.5616565346717834,-4.489053726196289,2.3980443477630615),new ba(1.6992552280426025,-4.480700969696045,1.8022922277450562),new ba(2.386552572250366,-4.471714973449707,.7175509333610535),new ba(2.4393889904022217,-4.464499473571777,-.5655227899551392),new ba(1.8436059951782227,-4.460989475250244,-1.7031309604644775),new ba(.7588432431221008,-4.462126731872559,-2.3904528617858887),new ba(-.5242375135421753,-4.467605113983154,-2.4433200359344482),new ba(-2.6277291774749756,-8.928065299987793,-2.9148523807525635),new ba(-3.7133281230926514,-8.94226360321045,-1.2014834880828857),new ba(-3.7967820167541504,-8.953658103942871,.8251562714576721),new ba(-2.8557300567626953,-8.959199905395508,2.6220293045043945),new ba(-1.142327070236206,-8.957405090332031,3.7076659202575684),new ba(.8843236565589905,-8.948752403259277,3.7911691665649414),new ba(2.681182384490967,-8.935558319091797,2.8501667976379395),new ba(3.766781806945801,-8.921364784240723,1.1367974281311035),new ba(3.850238084793091,-8.909966468811035,-.8898418545722961),new ba(2.909186840057373,-8.904423713684082,-2.6867153644561768),new ba(1.1957839727401733,-8.906219482421875,-3.772353410720825),new ba(-.8308665752410889,-8.914871215820312,-3.855858325958252),new ba(-1.406922698020935,-8.832839012145996,-1.589163064956665),new ba(-1.9932459592819214,-8.840507507324219,-.6637864112854004),new ba(-2.038318634033203,-8.846661567687988,.43078529834747314),new ba(-1.5300642251968384,-8.849654197692871,1.401261806488037),new ba(-.6046692132949829,-8.848684310913086,1.987605333328247),new ba(.4899083971977234,-8.844012260437012,2.0327045917510986),new ba(1.4603770971298218,-8.836885452270508,1.5244770050048828),new ba(2.0467004776000977,-8.829219818115234,.5991001129150391),new ba(2.0917744636535645,-8.823062896728516,-.49547120928764343),new ba(1.583520531654358,-8.820070266723633,-1.4659479856491089),new ba(.6581255197525024,-8.821039199829102,-2.0522921085357666),new ba(-.4364519417285919,-8.825712203979492,-2.0973925590515137),new ba(-.6114304065704346,-8.5830659866333,-.7253276109695435),new ba(-.8724194765090942,-8.586480140686035,-.31341639161109924),new ba(-.892482578754425,-8.589219093322754,.17380833625793457),new ba(-.6662442088127136,-8.590551376342773,.6057948470115662),new ba(-.2543247640132904,-8.590120315551758,.8667927384376526),new ba(.2329026162624359,-8.58803939819336,.8868677616119385),new ba(.6648856401443481,-8.584868431091309,.6606413722038269),new ba(.9258745908737183,-8.581456184387207,.24873000383377075),new ba(.9459383487701416,-8.578715324401855,-.23849454522132874),new ba(.7197002172470093,-8.577383041381836,-.6704810857772827),new ba(.30778077244758606,-8.577814102172852,-.9314795136451721),new ba(-.1794464886188507,-8.579894065856934,-.9515548944473267),new ba(.026727881282567978,-8.479126930236816,-.03234325721859932),new ba(-.3782625198364258,-4.132713794708252,1.244664192199707),new ba(.9928271174430847,-4.1147847175598145,-.9192845821380615),new ba(-1.2765675783157349,-4.13144588470459,.2691824436187744),new ba(-1.2483258247375488,-4.127589225769043,-.4166610538959503),new ba(-.2728599011898041,-4.118320941925049,-1.3149391412734985),new ba(-.9044193029403687,-3.338594436645508,-1.0158588886260986),new ba(-1.2803142070770264,-3.3435099124908447,-.4225943684577942),new ba(-1.3092105388641357,-3.3474557399749756,.27914169430732727),new ba(-.9833661913871765,-3.349375009536743,.9013196229934692),new ba(-.39008989930152893,-3.348752975463867,1.2772276401519775),new ba(.31164997816085815,-3.345757007598877,1.3061413764953613),new ba(.9338231682777405,-3.341188669204712,.9803138971328735),new ba(1.3097182512283325,-3.336273431777954,.38704946637153625),new ba(1.3386154174804688,-3.3323276042938232,-.3146865665912628),new ba(1.0127710103988647,-3.3304080963134766,-.9368648529052734),new ba(.41949498653411865,-3.3310301303863525,-1.3127734661102295),new ba(-.28224486112594604,-3.3340260982513428,-1.3416876792907715),new ba(-1.3213201761245728,-.5427400469779968,4.231791973114014),new ba(-3.003157377243042,-.509520947933197,-3.2664780616760254),new ba(-3.261303186416626,-.5447733998298645,3.002594470977783),new ba(-4.232311725616455,-.5255942940711975,-1.3265336751937866),new ba(-4.326800346374512,-.5384976267814636,.9681065678596497),new ba(3.007803201675415,-.5180059671401978,3.2608938217163086),new ba(.9733318090438843,-.5329424738883972,4.326335906982422),new ba(1.325969934463501,-.48478683829307556,-4.237376689910889),new ba(4.331447601318359,-.4890293478965759,-.9736892580986023),new ba(4.236958026885986,-.501932680606842,1.3209501504898071),new ba(-.9686821103096008,-.4945843815803528,-4.3319220542907715),new ba(3.2659523487091064,-.4827534854412079,-3.0081779956817627),new ba(-.8809435367584229,-4.122784614562988,-.9964894652366638),new ba(-.9581024646759033,-4.133321285247803,.8772696256637573),new ba(.3075847029685974,-4.129785537719727,1.2729228734970093),new ba(.9156670570373535,-4.125320911407471,.9544746279716492),new ba(1.28304922580719,-4.120517730712891,.37464621663093567),new ba(1.3112918138504028,-4.1166605949401855,-.31119707226753235),new ba(.41298723220825195,-4.115392208099365,-1.286679744720459),new ba(-1.20172917842865,-3.323627233505249,-.39827409386634827),new ba(-1.2288755178451538,-3.327333927154541,.2609657645225525),new ba(-.9227638840675354,-3.329136848449707,.8454654216766357),new ba(-.3654157221317291,-3.328552722930908,1.1986089944839478),new ba(.29382774233818054,-3.325737953186035,1.2257717847824097),new ba(.8783228397369385,-3.3214468955993652,.9196758270263672),new ba(1.2314543724060059,-3.3168294429779053,.36233872175216675),new ba(1.2586013078689575,-3.313122272491455,-.29690104722976685),new ba(.9524897933006287,-3.311318874359131,-.8814010620117188),new ba(.3951417803764343,-3.3119029998779297,-1.234545111656189),new ba(-.2641015946865082,-3.3147177696228027,-1.261708378791809),new ba(-.8485979437828064,-3.319009304046631,-.9556112885475159)];var PZ=[new aa(24,0,1,null,255,3),new aa(24,1,2,null,255,3),new aa(24,2,3,null,255,3),new aa(24,3,4,null,255,3),new aa(24,4,5,null,255,3),new aa(24,5,6,null,255,3),new aa(24,6,7,null,255,3),new aa(24,7,8,null,255,3),new aa(24,8,9,null,255,3),new aa(24,9,10,null,255,3),new aa(24,10,11,null,255,3),new aa(11,0,24,null,255,3),new aa(140,12,13),new aa(140,13,142),new aa(142,13,14),new aa(142,14,143),new aa(143,14,15),new aa(143,15,141),new aa(141,15,16),new aa(141,16,139),new aa(139,16,17),new aa(139,17,145),new aa(145,17,18),new aa(145,18,144),new aa(144,18,19),new aa(144,19,148),new aa(148,19,20),new aa(148,20,147),new aa(147,20,21),new aa(147,21,150),new aa(150,21,22),new aa(150,22,146),new aa(146,22,23),new aa(146,23,149),new aa(140,0,11),new aa(140,11,149),new aa(13,12,25),new aa(13,25,26),new aa(14,13,26),new aa(14,26,27),new aa(15,14,27),new aa(15,27,28),new aa(16,15,28),new aa(16,28,29),new aa(17,16,29),new aa(17,29,30),new aa(18,17,30),new aa(18,30,31),new aa(19,18,31),new aa(19,31,32),new aa(20,19,32),new aa(20,32,33),new aa(21,20,33),new aa(21,33,34),new aa(22,21,34),new aa(22,34,35),new aa(23,22,35),new aa(23,35,36),new aa(12,23,36),new aa(12,36,25),new aa(25,49,50),new aa(25,50,26),new aa(49,37,38),new aa(49,38,50),new aa(26,50,51),new aa(26,51,27),new aa(50,38,39),new aa(50,39,51),new aa(27,51,52),new aa(27,52,28),new aa(51,39,40),new aa(51,40,52),new aa(28,52,53),new aa(28,53,29),new aa(52,40,41),new aa(52,41,53),new aa(29,53,54),new aa(29,54,30),new aa(53,41,42),new aa(53,42,54),new aa(30,54,55),new aa(30,55,31),new aa(54,42,43),new aa(54,43,55),new aa(31,55,56),new aa(31,56,32),new aa(55,43,44),new aa(55,44,56),new aa(32,56,57),new aa(32,57,33),new aa(56,44,45),new aa(56,45,57),new aa(33,57,58),new aa(33,58,34),new aa(57,45,46),new aa(57,46,58),new aa(34,58,59),new aa(34,59,35),new aa(58,46,47),new aa(58,47,59),new aa(35,59,60),new aa(35,60,36),new aa(59,47,48),new aa(59,48,60),new aa(36,60,49),new aa(36,49,25),new aa(60,48,37),new aa(60,37,49),new aa(38,37,61),new aa(38,61,62),new aa(39,38,62),new aa(39,62,63),new aa(40,39,63),new aa(40,63,64),new aa(41,40,64),new aa(41,64,65),new aa(42,41,65),new aa(42,65,66),new aa(43,42,66),new aa(43,66,67),new aa(44,43,67),new aa(44,67,68),new aa(45,44,68),new aa(45,68,69),new aa(46,45,69),new aa(46,69,70),new aa(47,46,70),new aa(47,70,71),new aa(48,47,71),new aa(48,71,72),new aa(37,48,72),new aa(37,72,61),new aa(124,125,74),new aa(124,74,75),new aa(74,73,85),new aa(74,85,86),new aa(79,78,90),new aa(79,90,91),new aa(80,79,91),new aa(80,91,92),new aa(77,76,88),new aa(77,88,89),new aa(82,81,93),new aa(82,93,94),new aa(76,75,87),new aa(76,87,88),new aa(81,80,92),new aa(81,92,93),new aa(73,84,96),new aa(73,96,85),new aa(84,83,95),new aa(84,95,96),new aa(83,82,94),new aa(83,94,95),new aa(78,77,89),new aa(78,89,90),new aa(75,74,86),new aa(75,86,87),new aa(90,89,101),new aa(90,101,102),new aa(86,85,97),new aa(86,97,98),new aa(93,92,104),new aa(93,104,105),new aa(96,95,107),new aa(96,107,108),new aa(85,96,108),new aa(85,108,97),new aa(89,88,100),new aa(89,100,101),new aa(91,90,102),new aa(91,102,103),new aa(88,87,99),new aa(88,99,100),new aa(92,91,103),new aa(92,103,104),new aa(95,94,106),new aa(95,106,107),new aa(94,93,105),new aa(94,105,106),new aa(87,86,98),new aa(87,98,99),new aa(105,104,116),new aa(105,116,117),new aa(108,107,119),new aa(108,119,120),new aa(97,108,120),new aa(97,120,109),new aa(101,100,112),new aa(101,112,113),new aa(103,102,114),new aa(103,114,115),new aa(100,99,111),new aa(100,111,112),new aa(104,103,115),new aa(104,115,116),new aa(107,106,118),new aa(107,118,119),new aa(106,105,117),new aa(106,117,118),new aa(99,98,110),new aa(99,110,111),new aa(102,101,113),new aa(102,113,114),new aa(98,97,109),new aa(98,109,110),new aa(120,119,121,null,255,3),new aa(109,120,121,null,255,3),new aa(113,112,121,null,255,3),new aa(115,114,121,null,255,3),new aa(112,111,121,null,255,3),new aa(116,115,121,null,255,3),new aa(119,118,121,null,255,3),new aa(118,117,121,null,255,3),new aa(111,110,121,null,255,3),new aa(114,113,121,null,255,3),new aa(110,109,121,null,255,3),new aa(117,116,121,null,255,3),new aa(169,158,62),new aa(169,62,61),new aa(158,159,63),new aa(158,63,62),new aa(159,160,64),new aa(159,64,63),new aa(160,161,65),new aa(160,65,64),new aa(161,162,66),new aa(161,66,65),new aa(162,163,67),new aa(162,67,66),new aa(163,164,68),new aa(163,68,67),new aa(164,165,69),new aa(164,69,68),new aa(165,166,70),new aa(165,70,69),new aa(166,167,71),new aa(166,71,70),new aa(167,168,72),new aa(167,72,71),new aa(168,169,61),new aa(168,61,72),new aa(72,138,127),new aa(72,127,61),new aa(63,129,130),new aa(63,130,64),new aa(67,133,134),new aa(67,134,68),new aa(64,130,131),new aa(64,131,65),new aa(61,127,128),new aa(61,128,62),new aa(69,135,136),new aa(69,136,70),new aa(66,132,133),new aa(66,133,67),new aa(65,131,132),new aa(65,132,66),new aa(71,137,138),new aa(71,138,72),new aa(70,136,137),new aa(70,137,71),new aa(62,128,129),new aa(62,129,63),new aa(68,134,135),new aa(68,135,69),new aa(0,140,142),new aa(0,142,1),new aa(1,142,143),new aa(1,143,2),new aa(2,143,141),new aa(2,141,3),new aa(3,141,139),new aa(3,139,4),new aa(4,139,145),new aa(4,145,5),new aa(5,145,144),new aa(5,144,6),new aa(6,144,148),new aa(6,148,7),new aa(7,148,147),new aa(7,147,8),new aa(8,147,150),new aa(8,150,9),new aa(9,150,146),new aa(9,146,10),new aa(10,146,149),new aa(10,149,11),new aa(12,140,149),new aa(12,149,23),new aa(153,154,163),new aa(153,163,162),new aa(154,155,164),new aa(154,164,163),new aa(155,156,165),new aa(155,165,164),new aa(125,151,73),new aa(125,73,74),new aa(152,124,75),new aa(152,75,76),new aa(122,152,76),new aa(122,76,77),new aa(153,122,77),new aa(153,77,78),new aa(154,153,78),new aa(154,78,79),new aa(155,154,79),new aa(155,79,80),new aa(156,155,80),new aa(156,80,81),new aa(123,156,81),new aa(123,81,82),new aa(157,123,82),new aa(157,82,83),new aa(126,157,83),new aa(126,83,84),new aa(73,151,126),new aa(73,126,84),new aa(151,125,158),new aa(151,158,169),new aa(125,124,159),new aa(125,159,158),new aa(124,152,160),new aa(124,160,159),new aa(152,122,161),new aa(152,161,160),new aa(122,153,162),new aa(122,162,161),new aa(156,123,166),new aa(156,166,165),new aa(123,157,167),new aa(123,167,166),new aa(157,126,168),new aa(157,168,167),new aa(126,151,169),new aa(126,169,168)];var QZ=[new ba(-3.019268035888672,-.2780601382255554,-3.2815840244293213),new ba(-4.254585266113281,-.29421406984329224,-1.3319121599197388),new ba(-4.349547386169434,-.30718207359313965,.9742341041564941),new ba(-3.278707265853882,-.31348931789398193,3.018923282623291),new ba(-1.3289966583251953,-.31144583225250244,4.254283905029297),new ba(.9771613478660583,-.3015991449356079,4.349301815032959),new ba(3.021834135055542,-.286587655544281,3.278517007827759),new ba(4.257152080535889,-.2704337537288666,1.3288456201553345),new ba(4.352114677429199,-.2574657201766968,-.9772998094558716),new ba(3.2812767028808594,-.2511584162712097,-3.0219900608062744),new ba(1.331566333770752,-.2532019019126892,-4.257351398468018),new ba(-.974591851234436,-.26304861903190613,-4.3523712158203125),new ba(-2.9022715091705322,-1.9589225053787231,-3.1718835830688477),new ba(-4.092833042144775,-1.974491000175476,-1.2928534746170044),new ba(-4.184355735778809,-1.986989140510559,.9297359585762024),new ba(-3.152317523956299,-1.993067741394043,2.900343418121338),new ba(-1.2732502222061157,-1.9910985231399536,4.090946197509766),new ba(.9493513703346252,-1.9816086292266846,4.18252420425415),new ba(2.919942855834961,-1.967141032218933,3.150538682937622),new ba(4.1105055809021,-1.951572299003601,1.271509051322937),new ba(4.202029228210449,-1.9390742778778076,-.9510802030563354),new ba(3.169992446899414,-1.9329954385757446,-2.9216883182525635),new ba(1.2909256219863892,-1.9349647760391235,-4.112292766571045),new ba(-.9316755533218384,-1.9444547891616821,-4.2038726806640625),new ba(.0012834301451221108,-.5668943524360657,-.0015340081881731749),new ba(-1.446112036705017,-1.9612153768539429,-1.5906234979629517),new ba(-2.0411462783813477,-1.9689966440200806,-.6514983773231506),new ba(-2.086888313293457,-1.9752429723739624,.4593351483345032),new ba(-1.5710833072662354,-1.9782811403274536,1.4442298412322998),new ba(-.6319396495819092,-1.9772969484329224,2.0392844676971436),new ba(.4788999557495117,-1.9725537300109863,2.085054397583008),new ba(1.4637869596481323,-1.9653233289718628,1.569275975227356),new ba(2.058821439743042,-1.957542061805725,.6301507949829102),new ba(2.104564666748047,-1.9512957334518433,-.4806825816631317),new ba(1.5887597799301147,-1.948257327079773,-1.4655778408050537),new ba(.6496162414550781,-1.9492419958114624,-2.0606329441070557),new ba(-.4612230658531189,-1.9539846181869507,-2.1064038276672363),new ba(-1.4407693147659302,-3.1500906944274902,-1.5970885753631592),new ba(-2.0358033180236816,-3.1578714847564697,-.6579633355140686),new ba(-2.081545829772949,-3.1641180515289307,.45287013053894043),new ba(-1.5657404661178589,-3.167156457901001,1.4377648830413818),new ba(-.6265968084335327,-3.1661722660064697,2.0328197479248047),new ba(.4842427968978882,-3.1614291667938232,2.07858943939209),new ba(1.4691299200057983,-3.154198169708252,1.5628106594085693),new ba(2.064164400100708,-3.1464171409606934,.6236858367919922),new ba(2.109907627105713,-3.1401708126068115,-.4871475398540497),new ba(1.5941027402877808,-3.137132167816162,-1.4720429182052612),new ba(.6549590229988098,-3.1381168365478516,-2.0670981407165527),new ba(-.4558802545070648,-3.142859697341919,-2.1128687858581543),new ba(-1.4456579685211182,-2.062270164489746,-1.5911731719970703),new ba(-2.04069185256958,-2.0700509548187256,-.652047872543335),new ba(-2.0864343643188477,-2.0762977600097656,.4587855637073517),new ba(-1.5706290006637573,-2.0793356895446777,1.4436802864074707),new ba(-.6314853429794312,-2.0783514976501465,2.0387349128723145),new ba(.47935420274734497,-2.0736083984375,2.0845048427581787),new ba(1.4642411470413208,-2.066377639770508,1.5687263011932373),new ba(2.0592758655548096,-2.058596611022949,.629601240158081),new ba(2.1050186157226562,-2.0523500442504883,-.48123201727867126),new ba(1.5892138481140137,-2.049312114715576,-1.4661273956298828),new ba(.6500704288482666,-2.0502963066101074,-2.061182737350464),new ba(-.4607689082622528,-2.055039167404175,-2.1069533824920654),new ba(-.846520721912384,-3.267390727996826,-.9529860615730286),new ba(-1.1987367868423462,-3.27199649810791,-.397093266248703),new ba(-1.2258127927780151,-3.275693893432617,.26043808460235596),new ba(-.9204944372177124,-3.277492046356201,.8434229493141174),new ba(-.36459070444107056,-3.276909589767456,1.1956512928009033),new ba(.2929442524909973,-3.274102210998535,1.2227436304092407),new ba(.8759246468544006,-3.269821882247925,.9174410104751587),new ba(1.2281408309936523,-3.265216112136841,.3615483343601227),new ba(1.2552175521850586,-3.261518955230713,-.2959829568862915),new ba(.9498993158340454,-3.2597203254699707,-.8789681792259216),new ba(.3939957320690155,-3.260303020477295,-1.2311969995498657),new ba(-.2635391354560852,-3.263110399246216,-1.2582899332046509),new ba(-1.6618385314941406,-4.475956916809082,-1.847565770149231),new ba(-2.3491361141204834,-4.4849443435668945,-.7628244161605835),new ba(-2.4019711017608643,-4.492159366607666,.5202495455741882),new ba(-1.8061872720718384,-4.495668411254883,1.6578571796417236),new ba(-.7214244604110718,-4.494532108306885,2.3451778888702393),new ba(.5616565346717834,-4.489053726196289,2.3980443477630615),new ba(1.6992552280426025,-4.480700969696045,1.8022922277450562),new ba(2.386552572250366,-4.471714973449707,.7175509333610535),new ba(2.4393889904022217,-4.464499473571777,-.5655227899551392),new ba(1.8436059951782227,-4.460989475250244,-1.7031309604644775),new ba(.7588432431221008,-4.462126731872559,-2.3904528617858887),new ba(-.5242375135421753,-4.467605113983154,-2.4433200359344482),new ba(-2.1944406032562256,-8.92867660522461,-2.4443392753601074),new ba(-3.102836847305298,-8.940557479858398,-1.0106441974639893),new ba(-3.17266845703125,-8.950092315673828,.6851861476898193),new ba(-2.3852250576019287,-8.954730033874512,2.1887545585632324),new ba(-.9515015482902527,-8.953227043151855,3.097182035446167),new ba(.744337797164917,-8.945987701416016,3.167055130004883),new ba(2.247894287109375,-8.93494701385498,2.379653215408325),new ba(3.1562910079956055,-8.923069953918457,.9459580183029175),new ba(3.2261245250701904,-8.913532257080078,-.7498718500137329),new ba(2.4386816024780273,-8.908894538879395,-2.2534408569335938),new ba(1.0049583911895752,-8.910396575927734,-3.161869525909424),new ba(-.6908810138702393,-8.91763687133789,-3.2317440509796143),new ba(-1.406922698020935,-9.728320121765137,-1.589163064956665),new ba(-1.9932459592819214,-9.735987663269043,-.6637864112854004),new ba(-2.038318634033203,-9.742142677307129,.43078529834747314),new ba(-1.5300642251968384,-9.745135307312012,1.401261806488037),new ba(-.6046692132949829,-9.744165420532227,1.987605333328247),new ba(.4899083971977234,-9.739492416381836,2.0327045917510986),new ba(1.4603770971298218,-9.732366561889648,1.5244770050048828),new ba(2.0467004776000977,-9.724700927734375,.5991001129150391),new ba(2.0917744636535645,-9.718544006347656,-.49547120928764343),new ba(1.583520531654358,-9.715551376342773,-1.4659479856491089),new ba(.6581255197525024,-9.716520309448242,-2.0522921085357666),new ba(-.4364519417285919,-9.721193313598633,-2.0973925590515137),new ba(-.6114304065704346,-9.771082878112793,-.7253276109695435),new ba(-.8724194765090942,-9.774497032165527,-.31341639161109924),new ba(-.892482578754425,-9.777236938476562,.17380833625793457),new ba(-.6662442088127136,-9.778569221496582,.6057948470115662),new ba(-.2543247640132904,-9.77813720703125,.8667927384376526),new ba(.2329026162624359,-9.776057243347168,.8868677616119385),new ba(.6648856401443481,-9.7728853225708,.6606413722038269),new ba(.9258745908737183,-9.7694730758667,.24873000383377075),new ba(.9459383487701416,-9.766733169555664,-.23849454522132874),new ba(.7197002172470093,-9.765399932861328,-.6704810857772827),new ba(.30778077244758606,-9.765830993652344,-.9314795136451721),new ba(-.1794464886188507,-9.767911911010742,-.9515548944473267),new ba(.026727881282567978,-9.871400833129883,-.03234325721859932),new ba(-.3782625198364258,-4.132713794708252,1.244664192199707),new ba(.9928271174430847,-4.1147847175598145,-.9192845821380615),new ba(-1.2765675783157349,-4.13144588470459,.2691824436187744),new ba(-1.2483258247375488,-4.127589225769043,-.4166610538959503),new ba(-.2728599011898041,-4.118320941925049,-1.3149391412734985),new ba(-.9044193029403687,-3.338594436645508,-1.0158588886260986),new ba(-1.2803142070770264,-3.3435099124908447,-.4225943684577942),new ba(-1.3092105388641357,-3.3474557399749756,.27914169430732727),new ba(-.9833661913871765,-3.349375009536743,.9013196229934692),new ba(-.39008989930152893,-3.348752975463867,1.2772276401519775),new ba(.31164997816085815,-3.345757007598877,1.3061413764953613),new ba(.9338231682777405,-3.341188669204712,.9803138971328735),new ba(1.3097182512283325,-3.336273431777954,.38704946637153625),new ba(1.3386154174804688,-3.3323276042938232,-.3146865665912628),new ba(1.0127710103988647,-3.3304080963134766,-.9368648529052734),new ba(.41949498653411865,-3.3310301303863525,-1.3127734661102295),new ba(-.28224486112594604,-3.3340260982513428,-1.3416876792907715),new ba(-1.3213201761245728,-.5427400469779968,4.231791973114014),new ba(-3.003157377243042,-.509520947933197,-3.2664780616760254),new ba(-3.261303186416626,-.5447733998298645,3.002594470977783),new ba(-4.232311725616455,-.5255942940711975,-1.3265336751937866),new ba(-4.326800346374512,-.5384976267814636,.9681065678596497),new ba(3.007803201675415,-.5180059671401978,3.2608938217163086),new ba(.9733318090438843,-.5329424738883972,4.326335906982422),new ba(1.325969934463501,-.48478683829307556,-4.237376689910889),new ba(4.331447601318359,-.4890293478965759,-.9736892580986023),new ba(4.236958026885986,-.501932680606842,1.3209501504898071),new ba(-.9686821103096008,-.4945843815803528,-4.3319220542907715),new ba(3.2659523487091064,-.4827534854412079,-3.0081779956817627),new ba(-.8809435367584229,-4.122784614562988,-.9964894652366638),new ba(-.9581024646759033,-4.133321285247803,.8772696256637573),new ba(.3075847029685974,-4.129785537719727,1.2729228734970093),new ba(.9156670570373535,-4.125320911407471,.9544746279716492),new ba(1.28304922580719,-4.120517730712891,.37464621663093567),new ba(1.3112918138504028,-4.1166605949401855,-.31119707226753235),new ba(.41298723220825195,-4.115392208099365,-1.286679744720459),new ba(-1.20172917842865,-3.323627233505249,-.39827409386634827),new ba(-1.2288755178451538,-3.327333927154541,.2609657645225525),new ba(-.9227638840675354,-3.329136848449707,.8454654216766357),new ba(-.3654157221317291,-3.328552722930908,1.1986089944839478),new ba(.29382774233818054,-3.325737953186035,1.2257717847824097),new ba(.8783228397369385,-3.3214468955993652,.9196758270263672),new ba(1.2314543724060059,-3.3168294429779053,.36233872175216675),new ba(1.2586013078689575,-3.313122272491455,-.29690104722976685),new ba(.9524897933006287,-3.311318874359131,-.8814010620117188),new ba(.3951417803764343,-3.3119029998779297,-1.234545111656189),new ba(-.2641015946865082,-3.3147177696228027,-1.261708378791809),new ba(-.8485979437828064,-3.319009304046631,-.9556112885475159),new ba(-2.4085001945495605,-7.821017265319824,-2.672210454940796),new ba(-3.403625249862671,-7.834033489227295,-1.1016337871551514),new ba(.8108576536178589,-7.839981555938721,3.474930763244629),new ba(2.457965850830078,-7.827888488769531,2.612351894378662),new ba(3.453091621398926,-7.814876556396484,1.0417746305465698),new ba(-2.617499828338623,-7.849558353424072,2.4032270908355713),new ba(-1.046891689300537,-7.8479132652282715,3.3983864784240723),new ba(3.529592514038086,-7.804428577423096,-.8159644603729248),new ba(2.666968584060669,-7.7993483543396,-2.4630863666534424),new ba(-3.4801244735717773,-7.844477653503418,.7561056017875671),new ba(-.7613884806632996,-7.808925151824951,-3.534792423248291),new ba(1.0963609218597412,-7.8009934425354,-3.4582467079162598),new ba(-3.5280909538269043,-7.544366836547852,-1.1391332149505615),new ba(2.54472279548645,-7.53800106048584,2.7086853981018066),new ba(3.575707197189331,-7.524519920349121,1.081512689590454),new ba(-1.0864323377609253,-7.558748245239258,3.523045063018799),new ba(2.761256694793701,-7.508431434631348,-2.5496456623077393),new ba(-2.4971063137054443,-7.530882835388184,-2.766305685043335),new ba(.8382608890533447,-7.550529956817627,3.6023471355438232),new ba(-2.713637351989746,-7.560452938079834,2.4920248985290527),new ba(3.6549649238586426,-7.51369571685791,-.8431698083877563),new ba(-3.6073460578918457,-7.555188179016113,.7855496406555176),new ba(-.7906410098075867,-7.5183539390563965,-3.659970760345459),new ba(1.1340521574020386,-7.510136127471924,-3.580667018890381),new ba(-2.173365354537964,-7.79854679107666,-2.4167799949645996),new ba(-3.072309970855713,-7.810303688049316,-.9980021119117737),new ba(.7348364591598511,-7.815676689147949,3.136229991912842),new ba(2.2227489948272705,-7.804752349853516,2.357020616531372),new ba(3.1216936111450195,-7.792998790740967,.9382423162460327),new ba(-2.3621644973754883,-7.824328422546387,2.1681082248687744),new ba(-.9433584213256836,-7.822842121124268,3.0670838356018066),new ba(3.190800905227661,-7.783559799194336,-.7399431467056274),new ba(2.4115512371063232,-7.778970241546631,-2.227867841720581),new ba(-3.1414151191711426,-7.819738864898682,.6801837086677551),new ba(-.685449481010437,-7.787621974945068,-3.1959919929504395),new ba(.9927452802658081,-7.78045654296875,-3.126845121383667),new ba(-2.9289710521698,-7.565496921539307,-.9519111514091492),new ba(2.1195757389068604,-7.560204029083252,2.246917724609375),new ba(2.9766697883605957,-7.5489983558654785,.8941910266876221),new ba(-.8991332054138184,-7.577452182769775,2.923924207687378),new ba(2.2995879650115967,-7.535623073577881,-2.1245203018188477),new ba(-2.0718765258789062,-7.554286956787109,-2.3046376705169678),new ba(.700933039188385,-7.570621490478516,2.9898507595062256),new ba(-2.2518866062164307,-7.578869342803955,2.066800355911255),new ba(3.0425596237182617,-7.5399980545043945,-.7058661580085754),new ba(-2.994858980178833,-7.574492454528809,.6481464505195618),new ba(-.6532312631607056,-7.543872356414795,-3.0475733280181885),new ba(.9468348622322083,-7.5370402336120605,-2.981645345687866)];var RZ=[new aa(24,0,1,null,255,3),new aa(24,1,2,null,255,3),new aa(24,2,3,null,255,3),new aa(24,3,4,null,255,3),new aa(24,4,5,null,255,3),new aa(24,5,6,null,255,3),new aa(24,6,7,null,255,3),new aa(24,7,8,null,255,3),new aa(24,8,9,null,255,3),new aa(24,9,10,null,255,3),new aa(24,10,11,null,255,3),new aa(11,0,24,null,255,3),new aa(140,12,13),new aa(140,13,142),new aa(142,13,14),new aa(142,14,143),new aa(143,14,15),new aa(143,15,141),new aa(141,15,16),new aa(141,16,139),new aa(139,16,17),new aa(139,17,145),new aa(145,17,18),new aa(145,18,144),new aa(144,18,19),new aa(144,19,148),new aa(148,19,20),new aa(148,20,147),new aa(147,20,21),new aa(147,21,150),new aa(150,21,22),new aa(150,22,146),new aa(146,22,23),new aa(146,23,149),new aa(140,0,11),new aa(140,11,149),new aa(13,12,25),new aa(13,25,26),new aa(14,13,26),new aa(14,26,27),new aa(15,14,27),new aa(15,27,28),new aa(16,15,28),new aa(16,28,29),new aa(17,16,29),new aa(17,29,30),new aa(18,17,30),new aa(18,30,31),new aa(19,18,31),new aa(19,31,32),new aa(20,19,32),new aa(20,32,33),new aa(21,20,33),new aa(21,33,34),new aa(22,21,34),new aa(22,34,35),new aa(23,22,35),new aa(23,35,36),new aa(12,23,36),new aa(12,36,25),new aa(25,49,50),new aa(25,50,26),new aa(49,37,38),new aa(49,38,50),new aa(26,50,51),new aa(26,51,27),new aa(50,38,39),new aa(50,39,51),new aa(27,51,52),new aa(27,52,28),new aa(51,39,40),new aa(51,40,52),new aa(28,52,53),new aa(28,53,29),new aa(52,40,41),new aa(52,41,53),new aa(29,53,54),new aa(29,54,30),new aa(53,41,42),new aa(53,42,54),new aa(30,54,55),new aa(30,55,31),new aa(54,42,43),new aa(54,43,55),new aa(31,55,56),new aa(31,56,32),new aa(55,43,44),new aa(55,44,56),new aa(32,56,57),new aa(32,57,33),new aa(56,44,45),new aa(56,45,57),new aa(33,57,58),new aa(33,58,34),new aa(57,45,46),new aa(57,46,58),new aa(34,58,59),new aa(34,59,35),new aa(58,46,47),new aa(58,47,59),new aa(35,59,60),new aa(35,60,36),new aa(59,47,48),new aa(59,48,60),new aa(36,60,49),new aa(36,49,25),new aa(60,48,37),new aa(60,37,49),new aa(38,37,61),new aa(38,61,62),new aa(39,38,62),new aa(39,62,63),new aa(40,39,63),new aa(40,63,64),new aa(41,40,64),new aa(41,64,65),new aa(42,41,65),new aa(42,65,66),new aa(43,42,66),new aa(43,66,67),new aa(44,43,67),new aa(44,67,68),new aa(45,44,68),new aa(45,68,69),new aa(46,45,69),new aa(46,69,70),new aa(47,46,70),new aa(47,70,71),new aa(48,47,71),new aa(48,71,72),new aa(37,48,72),new aa(37,72,61),new aa(124,125,74),new aa(124,74,75),new aa(171,170,85),new aa(171,85,86),new aa(173,172,90),new aa(173,90,91),new aa(174,173,91),new aa(174,91,92),new aa(176,175,88),new aa(176,88,89),new aa(178,177,93),new aa(178,93,94),new aa(175,179,87),new aa(175,87,88),new aa(177,174,92),new aa(177,92,93),new aa(170,180,96),new aa(170,96,85),new aa(180,181,95),new aa(180,95,96),new aa(181,178,94),new aa(181,94,95),new aa(172,176,89),new aa(172,89,90),new aa(179,171,86),new aa(179,86,87),new aa(90,89,101),new aa(90,101,102),new aa(86,85,97),new aa(86,97,98),new aa(93,92,104),new aa(93,104,105),new aa(96,95,107),new aa(96,107,108),new aa(85,96,108),new aa(85,108,97),new aa(89,88,100),new aa(89,100,101),new aa(91,90,102),new aa(91,102,103),new aa(88,87,99),new aa(88,99,100),new aa(92,91,103),new aa(92,103,104),new aa(95,94,106),new aa(95,106,107),new aa(94,93,105),new aa(94,105,106),new aa(87,86,98),new aa(87,98,99),new aa(105,104,116),new aa(105,116,117),new aa(108,107,119),new aa(108,119,120),new aa(97,108,120),new aa(97,120,109),new aa(101,100,112),new aa(101,112,113),new aa(103,102,114),new aa(103,114,115),new aa(100,99,111),new aa(100,111,112),new aa(104,103,115),new aa(104,115,116),new aa(107,106,118),new aa(107,118,119),new aa(106,105,117),new aa(106,117,118),new aa(99,98,110),new aa(99,110,111),new aa(102,101,113),new aa(102,113,114),new aa(98,97,109),new aa(98,109,110),new aa(120,119,121,null,255,3),new aa(109,120,121,null,255,3),new aa(113,112,121,null,255,3),new aa(115,114,121,null,255,3),new aa(112,111,121,null,255,3),new aa(116,115,121,null,255,3),new aa(119,118,121,null,255,3),new aa(118,117,121,null,255,3),new aa(111,110,121,null,255,3),new aa(114,113,121,null,255,3),new aa(110,109,121,null,255,3),new aa(117,116,121,null,255,3),new aa(169,158,62),new aa(169,62,61),new aa(158,159,63),new aa(158,63,62),new aa(159,160,64),new aa(159,64,63),new aa(160,161,65),new aa(160,65,64),new aa(161,162,66),new aa(161,66,65),new aa(162,163,67),new aa(162,67,66),new aa(163,164,68),new aa(163,68,67),new aa(164,165,69),new aa(164,69,68),new aa(165,166,70),new aa(165,70,69),new aa(166,167,71),new aa(166,71,70),new aa(167,168,72),new aa(167,72,71),new aa(168,169,61),new aa(168,61,72),new aa(72,138,127),new aa(72,127,61),new aa(63,129,130),new aa(63,130,64),new aa(67,133,134),new aa(67,134,68),new aa(64,130,131),new aa(64,131,65),new aa(61,127,128),new aa(61,128,62),new aa(69,135,136),new aa(69,136,70),new aa(66,132,133),new aa(66,133,67),new aa(65,131,132),new aa(65,132,66),new aa(71,137,138),new aa(71,138,72),new aa(70,136,137),new aa(70,137,71),new aa(62,128,129),new aa(62,129,63),new aa(68,134,135),new aa(68,135,69),new aa(0,140,142),new aa(0,142,1),new aa(1,142,143),new aa(1,143,2),new aa(2,143,141),new aa(2,141,3),new aa(3,141,139),new aa(3,139,4),new aa(4,139,145),new aa(4,145,5),new aa(5,145,144),new aa(5,144,6),new aa(6,144,148),new aa(6,148,7),new aa(7,148,147),new aa(7,147,8),new aa(8,147,150),new aa(8,150,9),new aa(9,150,146),new aa(9,146,10),new aa(10,146,149),new aa(10,149,11),new aa(12,140,149),new aa(12,149,23),new aa(153,154,163),new aa(153,163,162),new aa(154,155,164),new aa(154,164,163),new aa(155,156,165),new aa(155,165,164),new aa(125,151,73),new aa(125,73,74),new aa(152,124,75),new aa(152,75,76),new aa(122,152,76),new aa(122,76,77),new aa(153,122,77),new aa(153,77,78),new aa(154,153,78),new aa(154,78,79),new aa(155,154,79),new aa(155,79,80),new aa(156,155,80),new aa(156,80,81),new aa(123,156,81),new aa(123,81,82),new aa(157,123,82),new aa(157,82,83),new aa(126,157,83),new aa(126,83,84),new aa(73,151,126),new aa(73,126,84),new aa(151,125,158),new aa(151,158,169),new aa(125,124,159),new aa(125,159,158),new aa(124,152,160),new aa(124,160,159),new aa(152,122,161),new aa(152,161,160),new aa(122,153,162),new aa(122,162,161),new aa(156,123,166),new aa(156,166,165),new aa(123,157,167),new aa(123,167,166),new aa(157,126,168),new aa(157,168,167),new aa(126,151,169),new aa(126,169,168),new aa(185,189,213),new aa(185,213,209),new aa(192,193,217),new aa(192,217,216),new aa(172,173,197),new aa(172,197,196),new aa(174,177,201),new aa(174,201,198),new aa(171,179,203),new aa(171,203,195),new aa(184,183,207),new aa(184,207,208),new aa(187,192,216),new aa(187,216,211),new aa(170,171,195),new aa(170,195,194),new aa(179,175,199),new aa(179,199,203),new aa(176,172,196),new aa(176,196,200),new aa(183,188,212),new aa(183,212,207),new aa(190,184,208),new aa(190,208,214),new aa(74,73,187),new aa(74,187,182),new aa(79,78,188),new aa(79,188,183),new aa(80,79,183),new aa(80,183,184),new aa(77,76,189),new aa(77,189,185),new aa(82,81,190),new aa(82,190,186),new aa(76,75,191),new aa(76,191,189),new aa(81,80,184),new aa(81,184,190),new aa(73,84,192),new aa(73,192,187),new aa(84,83,193),new aa(84,193,192),new aa(83,82,186),new aa(83,186,193),new aa(78,77,185),new aa(78,185,188),new aa(75,74,182),new aa(75,182,191),new aa(206,211,194),new aa(206,194,195),new aa(207,212,196),new aa(207,196,197),new aa(208,207,197),new aa(208,197,198),new aa(209,213,199),new aa(209,199,200),new aa(210,214,201),new aa(210,201,202),new aa(213,215,203),new aa(213,203,199),new aa(214,208,198),new aa(214,198,201),new aa(211,216,204),new aa(211,204,194),new aa(216,217,205),new aa(216,205,204),new aa(217,210,202),new aa(217,202,205),new aa(212,209,200),new aa(212,200,196),new aa(215,206,195),new aa(215,195,203),new aa(180,170,194),new aa(180,194,204),new aa(173,174,198),new aa(173,198,197),new aa(193,186,210),new aa(193,210,217),new aa(186,190,214),new aa(186,214,210),new aa(181,180,204),new aa(181,204,205),new aa(175,176,200),new aa(175,200,199),new aa(188,185,209),new aa(188,209,212),new aa(189,191,215),new aa(189,215,213),new aa(182,187,211),new aa(182,211,206),new aa(178,181,205),new aa(178,205,202),new aa(177,178,202),new aa(177,202,201),new aa(191,182,206),new aa(191,206,215)];var SZ=[new ba(-3.019268035888672,-.2780601382255554,-11.443300247192383),new ba(-4.254585266113281,-.29421406984329224,-9.49362850189209),new ba(-4.349547386169434,-.30718207359313965,-7.187482833862305),new ba(-3.278707265853882,-.31348931789398193,-5.14279317855835),new ba(-1.3289966583251953,-.31144583225250244,-3.9074323177337646),new ba(.9771613478660583,-.3015991449356079,-3.8124148845672607),new ba(3.021834135055542,-.286587655544281,-4.883199691772461),new ba(4.257152080535889,-.2704337537288666,-6.832870960235596),new ba(4.352114677429199,-.2574657201766968,-9.139016151428223),new ba(3.2812767028808594,-.2511584162712097,-11.183706283569336),new ba(1.331566333770752,-.2532019019126892,-12.419068336486816),new ba(-.974591851234436,-.26304861903190613,-12.514087677001953),new ba(-2.9022715091705322,-1.9589225053787231,-11.333600044250488),new ba(-4.092833042144775,-1.974491000175476,-9.454569816589355),new ba(-4.184355735778809,-1.986989140510559,-7.231980323791504),new ba(-3.152317523956299,-1.993067741394043,-5.261373043060303),new ba(-1.2732502222061157,-1.9910985231399536,-4.070770263671875),new ba(.9493513703346252,-1.9816086292266846,-3.9791922569274902),new ba(2.919942855834961,-1.967141032218933,-5.011178016662598),new ba(4.1105055809021,-1.951572299003601,-6.890207290649414),new ba(4.202029228210449,-1.9390742778778076,-9.112796783447266),new ba(3.169992446899414,-1.9329954385757446,-11.083404541015625),new ba(1.2909256219863892,-1.9349647760391235,-12.274008750915527),new ba(-.9316755533218384,-1.9444547891616821,-12.365589141845703),new ba(.0012834301451221108,-.5668943524360657,-8.163250923156738),new ba(-1.446112036705017,-1.9612153768539429,-9.752340316772461),new ba(-2.0411462783813477,-1.9689966440200806,-8.813215255737305),new ba(-2.086888313293457,-1.9752429723739624,-7.7023820877075195),new ba(-1.5710833072662354,-1.9782811403274536,-6.71748685836792),new ba(-.6319396495819092,-1.9772969484329224,-6.122431755065918),new ba(.4788999557495117,-1.9725537300109863,-6.076662063598633),new ba(1.4637869596481323,-1.9653233289718628,-6.592440605163574),new ba(2.058821439743042,-1.957542061805725,-7.5315656661987305),new ba(2.104564666748047,-1.9512957334518433,-8.642398834228516),new ba(1.5887597799301147,-1.948257327079773,-9.627294540405273),new ba(.6496162414550781,-1.9492419958114624,-10.222349166870117),new ba(-.4612230658531189,-1.9539846181869507,-10.268120765686035),new ba(-1.4407693147659302,-3.1500906944274902,-9.758804321289062),new ba(-2.0358033180236816,-3.1578714847564697,-8.819680213928223),new ba(-2.081545829772949,-3.1641180515289307,-7.708846092224121),new ba(-1.5657404661178589,-3.167156457901001,-6.72395133972168),new ba(-.6265968084335327,-3.1661722660064697,-6.128896713256836),new ba(.4842427968978882,-3.1614291667938232,-6.083127021789551),new ba(1.4691299200057983,-3.154198169708252,-6.59890604019165),new ba(2.064164400100708,-3.1464171409606934,-7.538031101226807),new ba(2.109907627105713,-3.1401708126068115,-8.648863792419434),new ba(1.5941027402877808,-3.137132167816162,-9.633759498596191),new ba(.6549590229988098,-3.1381168365478516,-10.228814125061035),new ba(-.4558802545070648,-3.142859697341919,-10.274585723876953),new ba(-1.4456579685211182,-2.062270164489746,-9.752889633178711),new ba(-2.04069185256958,-2.0700509548187256,-8.813764572143555),new ba(-2.0864343643188477,-2.0762977600097656,-7.702930927276611),new ba(-1.5706290006637573,-2.0793356895446777,-6.718036651611328),new ba(-.6314853429794312,-2.0783514976501465,-6.122981548309326),new ba(.47935420274734497,-2.0736083984375,-6.077211856842041),new ba(1.4642411470413208,-2.066377639770508,-6.592990398406982),new ba(2.0592758655548096,-2.058596611022949,-7.532115459442139),new ba(2.1050186157226562,-2.0523500442504883,-8.642948150634766),new ba(1.5892138481140137,-2.049312114715576,-9.627843856811523),new ba(.6500704288482666,-2.0502963066101074,-10.222899436950684),new ba(-.4607689082622528,-2.055039167404175,-10.268670082092285),new ba(-.846520721912384,-3.267390727996826,-9.114703178405762),new ba(-1.1987367868423462,-3.27199649810791,-8.558809280395508),new ba(-1.2258127927780151,-3.275693893432617,-7.901278018951416),new ba(-.9204944372177124,-3.277492046356201,-7.318294048309326),new ba(-.36459070444107056,-3.276909589767456,-6.966064929962158),new ba(.2929442524909973,-3.274102210998535,-6.9389729499816895),new ba(.8759246468544006,-3.269821882247925,-7.2442755699157715),new ba(1.2281408309936523,-3.265216112136841,-7.800168037414551),new ba(1.2552175521850586,-3.261518955230713,-8.4576997756958),new ba(.9498993158340454,-3.2597203254699707,-9.040684700012207),new ba(.3939957320690155,-3.260303020477295,-9.392913818359375),new ba(-.2635391354560852,-3.263110399246216,-9.42000675201416),new ba(-.3782625198364258,-4.132713794708252,-6.917051792144775),new ba(.9928271174430847,-4.1147847175598145,-9.081001281738281),new ba(-1.2765675783157349,-4.13144588470459,-7.892534255981445),new ba(-1.2483258247375488,-4.127589225769043,-8.578377723693848),new ba(-.2728599011898041,-4.118320941925049,-9.476655960083008),new ba(-.9044193029403687,-3.338594436645508,-9.17757511138916),new ba(-1.2803142070770264,-3.3435099124908447,-8.584310531616211),new ba(-1.3092105388641357,-3.3474557399749756,-7.882575035095215),new ba(-.9833661913871765,-3.349375009536743,-7.260396957397461),new ba(-.39008989930152893,-3.348752975463867,-6.884488582611084),new ba(.31164997816085815,-3.345757007598877,-6.855575084686279),new ba(.9338231682777405,-3.341188669204712,-7.181403160095215),new ba(1.3097182512283325,-3.336273431777954,-7.774667263031006),new ba(1.3386154174804688,-3.3323276042938232,-8.47640323638916),new ba(1.0127710103988647,-3.3304080963134766,-9.098581314086914),new ba(.41949498653411865,-3.3310301303863525,-9.47449016571045),new ba(-.28224486112594604,-3.3340260982513428,-9.503403663635254),new ba(-1.3213201761245728,-.5427400469779968,-3.929924488067627),new ba(-3.003157377243042,-.509520947933197,-11.428194046020508),new ba(-3.261303186416626,-.5447733998298645,-5.159121990203857),new ba(-4.232311725616455,-.5255942940711975,-9.488250732421875),new ba(-4.326800346374512,-.5384976267814636,-7.193610191345215),new ba(3.007803201675415,-.5180059671401978,-4.900822639465332),new ba(.9733318090438843,-.5329424738883972,-3.835380792617798),new ba(1.325969934463501,-.48478683829307556,-12.399092674255371),new ba(4.331447601318359,-.4890293478965759,-9.135405540466309),new ba(4.236958026885986,-.501932680606842,-6.840766429901123),new ba(-.9686821103096008,-.4945843815803528,-12.49363899230957),new ba(3.2659523487091064,-.4827534854412079,-11.16989517211914),new ba(-.8809435367584229,-4.122784614562988,-9.15820598602295),new ba(-.9581024646759033,-4.133321285247803,-7.284446716308594),new ba(.3075847029685974,-4.129785537719727,-6.888793468475342),new ba(.9156670570373535,-4.125320911407471,-7.207241535186768),new ba(1.28304922580719,-4.120517730712891,-7.787070274353027),new ba(1.3112918138504028,-4.1166605949401855,-8.47291374206543),new ba(.41298723220825195,-4.115392208099365,-9.448396682739258),new ba(-1.20172917842865,-3.323627233505249,-8.559990882873535),new ba(-1.2288755178451538,-3.327333927154541,-7.900750637054443),new ba(-.9227638840675354,-3.329136848449707,-7.316251277923584),new ba(-.3654157221317291,-3.328552722930908,-6.963107585906982),new ba(.29382774233818054,-3.325737953186035,-6.9359450340271),new ba(.8783228397369385,-3.3214468955993652,-7.242040157318115),new ba(1.2314543724060059,-3.3168294429779053,-7.799377918243408),new ba(1.2586013078689575,-3.313122272491455,-8.458617210388184),new ba(.9524897933006287,-3.311318874359131,-9.04311752319336),new ba(.3951417803764343,-3.3119029998779297,-9.396262168884277),new ba(-.2641015946865082,-3.3147177696228027,-9.42342472076416),new ba(-.8485979437828064,-3.319009304046631,-9.117327690124512),new ba(.41298723220825195,-7.012894153594971,-9.08381462097168),new ba(1.3112918138504028,-6.324020862579346,-8.393146514892578),new ba(1.28304922580719,-5.84178352355957,-7.905455112457275),new ba(.9156670570373535,-5.435179233551025,-7.492057800292969),new ba(.3075847029685974,-5.213159561157227,-7.263724327087402),new ba(-.9581024646759033,-5.495428085327148,-7.5409932136535645),new ba(-.8809435367584229,-6.812925815582275,-8.873391151428223),new ba(-.2728599011898041,-7.034946918487549,-9.101726531982422),new ba(-1.2483258247375488,-6.406322956085205,-8.459993362426758),new ba(-1.2765675783157349,-5.924084663391113,-7.972301483154297),new ba(.9928271174430847,-6.7526774406433105,-8.824455261230469),new ba(-.3782625198364258,-5.235211372375488,-7.281635761260986),new ba(-.9195230007171631,-5.464406967163086,1.7809234857559204),new ba(-1.262446641921997,-5.885434150695801,1.768570065498352),new ba(-1.262446641921997,-6.370398998260498,1.7658435106277466),new ba(-.9195230007171631,-6.7893548011779785,1.7734720706939697),new ba(-.3255612254142761,-7.0300445556640625,1.7894134521484375),new ba(.3602859675884247,-7.027973175048828,1.8093950748443604),new ba(.9542470574378967,-6.783698558807373,1.8280647993087769),new ba(1.2971705198287964,-6.362671375274658,1.8404178619384766),new ba(1.2971705198287964,-5.877706527709961,1.843144416809082),new ba(.9542470574378967,-5.458749771118164,1.8355145454406738),new ba(.3602859675884247,-5.2180609703063965,1.8195737600326538),new ba(-.3255612254142761,-5.2201313972473145,1.799590826034546),new ba(-3.019268035888672,-.2780601382255554,11.443300247192383),new ba(-4.254585266113281,-.29421406984329224,9.49362850189209),new ba(-4.349547386169434,-.30718207359313965,7.187482833862305),new ba(-3.278707265853882,-.31348931789398193,5.14279317855835),new ba(-1.3289966583251953,-.31144583225250244,3.9074323177337646),new ba(.9771613478660583,-.3015991449356079,3.8124148845672607),new ba(3.021834135055542,-.286587655544281,4.883199691772461),new ba(4.257152080535889,-.2704337537288666,6.832870960235596),new ba(4.352114677429199,-.2574657201766968,9.139016151428223),new ba(3.2812767028808594,-.2511584162712097,11.183706283569336),new ba(1.331566333770752,-.2532019019126892,12.419068336486816),new ba(-.974591851234436,-.26304861903190613,12.514087677001953),new ba(-2.9022715091705322,-1.9589225053787231,11.333600044250488),new ba(-4.092833042144775,-1.974491000175476,9.454569816589355),new ba(-4.184355735778809,-1.986989140510559,7.231980323791504),new ba(-3.152317523956299,-1.993067741394043,5.261373043060303),new ba(-1.2732502222061157,-1.9910985231399536,4.070770263671875),new ba(.9493513703346252,-1.9816086292266846,3.9791922569274902),new ba(2.919942855834961,-1.967141032218933,5.011178016662598),new ba(4.1105055809021,-1.951572299003601,6.890207290649414),new ba(4.202029228210449,-1.9390742778778076,9.112796783447266),new ba(3.169992446899414,-1.9329954385757446,11.083404541015625),new ba(1.2909256219863892,-1.9349647760391235,12.274008750915527),new ba(-.9316755533218384,-1.9444547891616821,12.365589141845703),new ba(.0012834301451221108,-.5668943524360657,8.163250923156738),new ba(-1.446112036705017,-1.9612153768539429,9.752340316772461),new ba(-2.0411462783813477,-1.9689966440200806,8.813215255737305),new ba(-2.086888313293457,-1.9752429723739624,7.7023820877075195),new ba(-1.5710833072662354,-1.9782811403274536,6.71748685836792),new ba(-.6319396495819092,-1.9772969484329224,6.122431755065918),new ba(.4788999557495117,-1.9725537300109863,6.076662063598633),new ba(1.4637869596481323,-1.9653233289718628,6.592440605163574),new ba(2.058821439743042,-1.957542061805725,7.5315656661987305),new ba(2.104564666748047,-1.9512957334518433,8.642398834228516),new ba(1.5887597799301147,-1.948257327079773,9.627294540405273),new ba(.6496162414550781,-1.9492419958114624,10.222349166870117),new ba(-.4612230658531189,-1.9539846181869507,10.268120765686035),new ba(-1.4407693147659302,-3.1500906944274902,9.758804321289062),new ba(-2.0358033180236816,-3.1578714847564697,8.819680213928223),new ba(-2.081545829772949,-3.1641180515289307,7.708846092224121),new ba(-1.5657404661178589,-3.167156457901001,6.72395133972168),new ba(-.6265968084335327,-3.1661722660064697,6.128896713256836),new ba(.4842427968978882,-3.1614291667938232,6.083127021789551),new ba(1.4691299200057983,-3.154198169708252,6.59890604019165),new ba(2.064164400100708,-3.1464171409606934,7.538031101226807),new ba(2.109907627105713,-3.1401708126068115,8.648863792419434),new ba(1.5941027402877808,-3.137132167816162,9.633759498596191),new ba(.6549590229988098,-3.1381168365478516,10.228814125061035),new ba(-.4558802545070648,-3.142859697341919,10.274585723876953),new ba(-1.4456579685211182,-2.062270164489746,9.752889633178711),new ba(-2.04069185256958,-2.0700509548187256,8.813764572143555),new ba(-2.0864343643188477,-2.0762977600097656,7.702930927276611),new ba(-1.5706290006637573,-2.0793356895446777,6.718036651611328),new ba(-.6314853429794312,-2.0783514976501465,6.122981548309326),new ba(.47935420274734497,-2.0736083984375,6.077211856842041),new ba(1.4642411470413208,-2.066377639770508,6.592990398406982),new ba(2.0592758655548096,-2.058596611022949,7.532115459442139),new ba(2.1050186157226562,-2.0523500442504883,8.642948150634766),new ba(1.5892138481140137,-2.049312114715576,9.627843856811523),new ba(.6500704288482666,-2.0502963066101074,10.222899436950684),new ba(-.4607689082622528,-2.055039167404175,10.268670082092285),new ba(-.846520721912384,-3.267390727996826,9.114703178405762),new ba(-1.1987367868423462,-3.27199649810791,8.558809280395508),new ba(-1.2258127927780151,-3.275693893432617,7.901278018951416),new ba(-.9204944372177124,-3.277492046356201,7.318294048309326),new ba(-.36459070444107056,-3.276909589767456,6.966064929962158),new ba(.2929442524909973,-3.274102210998535,6.9389729499816895),new ba(.8759246468544006,-3.269821882247925,7.2442755699157715),new ba(1.2281408309936523,-3.265216112136841,7.800168037414551),new ba(1.2552175521850586,-3.261518955230713,8.4576997756958),new ba(.9498993158340454,-3.2597203254699707,9.040684700012207),new ba(.3939957320690155,-3.260303020477295,9.392913818359375),new ba(-.2635391354560852,-3.263110399246216,9.42000675201416),new ba(-.3782625198364258,-4.132713794708252,6.917051792144775),new ba(.9928271174430847,-4.1147847175598145,9.081001281738281),new ba(-1.2765675783157349,-4.13144588470459,7.892534255981445),new ba(-1.2483258247375488,-4.127589225769043,8.578377723693848),new ba(-.2728599011898041,-4.118320941925049,9.476655960083008),new ba(-.9044193029403687,-3.338594436645508,9.17757511138916),new ba(-1.2803142070770264,-3.3435099124908447,8.584310531616211),new ba(-1.3092105388641357,-3.3474557399749756,7.882575035095215),new ba(-.9833661913871765,-3.349375009536743,7.260396957397461),new ba(-.39008989930152893,-3.348752975463867,6.884488582611084),new ba(.31164997816085815,-3.345757007598877,6.855575084686279),new ba(.9338231682777405,-3.341188669204712,7.181403160095215),new ba(1.3097182512283325,-3.336273431777954,7.774667263031006),new ba(1.3386154174804688,-3.3323276042938232,8.47640323638916),new ba(1.0127710103988647,-3.3304080963134766,9.098581314086914),new ba(.41949498653411865,-3.3310301303863525,9.47449016571045),new ba(-.28224486112594604,-3.3340260982513428,9.503403663635254),new ba(-1.3213201761245728,-.5427400469779968,3.929924488067627),new ba(-3.003157377243042,-.509520947933197,11.428194046020508),new ba(-3.261303186416626,-.5447733998298645,5.159121990203857),new ba(-4.232311725616455,-.5255942940711975,9.488250732421875),new ba(-4.326800346374512,-.5384976267814636,7.193610191345215),new ba(3.007803201675415,-.5180059671401978,4.900822639465332),new ba(.9733318090438843,-.5329424738883972,3.835380792617798),new ba(1.325969934463501,-.48478683829307556,12.399092674255371),new ba(4.331447601318359,-.4890293478965759,9.135405540466309),new ba(4.236958026885986,-.501932680606842,6.840766429901123),new ba(-.9686821103096008,-.4945843815803528,12.49363899230957),new ba(3.2659523487091064,-.4827534854412079,11.16989517211914),new ba(-.8809435367584229,-4.122784614562988,9.15820598602295),new ba(-.9581024646759033,-4.133321285247803,7.284446716308594),new ba(.3075847029685974,-4.129785537719727,6.888793468475342),new ba(.9156670570373535,-4.125320911407471,7.207241535186768),new ba(1.28304922580719,-4.120517730712891,7.787070274353027),new ba(1.3112918138504028,-4.1166605949401855,8.47291374206543),new ba(.41298723220825195,-4.115392208099365,9.448396682739258),new ba(-1.20172917842865,-3.323627233505249,8.559990882873535),new ba(-1.2288755178451538,-3.327333927154541,7.900750637054443),new ba(-.9227638840675354,-3.329136848449707,7.316251277923584),new ba(-.3654157221317291,-3.328552722930908,6.963107585906982),new ba(.29382774233818054,-3.325737953186035,6.9359450340271),new ba(.8783228397369385,-3.3214468955993652,7.242040157318115),new ba(1.2314543724060059,-3.3168294429779053,7.799377918243408),new ba(1.2586013078689575,-3.313122272491455,8.458617210388184),new ba(.9524897933006287,-3.311318874359131,9.04311752319336),new ba(.3951417803764343,-3.3119029998779297,9.396262168884277),new ba(-.2641015946865082,-3.3147177696228027,9.42342472076416),new ba(-.8485979437828064,-3.319009304046631,9.117327690124512),new ba(.41298723220825195,-7.012894153594971,9.08381462097168),new ba(1.3112918138504028,-6.324020862579346,8.393146514892578),new ba(1.28304922580719,-5.84178352355957,7.905455112457275),new ba(.9156670570373535,-5.435179233551025,7.492057800292969),new ba(.3075847029685974,-5.213159561157227,7.263724327087402),new ba(-.9581024646759033,-5.495428085327148,7.5409932136535645),new ba(-.8809435367584229,-6.812925815582275,8.873391151428223),new ba(-.2728599011898041,-7.034946918487549,9.101726531982422),new ba(-1.2483258247375488,-6.406322956085205,8.459993362426758),new ba(-1.2765675783157349,-5.924084663391113,7.972301483154297),new ba(.9928271174430847,-6.7526774406433105,8.824455261230469),new ba(-.3782625198364258,-5.235211372375488,7.281635761260986),new ba(-.9195230007171631,-5.464406967163086,-1.7809234857559204),new ba(-1.262446641921997,-5.885434150695801,-1.768570065498352),new ba(-1.262446641921997,-6.370398998260498,-1.7658435106277466),new ba(-.9195230007171631,-6.7893548011779785,-1.7734720706939697),new ba(-.3255612254142761,-7.0300445556640625,-1.7894134521484375),new ba(.3602859675884247,-7.027973175048828,-1.8093950748443604),new ba(.9542470574378967,-6.783698558807373,-1.8280647993087769),new ba(1.2971705198287964,-6.362671375274658,-1.8404178619384766),new ba(1.2971705198287964,-5.877706527709961,-1.843144416809082),new ba(.9542470574378967,-5.458749771118164,-1.8355145454406738),new ba(.3602859675884247,-5.2180609703063965,-1.8195737600326538),new ba(-.3255612254142761,-5.2201313972473145,-1.799590826034546)];var TZ=[new aa(24,0,1,null,255,3),new aa(24,1,2,null,255,3),new aa(24,2,3,null,255,3),new aa(24,3,4,null,255,3),new aa(24,4,5,null,255,3),new aa(24,5,6,null,255,3),new aa(24,6,7,null,255,3),new aa(24,7,8,null,255,3),new aa(24,8,9,null,255,3),new aa(24,9,10,null,255,3),new aa(24,10,11,null,255,3),new aa(11,0,24,null,255,3),new aa(91,12,13),new aa(91,13,93),new aa(93,13,14),new aa(93,14,94),new aa(94,14,15),new aa(94,15,92),new aa(92,15,16),new aa(92,16,90),new aa(90,16,17),new aa(90,17,96),new aa(96,17,18),new aa(96,18,95),new aa(95,18,19),new aa(95,19,99),new aa(99,19,20),new aa(99,20,98),new aa(98,20,21),new aa(98,21,101),new aa(101,21,22),new aa(101,22,97),new aa(97,22,23),new aa(97,23,100),new aa(91,0,11),new aa(91,11,100),new aa(13,12,25),new aa(13,25,26),new aa(14,13,26),new aa(14,26,27),new aa(15,14,27),new aa(15,27,28),new aa(16,15,28),new aa(16,28,29),new aa(17,16,29),new aa(17,29,30),new aa(18,17,30),new aa(18,30,31),new aa(19,18,31),new aa(19,31,32),new aa(20,19,32),new aa(20,32,33),new aa(21,20,33),new aa(21,33,34),new aa(22,21,34),new aa(22,34,35),new aa(23,22,35),new aa(23,35,36),new aa(12,23,36),new aa(12,36,25),new aa(25,49,50),new aa(25,50,26),new aa(49,37,38),new aa(49,38,50),new aa(26,50,51),new aa(26,51,27),new aa(50,38,39),new aa(50,39,51),new aa(27,51,52),new aa(27,52,28),new aa(51,39,40),new aa(51,40,52),new aa(28,52,53),new aa(28,53,29),new aa(52,40,41),new aa(52,41,53),new aa(29,53,54),new aa(29,54,30),new aa(53,41,42),new aa(53,42,54),new aa(30,54,55),new aa(30,55,31),new aa(54,42,43),new aa(54,43,55),new aa(31,55,56),new aa(31,56,32),new aa(55,43,44),new aa(55,44,56),new aa(32,56,57),new aa(32,57,33),new aa(56,44,45),new aa(56,45,57),new aa(33,57,58),new aa(33,58,34),new aa(57,45,46),new aa(57,46,58),new aa(34,58,59),new aa(34,59,35),new aa(58,46,47),new aa(58,47,59),new aa(35,59,60),new aa(35,60,36),new aa(59,47,48),new aa(59,48,60),new aa(36,60,49),new aa(36,49,25),new aa(60,48,37),new aa(60,37,49),new aa(38,37,61),new aa(38,61,62),new aa(39,38,62),new aa(39,62,63),new aa(40,39,63),new aa(40,63,64),new aa(41,40,64),new aa(41,64,65),new aa(42,41,65),new aa(42,65,66),new aa(43,42,66),new aa(43,66,67),new aa(44,43,67),new aa(44,67,68),new aa(45,44,68),new aa(45,68,69),new aa(46,45,69),new aa(46,69,70),new aa(47,46,70),new aa(47,70,71),new aa(48,47,71),new aa(48,71,72),new aa(37,48,72),new aa(37,72,61),new aa(120,109,62),new aa(120,62,61),new aa(109,110,63),new aa(109,63,62),new aa(110,111,64),new aa(110,64,63),new aa(111,112,65),new aa(111,65,64),new aa(112,113,66),new aa(112,66,65),new aa(113,114,67),new aa(113,67,66),new aa(114,115,68),new aa(114,68,67),new aa(115,116,69),new aa(115,69,68),new aa(116,117,70),new aa(116,70,69),new aa(117,118,71),new aa(117,71,70),new aa(118,119,72),new aa(118,72,71),new aa(119,120,61),new aa(119,61,72),new aa(72,89,78),new aa(72,78,61),new aa(63,80,81),new aa(63,81,64),new aa(67,84,85),new aa(67,85,68),new aa(64,81,82),new aa(64,82,65),new aa(61,78,79),new aa(61,79,62),new aa(69,86,87),new aa(69,87,70),new aa(66,83,84),new aa(66,84,67),new aa(65,82,83),new aa(65,83,66),new aa(71,88,89),new aa(71,89,72),new aa(70,87,88),new aa(70,88,71),new aa(62,79,80),new aa(62,80,63),new aa(68,85,86),new aa(68,86,69),new aa(0,91,93),new aa(0,93,1),new aa(1,93,94),new aa(1,94,2),new aa(2,94,92),new aa(2,92,3),new aa(3,92,90),new aa(3,90,4),new aa(4,90,96),new aa(4,96,5),new aa(5,96,95),new aa(5,95,6),new aa(6,95,99),new aa(6,99,7),new aa(7,99,98),new aa(7,98,8),new aa(8,98,101),new aa(8,101,9),new aa(9,101,97),new aa(9,97,10),new aa(10,97,100),new aa(10,100,11),new aa(12,91,100),new aa(12,100,23),new aa(104,105,114),new aa(104,114,113),new aa(105,106,115),new aa(105,115,114),new aa(106,107,116),new aa(106,116,115),new aa(102,76,109),new aa(102,109,120),new aa(76,75,110),new aa(76,110,109),new aa(75,103,111),new aa(75,111,110),new aa(103,73,112),new aa(103,112,111),new aa(73,104,113),new aa(73,113,112),new aa(107,74,117),new aa(107,117,116),new aa(74,108,118),new aa(74,118,117),new aa(108,77,119),new aa(108,119,118),new aa(77,102,120),new aa(77,120,119),new aa(74,107,122),new aa(74,122,131),new aa(107,106,123),new aa(107,123,122),new aa(104,73,132),new aa(104,132,125),new aa(106,105,124),new aa(106,124,123),new aa(75,76,129),new aa(75,129,130),new aa(73,103,126),new aa(73,126,132),new aa(105,104,125),new aa(105,125,124),new aa(102,77,128),new aa(102,128,127),new aa(103,75,130),new aa(103,130,126),new aa(77,108,121),new aa(77,121,128),new aa(76,102,127),new aa(76,127,129),new aa(108,74,131),new aa(108,131,121),new aa(126,130,134),new aa(126,134,133),new aa(130,129,135),new aa(130,135,134),new aa(129,127,136),new aa(129,136,135),new aa(127,128,137),new aa(127,137,136),new aa(128,121,138),new aa(128,138,137),new aa(121,131,139),new aa(121,139,138),new aa(131,122,140),new aa(131,140,139),new aa(122,123,141),new aa(122,141,140),new aa(123,124,142),new aa(123,142,141),new aa(124,125,143),new aa(124,143,142),new aa(125,132,144),new aa(125,144,143),new aa(132,126,133),new aa(132,133,144),new aa(169,146,145,null,255,3),new aa(169,147,146,null,255,3),new aa(169,148,147,null,255,3),new aa(169,149,148,null,255,3),new aa(169,150,149,null,255,3),new aa(169,151,150,null,255,3),new aa(169,152,151,null,255,3),new aa(169,153,152,null,255,3),new aa(169,154,153,null,255,3),new aa(169,155,154,null,255,3),new aa(169,156,155,null,255,3),new aa(156,169,145,null,255,3),new aa(236,238,158),new aa(236,158,157),new aa(238,239,159),new aa(238,159,158),new aa(239,237,160),new aa(239,160,159),new aa(237,235,161),new aa(237,161,160),new aa(235,241,162),new aa(235,162,161),new aa(241,240,163),new aa(241,163,162),new aa(240,244,164),new aa(240,164,163),new aa(244,243,165),new aa(244,165,164),new aa(243,246,166),new aa(243,166,165),new aa(246,242,167),new aa(246,167,166),new aa(242,245,168),new aa(242,168,167),new aa(236,245,156),new aa(236,156,145),new aa(158,171,170),new aa(158,170,157),new aa(159,172,171),new aa(159,171,158),new aa(160,173,172),new aa(160,172,159),new aa(161,174,173),new aa(161,173,160),new aa(162,175,174),new aa(162,174,161),new aa(163,176,175),new aa(163,175,162),new aa(164,177,176),new aa(164,176,163),new aa(165,178,177),new aa(165,177,164),new aa(166,179,178),new aa(166,178,165),new aa(167,180,179),new aa(167,179,166),new aa(168,181,180),new aa(168,180,167),new aa(157,170,181),new aa(157,181,168),new aa(170,171,195),new aa(170,195,194),new aa(194,195,183),new aa(194,183,182),new aa(171,172,196),new aa(171,196,195),new aa(195,196,184),new aa(195,184,183),new aa(172,173,197),new aa(172,197,196),new aa(196,197,185),new aa(196,185,184),new aa(173,174,198),new aa(173,198,197),new aa(197,198,186),new aa(197,186,185),new aa(174,175,199),new aa(174,199,198),new aa(198,199,187),new aa(198,187,186),new aa(175,176,200),new aa(175,200,199),new aa(199,200,188),new aa(199,188,187),new aa(176,177,201),new aa(176,201,200),new aa(200,201,189),new aa(200,189,188),new aa(177,178,202),new aa(177,202,201),new aa(201,202,190),new aa(201,190,189),new aa(178,179,203),new aa(178,203,202),new aa(202,203,191),new aa(202,191,190),new aa(179,180,204),new aa(179,204,203),new aa(203,204,192),new aa(203,192,191),new aa(180,181,205),new aa(180,205,204),new aa(204,205,193),new aa(204,193,192),new aa(181,170,194),new aa(181,194,205),new aa(205,194,182),new aa(205,182,193),new aa(183,207,206),new aa(183,206,182),new aa(184,208,207),new aa(184,207,183),new aa(185,209,208),new aa(185,208,184),new aa(186,210,209),new aa(186,209,185),new aa(187,211,210),new aa(187,210,186),new aa(188,212,211),new aa(188,211,187),new aa(189,213,212),new aa(189,212,188),new aa(190,214,213),new aa(190,213,189),new aa(191,215,214),new aa(191,214,190),new aa(192,216,215),new aa(192,215,191),new aa(193,217,216),new aa(193,216,192),new aa(182,206,217),new aa(182,217,193),new aa(265,206,207),new aa(265,207,254),new aa(254,207,208),new aa(254,208,255),new aa(255,208,209),new aa(255,209,256),new aa(256,209,210),new aa(256,210,257),new aa(257,210,211),new aa(257,211,258),new aa(258,211,212),new aa(258,212,259),new aa(259,212,213),new aa(259,213,260),new aa(260,213,214),new aa(260,214,261),new aa(261,214,215),new aa(261,215,262),new aa(262,215,216),new aa(262,216,263),new aa(263,216,217),new aa(263,217,264),new aa(264,217,206),new aa(264,206,265),new aa(217,206,223),new aa(217,223,234),new aa(208,209,226),new aa(208,226,225),new aa(212,213,230),new aa(212,230,229),new aa(209,210,227),new aa(209,227,226),new aa(206,207,224),new aa(206,224,223),new aa(214,215,232),new aa(214,232,231),new aa(211,212,229),new aa(211,229,228),new aa(210,211,228),new aa(210,228,227),new aa(216,217,234),new aa(216,234,233),new aa(215,216,233),new aa(215,233,232),new aa(207,208,225),new aa(207,225,224),new aa(213,214,231),new aa(213,231,230),new aa(145,146,238),new aa(145,238,236),new aa(146,147,239),new aa(146,239,238),new aa(147,148,237),new aa(147,237,239),new aa(148,149,235),new aa(148,235,237),new aa(149,150,241),new aa(149,241,235),new aa(150,151,240),new aa(150,240,241),new aa(151,152,244),new aa(151,244,240),new aa(152,153,243),new aa(152,243,244),new aa(153,154,246),new aa(153,246,243),new aa(154,155,242),new aa(154,242,246),new aa(155,156,245),new aa(155,245,242),new aa(157,168,245),new aa(157,245,236),new aa(249,258,259),new aa(249,259,250),new aa(250,259,260),new aa(250,260,251),new aa(251,260,261),new aa(251,261,252),new aa(247,265,254),new aa(247,254,221),new aa(221,254,255),new aa(221,255,220),new aa(220,255,256),new aa(220,256,248),new aa(248,256,257),new aa(248,257,218),new aa(218,257,258),new aa(218,258,249),new aa(252,261,262),new aa(252,262,219),new aa(219,262,263),new aa(219,263,253),new aa(253,263,264),new aa(253,264,222),new aa(222,264,265),new aa(222,265,247),new aa(219,276,267),new aa(219,267,252),new aa(252,267,268),new aa(252,268,251),new aa(249,270,277),new aa(249,277,218),new aa(251,268,269),new aa(251,269,250),new aa(220,275,274),new aa(220,274,221),new aa(218,277,271),new aa(218,271,248),new aa(250,269,270),new aa(250,270,249),new aa(247,272,273),new aa(247,273,222),new aa(248,271,275),new aa(248,275,220),new aa(222,273,266),new aa(222,266,253),new aa(221,274,272),new aa(221,272,247),new aa(253,266,276),new aa(253,276,219),new aa(271,278,279),new aa(271,279,275),new aa(275,279,280),new aa(275,280,274),new aa(274,280,281),new aa(274,281,272),new aa(272,281,282),new aa(272,282,273),new aa(273,282,283),new aa(273,283,266),new aa(266,283,284),new aa(266,284,276),new aa(276,284,285),new aa(276,285,267),new aa(267,285,286),new aa(267,286,268),new aa(268,286,287),new aa(268,287,269),new aa(269,287,288),new aa(269,288,270),new aa(270,288,289),new aa(270,289,277),new aa(277,289,278),new aa(277,278,271)];var IC=function(){function e(){KZ(this,e)}return LZ(e,null,[{key:"generate_handle",value:function(a,r,t,o,n,i,$,m,l){var c=null;switch(a){case"HANDLE_01":c=e.handle_model_01(l);break;case"HANDLE_02":c=e.handle_model_02(l);break;case"HANDLE_03":c=e.handle_model_03(l);break;case"HANDLE_04":c=e.handle_model_04(l);}if(c){var p=n-2*i-.5,u=.5*$-.75;"Front"===r?(c.applyMatrix4(new fa().makeRotationAxis(new ba(1,0,0),.5*-Math.PI)),c.applyMatrix4(new fa().makeTranslation(0,0,u))):(c.applyMatrix4(new fa().makeRotationAxis(new ba(1,0,0),.5*Math.PI)),c.applyMatrix4(new fa().makeTranslation(0,0,-u))),"Right"===t&&"BOTH_SIDES"!==m?(c.applyMatrix4(new fa().makeRotationAxis(new ba(0,0,1),Math.PI)),c.applyMatrix4(new fa().makeTranslation(-10,0,0))):"Left"===t&&"BOTH_SIDES"!==m?c.applyMatrix4(new fa().makeTranslation(10,0,0)):"Right"!==t&&"BOTH_SIDES"===m&&c.applyMatrix4(new fa().makeRotationAxis(new ba(0,0,1),-Math.PI)),"BOTH_SIDES"===m&&"Left"===t&&c.applyMatrix4(new fa().makeTranslation(p*o-10,0,0)),"BOTH_SIDES"===m&&"Right"===t&&c.applyMatrix4(new fa().makeTranslation(-p*o+10,0,0))}return c}},{key:"handle_model_01",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,a=new oa,r=[],t=[];return MZ.forEach(function(e){r.push(e.clone())}),NZ.forEach(function(a){var r=a.clone();r.materialIndex=e,t.push(r)}),a.vertices=r,a.faces=t,a.computeVertexNormals(),a.computeFaceNormals(),a.computeBoundingBox(),a}},{key:"handle_model_02",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,a=new oa,r=[],t=[];return OZ.forEach(function(e){r.push(e.clone())}),PZ.forEach(function(a){var r=a.clone();r.materialIndex=e,t.push(r)}),a.vertices=r,a.faces=t,a.elementsNeedUpdate=!0,a.computeVertexNormals(),a.computeFaceNormals(),a.computeBoundingBox(),a}},{key:"handle_model_03",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,a=new oa,r=[],t=[];return QZ.forEach(function(e){r.push(e.clone())}),RZ.forEach(function(a){var r=a.clone();r.materialIndex=e,t.push(r)}),a.vertices=r,a.faces=t,a.computeVertexNormals(),a.computeFaceNormals(),a.computeBoundingBox(),a}},{key:"handle_model_04",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,a=new oa,r=[],t=[];return SZ.forEach(function(e){r.push(e.clone())}),TZ.forEach(function(a){var r=a.clone();r.materialIndex=e,t.push(r)}),a.vertices=r,a.faces=t,a.computeVertexNormals(),a.computeFaceNormals(),a.computeBoundingBox(),a}}]),e}();var Fa=Pn.d("RIGHT","LEFT","BOTH_SIDES","NO_DOORS");var _a=Pn.d("None","HANDLE_01","HANDLE_02","HANDLE_03","HANDLE_04");var yj=function(e){EZ(r,Qa);var t=GZ(r);function r(e){var o;CZ(this,r),o=t.call(this);var i={frameSize:5,frameColor:"#FF0000",doorColor:"#E0E0EE",frameWidth:100,frameHeight:200,frameThickness:20,doorRatio:.5,openDirection:Fa.RIGHT.description,handleType:_a.HANDLE_01.description,doorHandleColor:"#F0F0F0",glassColor:"#87CEEB"};for(var a in i)"frameColor"===a||"doorColor"===a||"doorHandleColor"===a||"glassColor"===a?i[a]=new ga(e[a]):i.hasOwnProperty(a)&&e.hasOwnProperty(a)&&(i[a]=e[a]);switch(i=o.__validateParameters(i),o.__doorType=1,o.__name="Door",o.__frameSize=i.frameSize,o.__frameWidth=i.frameWidth,o.__frameHeight=i.frameHeight,o.__frameThickness=i.frameThickness,o.__doorRatio=i.doorRatio,o.__openDirection=null,o.__handleType=null,i.openDirection){case Fa.RIGHT.description:o.__openDirection=Fa.RIGHT;break;case Fa.LEFT.description:o.__openDirection=Fa.LEFT;break;case Fa.BOTH_SIDES.description:o.__openDirection=Fa.BOTH_SIDES;break;case Fa.NO_DOORS.description:o.__openDirection=Fa.NO_DOORS;}switch(i.handleType){case _a.None.description:o.__handleType=_a.None;break;case _a.HANDLE_01.description:o.__handleType=_a.HANDLE_01;break;case _a.HANDLE_02.description:o.__handleType=_a.HANDLE_02;break;case _a.HANDLE_03.description:o.__handleType=_a.HANDLE_03;break;case _a.HANDLE_04.description:o.__handleType=_a.HANDLE_04;}return o.__frameMaterial=new Hb({color:i.frameColor,side:Pb}),o.__doorMaterial=new Hb({color:i.doorColor,side:Pb,wireframe:!1}),o.__handleMaterial=new Hb({color:"#F0F0FF",side:Pb,wireframe:!1}),o.__rightDoorMaterial=o.__doorMaterial,o.__leftDoorMaterial=o.__doorMaterial,o.__doorHandleMaterial=new Hb({color:i.doorHandleColor,wireframe:!1,roughness:0,metalness:0}),o.__glassMaterial=new Hb({color:i.glassColor,side:Pb,wireframe:!1,transparent:!0,opacity:.6}),o.__doorFrameMaterialId=0,o.__doorMaterialId=1,o.__leftDoorMaterialId=2,o.__rightDoorMaterialId=3,o.__doorHandleMaterialId=4,o.__glassMaterialId=5,o.__material=[o.__frameMaterial,o.__doorMaterial,o.__leftDoorMaterial,o.__rightDoorMaterial,o.__doorHandleMaterial,o.__glassMaterial],o.__doorMaterial.normalScale.set(100,100,100),o.__geometry=o.__proceedure(),o}return DZ(r,[{key:"__convertFrom4ToFace3",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],o=0;o<e.length;o+=4){var i=new aa(e[o],e[o+1],e[o+2]),a=new aa(e[o],e[o+2],e[o+3]);i.materialIndex=t,a.materialIndex=t,r.push(i),r.push(a)}return r}},{key:"__validateParameters",value:function(e){switch(e.frameSize=Math.max(5,Math.min(25,e.frameSize)),e.doorRatio=Math.max(0,Math.min(1,e.doorRatio)),e.openDirection){case Fa.RIGHT.description:case Fa.LEFT.description:case Fa.BOTH_SIDES.description:case Fa.NO_DOORS.description:break;default:throw new Error("Unindentifiable door type");}return e}},{key:"__updateGeometry",value:function(){var e=this.__proceedure();this.__geometry.dispose(),this.__geometry=e,this.dispatchEvent({type:tp,target:this})}},{key:"__proceedure",value:function(){var e=null,t=new oa,r=this.__shapeMesh(),o=this.__shapeChildren();return r&&t.merge(r),o.right&&t.merge(o.right),o.left&&t.merge(o.left),t.computeVertexNormals(),t.computeFaceNormals(),t.computeBoundingBox(),(e=new ia().fromGeometry(t)).normalizeNormals(),e}},{key:"__shapeMesh",value:function(){return this.__createDoorFrame()}},{key:"__createDoorFrame",value:function(){var e=this.__frameThickness/3,t=this.__frameSize,r=.5*this.__frameWidth-t,o=this.__frameHeight-t,i=.5*this.__frameThickness,a=[new ba(-r-t,-e,0),new ba(-r-t,2*e,0),new ba(-r,2*e,0),new ba(-r-t,-e,o+t),new ba(-r-t,2*e,o+t),new ba(r+t,2*e,o+t),new ba(r+t,-e,o+t),new ba(r,-e,o),new ba(-r,2*e,o),new ba(r,-e,0),new ba(r+t,-e,0),new ba(r+t,2*e,0),new ba(r,-e+i,o),new ba(-r,-e+i,o),new ba(-r,-e+i,0),new ba(.02-r,-e+i,o),new ba(.02-r,-e+i,0),new ba(.02-r,2*e,o),new ba(.02-r,2*e,0),new ba(r,-e+i,0),new ba(-r,-e,o),new ba(-r,-e,0),new ba(r,2*e,o),new ba(r,2*e,0),new ba(r-.02,2*e,0),new ba(r-.02,-e+i,0),new ba(r-.02,2*e,o),new ba(r-.02,-e+i,o-.02),new ba(r-.02,-e+i,o),new ba(.02-r,2*e,o-.02),new ba(.02-r,-e+i,o-.02),new ba(r-.02,2*e,o-.02)],n=new oa,_=this.__convertFrom4ToFace3([3,4,1,0,7,12,19,9,4,3,6,5,10,11,5,6,13,20,21,14,17,15,16,18,11,23,22,5,20,13,12,7,20,3,0,21,9,10,6,7,13,14,16,15,4,8,2,1,29,30,27,31,7,6,3,20,8,4,5,22,14,2,18,16,17,18,2,8,28,25,19,12,28,26,24,25,25,24,23,19,22,23,24,26,29,31,26,17,15,28,27,30],0),$=new aa(8,22,26);return $.materialIndex=0,_.push($),n.vertices=a,n.faces=_,n.elementsNeedUpdate=!0,n.applyMatrix4(new fa().makeRotationAxis(new ba(1,0,0),.5*-Math.PI)),n.applyMatrix4(new fa().makeTranslation(0,.5*-this.__frameHeight,0)),n.computeVertexNormals(),n.computeFaceNormals(),n.computeBoundingBox(),n}},{key:"__shapeChildren",value:function(){var e=null,t=null,r=this.__frameWidth,o=r*this.__doorRatio,i=r-o;switch(this.__openDirection){case Fa.NO_DOORS:break;case Fa.LEFT:(t=this.__makeOneDoor(r,this.__openDirection,this.__leftDoorMaterialId,"Left")).applyMatrix4(new fa().makeTranslation(-.5*this.__frameWidth+this.__frameSize,0,0));break;case Fa.RIGHT:(e=this.__makeOneDoor(r,this.__openDirection,this.__rightDoorMaterialId,"Right")).applyMatrix4(new fa().makeTranslation(.5*this.__frameWidth-this.__frameSize,0,0));break;case Fa.BOTH_SIDES:(t=this.__makeOneDoor(o+this.__frameSize,Fa.LEFT,this.__leftDoorMaterialId,"Left")).applyMatrix4(new fa().makeTranslation(-.5*this.__frameWidth+this.__frameSize,0,0)),(e=this.__makeOneDoor(i+this.__frameSize,Fa.RIGHT,this.__rightDoorMaterialId,"Right")).applyMatrix4(new fa().makeTranslation(.5*this.__frameWidth-this.__frameSize,0,0));break;default:throw new Error("Unindentifiable door type ".concat(this.__openDirection));}return{right:e,left:t}}},{key:"__makeOneDoor",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Right",i=this.__createDoorData(e,t,r);if(this.__handleType!==_a.None){var a="Right"===o?1-this.doorRatio:this.doorRatio,n=IC.generate_handle(this.__handleType.description,"Front",o,a,this.frameWidth,this.frameSize,this.frameThickness,this.__openDirection.description,this.__doorHandleMaterialId),_=IC.generate_handle(this.__handleType.description,"Back",o,a,this.frameWidth,this.frameSize,this.frameThickness,this.__openDirection.description,this.__doorHandleMaterialId);i.merge(n),i.merge(_)}return i}},{key:"__createDoorData",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=this.__createForDoorModel(e,t,r),i=new oa,a=new fa;o.widthFactor,o.side,this.__frameHeight,o.depth;return i.vertices=o.vertices,i.faces=o.faces,i.elementsNeedUpdate=!0,a.makeRotationAxis(new ba(1,0,0),.5*-Math.PI),i.applyMatrix4(a),i.elementsNeedUpdate=!0,i.computeVertexNormals(),i.computeFaceNormals(),i.computeBoundingBox(),i}},{key:"__createForDoorModel",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=this.__frameSize,i=e-2*o-.5,a=this.__frameHeight/2-.5,n=.5*this.__frameThickness-.75,_=0,$=0,h=0;t===Fa.RIGHT?(_=1,$=-1*i,h=0):(_=-1,$=0,h=i);var s=n,f=-a,p=a-o;return{vertices:[new ba($,0,f),new ba($,s,f),new ba(h,s,f),new ba(h,0,f),new ba($,0,p),new ba($,s,p),new ba(h,s,p),new ba(h,0,p)],faces:this.__convertFrom4ToFace3([4,5,1,0,5,6,2,1,6,7,3,2,7,4,0,3,0,1,2,3,7,6,5,4],r),widthFactor:i,depth:n,side:_}}},{key:"frameWidth",get:function(){return this.__frameWidth},set:function(e){this.__frameWidth=e,this.__updateGeometry()}},{key:"frameHeight",get:function(){return this.__frameHeight},set:function(e){this.__frameHeight=e,this.__updateGeometry()}},{key:"frameThickness",get:function(){return this.__frameThickness},set:function(e){this.__frameThickness=e,this.__updateGeometry()}},{key:"frameSize",get:function(){return this.__frameSize},set:function(e){this.__frameSize=Math.max(5,Math.min(25,e)),this.__updateGeometry()}},{key:"doorRatio",get:function(){return this.__doorRatio},set:function(e){this.__doorRatio=Math.max(0,Math.min(1,e)),this.__updateGeometry()}},{key:"doorHandleColor",get:function(){return"#".concat(this.__doorHandleMaterial.color.getHexString())},set:function(e){this.__doorHandleMaterial.color=new ga(e),this.__doorHandleMaterial.needsUpdate=!0,this.__material.needsUpdate=!0}},{key:"doorGlassColor",get:function(){return"#".concat(this.__glassMaterial.color.getHexString())},set:function(e){this.__glassMaterial.color=new ga(e),this.__glassMaterial.needsUpdate=!0,this.__material.needsUpdate=!0}},{key:"doorColor",get:function(){return"#".concat(this.__doorMaterial.color.getHexString())},set:function(e){this.__doorMaterial.color=new ga(e),this.__doorMaterial.needsUpdate=!0,this.__material.needsUpdate=!0}},{key:"frameColor",get:function(){return"#".concat(this.__frameMaterial.color.getHexString())},set:function(e){this.__frameMaterial.color=new ga(e),this.__frameMaterial.needsUpdate=!0,this.__material.needsUpdate=!0}},{key:"openDirection",get:function(){return this.__openDirection.description},set:function(e){switch(e){case Fa.RIGHT.description:this.__openDirection=Fa.RIGHT;break;case Fa.LEFT.description:this.__openDirection=Fa.LEFT;break;case Fa.BOTH_SIDES.description:this.__openDirection=Fa.BOTH_SIDES;break;case Fa.NO_DOORS.description:this.__openDirection=Fa.NO_DOORS;}this.__updateGeometry()}},{key:"handleType",get:function(){return this.__handleType.description},set:function(e){switch(e){case _a.None.description:this.__handleType=_a.None;break;case _a.HANDLE_01.description:this.__handleType=_a.HANDLE_01;break;case _a.HANDLE_02.description:this.__handleType=_a.HANDLE_02;break;case _a.HANDLE_03.description:this.__handleType=_a.HANDLE_03;break;case _a.HANDLE_04.description:this.__handleType=_a.HANDLE_04;}this.__updateGeometry()}},{key:"doorType",get:function(){return this.__doorType}},{key:"geometry",get:function(){return this.__geometry}},{key:"material",get:function(){return this.__material}},{key:"metadata",get:function(){return{type:this.__doorType,frameColor:this.__frameMaterial.color,doorColor:this.__doorMaterial.color,doorHandleColor:this.__doorHandleMaterial.color,glassColor:this.__glassMaterial.color,frameWidth:this.frameWidth,frameHeight:this.frameHeight,frameSize:this.frameSize,frameThickness:this.frameThickness,doorRatio:this.doorRatio,openDirection:this.__openDirection.description,handleType:this.__handleType.description}}},{key:"parameters",get:function(){return{frameColor:{type:"color"},doorColor:{type:"color"},doorHandleColor:{type:"color"},doorGlassColor:{type:"color"},frameWidth:{type:"number"},frameHeight:{type:"number"},frameSize:{type:"range",min:5,max:25,step:.1},frameThickness:{type:"number"},doorRatio:{type:"range",min:.2,max:.8,step:.001},openDirection:{type:"choice",value:[Fa.RIGHT.description,Fa.LEFT.description,Fa.BOTH_SIDES.description,Fa.NO_DOORS.description]},handleType:{type:"choice",value:[_a.None.description,_a.HANDLE_01.description,_a.HANDLE_02.description,_a.HANDLE_03.description,_a.HANDLE_04.description]}}}},{key:"name",get:function(){return this.__name},set:function(e){this.__name=e}}]),r}();function UZ($){return(UZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function($){return typeof $}:function($){return $&&"function"==typeof Symbol&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $})($)}function VZ($,e){if(!($ instanceof e))throw new TypeError("Cannot call a class as a function")}function JC($,e){for(var c=0;c<e.length;c++){var t=e[c];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty($,t.key,t)}}function WZ($,e,c){return e&&JC($.prototype,e),c&&JC($,c),$}function XZ($,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");$.prototype=Object.create(e&&e.prototype,{constructor:{value:$,writable:!0,configurable:!0}}),e&&YZ($,e)}function YZ($,e){return(YZ=Object.setPrototypeOf||function($,e){return $.__proto__=e,$})($,e)}function ZZ($){var e=a$();return function(){var c,t=KC($);if(e){var r=KC(this).constructor;c=Reflect.construct(t,arguments,r)}else c=t.apply(this,arguments);return $Z(this,c)}}function $Z($,e){return!e||"object"!==UZ(e)&&"function"!=typeof e?_Z($):e}function _Z($){if(void 0===$)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $}function a$(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch($){return!1}}function KC($){return(KC=Object.setPrototypeOf?Object.getPrototypeOf:function($){return $.__proto__||Object.getPrototypeOf($)})($)}var b$=function($){XZ(c,yj);var e=ZZ(c);function c($){var t;return VZ(this,c),(t=e.call(this,$)).__doorType=2,t}return WZ(c,[{key:"__createForDoorModel",value:function($,e){var c=this.__frameSize,t=$-2*c-.5,r=this.__frameHeight/2-.5,o=.5*this.__frameThickness,n=0,i=0,p=0;e===Fa.RIGHT?(n=1,i=-1*t,p=0):(n=-1,i=0,p=t);var G=o,J=-r,m=r-c-.25,a=[new ba(i,-157160684466362e-20,J+.0002384185791015625),new ba(p,-15599653124809265e-22,J),new ba(i,-15599653124809265e-22,m),new ba(i,-15599653124809265e-22,m-12.999999523162842),new ba(i,-157160684466362e-20,J+25.00007152557373),new ba(p,-15599653124809265e-22,J+25.000011920928955),new ba(p,-15599653124809265e-22,m),new ba(p,-15599653124809265e-22,m-12.999999523162842),new ba(p-11.609852313995361,-15599653124809265e-22,m),new ba(p-12.357193231582642,-15599653124809265e-22,J),new ba(p-11.658430099487305,-15599653124809265e-22,m-12.999999523162842),new ba(p-12.263774871826172,-15599653124809265e-22,J+25.000011920928955),new ba(i,-157160684466362e-20,J+87.00000941753387),new ba(p,-15599653124809265e-22,J+87.00000941753387),new ba(p-12.076938152313232,-15599653124809265e-22,J+75.00001192092896),new ba(i+11.735659837722778,-157160684466362e-20,J+25.000011920928955),new ba(i+12.341010570526123,-15599653124809265e-22,m-12.999999523162842),new ba(i+11.642247438430786,-157160684466362e-20,J),new ba(i+11.967337131500244,-157160684466362e-20,J+87.00000941753387),new ba(i,-157160684466362e-20,J+75.00001192092896),new ba(p-12.032097578048706,-15599653124809265e-22,J+87.00000941753387),new ba(i+12.389582395553589,-15599653124809265e-22,m),new ba(p,-15599653124809265e-22,J+75.00001192092896),new ba(i+11.922496557235718,-157160684466362e-20,J+75.00001192092896),new ba(i+11.922496557235718,-1.0000014677643776,J+75.00001192092896),new ba(i+12.341010570526123,-1.0000014677643776,m-12.999999523162842),new ba(p-12.032097578048706,-1.0000014677643776,J+87.00000941753387),new ba(i+11.735659837722778,-1.0000014677643776,J+25.000011920928955),new ba(p-11.658430099487305,-1.0000014677643776,m-12.999999523162842),new ba(p-12.263774871826172,-1.0000014677643776,J+25.000011920928955),new ba(i+11.967337131500244,-1.0000014677643776,J+87.00000941753387),new ba(p-12.076938152313232,-1.0000014677643776,J+75.00001192092896),new ba(i+13.388586044311523,-1.0000014677643776,J+73.75001013278961),new ba(i+13.21108341217041,-1.0000014677643776,J+26.25001072883606),new ba(p-13.729861378669739,-1.0000014677643776,J+26.25001072883606),new ba(p-13.552364706993103,-1.0000014677643776,J+73.75001013278961),new ba(i+13.802427053451538,-1.0000014677643776,m-14.747536182403564),new ba(p-13.493508100509644,-1.0000014677643776,J+88.66067305207253),new ba(p-13.138526678085327,-1.0000014677643776,m-14.747536182403564),new ba(i+13.447439670562744,-1.0000014677643776,J+88.66067305207253),new ba(i+13.388586044311523,-.8776669390499592,J+73.75001013278961),new ba(i+13.21108341217041,-.8776669390499592,J+26.25001072883606),new ba(p-13.729861378669739,-.8776669390499592,J+26.25001072883606),new ba(p-13.552364706993103,-.8776669390499592,J+73.75001013278961),new ba(i+13.802427053451538,-.8776669390499592,m-14.747536182403564),new ba(p-13.493508100509644,-.8776669390499592,J+88.66067305207253),new ba(p-13.138526678085327,-.8776669390499592,m-14.747536182403564),new ba(i+13.447439670562744,-.8776669390499592,J+88.66067305207253),new ba(i,G-.9999999776482582,J+.0002384185791015625),new ba(p,G-.9999999776482582,J),new ba(i,G-.9999999776482582,m),new ba(i,G-.9999999776482582,m-12.999999523162842),new ba(i,G-.9999999776482582,J+25.00007152557373),new ba(p,G-.9999999776482582,J+25.000011920928955),new ba(p,G-.9999999776482582,m),new ba(p,G-.9999999776482582,m-12.999999523162842),new ba(p-11.609852313995361,G-.9999999776482582,m),new ba(p-12.357193231582642,G-.9999999776482582,J),new ba(p-11.658430099487305,G-.9999999776482582,m-12.999999523162842),new ba(p-12.263774871826172,G-.9999999776482582,J+25.000011920928955),new ba(i,G-.9999999776482582,J+87.00000941753387),new ba(p,G-.9999999776482582,J+87.00000941753387),new ba(p-12.076938152313232,G-.9999999776482582,J+75.00001192092896),new ba(i+11.735659837722778,G-.9999999776482582,J+25.000011920928955),new ba(i+12.341010570526123,G-.9999999776482582,m-12.999999523162842),new ba(i+11.642247438430786,G-.9999999776482582,J),new ba(i+11.967337131500244,G-.9999999776482582,J+87.00000941753387),new ba(i,G-.9999999776482582,J+75.00001192092896),new ba(p-12.032097578048706,G-.9999999776482582,J+87.00000941753387),new ba(i+12.389582395553589,G-.9999999776482582,m),new ba(p,G-.9999999776482582,J+75.00001192092896),new ba(i+11.922496557235718,G-.9999999776482582,J+75.00001192092896),new ba(i+11.922496557235718,G,J+75.00001192092896),new ba(i+12.341010570526123,G,m-12.999999523162842),new ba(p-12.032097578048706,G,J+87.00000941753387),new ba(i+11.735659837722778,G,J+25.000011920928955),new ba(p-11.658430099487305,G,m-12.999999523162842),new ba(p-12.263774871826172,G,J+25.000011920928955),new ba(i+11.967337131500244,G,J+87.00000941753387),new ba(p-12.076938152313232,G,J+75.00001192092896),new ba(i+13.388586044311523,G,J+73.75001013278961),new ba(i+13.21108341217041,G,J+26.25001072883606),new ba(p-13.729861378669739,G,J+26.25001072883606),new ba(p-13.552364706993103,G,J+73.75001013278961),new ba(i+13.802427053451538,G,m-14.747536182403564),new ba(p-13.493508100509644,G,J+88.66067305207253),new ba(p-13.138526678085327,G,m-14.747536182403564),new ba(i+13.447439670562744,G,J+88.66067305207253),new ba(i+13.388586044311523,G-.12233443558216095,J+73.75001013278961),new ba(i+13.21108341217041,G-.12233443558216095,J+26.25001072883606),new ba(p-13.729861378669739,G-.12233443558216095,J+26.25001072883606),new ba(p-13.552364706993103,G-.12233443558216095,J+73.75001013278961),new ba(i+13.802427053451538,G-.12233443558216095,m-14.747536182403564),new ba(p-13.493508100509644,G-.12233443558216095,J+88.66067305207253),new ba(p-13.138526678085327,G-.12233443558216095,m-14.747536182403564),new ba(i+13.447439670562744,G-.12233443558216095,J+88.66067305207253)],w=[new aa(0,4,15),new aa(17,0,15),new aa(3,2,21),new aa(16,3,21),new aa(4,19,23),new aa(15,4,23),new aa(10,8,6),new aa(7,10,6),new aa(16,21,8),new aa(10,16,8),new aa(12,3,16),new aa(18,12,16),new aa(17,15,11),new aa(9,17,11),new aa(23,18,20),new aa(14,23,20),new aa(19,12,18),new aa(23,19,18),new aa(9,11,5),new aa(1,9,5),new aa(11,14,22),new aa(5,11,22),new aa(20,10,7),new aa(13,20,7),new aa(14,20,13),new aa(22,14,13),new aa(28,10,20),new aa(26,28,20),new aa(25,16,10),new aa(28,25,10),new aa(30,18,16),new aa(25,30,16),new aa(26,20,18),new aa(30,26,18),new aa(29,11,15),new aa(27,29,15),new aa(24,23,14),new aa(31,24,14),new aa(27,15,23),new aa(24,27,23),new aa(31,14,11),new aa(29,31,11),new aa(32,24,31),new aa(35,32,31),new aa(33,27,24),new aa(32,33,24),new aa(34,29,27),new aa(33,34,27),new aa(35,31,29),new aa(34,35,29),new aa(38,28,26),new aa(37,38,26),new aa(37,26,30),new aa(39,37,30),new aa(36,25,28),new aa(38,36,28),new aa(39,30,25),new aa(36,39,25),new aa(42,34,33),new aa(41,42,33),new aa(47,39,36),new aa(44,47,36),new aa(43,35,34),new aa(42,43,34),new aa(46,38,37),new aa(45,46,37),new aa(41,33,32),new aa(40,41,32),new aa(44,36,38),new aa(46,44,38),new aa(40,32,35),new aa(43,40,35),new aa(45,37,39),new aa(47,45,39),new aa(10,20,18),new aa(16,10,18),new aa(15,23,14),new aa(11,15,14),new aa(48,52,63),new aa(65,48,63),new aa(51,50,69),new aa(64,51,69),new aa(52,67,71),new aa(63,52,71),new aa(58,56,54),new aa(55,58,54),new aa(64,69,56),new aa(58,64,56),new aa(60,51,64),new aa(66,60,64),new aa(65,63,59),new aa(57,65,59),new aa(71,66,68),new aa(62,71,68),new aa(67,60,66),new aa(71,67,66),new aa(57,59,53),new aa(49,57,53),new aa(59,62,70),new aa(53,59,70),new aa(68,58,55),new aa(61,68,55),new aa(62,68,61),new aa(70,62,61),new aa(76,58,68),new aa(74,76,68),new aa(73,64,58),new aa(76,73,58),new aa(78,66,64),new aa(73,78,64),new aa(74,68,66),new aa(78,74,66),new aa(77,59,63),new aa(75,77,63),new aa(72,71,62),new aa(79,72,62),new aa(75,63,71),new aa(72,75,71),new aa(79,62,59),new aa(77,79,59),new aa(80,72,79),new aa(83,80,79),new aa(81,75,72),new aa(80,81,72),new aa(82,77,75),new aa(81,82,75),new aa(83,79,77),new aa(82,83,77),new aa(86,76,74),new aa(85,86,74),new aa(85,74,78),new aa(87,85,78),new aa(84,73,76),new aa(86,84,76),new aa(87,78,73),new aa(84,87,73),new aa(90,82,81),new aa(89,90,81),new aa(95,87,84),new aa(92,95,84),new aa(91,83,82),new aa(90,91,82),new aa(94,86,85),new aa(93,94,85),new aa(89,81,80),new aa(88,89,80),new aa(92,84,86),new aa(94,92,86),new aa(88,80,83),new aa(91,88,83),new aa(93,85,87),new aa(95,93,87),new aa(58,68,66),new aa(64,58,66),new aa(63,71,62),new aa(59,63,62),new aa(21,2,50),new aa(69,21,50),new aa(69,56,8),new aa(21,69,8),new aa(56,54,6),new aa(8,56,6),new aa(7,6,54),new aa(55,7,54),new aa(13,7,55),new aa(61,13,55),new aa(22,13,61),new aa(70,22,61),new aa(70,53,5),new aa(22,70,5),new aa(53,49,1),new aa(5,53,1),new aa(9,1,49),new aa(57,9,49),new aa(17,9,57),new aa(65,17,57),new aa(65,48,0),new aa(17,65,0),new aa(4,0,48),new aa(52,4,48),new aa(19,4,52),new aa(67,19,52),new aa(67,60,12),new aa(19,67,12),new aa(60,51,3),new aa(12,60,3),new aa(51,50,2),new aa(3,51,2)],F=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187],V=[],f=0;for(f=0;f<F.length;f++)w[F[f]].materialIndex=this.__doorMaterialId;for(f=0;f<V.length;f++)w[V[f]].materialIndex=this.__glassMaterialId;return{vertices:a,faces:w,widthFactor:t,depth:o,side:n}}}]),c}();function c$($){return(c$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function($){return typeof $}:function($){return $&&"function"==typeof Symbol&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $})($)}function d$($,e){if(!($ instanceof e))throw new TypeError("Cannot call a class as a function")}function LC($,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty($,t.key,t)}}function e$($,e,n){return e&&LC($.prototype,e),n&&LC($,n),$}function f$($,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");$.prototype=Object.create(e&&e.prototype,{constructor:{value:$,writable:!0,configurable:!0}}),e&&g$($,e)}function g$($,e){return(g$=Object.setPrototypeOf||function($,e){return $.__proto__=e,$})($,e)}function h$($){var e=k$();return function(){var n,t=MC($);if(e){var r=MC(this).constructor;n=Reflect.construct(t,arguments,r)}else n=t.apply(this,arguments);return i$(this,n)}}function i$($,e){return!e||"object"!==c$(e)&&"function"!=typeof e?j$($):e}function j$($){if(void 0===$)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $}function k$(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch($){return!1}}function MC($){return(MC=Object.setPrototypeOf?Object.getPrototypeOf:function($){return $.__proto__||Object.getPrototypeOf($)})($)}var l$=function($){f$(n,yj);var e=h$(n);function n($){var t;return d$(this,n),(t=e.call(this,$)).__doorType=3,t}return e$(n,[{key:"__createForDoorModel",value:function($,e){var n=this.__frameSize,t=$-2*n-.5,r=this.__frameHeight/2-.5,o=.5*this.__frameThickness,V=0,i=0,c=0;e===Fa.RIGHT?(V=1,i=-1*t,c=0):(V=-1,i=0,c=t);var h=o,p=-r,m=r-n-.25,w=[new ba(i,-15599653124809265e-22,m),new ba(c,-15599653124809265e-22,m),new ba(i,h,m),new ba(c,h,m),new ba(c-10.429960489273071,-15832483768463135e-22,m),new ba(i+10.429966449737549,-15832483768463135e-22,m),new ba(i+10.429966449737549,h,m),new ba(i,-15628756955265999e-22,m-50.12519359588623),new ba(c,-15599653124809265e-22,m-50.125253200531006),new ba(i,h,m-50.12519359588623),new ba(c,h,m-50.125253200531006),new ba(c-10.429960489273071,-15832483768463135e-22,m-50.125229358673096),new ba(i+10.429966449737549,-15832483768463135e-22,m-50.12521147727966),new ba(i+10.429966449737549,h,m-50.12521147727966),new ba(c-10.429960489273071,h,m-50.125229358673096),new ba(i+11.909735202789307,-15832483768463135e-22,m),new ba(c-11.909729242324829,-15832483768463135e-22,m),new ba(i+11.909735202789307,h,m),new ba(i+11.909735202789307,-15832483768463135e-22,m-50.12521743774414),new ba(c-11.909729242324829,-15832483768463135e-22,m-50.12522339820862),new ba(i,-15629622041046787e-22,m-51.6154021024704),new ba(c,-15599653124809265e-22,m-51.61546468734741),new ba(i,h,m-51.6154021024704),new ba(c,h,m-51.61546468734741),new ba(c-10.429960489273071,-15832483768463135e-22,m-51.6154408454895),new ba(i+10.429966449737549,-15832483768463135e-22,m-51.61541998386383),new ba(c-10.429960489273071,h,m-51.6154408454895),new ba(c-11.909729242324829,-15832483768463135e-22,m-51.615431904792786),new ba(i+11.909735202789307,-15832483768463135e-22,m-51.61542594432831),new ba(i+11.909735202789307,h,m-51.61542594432831),new ba(c-10.429960489273071,.9999999776482582,m),new ba(i+10.429966449737549,.9999999776482582,m),new ba(c-10.429960489273071,.9999999776482582,m-50.125229358673096),new ba(i+10.429966449737549,.9999999776482582,m-50.12521147727966),new ba(i+11.909735202789307,.9999999776482582,m),new ba(c-11.909729242324829,.9999999776482582,m),new ba(i+11.909735202789307,.9999999776482582,m-50.12521743774414),new ba(c-11.909729242324829,.9999999776482582,m-50.12522339820862),new ba(c-10.429960489273071,.9999999776482582,m-51.6154408454895),new ba(i+10.429966449737549,.9999999776482582,m-51.61541998386383),new ba(c-11.909729242324829,.9999999776482582,m-51.615431904792786),new ba(i+11.909735202789307,.9999999776482582,m-51.61542594432831),new ba(c-11.909729242324829,-15832483768463135e-22,m-99.2994874715805),new ba(i+11.909735202789307,-15832483768463135e-22,m-99.29947257041931),new ba(i+11.909735202789307,h,m-99.29947257041931),new ba(c-11.909738183021545,h,m-99.2994874715805),new ba(i,-1565730833874568e-21,m-99.29942488670349),new ba(c,-15599653124809265e-22,m-99.29954260587692),new ba(i,h,m-99.29942488670349),new ba(c,h,m-99.29954260587692),new ba(c-10.429960489273071,-15832483768463135e-22,m-99.29950088262558),new ba(i+10.429966449737549,-15832483768463135e-22,m-99.29945915937424),new ba(c-10.429960489273071,h,m-99.29950088262558),new ba(c-10.429960489273071,.9999999776482582,m-99.29950088262558),new ba(i+10.429966449737549,.9999999776482582,m-99.29945915937424),new ba(c-11.909729242324829,.9999999776482582,m-99.2994874715805),new ba(i+11.909735202789307,.9999999776482582,m-99.29947257041931),new ba(c-11.909729242324829,h-.04077646881341934,m-99.2994874715805),new ba(c-10.429960489273071,h-.04077646881341934,m-99.29950088262558),new ba(c-10.429960489273071,h,m),new ba(c-11.909729242324829,h,m),new ba(c-11.909738183021545,h,m-50.12522339820862),new ba(i+11.909735202789307,h,m-50.12521743774414),new ba(i+10.429966449737549,h,m-51.61541998386383),new ba(c-11.909738183021545,h,m-51.615431904792786),new ba(i+10.429966449737549,h,m-99.29945915937424),new ba(c-10.429960489273071,h-.8999999612569809,m),new ba(i+10.429966449737549,h-.8999999612569809,m),new ba(i+10.429966449737549,h-.8999999612569809,m-50.12521147727966),new ba(c-10.429960489273071,h-.8999999612569809,m-50.125229358673096),new ba(i+11.909735202789307,h-.8999999612569809,m),new ba(c-11.909729242324829,h-.8999999612569809,m),new ba(c-11.909738183021545,h-.8999999612569809,m-50.12522339820862),new ba(i+11.909735202789307,h-.8999999612569809,m-50.12521743774414),new ba(i+10.429966449737549,h-.8999999612569809,m-51.61541998386383),new ba(c-10.429960489273071,h-.8999999612569809,m-51.6154408454895),new ba(i+11.909735202789307,h-.8999999612569809,m-51.61542594432831),new ba(c-11.909738183021545,h-.8999999612569809,m-51.615431904792786),new ba(i+11.909735202789307,h-.8999999612569809,m-99.29947257041931),new ba(c-11.909738183021545,h-.8999999612569809,m-99.2994874715805),new ba(i+10.429966449737549,h-.8999999612569809,m-99.29945915937424),new ba(c-10.429960489273071,h-.8999999612569809,m-99.29950088262558),new ba(i,-15599653124809265e-22,p),new ba(c,-15599653124809265e-22,p),new ba(i,h,p),new ba(c,h,p),new ba(c-10.429960489273071,-15832483768463135e-22,p),new ba(i+10.429966449737549,-15832483768463135e-22,p),new ba(i+10.429966449737549,h,p),new ba(i,-15628756955265999e-22,p+50.12519359588623),new ba(i,-15657860785722733e-22,p+100.25038719177246),new ba(c,-15599653124809265e-22,p+50.125253200531006),new ba(c,-15599653124809265e-22,p+100.25050640106201),new ba(i,h,p+50.12519359588623),new ba(i,h,p+100.25038719177246),new ba(c,h,p+50.125253200531006),new ba(c,h,p+100.25050640106201),new ba(c-10.429960489273071,-15832483768463135e-22,p+50.125229358673096),new ba(c-10.429960489273071,-15832483768463135e-22,p+100.25046467781067),new ba(i+10.429966449737549,-15832483768463135e-22,p+50.12521147727966),new ba(i+10.429966449737549,-15832483768463135e-22,p+100.25042295455933),new ba(i+10.429966449737549,h,p+50.12521147727966),new ba(i+10.429966449737549,h,p+100.25042295455933),new ba(c-10.429960489273071,h,p+50.125229358673096),new ba(c-10.429960489273071,h,p+100.25046467781067),new ba(i+11.909735202789307,-15832483768463135e-22,p),new ba(c-11.909729242324829,-15832483768463135e-22,p),new ba(i+11.909735202789307,h,p),new ba(i+11.909735202789307,-15832483768463135e-22,p+50.12521743774414),new ba(c-11.909729242324829,-15832483768463135e-22,p+50.12522339820862),new ba(i+11.909735202789307,h,p+100.25043686230788),new ba(i,-15629622041046787e-22,p+51.6154021024704),new ba(c,-15599653124809265e-22,p+51.61546468734741),new ba(i,h,p+51.6154021024704),new ba(c,h,p+51.61546468734741),new ba(c-10.429960489273071,-15832483768463135e-22,p+51.6154408454895),new ba(i+10.429966449737549,-15832483768463135e-22,p+51.61541998386383),new ba(c-10.429960489273071,h,p+51.6154408454895),new ba(c-11.909729242324829,-15832483768463135e-22,p+51.615431904792786),new ba(i+11.909735202789307,-15832483768463135e-22,p+51.61542594432831),new ba(i+11.909735202789307,h,p+51.61542594432831),new ba(c-10.429960489273071,.9999999776482582,p),new ba(i+10.429966449737549,.9999999776482582,p),new ba(c-10.429960489273071,.9999999776482582,p+50.125229358673096),new ba(c-10.429960489273071,.9999999776482582,p+100.25046467781067),new ba(i+10.429966449737549,.9999999776482582,p+50.12521147727966),new ba(i+10.429966449737549,.9999999776482582,p+100.25042295455933),new ba(i+11.909735202789307,.9999999776482582,p),new ba(c-11.909729242324829,.9999999776482582,p),new ba(i+11.909735202789307,.9999999776482582,p+50.12521743774414),new ba(c-11.909729242324829,.9999999776482582,p+50.12522339820862),new ba(c-10.429960489273071,.9999999776482582,p+51.6154408454895),new ba(i+10.429966449737549,.9999999776482582,p+51.61541998386383),new ba(c-11.909729242324829,.9999999776482582,p+51.615431904792786),new ba(i+11.909735202789307,.9999999776482582,p+51.61542594432831),new ba(c-11.909729242324829,-15832483768463135e-22,p+99.2994874715805),new ba(i+11.909735202789307,-15832483768463135e-22,p+99.29947257041931),new ba(i+11.909735202789307,h,p+99.29947257041931),new ba(c-11.909738183021545,h,p+99.2994874715805),new ba(i,-1565730833874568e-21,p+99.29942488670349),new ba(c,-15599653124809265e-22,p+99.29954260587692),new ba(i,h,p+99.29942488670349),new ba(c,h,p+99.29954260587692),new ba(c-10.429960489273071,-15832483768463135e-22,p+99.29950088262558),new ba(i+10.429966449737549,-15832483768463135e-22,p+99.29945915937424),new ba(c-10.429960489273071,h,p+99.29950088262558),new ba(c-10.429960489273071,.9999999776482582,p+99.29950088262558),new ba(i+10.429966449737549,.9999999776482582,p+99.29945915937424),new ba(i+11.909735202789307,.9999999776482582,p+100.25043686231356),new ba(c-11.909729242324829,.9999999776482582,p+100.25045077006212),new ba(c-10.429960489273071,h-.04077646881341934,p+100.25046467781067),new ba(c-11.909729242324829,h-.04077646881341934,p+100.25045077006212),new ba(c-11.909729242324829,.9999999776482582,p+99.2994874715805),new ba(i+11.909735202789307,.9999999776482582,p+99.29947257041931),new ba(c-11.909729242324829,h-.04077646881341934,p+99.2994874715805),new ba(c-10.429960489273071,h-.04077646881341934,p+99.29950088262558),new ba(c-10.429960489273071,h,p),new ba(c-11.909729242324829,h,p),new ba(c-11.909738183021545,h,p+50.12522339820862),new ba(i+11.909735202789307,h,p+50.12521743774414),new ba(c-11.909738183021545,h,p+100.25045077005643),new ba(i+10.429966449737549,h,p+51.61541998386383),new ba(c-11.909738183021545,h,p+51.615431904792786),new ba(i+10.429966449737549,h,p+99.29945915937424),new ba(c-10.429960489273071,h-.8999999612569809,p),new ba(i+10.429966449737549,h-.8999999612569809,p),new ba(i+10.429966449737549,h-.8999999612569809,p+50.12521147727966),new ba(i+10.429966449737549,h-.8999999612569809,p+100.25042295455933),new ba(c-10.429960489273071,h-.8999999612569809,p+50.125229358673096),new ba(c-10.429960489273071,h-.8999999612569809,p+100.25046467781067),new ba(i+11.909735202789307,h-.8999999612569809,p),new ba(c-11.909729242324829,h-.8999999612569809,p),new ba(c-11.909738183021545,h-.8999999612569809,p+50.12522339820862),new ba(i+11.909735202789307,h-.8999999612569809,p+50.12521743774414),new ba(c-11.909738183021545,h-.8999999612569809,p+100.25045077005643),new ba(i+11.909735202789307,h-.8999999612569809,p+100.25043686230788),new ba(i+10.429966449737549,h-.8999999612569809,p+51.61541998386383),new ba(c-10.429960489273071,h-.8999999612569809,p+51.6154408454895),new ba(i+11.909735202789307,h-.8999999612569809,p+51.61542594432831),new ba(c-11.909738183021545,h-.8999999612569809,p+51.615431904792786),new ba(i+11.909735202789307,h-.8999999612569809,p+99.29947257041931),new ba(c-11.909738183021545,h-.8999999612569809,p+99.2994874715805),new ba(i+10.429966449737549,h-.8999999612569809,p+99.29945915937424),new ba(c-10.429960489273071,h-.8999999612569809,p+99.29950088262558)],a=[new aa(5,0,2),new aa(6,5,2),new aa(8,1,3),new aa(10,8,3),new aa(92,47,49),new aa(96,92,49),new aa(9,2,0),new aa(7,9,0),new aa(94,48,46),new aa(90,94,46),new aa(7,0,5),new aa(12,7,5),new aa(90,46,51),new aa(100,90,51),new aa(96,49,52),new aa(104,96,52),new aa(11,4,1),new aa(8,11,1),new aa(98,50,47),new aa(92,98,47),new aa(39,25,12),new aa(33,39,12),new aa(13,6,2),new aa(9,13,2),new aa(33,12,5),new aa(31,33,5),new aa(18,15,16),new aa(19,18,16),new aa(34,15,18),new aa(36,34,18),new aa(21,8,10),new aa(23,21,10),new aa(22,9,7),new aa(20,22,7),new aa(20,7,12),new aa(25,20,12),new aa(23,10,14),new aa(26,23,14),new aa(24,11,8),new aa(21,24,8),new aa(126,100,51),new aa(54,126,51),new aa(32,11,24),new aa(38,32,24),new aa(37,19,16),new aa(35,37,16),new aa(33,31,34),new aa(36,33,34),new aa(37,35,30),new aa(32,37,30),new aa(39,33,36),new aa(41,39,36),new aa(40,37,32),new aa(38,40,32),new aa(41,36,37),new aa(40,41,37),new aa(36,18,19),new aa(37,36,19),new aa(40,27,28),new aa(41,40,28),new aa(48,22,20),new aa(46,48,20),new aa(30,4,11),new aa(32,30,11),new aa(47,21,23),new aa(49,47,23),new aa(38,24,50),new aa(53,38,50),new aa(46,20,25),new aa(51,46,25),new aa(49,23,26),new aa(52,49,26),new aa(50,24,21),new aa(47,50,21),new aa(43,28,27),new aa(42,43,27),new aa(54,51,25),new aa(39,54,25),new aa(53,50,98),new aa(124,53,98),new aa(148,56,55),new aa(149,148,55),new aa(56,148,126),new aa(54,56,126),new aa(56,43,42),new aa(55,56,42),new aa(55,53,124),new aa(149,55,124),new aa(71,60,61),new aa(72,71,61),new aa(66,30,35),new aa(71,66,35),new aa(70,34,31),new aa(67,70,31),new aa(69,66,71),new aa(72,69,71),new aa(169,81,79),new aa(174,169,79),new aa(73,70,67),new aa(68,73,67),new aa(175,78,80),new aa(167,175,80),new aa(174,79,78),new aa(175,174,78),new aa(75,69,72),new aa(77,75,72),new aa(76,73,68),new aa(74,76,68),new aa(77,72,73),new aa(76,77,73),new aa(81,75,77),new aa(79,81,77),new aa(78,76,74),new aa(80,78,74),new aa(72,61,62),new aa(73,72,62),new aa(74,63,65),new aa(80,74,65),new aa(1,4,59),new aa(3,1,59),new aa(10,3,59),new aa(14,10,59),new aa(102,65,48),new aa(94,102,48),new aa(16,15,17),new aa(60,16,17),new aa(61,60,17),new aa(62,61,17),new aa(63,13,9),new aa(22,63,9),new aa(41,28,43),new aa(56,41,43),new aa(55,42,27),new aa(40,55,27),new aa(65,63,22),new aa(48,65,22),new aa(45,64,29),new aa(44,45,29),new aa(54,39,41),new aa(56,54,41),new aa(55,40,38),new aa(53,55,38),new aa(78,44,29),new aa(76,78,29),new aa(68,13,63),new aa(74,68,63),new aa(73,62,17),new aa(70,73,17),new aa(169,104,52),new aa(81,169,52),new aa(76,29,64),new aa(77,76,64),new aa(67,6,13),new aa(68,67,13),new aa(69,14,59),new aa(66,69,59),new aa(79,45,44),new aa(78,79,44),new aa(77,64,45),new aa(79,77,45),new aa(75,26,14),new aa(69,75,14),new aa(81,52,26),new aa(75,81,26),new aa(80,65,102),new aa(167,80,102),new aa(87,88,84),new aa(82,87,84),new aa(91,95,85),new aa(83,91,85),new aa(92,96,142),new aa(140,92,142),new aa(93,89,82),new aa(84,93,82),new aa(94,90,139),new aa(141,94,139),new aa(89,99,87),new aa(82,89,87),new aa(90,100,144),new aa(139,90,144),new aa(96,104,145),new aa(142,96,145),new aa(97,91,83),new aa(86,97,83),new aa(98,92,140),new aa(143,98,140),new aa(132,125,99),new aa(116,132,99),new aa(101,93,84),new aa(88,101,84),new aa(125,122,87),new aa(99,125,87),new aa(108,109,106),new aa(105,108,106),new aa(127,129,108),new aa(105,127,108),new aa(112,114,95),new aa(91,112,95),new aa(113,111,89),new aa(93,113,89),new aa(111,116,99),new aa(89,111,99),new aa(114,117,103),new aa(95,114,103),new aa(115,112,91),new aa(97,115,91),new aa(126,147,144),new aa(100,126,144),new aa(123,131,115),new aa(97,123,115),new aa(130,128,106),new aa(109,130,106),new aa(125,129,127),new aa(122,125,127),new aa(130,123,121),new aa(128,130,121),new aa(132,134,129),new aa(125,132,129),new aa(133,131,123),new aa(130,133,123),new aa(134,133,130),new aa(129,134,130),new aa(129,130,109),new aa(108,129,109),new aa(133,134,119),new aa(118,133,119),new aa(141,139,111),new aa(113,141,111),new aa(121,123,97),new aa(86,121,97),new aa(140,142,114),new aa(112,140,114),new aa(131,146,143),new aa(115,131,143),new aa(139,144,116),new aa(111,139,116),new aa(142,145,117),new aa(114,142,117),new aa(143,140,112),new aa(115,143,112),new aa(136,135,118),new aa(119,136,118),new aa(147,132,116),new aa(144,147,116),new aa(146,124,98),new aa(143,146,98),new aa(148,149,152),new aa(153,148,152),new aa(153,147,126),new aa(148,153,126),new aa(153,152,135),new aa(136,153,135),new aa(152,149,124),new aa(146,152,124),new aa(171,172,158),new aa(157,171,158),new aa(164,171,128),new aa(121,164,128),new aa(170,165,122),new aa(127,170,122),new aa(168,172,171),new aa(164,168,171),new aa(169,174,181),new aa(183,169,181),new aa(173,166,165),new aa(170,173,165),new aa(175,167,182),new aa(180,175,182),new aa(174,175,180),new aa(181,174,180),new aa(177,179,172),new aa(168,177,172),new aa(178,176,166),new aa(173,178,166),new aa(179,178,173),new aa(172,179,173),new aa(183,181,179),new aa(177,183,179),new aa(180,182,176),new aa(178,180,176),new aa(172,173,159),new aa(158,172,159),new aa(176,182,163),new aa(161,176,163),new aa(83,85,156),new aa(86,83,156),new aa(95,103,156),new aa(85,95,156),new aa(102,94,141),new aa(163,102,141),new aa(106,157,107),new aa(105,106,107),new aa(158,159,107),new aa(157,158,107),new aa(161,113,93),new aa(101,161,93),new aa(134,153,136),new aa(119,134,136),new aa(152,133,118),new aa(135,152,118),new aa(163,141,113),new aa(161,163,113),new aa(138,137,120),new aa(162,138,120),new aa(147,153,134),new aa(132,147,134),new aa(152,146,131),new aa(133,152,131),new aa(180,178,120),new aa(137,180,120),new aa(166,176,161),new aa(101,166,161),new aa(173,170,107),new aa(159,173,107),new aa(169,183,145),new aa(104,169,145),new aa(178,179,162),new aa(120,178,162),new aa(165,166,101),new aa(88,165,101),new aa(175,174,160),new aa(110,175,160),new aa(168,164,156),new aa(103,168,156),new aa(181,180,137),new aa(138,181,137),new aa(179,181,138),new aa(162,179,138),new aa(177,168,103),new aa(117,177,103),new aa(183,177,117),new aa(145,183,117),new aa(182,167,102),new aa(163,182,102)],F=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333],f=[],s=0;for(s=0;s<F.length;s++)a[F[s]].materialIndex=this.__doorMaterialId;for(s=0;s<f.length;s++)a[f[s]].materialIndex=this.__glassMaterialId;return{vertices:w,faces:a,widthFactor:t,depth:o,side:V}}}]),n}();function m$(r){return(m$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function n$(r,$){if(!(r instanceof $))throw new TypeError("Cannot call a class as a function")}function NC(r,$){for(var e=0;e<$.length;e++){var t=$[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function o$(r,$,e){return $&&NC(r.prototype,$),e&&NC(r,e),r}function p$(r,$){if("function"!=typeof $&&null!==$)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create($&&$.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),$&&q$(r,$)}function q$(r,$){return(q$=Object.setPrototypeOf||function(r,$){return r.__proto__=$,r})(r,$)}function r$(r){var $=u$();return function(){var e,t=OC(r);if($){var o=OC(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return s$(this,e)}}function s$(r,$){return!$||"object"!==m$($)&&"function"!=typeof $?t$(r):$}function t$(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function u$(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}function OC(r){return(OC=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}var v$=function(r){p$(e,yj);var $=r$(e);function e(r){var t;return n$(this,e),(t=$.call(this,r)).__doorType=4,t}return o$(e,[{key:"__createForDoorModel",value:function(r,$){var e=this.__frameSize,t=r-2*e-.5,o=this.__frameHeight/2-.5,n=.5*this.__frameThickness,i=0,c=0,p=0;$===Fa.RIGHT?(i=1,c=-1*t,p=0):(i=-1,c=0,p=t);var a=n,k=-o,B=o-e-.25,Q=[new ba(c,-157160684466362e-20,k+.0002384185791015625),new ba(p,-15599653124809265e-22,k),new ba(c,-15599653124809265e-22,B),new ba(c,-15599653124809265e-22,B-12.999999523162842),new ba(c,-157160684466362e-20,k+25.00007152557373),new ba(p,-15599653124809265e-22,k+25.000011920928955),new ba(p,-15599653124809265e-22,B),new ba(p,-15599653124809265e-22,B-12.999999523162842),new ba(p-11.968576163053513,-15599653124809265e-22,B),new ba(p-11.968576163053513,-15599653124809265e-22,k),new ba(p-11.968576163053513,-15599653124809265e-22,B-12.999999523162842),new ba(p-11.968576163053513,-15599653124809265e-22,k+25.000011920928955),new ba(c+12.030857801437378,-15832483768463135e-22,k+25.000011920928955),new ba(c+12.030857801437378,-15599653124809265e-22,B-12.999999523162842),new ba(c+12.030857801437378,-15832483768463135e-22,k),new ba(c+12.030857801437378,-15599653124809265e-22,B),new ba(c+12.030857801437378,-1.0000014677643776,B-12.999999523162842),new ba(c+12.030857801437378,-1.0000014677643776,k+25.000011920928955),new ba(p-11.968576163053513,-1.0000014677643776,B-12.999999523162842),new ba(p-11.968576163053513,-1.0000014677643776,k+25.000011920928955),new ba(p-13.532750308513641,-.9388341568410397,k+26.250016689300537),new ba(p-13.532750308513641,-.9388341568410397,B-14.747536182403564),new ba(c+13.506758213043213,-.9388341568410397,k+26.250016689300537),new ba(p-13.532750308513641,-.8776669390499592,k+26.250016689300537),new ba(c+13.506758213043213,-.9388341568410397,B-14.747536182403564),new ba(p-13.532750308513641,-.03883419558405876,k+26.250016689300537),new ba(p-13.532750308513641,-.03883419558405876,B-14.747536182403564),new ba(c+13.506758213043213,-.03883419558405876,k+26.250016689300537),new ba(p-13.532750308513641,1.0223344899713993,k+26.250016689300537),new ba(c+13.506758213043213,-.03883419558405876,B-14.747536182403564),new ba(c,a-.9999999776482582,k+.0002384185791015625),new ba(p,a-.9999999776482582,k),new ba(c,a-.9999999776482582,B),new ba(c,a-.9999999776482582,B-12.999999523162842),new ba(c,a-.9999999776482582,k+25.00007152557373),new ba(p,a-.9999999776482582,k+25.000011920928955),new ba(p,a-.9999999776482582,B),new ba(p,a-.9999999776482582,B-12.999999523162842),new ba(p-11.968576908111572,a-.9999999776482582,B),new ba(p-11.968576908111572,a-.9999999776482582,k),new ba(p-11.968576908111572,a-.9999999776482582,B-12.999999523162842),new ba(p-11.968576908111572,a-.9999999776482582,k+25.000011920928955),new ba(c+12.030857801437378,a-.9999999776482582,k+25.000011920928955),new ba(c+12.030857801437378,a-.9999999776482582,B-12.999999523162842),new ba(c+12.030857801437378,a-.9999999776482582,k),new ba(c+12.030857801437378,a-.9999999776482582,B),new ba(c+12.030857801437378,a,B-12.999999523162842),new ba(c+12.030857801437378,a,k+25.000011920928955),new ba(p-11.968576908111572,a,B-12.999999523162842),new ba(p-11.968576908111572,a,k+25.000011920928955),new ba(p-13.53275179862976,a-.061167217791080475,k+26.250016689300537),new ba(p-13.53275179862976,a-.061167217791080475,B-14.747536182403564),new ba(c+13.506758213043213,a-.061167217791080475,k+26.250016689300537),new ba(p-13.53275179862976,a-.12233462184667587,k+26.250016689300537),new ba(c+13.506758213043213,a-.061167217791080475,B-14.747536182403564),new ba(p-13.53275179862976,a-.9611671790480614,k+26.250016689300537),new ba(p-13.53275179862976,a-.9611671790480614,B-14.747536182403564),new ba(c+13.506758213043213,a-.9611671790480614,k+26.250016689300537),new ba(p-13.53275179862976,a-1.0223345831036568,k+26.250016689300537),new ba(c+13.506758213043213,a-.9611671790480614,B-14.747536182403564)],m=[new aa(0,4,12),new aa(14,0,12),new aa(3,2,15),new aa(13,3,15),new aa(10,8,6),new aa(7,10,6),new aa(13,15,8),new aa(10,13,8),new aa(14,12,11),new aa(9,14,11),new aa(9,11,5),new aa(1,9,5),new aa(16,13,10),new aa(18,16,10),new aa(19,11,12),new aa(17,19,12),new aa(12,4,3),new aa(13,12,3),new aa(10,7,5),new aa(11,10,5),new aa(17,19,23),new aa(22,17,23),new aa(20,19,18),new aa(21,20,18),new aa(24,16,17),new aa(22,24,17),new aa(13,16,17),new aa(12,13,17),new aa(18,10,11),new aa(19,18,11),new aa(16,18,21),new aa(24,16,21),new aa(29,24,22),new aa(27,29,22),new aa(29,24,21),new aa(26,29,21),new aa(25,20,21),new aa(26,25,21),new aa(27,22,23),new aa(28,27,23),new aa(27,28,25),new aa(26,29,27),new aa(27,25,26),new aa(30,34,42),new aa(44,30,42),new aa(33,32,45),new aa(43,33,45),new aa(40,38,36),new aa(37,40,36),new aa(43,45,38),new aa(40,43,38),new aa(44,42,41),new aa(39,44,41),new aa(39,41,35),new aa(31,39,35),new aa(46,43,40),new aa(48,46,40),new aa(49,41,42),new aa(47,49,42),new aa(42,34,33),new aa(43,42,33),new aa(40,37,35),new aa(41,40,35),new aa(47,49,53),new aa(52,47,53),new aa(50,49,48),new aa(51,50,48),new aa(54,46,47),new aa(52,54,47),new aa(43,46,47),new aa(42,43,47),new aa(48,40,41),new aa(49,48,41),new aa(46,48,51),new aa(54,46,51),new aa(59,54,52),new aa(57,59,52),new aa(59,54,51),new aa(56,59,51),new aa(55,50,51),new aa(56,55,51),new aa(57,52,53),new aa(58,57,53),new aa(57,58,55),new aa(56,59,57),new aa(57,55,56),new aa(8,6,36),new aa(38,8,36),new aa(15,8,38),new aa(45,15,38),new aa(45,32,2),new aa(15,45,2),new aa(37,36,6),new aa(7,37,6),new aa(35,37,7),new aa(5,35,7),new aa(5,1,31),new aa(35,5,31),new aa(39,31,1),new aa(9,39,1),new aa(44,39,9),new aa(14,44,9),new aa(14,0,30),new aa(44,14,30),new aa(3,4,34),new aa(33,3,34),new aa(3,2,32),new aa(33,3,32),new aa(0,4,34),new aa(30,0,34)],w=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109],F=[],f=0;for(f=0;f<w.length;f++)m[w[f]].materialIndex=this.__doorMaterialId;for(f=0;f<F.length;f++)m[F[f]].materialIndex=this.__glassMaterialId;return{vertices:Q,faces:m,widthFactor:t,depth:n,side:i}}}]),e}();function w$(r){return(w$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function x$(r,$){if(!(r instanceof $))throw new TypeError("Cannot call a class as a function")}function PC(r,$){for(var e=0;e<$.length;e++){var t=$[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function y$(r,$,e){return $&&PC(r.prototype,$),e&&PC(r,e),r}function z$(r,$){if("function"!=typeof $&&null!==$)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create($&&$.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),$&&A$(r,$)}function A$(r,$){return(A$=Object.setPrototypeOf||function(r,$){return r.__proto__=$,r})(r,$)}function B$(r){var $=E$();return function(){var e,t=QC(r);if($){var w=QC(this).constructor;e=Reflect.construct(t,arguments,w)}else e=t.apply(this,arguments);return C$(this,e)}}function C$(r,$){return!$||"object"!==w$($)&&"function"!=typeof $?D$(r):$}function D$(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function E$(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}function QC(r){return(QC=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}var F$=function(r){z$(e,yj);var $=B$(e);function e(r){var t;return x$(this,e),(t=$.call(this,r)).__doorType=5,t}return y$(e,[{key:"__createForDoorModel",value:function(r,$){var e=this.__frameSize,t=r-2*e-.5,w=this.__frameHeight/2-.5,o=.5*this.__frameThickness,n=0,i=0,c=0;$===Fa.RIGHT?(n=1,i=-1*t,c=0):(n=-1,i=0,c=t);var p=o,a=-w,k=w-e-.25,L=[new ba(i,-157160684466362e-20,a+.0002384185791015625),new ba(c,-15599653124809265e-22,a),new ba(i,-15599653124809265e-22,k),new ba(i,-15599653124809265e-22,k-12.999999523162842),new ba(i,-157160684466362e-20,a+25.00007152557373),new ba(c,-15599653124809265e-22,a+25.000011920928955),new ba(c,-15599653124809265e-22,k),new ba(c,-15599653124809265e-22,k-12.999999523162842),new ba(c-11.968576163053513,-15599653124809265e-22,k),new ba(c-11.968576163053513,-15599653124809265e-22,a),new ba(c-11.968576163053513,-15599653124809265e-22,k-12.999999523162842),new ba(c-11.968576163053513,-15599653124809265e-22,a+25.000011920928955),new ba(i+12.030857801437378,-15832483768463135e-22,a+25.000011920928955),new ba(i+12.030857801437378,-15599653124809265e-22,k-12.999999523162842),new ba(i+12.030857801437378,-15832483768463135e-22,a),new ba(i+12.030857801437378,-15599653124809265e-22,k),new ba(i+12.030857801437378,-1.0000014677643776,k-12.999999523162842),new ba(i+12.030857801437378,-1.0000014677643776,a+25.000011920928955),new ba(c-11.968576163053513,-1.0000014677643776,k-12.999999523162842),new ba(c-11.968576163053513,-1.0000014677643776,a+25.000011920928955),new ba(c-13.532750308513641,-.9388341568410397,a+26.250016689300537),new ba(c-13.532750308513641,-.9388341568410397,k-14.747536182403564),new ba(i+13.506758213043213,-.9388341568410397,a+26.250016689300537),new ba(c-13.532750308513641,-.8776669390499592,a+26.250016689300537),new ba(i+13.506758213043213,-.9388341568410397,k-14.747536182403564),new ba(c-13.532750308513641,-.03883419558405876,a+26.250016689300537),new ba(c-13.532750308513641,-.03883419558405876,k-14.747536182403564),new ba(i+13.506758213043213,-.03883419558405876,a+26.250016689300537),new ba(c-13.532750308513641,1.0223344899713993,a+26.250016689300537),new ba(i+13.506758213043213,-.03883419558405876,k-14.747536182403564),new ba(i,p-.9999999776482582,a+.0002384185791015625),new ba(c,p-.9999999776482582,a),new ba(i,p-.9999999776482582,k),new ba(i,p-.9999999776482582,k-12.999999523162842),new ba(i,p-.9999999776482582,a+25.00007152557373),new ba(c,p-.9999999776482582,a+25.000011920928955),new ba(c,p-.9999999776482582,k),new ba(c,p-.9999999776482582,k-12.999999523162842),new ba(c-11.968576908111572,p-.9999999776482582,k),new ba(c-11.968576908111572,p-.9999999776482582,a),new ba(c-11.968576908111572,p-.9999999776482582,k-12.999999523162842),new ba(c-11.968576908111572,p-.9999999776482582,a+25.000011920928955),new ba(i+12.030857801437378,p-.9999999776482582,a+25.000011920928955),new ba(i+12.030857801437378,p-.9999999776482582,k-12.999999523162842),new ba(i+12.030857801437378,p-.9999999776482582,a),new ba(i+12.030857801437378,p-.9999999776482582,k),new ba(i+12.030857801437378,p,k-12.999999523162842),new ba(i+12.030857801437378,p,a+25.000011920928955),new ba(c-11.968576908111572,p,k-12.999999523162842),new ba(c-11.968576908111572,p,a+25.000011920928955),new ba(c-13.53275179862976,p-.061167217791080475,a+26.250016689300537),new ba(c-13.53275179862976,p-.061167217791080475,k-14.747536182403564),new ba(i+13.506758213043213,p-.061167217791080475,a+26.250016689300537),new ba(c-13.53275179862976,p-.12233462184667587,a+26.250016689300537),new ba(i+13.506758213043213,p-.061167217791080475,k-14.747536182403564),new ba(c-13.53275179862976,p-.9611671790480614,a+26.250016689300537),new ba(c-13.53275179862976,p-.9611671790480614,k-14.747536182403564),new ba(i+13.506758213043213,p-.9611671790480614,a+26.250016689300537),new ba(c-13.53275179862976,p-1.0223345831036568,a+26.250016689300537),new ba(i+13.506758213043213,p-.9611671790480614,k-14.747536182403564)],m=[new aa(0,4,12),new aa(14,0,12),new aa(3,2,15),new aa(13,3,15),new aa(10,8,6),new aa(7,10,6),new aa(13,15,8),new aa(10,13,8),new aa(14,12,11),new aa(9,14,11),new aa(9,11,5),new aa(1,9,5),new aa(16,13,10),new aa(18,16,10),new aa(19,11,12),new aa(17,19,12),new aa(12,4,3),new aa(13,12,3),new aa(10,7,5),new aa(11,10,5),new aa(17,19,23),new aa(22,17,23),new aa(20,19,18),new aa(21,20,18),new aa(24,16,17),new aa(22,24,17),new aa(13,16,17),new aa(12,13,17),new aa(18,10,11),new aa(19,18,11),new aa(16,18,21),new aa(24,16,21),new aa(29,24,22),new aa(27,29,22),new aa(29,24,21),new aa(26,29,21),new aa(25,20,21),new aa(26,25,21),new aa(27,22,23),new aa(28,27,23),new aa(27,28,25),new aa(26,29,27),new aa(27,25,26),new aa(30,34,42),new aa(44,30,42),new aa(33,32,45),new aa(43,33,45),new aa(40,38,36),new aa(37,40,36),new aa(43,45,38),new aa(40,43,38),new aa(44,42,41),new aa(39,44,41),new aa(39,41,35),new aa(31,39,35),new aa(46,43,40),new aa(48,46,40),new aa(49,41,42),new aa(47,49,42),new aa(42,34,33),new aa(43,42,33),new aa(40,37,35),new aa(41,40,35),new aa(47,49,53),new aa(52,47,53),new aa(50,49,48),new aa(51,50,48),new aa(54,46,47),new aa(52,54,47),new aa(43,46,47),new aa(42,43,47),new aa(48,40,41),new aa(49,48,41),new aa(46,48,51),new aa(54,46,51),new aa(59,54,52),new aa(57,59,52),new aa(59,54,51),new aa(56,59,51),new aa(55,50,51),new aa(56,55,51),new aa(57,52,53),new aa(58,57,53),new aa(57,58,55),new aa(56,59,57),new aa(57,55,56),new aa(8,6,36),new aa(38,8,36),new aa(15,8,38),new aa(45,15,38),new aa(45,32,2),new aa(15,45,2),new aa(37,36,6),new aa(7,37,6),new aa(35,37,7),new aa(5,35,7),new aa(5,1,31),new aa(35,5,31),new aa(39,31,1),new aa(9,39,1),new aa(44,39,9),new aa(14,44,9),new aa(14,0,30),new aa(44,14,30),new aa(3,4,34),new aa(33,3,34),new aa(3,2,32),new aa(33,3,32),new aa(0,4,34),new aa(30,0,34)],F=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109],f=[40,41,42,83,84,85],s=0;for(s=0;s<F.length;s++)m[F[s]].materialIndex=this.__doorMaterialId;for(s=0;s<f.length;s++)m[f[s]].materialIndex=this.__glassMaterialId;return{vertices:L,faces:m,widthFactor:t,depth:o,side:n}}}]),e}();function G$($){return(G$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function($){return typeof $}:function($){return $&&"function"==typeof Symbol&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $})($)}function H$($,t){if(!($ instanceof t))throw new TypeError("Cannot call a class as a function")}function RC($,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty($,i.key,i)}}function I$($,t,e){return t&&RC($.prototype,t),e&&RC($,e),$}function J$($,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");$.prototype=Object.create(t&&t.prototype,{constructor:{value:$,writable:!0,configurable:!0}}),t&&K$($,t)}function K$($,t){return(K$=Object.setPrototypeOf||function($,t){return $.__proto__=t,$})($,t)}function L$($){var t=O$();return function(){var e,i=SC($);if(t){var w=SC(this).constructor;e=Reflect.construct(i,arguments,w)}else e=i.apply(this,arguments);return M$(this,e)}}function M$($,t){return!t||"object"!==G$(t)&&"function"!=typeof t?N$($):t}function N$($){if(void 0===$)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $}function O$(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch($){return!1}}function SC($){return(SC=Object.setPrototypeOf?Object.getPrototypeOf:function($){return $.__proto__||Object.getPrototypeOf($)})($)}var P$=function($){J$(e,yj);var t=L$(e);function e($){var i;return H$(this,e),(i=t.call(this,$)).__doorType=6,i}return I$(e,[{key:"__createForDoorModel",value:function($,t){var e=this.__frameSize,i=$-2*e-.5,w=this.__frameHeight/2-.5,r=.5*this.__frameThickness,o=0,n=0,c=0;t===Fa.RIGHT?(o=1,n=-1*i,c=0):(o=-1,n=0,c=i);var p=r,d=-w,m=w-e-.25,a=[new ba(n,-157160684466362e-20,d+.0002384185791015625),new ba(c,-15599653124809265e-22,d),new ba(n,-15599653124809265e-22,m),new ba(n,-15599653124809265e-22,m-12.999999523162842),new ba(n,-157160684466362e-20,d+25.00007152557373),new ba(c,-15599653124809265e-22,d+25.000011920928955),new ba(c,-15599653124809265e-22,m),new ba(c,-15599653124809265e-22,m-12.999999523162842),new ba(c-11.609852313995361,-15599653124809265e-22,m),new ba(c-12.357193231582642,-15599653124809265e-22,d),new ba(c-11.658430099487305,-15599653124809265e-22,m-12.999999523162842),new ba(c-12.263774871826172,-15599653124809265e-22,d+25.000011920928955),new ba(n,-157160684466362e-20,d+87.00000941753387),new ba(c,-15599653124809265e-22,d+87.00000941753387),new ba(c-12.076938152313232,-15599653124809265e-22,d+75.00001192092896),new ba(n+11.735659837722778,-157160684466362e-20,d+25.000011920928955),new ba(n+12.341010570526123,-15599653124809265e-22,m-12.999999523162842),new ba(n+11.642247438430786,-157160684466362e-20,d),new ba(n+11.967337131500244,-157160684466362e-20,d+87.00000941753387),new ba(n,-157160684466362e-20,d+75.00001192092896),new ba(c-12.032097578048706,-15599653124809265e-22,d+87.00000941753387),new ba(n+12.389582395553589,-15599653124809265e-22,m),new ba(c,-15599653124809265e-22,d+75.00001192092896),new ba(n+11.922496557235718,-157160684466362e-20,d+75.00001192092896),new ba(n+11.922496557235718,-1.0000014677643776,d+75.00001192092896),new ba(n+12.341010570526123,-1.0000014677643776,m-12.999999523162842),new ba(c-12.032097578048706,-1.0000014677643776,d+87.00000941753387),new ba(n+11.735659837722778,-1.0000014677643776,d+25.000011920928955),new ba(c-11.658430099487305,-1.0000014677643776,m-12.999999523162842),new ba(c-12.263774871826172,-1.0000014677643776,d+25.000011920928955),new ba(n+11.967337131500244,-1.0000014677643776,d+87.00000941753387),new ba(c-12.076938152313232,-1.0000014677643776,d+75.00001192092896),new ba(n+13.388586044311523,-1.0000014677643776,d+73.75001013278961),new ba(n+13.21108341217041,-1.0000014677643776,d+26.25001072883606),new ba(c-13.729861378669739,-1.0000014677643776,d+26.25001072883606),new ba(c-13.552364706993103,-1.0000014677643776,d+73.75001013278961),new ba(n+13.802427053451538,-1.0000014677643776,m-14.747536182403564),new ba(c-13.493508100509644,-1.0000014677643776,d+88.66067305207253),new ba(c-13.138526678085327,-1.0000014677643776,m-14.747536182403564),new ba(n+13.447439670562744,-1.0000014677643776,d+88.66067305207253),new ba(n+13.388586044311523,-.8776669390499592,d+73.75001013278961),new ba(n+13.21108341217041,-.8776669390499592,d+26.25001072883606),new ba(c-13.729861378669739,-.8776669390499592,d+26.25001072883606),new ba(c-13.552364706993103,-.8776669390499592,d+73.75001013278961),new ba(n+13.802427053451538,-.8776669390499592,m-14.747536182403564),new ba(c-13.493508100509644,-.8776669390499592,d+88.66067305207253),new ba(c-13.138526678085327,-.8776669390499592,m-14.747536182403564),new ba(n+13.447439670562744,-.8776669390499592,d+88.66067305207253),new ba(n,p-.9999999776482582,d+.0002384185791015625),new ba(c,p-.9999999776482582,d),new ba(n,p-.9999999776482582,m),new ba(n,p-.9999999776482582,m-12.999999523162842),new ba(n,p-.9999999776482582,d+25.00007152557373),new ba(c,p-.9999999776482582,d+25.000011920928955),new ba(c,p-.9999999776482582,m),new ba(c,p-.9999999776482582,m-12.999999523162842),new ba(c-11.609852313995361,p-.9999999776482582,m),new ba(c-12.357193231582642,p-.9999999776482582,d),new ba(c-11.658430099487305,p-.9999999776482582,m-12.999999523162842),new ba(c-12.263774871826172,p-.9999999776482582,d+25.000011920928955),new ba(n,p-.9999999776482582,d+87.00000941753387),new ba(c,p-.9999999776482582,d+87.00000941753387),new ba(c-12.076938152313232,p-.9999999776482582,d+75.00001192092896),new ba(n+11.735659837722778,p-.9999999776482582,d+25.000011920928955),new ba(n+12.341010570526123,p-.9999999776482582,m-12.999999523162842),new ba(n+11.642247438430786,p-.9999999776482582,d),new ba(n+11.967337131500244,p-.9999999776482582,d+87.00000941753387),new ba(n,p-.9999999776482582,d+75.00001192092896),new ba(c-12.032097578048706,p-.9999999776482582,d+87.00000941753387),new ba(n+12.389582395553589,p-.9999999776482582,m),new ba(c,p-.9999999776482582,d+75.00001192092896),new ba(n+11.922496557235718,p-.9999999776482582,d+75.00001192092896),new ba(n+11.922496557235718,p,d+75.00001192092896),new ba(n+12.341010570526123,p,m-12.999999523162842),new ba(c-12.032097578048706,p,d+87.00000941753387),new ba(n+11.735659837722778,p,d+25.000011920928955),new ba(c-11.658430099487305,p,m-12.999999523162842),new ba(c-12.263774871826172,p,d+25.000011920928955),new ba(n+11.967337131500244,p,d+87.00000941753387),new ba(c-12.076938152313232,p,d+75.00001192092896),new ba(n+13.388586044311523,p,d+73.75001013278961),new ba(n+13.21108341217041,p,d+26.25001072883606),new ba(c-13.729861378669739,p,d+26.25001072883606),new ba(c-13.552364706993103,p,d+73.75001013278961),new ba(n+13.802427053451538,p,m-14.747536182403564),new ba(c-13.493508100509644,p,d+88.66067305207253),new ba(c-13.138526678085327,p,m-14.747536182403564),new ba(n+13.447439670562744,p,d+88.66067305207253),new ba(n+13.388586044311523,p-.12233443558216095,d+73.75001013278961),new ba(n+13.21108341217041,p-.12233443558216095,d+26.25001072883606),new ba(c-13.729861378669739,p-.12233443558216095,d+26.25001072883606),new ba(c-13.552364706993103,p-.12233443558216095,d+73.75001013278961),new ba(n+13.802427053451538,p-.12233443558216095,m-14.747536182403564),new ba(c-13.493508100509644,p-.12233443558216095,d+88.66067305207253),new ba(c-13.138526678085327,p-.12233443558216095,m-14.747536182403564),new ba(n+13.447439670562744,p-.12233443558216095,d+88.66067305207253)],F=[new aa(0,4,15),new aa(17,0,15),new aa(3,2,21),new aa(16,3,21),new aa(4,19,23),new aa(15,4,23),new aa(10,8,6),new aa(7,10,6),new aa(16,21,8),new aa(10,16,8),new aa(12,3,16),new aa(18,12,16),new aa(17,15,11),new aa(9,17,11),new aa(23,18,20),new aa(14,23,20),new aa(19,12,18),new aa(23,19,18),new aa(9,11,5),new aa(1,9,5),new aa(11,14,22),new aa(5,11,22),new aa(20,10,7),new aa(13,20,7),new aa(14,20,13),new aa(22,14,13),new aa(28,10,20),new aa(26,28,20),new aa(25,16,10),new aa(28,25,10),new aa(30,18,16),new aa(25,30,16),new aa(26,20,18),new aa(30,26,18),new aa(29,11,15),new aa(27,29,15),new aa(24,23,14),new aa(31,24,14),new aa(27,15,23),new aa(24,27,23),new aa(31,14,11),new aa(29,31,11),new aa(32,24,31),new aa(35,32,31),new aa(33,27,24),new aa(32,33,24),new aa(34,29,27),new aa(33,34,27),new aa(35,31,29),new aa(34,35,29),new aa(38,28,26),new aa(37,38,26),new aa(37,26,30),new aa(39,37,30),new aa(36,25,28),new aa(38,36,28),new aa(39,30,25),new aa(36,39,25),new aa(42,34,33),new aa(41,42,33),new aa(47,39,36),new aa(44,47,36),new aa(43,35,34),new aa(42,43,34),new aa(46,38,37),new aa(45,46,37),new aa(41,33,32),new aa(40,41,32),new aa(44,36,38),new aa(46,44,38),new aa(40,32,35),new aa(43,40,35),new aa(45,37,39),new aa(47,45,39),new aa(10,20,18),new aa(16,10,18),new aa(15,23,14),new aa(11,15,14),new aa(48,52,63),new aa(65,48,63),new aa(51,50,69),new aa(64,51,69),new aa(52,67,71),new aa(63,52,71),new aa(58,56,54),new aa(55,58,54),new aa(64,69,56),new aa(58,64,56),new aa(60,51,64),new aa(66,60,64),new aa(65,63,59),new aa(57,65,59),new aa(71,66,68),new aa(62,71,68),new aa(67,60,66),new aa(71,67,66),new aa(57,59,53),new aa(49,57,53),new aa(59,62,70),new aa(53,59,70),new aa(68,58,55),new aa(61,68,55),new aa(62,68,61),new aa(70,62,61),new aa(76,58,68),new aa(74,76,68),new aa(73,64,58),new aa(76,73,58),new aa(78,66,64),new aa(73,78,64),new aa(74,68,66),new aa(78,74,66),new aa(77,59,63),new aa(75,77,63),new aa(72,71,62),new aa(79,72,62),new aa(75,63,71),new aa(72,75,71),new aa(79,62,59),new aa(77,79,59),new aa(80,72,79),new aa(83,80,79),new aa(81,75,72),new aa(80,81,72),new aa(82,77,75),new aa(81,82,75),new aa(83,79,77),new aa(82,83,77),new aa(86,76,74),new aa(85,86,74),new aa(85,74,78),new aa(87,85,78),new aa(84,73,76),new aa(86,84,76),new aa(87,78,73),new aa(84,87,73),new aa(90,82,81),new aa(89,90,81),new aa(95,87,84),new aa(92,95,84),new aa(91,83,82),new aa(90,91,82),new aa(94,86,85),new aa(93,94,85),new aa(89,81,80),new aa(88,89,80),new aa(92,84,86),new aa(94,92,86),new aa(88,80,83),new aa(91,88,83),new aa(93,85,87),new aa(95,93,87),new aa(58,68,66),new aa(64,58,66),new aa(63,71,62),new aa(59,63,62),new aa(21,2,50),new aa(69,21,50),new aa(69,56,8),new aa(21,69,8),new aa(56,54,6),new aa(8,56,6),new aa(7,6,54),new aa(55,7,54),new aa(13,7,55),new aa(61,13,55),new aa(22,13,61),new aa(70,22,61),new aa(70,53,5),new aa(22,70,5),new aa(53,49,1),new aa(5,53,1),new aa(9,1,49),new aa(57,9,49),new aa(17,9,57),new aa(65,17,57),new aa(65,48,0),new aa(17,65,0),new aa(4,0,48),new aa(52,4,48),new aa(19,4,52),new aa(67,19,52),new aa(67,60,12),new aa(19,67,12),new aa(60,51,3),new aa(12,60,3),new aa(51,50,2),new aa(3,51,2)],V=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187],f=[74,75,152,153],s=0;for(s=0;s<V.length;s++)F[V[s]].materialIndex=this.__doorMaterialId;for(s=0;s<f.length;s++)F[f[s]].materialIndex=this.__glassMaterialId;return{vertices:a,faces:F,widthFactor:i,depth:r,side:o}}}]),e}();var Q$={1:yj,2:b$,3:l$,4:v$,5:F$,6:P$};var R$=function(){function r(){zZ(this,r)}return AZ(r,null,[{key:"getClass",value:function(r){return Q$[r]}}]),r}();var S$="DOOR";var T$="WINDOW";var U$="CABINET";var V$="SHELVES";var cf=Pn.d(S$,T$,U$,V$);var W$={DOOR:R$};var X$=function(){function t(){xZ(this,t)}return yZ(t,null,[{key:"getParametricClass",value:function(t){var r=W$[t];if(void 0!==r)return r;throw new Error("Unimplemented parametric class error")}}]),t}();var _l=new ba(0,1,0);var am=function(t){sZ(i,Qa);var e=uZ(i);function i(t,a,r){var o;return qZ(this,i),(o=e.call(this)).__id=r||va.guide(),o.__metadata=t,o.__model=a,o.__position2d=new ca,o.__position=new ba,o.__rotation=new ba,o.__scale=new ba(1,1,1),o.__size=new ba(1,1,1),o.__halfSize=new ba(1,1,1),o.__customIntersectionPlanes=[],o.__hover=!1,o.__selected=!1,o.__freePosition=!0,o.__boundToFloor=!1,o.__allowRotate=!0,o.__fixed=!1,o.__resizable=!1,o.__frontVisible=!1,o.__backVisible=!1,o.__visible=!0,o.__offlineUpdate=!1,o.__isParametric=!1,o.__baseParametricType=cf.DOOR,o.__subParametricType=1,o.__parametricClass=null,o.__currentWall=null,o.__currentFloor=null,o.__currentWallNormal=null,o.__currentWallSnapPoint=null,o.__isWallDependent=!1,o.__followWallEvent=o.__followWall.bind(xp(o)),o.__edgeDeletedEvent=o.__edgeDeleted.bind(xp(o)),o.__parametricGeometryUpdateEvent=o.__parametricGeometryUpdate.bind(xp(o)),o.castShadow=!1,o.receiveShadow=!1,o.__initializeMetaData(),o}return rZ(i,[{key:"__initializeMetaData",value:function(){if(this.__fixed=!this.__metadata.fixed||this.__metadata.fixed,this.__resizable=!this.__metadata.resizable||this.__metadata.resizable,this.__metadata.position.length&&(this.__position=new ba().fromArray(this.__metadata.position).clone()),this.__metadata.rotation.length&&(this.__rotation=new ba().fromArray(this.__metadata.rotation).clone()),this.__metadata.scale.length&&(this.__scale=new ba().fromArray(this.__metadata.scale).clone()),this.__metadata.size.length&&(this.__size=new ba().fromArray(this.__metadata.size).clone(),this.__halfSize=this.__size.clone().multiplyScalar(.5)),this.__metadata.isParametric){switch(this.__isParametric=this.__metadata.isParametric,this.__metadata.baseParametricType){case cf.DOOR.description:this.__baseParametricType=cf.DOOR;break;case cf.WINDOW.description:this.__baseParametricType=cf.WINDOW;break;case cf.CABINET.description:this.__baseParametricType=cf.CABINET;break;case cf.SHELVES.description:this.__baseParametricType=cf.SHELVES;}this.__subParametricData=this.__metadata.subParametricData;var t=X$.getParametricClass(this.__baseParametricType.description);this.__parametricClass=new(t.getClass(this.__subParametricData.type))(this.__subParametricData),this.__parametricClass.addEventListener(tp,this.__parametricGeometryUpdateEvent)}else this.__isParametric=!1;if(this.__metadata.wall)for(var e=this.__model.floorplan.walls,i=0;i<e.length;i++){var a=e[i];if(a.id===this.__metadata.wall){var r="front"===this.__metadata.wallSide?a.frontEdge:a.backEdge,o=this.__metadata.wallSurfacePoint;this.__currentWallSnapPoint=new ba(o[0],o[1],o[2]),this.__addToAWall(a,r);break}}}},{key:"__parametricGeometryUpdate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.__parametricClass.geometry.boundingBox;if(this.__size=i.getSize(new ba),this.__halfSize=this.__size.clone().multiplyScalar(.5),this.__currentWall&&e){var a=va.cartesianFromBarycenter(this.__currentWallEdge.vertices,this.__barycentricLocation);this.snapToWall(a,this.__currentWall,this.__currentWallEdge)}}},{key:"__edgeDeleted",value:function(t){if(this.__currentWall){var e="front"===this.__metadata.wallSide?this.__currentWall.frontEdge:this.__currentWall.backEdge;this.__currentWallEdge=null;var i=va.cartesianFromBarycenter(e.vertices,this.__barycentricLocation);this.snapToWall(i,this.__currentWall,e)}}},{key:"__followWall",value:function(t){if(this.__isWallDependent&&this.__currentWall&&!this.__offlineUpdate){var e=va.cartesianFromBarycenter(this.__currentWallEdge.vertices,this.__barycentricLocation);this.snapToWall(e,this.__currentWall,this.__currentWallEdge)}}},{key:"__addToAWall",value:function(t,e){if(void 0!==t&&t&&"undefined"!==t){this.__currentWall&&this.__currentWall!==t&&(this.__currentWall.removeEventListener(Va,this.__followWallEvent),this.__currentWallEdge.removeEventListener(rb,this.__edgeDeletedEvent),this.__currentWall.removeItem(this));var i=va.barycentricFromCartesian(e.vertices,this.__currentWallSnapPoint);this.__currentWall=t,this.__currentWallEdge=e,this.__barycentricLocation=i.clone(),this.__metadata.wall=this.__currentWall.id,this.__metadata.wallSide=e.front?"front":"back",this.__metadata.wallSurfacePoint=[this.__currentWallSnapPoint.x,this.__currentWallSnapPoint.y,this.__currentWallSnapPoint.z],this.__offlineUpdate=!0,this.__currentWall.addItem(this),this.__offlineUpdate=!1,this.__currentWall.hasEventListener(Va,this.__followWallEvent)||(this.__currentWall.addEventListener(Va,this.__followWallEvent),this.__currentWallEdge.addEventListener(rb,this.__edgeDeletedEvent))}}},{key:"__moveToPosition",value:function(){}},{key:"__getMetaData",value:function(){return{id:this.id,itemName:this.metadata.itemName,itemType:this.metadata.itemType,modelURL:this.metadata.modelUrl,position:this.position.toArray(),rotation:this.rotation.toArray(),scale:this.scale.toArray(),size:this.size.toArray(),fixed:this.__fixed,resizable:this.__resizable}}},{key:"__metaDataUpdate",value:function(t){this.dispatchEvent({type:Fd,property:t})}},{key:"updateMetadataExplicit",value:function(){this.__metadata=this.__getMetaData()}},{key:"snapToPoint",value:function(t,e,i,a,r,o){this.position=t}},{key:"snapToWall",value:function(t,e,i){}},{key:"newWallEdge",value:function(){var t="front"===this.__metadata.wallSide?this.__currentWall.frontEdge:this.__currentWall.backEdge;this.__currentWallEdge=null,this.__currentWallEdge=t}},{key:"dispose",value:function(){this.isParametric&&this.__parametricClass&&this.__parametricClass.removeEventListener(tp,this.__parametricGeometryUpdateEvent),this.__currentWall&&this.__currentWall.removeEventListener(Va,this.__followWallEvent),this.__currentWallEdge&&this.__currentWallEdge.removeEventListener(rb,this.__edgeDeletedEvent)}},{key:"id",get:function(){return this.__id}},{key:"metadata",get:function(){return this.isParametric&&(this.__metadata.subParametricData=this.__parametricClass.metadata),this.__metadata},set:function(t){this.__metadata=t,this.__applyMetaData()}},{key:"position2d",get:function(){return this.__position2d}},{key:"position",get:function(){return this.__position},set:function(t){this.__position2d.x=t.x,this.__position2d.y=t.z,this.__position.copy(t),this.__metadata.position=this.__position.toArray(),this.__moveToPosition(),this.__metaDataUpdate("position")}},{key:"rotation",get:function(){return this.__rotation},set:function(t){var e=this.__rotation.clone(),i=t.clone();e.sub(i).length()<1e-4||(this.__rotation.copy(t),this.__metadata.rotation=this.__rotation.toArray(),this.__metaDataUpdate("rotation"))}},{key:"scale",get:function(){return this.__scale},set:function(t){this.__scale.copy(t),this.__metadata.scale=this.__scale.toArray(),this.__metaDataUpdate("scale")}},{key:"size",get:function(){return this.__size.clone()}},{key:"modelURL",get:function(){return this.__metadata.modelURL},set:function(t){this.__metadata.modelURL=t,this.__metaDataUpdate("modelURL")}},{key:"fixed",get:function(){return this.__fixed},set:function(t){this.__fixed=t,this.__metaDataUpdate("fixed")}},{key:"frontVisible",get:function(){return this.__frontVisible},set:function(t){this.__frontVisible=t}},{key:"backVisible",get:function(){return this.__backVisible},set:function(t){this.__backVisible=t}},{key:"visible",get:function(){return this.__visible},set:function(t){this.__visible=t,this.__metaDataUpdate("visible")}},{key:"isParametric",get:function(){return this.__isParametric}},{key:"baseParametricType",get:function(){return this.__baseParametricType}},{key:"subParametricData",get:function(){return this.__subParametricData}},{key:"parametricClass",get:function(){return this.__parametricClass}},{key:"resizable",get:function(){return this.__resizable}},{key:"itemName",get:function(){return this.__metadata.itemName}},{key:"itemType",get:function(){return this.__metadata.itemType}},{key:"halfSize",get:function(){return this.__halfSize.clone()}},{key:"intersectionPlanes",get:function(){return this.__customIntersectionPlanes}},{key:"isWallDependent",get:function(){return this.__isWallDependent}},{key:"offlineUpdate",get:function(){return this.__offlineUpdate}},{key:"wallSide",get:function(){return this.__metadata.wallSide}}]),i}();var bm=function(t){jZ(e,am);var n=lZ(e);function e(t,r,o){var a;return gZ(this,e),(a=n.call(this,t,r,o)).__isWallDependent=!0,a.__boundToFloor=!1,a.__allowRotate=!1,a.__freePosition=!1,a.__customIntersectionPlanes=a.__model.floorplan.wallPlanesForIntersection,a}return hZ(e,[{key:"__fitToWallBounds",value:function(t,n){var e=new ca(t.x,t.z),r=n.interiorEnd().clone().sub(n.interiorStart()),o=this.__halfSize.x+5,a=r.clone().normalize().multiplyScalar(o),i=e.clone().sub(a),l=e.clone().add(a).sub(n.interiorStart()),$=i.sub(n.interiorEnd());if(l.length()>r.length()){var c=n.interiorEnd().clone().sub(a);return new ba(c.x,t.y,c.y)}if($.length()>r.length()){var s=n.interiorStart().clone().add(a);return new ba(s.x,t.y,s.y)}return t}},{key:"snapToPoint",value:function(t,n,e,r,o,a){this.snapToWall(t,e.wall,e.edge)}},{key:"snapToWall",value:function(t,n,r){AC($l(e.prototype),"snapToWall",this).call(this,t,n,r),t=this.__fitToWallBounds(t,r);var o=r.normal,a=new ca(o.x,o.z),i=va.angle(_l,a);this.__currentWallNormal=o.clone(),this.__currentWallSnapPoint=t.clone(),t=t.clone().add(o.clone().multiplyScalar(this.halfSize.z+.25*n.thickness)),this.position=t,this.rotation=new ba(0,i,0),this.__addToAWall(n,r)}},{key:"__parametricGeometryUpdate",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(AC($l(e.prototype),"__parametricGeometryUpdate",this).call(this,t,!1),this.__currentWall&&n){var r=this.__currentWallSnapPoint.clone();r=r.clone().add(this.__currentWallNormal.clone().multiplyScalar(this.halfSize.z+.25*this.__currentWall.thickness)),this.position=r,this.__currentWall.addItem(this)}}}]),e}();var yp=function(t){_Y(o,bm);var e=bZ(o);function o(t,r,n){var l;return ZY(this,o),(l=e.call(this,t,r,n)).__customIntersectionPlanes=l.__model.floorplan.wallPlanesForIntersection,l}return $Y(o,[{key:"snapToPoint",value:function(t,e,o,r,n,l){this.snapToWall(t,o.wall,o.edge)}},{key:"snapToWall",value:function(t,e,o){t=this.__fitToWallBounds(t,o);var r=o.normal,n=new ca(r.x,r.z),l=va.angle(_l,n);this.rotation=new ba(0,l,0),this.position=t,this.__currentWallSnapPoint=t.clone(),this.__addToAWall(e,o)}}]),o}();function Y$(t){return(Y$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z$(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TC(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function $$(t,e,r){return e&&TC(t.prototype,e),r&&TC(t,r),t}function _$(t,e,r){return(_$="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=a_(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function a_(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zp(t)););return t}function b_(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c_(t,e)}function c_(t,e){return(c_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d_(t){var e=g_();return function(){var r,o=zp(t);if(e){var n=zp(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return e_(this,r)}}function e_(t,e){return!e||"object"!==Y$(e)&&"function"!=typeof e?f_(t):e}function f_(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g_(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function zp(t){return(zp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ap=function(t){b_(r,yp);var e=d_(r);function r(t,o,n){var a;return Z$(this,r),(a=e.call(this,t,o,n)).__customIntersectionPlanes=a.__model.floorplan.wallPlanesForIntersection,a}return $$(r,[{key:"snapToPoint",value:function(t,e,r,o,n,a){this.snapToWall(t,r.wall,r.edge)}},{key:"snapToWall",value:function(t,e,r){t=this.__fitToWallBounds(t,r);var o=r.normal,n=new ca(o.x,o.z),a=va.angle(_l,n);this.rotation=new ba(0,a,0),t.y=this.halfSize.y+5,this.position=t,this.__currentWallSnapPoint=t.clone(),this.__currentWallNormal=o.clone(),this.__addToAWall(e,r)}},{key:"__parametricGeometryUpdate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(_$(zp(r.prototype),"__parametricGeometryUpdate",this).call(this,t,!1),this.__currentWall&&e){var o=this.position.clone();o.y=this.halfSize.y+5,this.position=o,this.__currentWall.addItem(this)}}}]),r}();function h_(t){return(h_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i_(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UC(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function j_(t,e,r){return e&&UC(t.prototype,e),r&&UC(t,r),t}function k_(t,e,r){return(k_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=l_(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function l_(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bp(t)););return t}function m_(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n_(t,e)}function n_(t,e){return(n_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o_(t){var e=r_();return function(){var r,o=Bp(t);if(e){var n=Bp(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return p_(this,r)}}function p_(t,e){return!e||"object"!==h_(e)&&"function"!=typeof e?q_(t):e}function q_(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r_(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Bp(t){return(Bp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ut=function(t){m_(r,bm);var e=o_(r);function r(t,o,n){var a;return i_(this,r),(a=e.call(this,t,o,n)).__boundToFloor=!0,a.__customIntersectionPlanes=a.__model.floorplan.wallPlanesForIntersection,a}return j_(r,[{key:"snapToPoint",value:function(t,e,r,o,n,a){this.snapToWall(t,r.wall,r.edge)}},{key:"snapToWall",value:function(t,e,r){t=this.__fitToWallBounds(t,r);var o=r.normal,n=new ca(o.x,o.z),a=va.angle(_l,n);this.__currentWallNormal=o.clone(),this.__currentWallSnapPoint=t.clone(),(t=t.clone().add(o.clone().multiplyScalar(this.halfSize.z+.25*e.thickness))).y=this.halfSize.y+5,this.rotation=new ba(0,a,0),this.position=t,this.__addToAWall(e,r)}},{key:"__parametricGeometryUpdate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(k_(Bp(r.prototype),"__parametricGeometryUpdate",this).call(this,t,!1),this.__currentWall&&e){var o=this.__currentWallSnapPoint.clone();(o=o.clone().add(this.__currentWallNormal.clone().multiplyScalar(this.halfSize.z+.25*this.__currentWall.thickness))).y=this.halfSize.y+5,this.position=o,this.__currentWall.addItem(this)}}}]),r}();var s_=new ba(0,0,1),Vt=function(t){DY(i,Qa);var e=FY(i);function i(t,n,o,r){var a;BY(this,i),(a=e.call(this)).start=t,a.end=n,a.name="wall",a._walltype=o||r?za.CURVED:za.STRAIGHT;var s=new ca(0,0),l=n.location.clone().sub(t.location).multiplyScalar(.5),c=l.clone().rotateAround(s,.75*Math.PI),d=l.clone().rotateAround(s,.25*Math.PI);var $CHVU$$interop$default=Wc(IY);return o?(a._a=new ca(0,0),a._a.x=o.x,a._a.y=o.y):a._a=t.location.clone().add(d),r?(a._b=new ca(0,0),a._b.x=r.x,a._b.y=r.y):a._b=n.location.clone().add(c),a._a_vector=a._a.clone().sub(t.location),a._b_vector=a._b.clone().sub(t.location),a._bezier=new $CHVU$$interop$default.d(t.location.x,t.location.y,a._a.x,a._a.y,a._b.x,a._b.y,n.location.x,n.location.y),a.id=a.getUuid(),a.start.attachStart(xj(a)),a.end.attachEnd(xj(a)),a.__frontEdge=null,a.__backEdge=null,a.__attachedRooms=[],a.orphan=!1,a.items=[],a.onItems=[],a.__onWallItems=[],a.__inWallItems=[],a.__onWallItemsSnappedRatios=[],a.__inWallItemsSnappedRatios=[],a.frontTexture=ri,a.backTexture=ri,a._thickness=ha.getNumericValue(ZB),a.height=ha.getNumericValue(up),a.moved_callbacks=null,a.deleted_callbacks=null,a.action_callbacks=null,a.__isLocked=!1,a.__location=new ca,a.__wallPlane2D=new xc,a.__wallNormal2D=new ca,a.__cornerMovedEvent=a.__cornerMoved.bind(xj(a)),a.__cornerAttributesChangedEvent=a.__cornerAttributesChanged.bind(xj(a)),a.__cornerDeletedEvent=a.__cornerDeleted.bind(xj(a)),a.addCornerMoveListener(a.start),a.addCornerMoveListener(a.end),a}return CY(i,[{key:"__updateItemPositions",value:function(){}},{key:"__cornerMoved",value:function(){this.updateControlVectors(),this.dispatchEvent({type:Va,item:this,position:null})}},{key:"__cornerAttributesChanged",value:function(){this.__updateItemPositions(),this.dispatchEvent({type:Va,item:this,position:null})}},{key:"__cornerDeleted",value:function(t){this.addCornerMoveListener(t.item,!0),this.remove()}},{key:"addItem",value:function(t){(t instanceof yp||t instanceof Ap)&&(va.hasValue(this.__inWallItems,t)||this.__inWallItems.push(t),this.dispatchEvent({type:Va,item:this,position:null})),(t instanceof bm||t instanceof Ut)&&(va.hasValue(this.__onWallItems,t)||this.__onWallItems.push(t),this.dispatchEvent({type:Va,item:this,position:null}))}},{key:"removeItem",value:function(t){(t instanceof yp||t instanceof Ap)&&(va.hasValue(this.__inWallItems,t)&&va.removeValue(this.__inWallItems,t),this.dispatchEvent({type:Va,item:this,position:null})),(t instanceof bm||t instanceof Ut)&&(va.hasValue(this.__onWallItems,t)&&va.removeValue(this.__onWallItems,t),this.dispatchEvent({type:Va,item:this,position:null}))}},{key:"addCornerMoveListener",value:function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return t.removeEventListener(Va,this.__cornerMovedEvent),t.removeEventListener(kg,this.__cornerAttributesChangedEvent),void t.removeEventListener(rb,this.__cornerDeletedEvent);t.addEventListener(Va,this.__cornerMovedEvent),t.addEventListener(kg,this.__cornerAttributesChangedEvent),t.addEventListener(rb,this.__cornerDeletedEvent)}},{key:"projectOnWallPlane",value:function(t){var e=new ba;return e=this.__wallPlane2D.projectPoint(new ba(t.x,t.y,0),e),new ca(e.x,e.y)}},{key:"updateControlVectors",value:function(){var t=this.start.location.clone(),e=this.end.location.clone().clone().sub(t.clone()),i=e.clone().multiplyScalar(.5),n=t.clone().add(i);this.__location=n.clone();var o=new ba(e.x,e.y,0),r=o.clone().normalize().cross(s_);this.__wallPlane2D=this.__wallPlane2D.setFromNormalAndCoplanarPoint(r,new ba(n.x,n.y,0)),this.__wallNormal2D.x=o.x,this.__wallNormal2D.y=o.y,this._bezier.points[0].x=this.start.location.x,this._bezier.points[0].y=this.start.location.y,this._bezier.points[1].x=this.a.x,this._bezier.points[1].y=this.a.y,this._bezier.points[2].x=this.b.x,this._bezier.points[2].y=this.b.y,this._bezier.points[3].x=this.end.location.x,this._bezier.points[3].y=this.end.location.y,this._bezier.update(),(this.getStart()||this.getEnd())&&(null!=this.getStart()?this.getStart().floorplan.update(!1):null!=this.getEnd()&&this.getEnd().floorplan.update(!1))}},{key:"getUuid",value:function(){return[this.start.id,this.end.id].join()}},{key:"resetFrontBack",value:function(){this.frontEdge&&this.frontEdge.destroy(),this.backEdge&&this.backEdge.destroy(),this.frontEdge=null,this.backEdge=null,this.orphan=!1,this.__attachedRooms=[]}},{key:"snapToAxis",value:function(t){this.start.snapToAxis(t),this.end.snapToAxis(t)}},{key:"fireOnMove",value:function(t){this.moved_callbacks.add(t)}},{key:"fireOnDelete",value:function(t){this.deleted_callbacks.add(t)}},{key:"dontFireOnDelete",value:function(t){this.deleted_callbacks.remove(t)}},{key:"fireOnAction",value:function(t){this.action_callbacks.add(t)}},{key:"fireAction",value:function(t){this.dispatchEvent({type:TB,action:t})}},{key:"move",value:function(t,e){var i=t-.5*(this.start.location.x+this.end.location.x),n=e-.5*(this.start.location.y+this.end.location.y);this.relativeMove(i,n)}},{key:"relativeMove",value:function(t,e,i){i?i.relativeMove(t,e):(this.start.relativeMove(t,e),this.end.relativeMove(t,e)),this.updateControlVectors()}},{key:"fireMoved",value:function(){this.dispatchEvent({type:Va,item:this,position:null})}},{key:"fireRedraw",value:function(){this.frontEdge&&this.frontEdge.dispatchRedrawEvent(),this.backEdge&&this.backEdge.dispatchRedrawEvent()}},{key:"getStart",value:function(){return this.start}},{key:"getEnd",value:function(){return this.end}},{key:"getStartX",value:function(){return this.start.getX()}},{key:"getEndX",value:function(){return this.end.getX()}},{key:"getStartY",value:function(){return this.start.getY()}},{key:"getEndY",value:function(){return this.end.getY()}},{key:"wallDirection",value:function(){return this.end.location.clone().sub(this.start.location)}},{key:"wallDirectionNormalized",value:function(){return this.wallDirection().normalize()}},{key:"wallDirection3",value:function(){var t=this.wallDirection();return new ba(t.x,t.y,0)}},{key:"wallDirectionNormalized3",value:function(){return this.wallDirection3().normalize()}},{key:"wallLength",value:function(){if(this.wallType===za.STRAIGHT){var t=this.getStart(),e=this.getEnd();return va.distance(t,e)}return this.wallType===za.CURVED?this._bezier.length():-1}},{key:"wallCenter",value:function(){if(this.wallType===za.STRAIGHT)return new ca((this.getStart().x+this.getEnd().x)/2,(this.getStart().y+this.getEnd().y)/2);if(this.wallType===za.CURVED){var t=this._bezier.get(.5);return new ca(t.x,t.y)}return new ca(0,0)}},{key:"remove",value:function(){this.start.detachWall(this),this.end.detachWall(this),this.addCornerMoveListener(this.start,!0),this.addCornerMoveListener(this.end,!0),this.dispatchEvent({type:rb,item:this})}},{key:"setStart",value:function(t){this.start.detachWall(this),this.addCornerMoveListener(this.start,!0),t.attachStart(this),this.start=t,this.addCornerMoveListener(this.start),this.fireMoved()}},{key:"setEnd",value:function(t){this.end.detachWall(this),this.addCornerMoveListener(this.end),t.attachEnd(this),this.end=t,this.addCornerMoveListener(this.end,!0),this.fireMoved()}},{key:"distanceFrom",value:function(t){if(this.wallType===za.STRAIGHT)return va.pointDistanceFromLine(t,new ca(this.getStartX(),this.getStartY()),new ca(this.getEndX(),this.getEndY()));if(this.wallType===za.CURVED){var e=this._bezier.project(t);return new ca(e.x,e.y).distanceTo(t)}return-1}},{key:"oppositeCorner",value:function(t){return this.start===t?this.end:this.end===t?this.start:(console.log("Wall does not connect to corner"),null)}},{key:"getClosestCorner",value:function(t){var e=new ca(this.start.x,this.start.y),i=new ca(this.end.x,this.end.y),n=t.distanceTo(e),o=t.distanceTo(i);return n<=2*this.thickness?this.start:o<=2*this.thickness?this.end:null}},{key:"updateAttachedRooms",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null!=this.start&&this.start.updateAttachedRooms(t),this.end&&this.end.updateAttachedRooms(t)}},{key:"addRoom",value:function(t){this.__attachedRooms.push(t)}},{key:"clearAttachedRooms",value:function(){this.__attachedRooms=[]}},{key:"isLocked",set:function(t){this.__isLocked=t},get:function(){return this.__isLocked}},{key:"wallSize",set:function(t){if(this.wallType===za.STRAIGHT){var e,i,n,o,r=this.getEnd().location.clone().sub(this.getStart().location),a=t/this.wallLength(),s=1===this.getStart().adjacentCorners().length,l=1===this.getEnd().adjacentCorners().length;e=a-1,!s&&!l||s&&l?(e*=.5,n=(i=r.clone().multiplyScalar(e)).clone().multiplyScalar(-1).add(this.getStart().location),o=i.clone().add(this.getEnd().location)):s?(n=(i=r.clone().multiplyScalar(e)).clone().multiplyScalar(-1).add(this.getStart().location),o=this.getEnd().location):l&&(o=(i=r.clone().multiplyScalar(e)).clone().add(this.getEnd().location),n=this.getStart().location),this.getStart().move(n.x,n.y),this.getEnd().move(o.x,o.y),this.updateAttachedRooms()}},get:function(){return this.wallLength()}},{key:"onWallItems",get:function(){return this.__onWallItems}},{key:"inWallItems",get:function(){return this.__inWallItems}},{key:"attachedRooms",get:function(){return this.__attachedRooms}},{key:"thickness",get:function(){return this._thickness},set:function(t){this._thickness=t,this.start.move(this.start.location.x,this.start.location.y),this.end.move(this.end.location.x,this.end.location.y)}},{key:"uuid",get:function(){return this.getUuid()}},{key:"a",get:function(){return this._a},set:function(t){this._a.x=t.x,this._a.y=t.y,this._a_vector=this._a.clone().sub(this.start.location),this.updateControlVectors()}},{key:"b",get:function(){return this._b},set:function(t){this._b.x=t.x,this._b.y=t.y,this._b_vector=this._b.clone().sub(this.start.location),this.updateControlVectors()}},{key:"aVector",get:function(){return this._a_vector.clone()}},{key:"bVector",get:function(){return this._b_vector.clone()}},{key:"bezier",get:function(){return this._bezier}},{key:"wallType",get:function(){return this._walltype},set:function(t){t!==za.STRAIGHT&&t!==za.CURVED||(this._walltype=t),this.updateControlVectors(),this.updateAttachedRooms(!0)}},{key:"startElevation",get:function(){return this.start&&null!=this.start?this.start.elevation:0}},{key:"endElevation",get:function(){return this.end&&null!=this.end?this.end.elevation:0}},{key:"location",get:function(){return this.__location},set:function(t){var e=this.start.location.clone(),i=this.end.location.clone(),n=i.clone().sub(e),o=e.clone().add(n.clone().multiplyScalar(.5)),r=e.clone().sub(o),a=i.clone().sub(o),s=t.clone().add(r),l=t.clone().add(a);this.start.move(s.x,s.y),this.end.move(l.x,l.y),this.__location=t}},{key:"frontEdge",get:function(){return this.__frontEdge},set:function(t){this.__frontEdge&&this.__frontEdge.destroy(),this.__frontEdge=t,this.__inWallItems.forEach(function(t){t.newWallEdge()}),this.__onWallItems.forEach(function(t){t.newWallEdge()})}},{key:"backEdge",get:function(){return this.__backEdge},set:function(t){this.__backEdge&&this.__backEdge.destroy(),this.__backEdge=t,this.__inWallItems.forEach(function(t){t.newWallEdge()}),this.__onWallItems.forEach(function(t){t.newWallEdge()})}}]),i}();function t_(e){return(t_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VC(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function v_(e,t,r){return t&&VC(e.prototype,t),r&&VC(e,r),e}function w_(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x_(e,t)}function x_(e,t){return(x_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y_(e){var t=A_();return function(){var r,o=WC(e);if(t){var n=WC(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return z_(this,r)}}function z_(e,t){return!t||"object"!==t_(t)&&"function"!=typeof t?Cp(e):t}function Cp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A_(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function WC(e){return(WC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Dp=function(e){w_(r,Qa);var t=y_(r);function r(e,o){var n;u_(this,r),(n=t.call(this))._name="A New Room",n.min=null,n.max=null,n.center=null,n.area=0,n.areaCenter=null,n._polygonPoints=[],n.__walls=[],n.floorplan=e,n._corners=o,n.interiorCorners=[],n.interiorCorners3D=[],n.floorRectangleSize=new ca,n.edgePointer=null,n.floorPlane=null,n.roofPlane=null,n.customTexture=!1,n.floorChangeCallbacks=null,n.__destroyed=!1,n.__isLocked=!1,n.updateWalls(),n.updateInteriorCorners(),n.generateFloorPlane(),n.generateRoofPlane();var i=[],a=0;for(n.__roomUpdatedEvent=n._roomUpdated.bind(Cp(n)),n.__wallsChangedEvent=n.__wallsChanged.bind(Cp(n));a<n.corners.length;a++){var s=n.corners[a];s.attachRoom(Cp(n)),i.push(s.id),s.addEventListener(Va,n.__roomUpdatedEvent),s.addEventListener(kg,n.__roomUpdatedEvent)}for(a=0;a<n.__walls.length;a++){n.__walls[a].addEventListener(Fd,n.__wallsChangedEvent)}return n._roomByCornersId=i.join(","),n}return v_(r,[{key:"__wallsChanged",value:function(e){this.updateInteriorCorners(),this.dispatchEvent({type:gd,item:this})}},{key:"_roomUpdated",value:function(){this.updateInteriorCorners(),this.updateArea(),this.generateFloorPlane(),this.generateRoofPlane()}},{key:"destroy",value:function(){for(var e=0;e<this.corners.length;e++){this.corners[e].removeEventListener(Va,this.__roomUpdatedEvent)}for(e=0;e<this.__walls.length;e++){this.__walls[e].removeEventListener(Fd,this.__wallsChangedEvent)}this.__destroyed=!0,this.dispatchEvent({type:gd,item:this})}},{key:"__getOrderedCorners",value:function(e){var t=this.corners.indexOf(e.start),r=this.corners.indexOf(e.end);if(-1===t||-1===r)return null;var o=this.corners[Math.max(t,r)].location.clone(),n=this.corners[Math.min(t,r)].location.clone();return(0===t&&r===this.corners.length-1||0===r&&t===this.corners.length-1)&&(n=this.corners[this.corners.length-1].location.clone(),o=this.corners[0].location.clone()),{start:o,end:n}}},{key:"getWallDirection",value:function(e){var t=this.__getOrderedCorners(e);if(null===t)return null;var r=t.start,o=t.end.sub(r);return new ba(o.x,o.y,0).normalize().clone()}},{key:"getWallOutDirection",value:function(e){var t=this.getWallDirection(e);return null===t?null:(t=t.applyAxisAngle(new ba(0,0,1),.5*Math.PI)).normalize()}},{key:"getWallStart",value:function(e){var t=this.__getOrderedCorners(e);return null===t?null:t.start}},{key:"getWallEnd",value:function(e){var t=this.__getOrderedCorners(e);return null===t?null:t.end}},{key:"getWallPlane",value:function(e){if(null===this.__getOrderedCorners(e))return null;var t=e.start.location.clone().add(e.end.location).multiplyScalar(.5),r=this.getWallOutDirection(e),o=new xc(r,0);return new fa().makeTranslation(t.x,t.y,0),o.setFromNormalAndCoplanarPoint(r,new ba(t.x,t.y,0)),o}},{key:"roomIdentifier",value:function(){var e=[];return this.corners.forEach(function(t){e.push(t.id)}),e.join(",")}},{key:"getUuid",value:function(){var e=va.map(this.corners,function(e){return e.id});return e.sort(),e.join()}},{key:"fireOnFloorChange",value:function(e){this.floorChangeCallbacks.add(e)}},{key:"setRoomWallsTexture",value:function(e,t,r){var o=this.edgePointer;for(o.setTexture(e,t,r);o.next!==this.edgePointer;)(o=o.next).setTexture(e,t,r)}},{key:"getTexture",value:function(){var e=this.getUuid(),t=this.floorplan.getFloorTexture(e);return t||this.floorplan.setFloorTexture(e,uz),t||uz}},{key:"setTexture",value:function(e,t,r){var o=this.getUuid();this.floorplan.setFloorTexture(o,e,r),this.dispatchEvent({type:gd,item:this})}},{key:"setRoomWallsTextureMaps",value:function(e){var t=this.edgePointer;for(e.color||(e.color="#FFFFFF"),e.repeat||(e.repeat=Yg),t.setTextureMaps(e);t.next!==this.edgePointer;)(t=t.next).setTextureMaps(e)}},{key:"setTextureMaps",value:function(e){var t=this.getUuid();e.color||(e.color="#FFFFFF"),e.repeat||(e.repeat=Yg),this.floorplan.setFloorTexture(t,e),this.dispatchEvent({type:sj,item:this})}},{key:"generateRoofPlane",value:function(){var e=new oa;this.corners.forEach(function(t){var r=new ba(t.location.x,t.elevation,t.location.y);e.vertices.push(r)});for(var t=2;t<e.vertices.length;t++){var r=new aa(0,t-1,t);e.faces.push(r)}if(this.roofPlane)this.roofPlane.geometry.dispose(),this.roofPlane.geometry=new ia().fromGeometry(e);else{var o=new ia().fromGeometry(e);this.roofPlane=new Aa(o,new kb({side:Pb,visible:!1}))}this.roofPlane.geometry.computeBoundingBox(),this.roofPlane.geometry.computeFaceNormals(),this.roofPlane.room=this}},{key:"generateFloorPlane",value:function(){var e=[];this.interiorCorners.forEach(function(t){e.push(new ca(t.x,t.y))});var t=new Oc(e),r=new cd(t);if(this.floorPlane)this.floorPlane.geometry.dispose(),this.floorPlane.geometry=new ia().fromGeometry(r);else{var o=new ia().fromGeometry(r);this.floorPlane=new Aa(o,new kb({side:Pb,visible:!1}))}this.floorPlane.visible=!0,this.floorPlane.rotation.set(Math.PI/2,0,0),this.floorPlane.geometry.computeBoundingBox(),this.floorPlane.geometry.computeFaceNormals(),this.floorPlane.room=this;var n=new wc;n.setFromObject(this.floorPlane),this.min=n.min.clone(),this.max=n.max.clone(),this.center=this.max.clone().sub(this.min).multiplyScalar(.5).add(this.min)}},{key:"cycleIndex",value:function(e){return e<0?e+this.corners.length:e%this.corners.length}},{key:"pointInRoom",value:function(e){var t=[];return this.corners.forEach(function(e){var r=new ca(e.x,e.y);t.push(r)}),va.pointInPolygon2(e,t)}},{key:"updateInteriorCorners",value:function(){var e=new ca(Number.MAX_VALUE,Number.MAX_VALUE),t=new ca(-Number.MAX_VALUE,-Number.MAX_VALUE),r=this.edgePointer;for(this.interiorCorners=[],this.interiorCorners3D=[];;){var o=r.interiorStart(),n=r.getStart();if(e.x=Math.min(o.x,e.x),e.y=Math.min(o.y,e.y),t.x=Math.max(t.x,o.x),t.y=Math.max(t.y,o.y),this.interiorCorners.push(o),this.interiorCorners3D.push(new ba(o.x,n.elevation,o.y)),r.generatePlane(),r.next===this.edgePointer)break;r=r.next}this.floorRectangleSize=t.clone().sub(e)}},{key:"updateArea",value:function(){var e,t,r,o,n,i,a,s=this.area,l=[];for(this.areaCenter=new ca,this._polygonPoints=[],n=0;n<this.corners.length;n++)if(i=this.corners[n],t=this.corners[n],r=this.corners[(n+1)%this.corners.length],null!=(o=t.wallToOrFrom(r))){if(o.wallType===za.CURVED){var $=i.location.clone().sub(o.bezier.get(0)).length(),u=void 0,m=void 0;if(l.push(i.location.clone()),$<1e-6)for(m=1;m<20;m++)u=o.bezier.get(m/20),l.push(new ca(u.x,u.y));else for(m=19;m>0;m--)u=o.bezier.get(m/20),l.push(new ca(u.x,u.y))}else l.push(i.location.clone());}else l.push(i.location.clone());e=l,a=new eY(e),this.area=Math.abs(a.area()),this.areaCenter=a.centroid(),this._polygonPoints=e,this.generateFloorPlane(),this.generateRoofPlane(),this.dispatchEvent({type:lg,item:this,info:{from:s,to:this.area}})}},{key:"updateArea2",value:function(){var e,t,r,o,n=this,i=!1,a=this.area,s=[],l=0;this.areaCenter=new ca,this._polygonPoints=[];for(var $=0;$<this.corners.length;$++){var u=this.corners[$],m=this.corners[($+1)%this.corners.length];i|=u.wallToOrFrom(m).wallType===za.CURVED}if(!i){this.corners.forEach(function(e){var t=new ca(e.x,e.y);n.areaCenter.add(t),s.push(t)}),this.areaCenter.multiplyScalar(1/s.length);for(var h=0;h<s.length;h++)t=(h+1)%s.length,r=s[h],o=s[t],l+=r.x*o.y-r.y*o.x;return this.area=.5*Math.abs(l),this._polygonPoints=s,void this.dispatchEvent({type:lg,item:this,info:{from:a,to:this.area}})}e=this.corners.length;for(var c=0;c<this.corners.length;c++){var p=this.corners[c],f=this.corners[(c+1)%this.corners.length],v=p.wallToOrFrom(f);if(this.areaCenter.add(p.location),null!=v){if(v.wallType===za.CURVED){s.push(p.location);for(var R=v.bezier.getLUT(20),d=1;d<R.length-1;d++){var y=R[d];y=new ca(y.x,y.y),s.push(y)}}else s.push(p.location);}else s.push(p.location)}this.areaCenter.multiplyScalar(1/e);var _=va.getCyclicOrder(s,this.areaCenter);s=_.points;for(var D=0;D<s.length;D++)t=(D+1)%s.length,r=s[D],o=s[t],l+=r.x*o.y-r.y*o.x;this._polygonPoints=s,this.area=.5*Math.abs(l),this.dispatchEvent({type:lg,item:this,info:{from:a,to:this.area}})}},{key:"hasAllCornersById",value:function(e){for(var t=0,r=0;r<e.length;r++)t+=this.hasACornerById(e[r]);return t===this.corners.length}},{key:"hasACornerById",value:function(e){for(var t=0;t<this.corners.length;t++){if(this.corners[t].id===e)return 1}return 0}},{key:"updateWalls",value:function(){var e=null,t=null;this.__walls=[];for(var r=0;r<this.corners.length;r++){var o=this.corners[r],n=this.corners[(r+1)%this.corners.length],i=o.wallTo(n),a=o.wallFrom(n),s=null;i?s=new wp(this,i,!0):a?s=new wp(this,a,!1):console.log("corners arent connected by a wall, uh oh"),!this.__walls.includes(i)&&i&&(this.__walls.push(i),i.addRoom(this)),!this.__walls.includes(a)&&a&&(this.__walls.push(a),a.addRoom(this)),0===r?t=s:(s.prev=e,e.next=s,r+1===this.corners.length&&(t.prev=s,s.next=t)),e=s}this.edgePointer=t}},{key:"isLocked",set:function(e){this.__isLocked=e},get:function(){return this.__isLocked}},{key:"uuid",get:function(){return this.getUuid()}},{key:"corners",get:function(){return this._corners}},{key:"sharedWalls",get:function(){return this.__walls}},{key:"roomCornerPoints",get:function(){return this._polygonPoints}},{key:"roomByCornersId",get:function(){return this._roomByCornersId}},{key:"name",set:function(e){var t=this._name;this._name=e,this.dispatchEvent({type:lg,item:this,info:{from:t,to:this._name}})},get:function(){return this._name}}]),r}();function XC(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function YC(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function ZC(r,t,e){return t&&YC(r.prototype,t),e&&YC(r,e),r}var B_=function(){function r(t){XC(this,r),this.__corners=t,this.__size=new ca,this.__center=null,this.__currentCenter=new ca,this.__deltaTranslation=new ca,this.__radians=0,this.__originalCornerPositions=null,this.__tl=null,this.__br=null,this.__tr=null,this.__bl=null,this.__matrix=new fa,this.__cornerMovedEvent=this.__cornerMoved.bind(this),this.__addCornerListeners(),this.__update()}return ZC(r,[{key:"__cornerMoved",value:function(){}},{key:"__addCornerListeners",value:function(){for(var r=0;r<this.__corners.length;r++)this.__corners[r].addEventListener(Va,this.__cornerMovedEvent)}},{key:"__update",value:function(){this.__originalCornerPositions=[];for(var r=new ca(Number.MAX_VALUE,Number.MAX_VALUE),t=new ca(-Number.MAX_VALUE,-Number.MAX_VALUE),e=0;e<this.__corners.length;e++){var n=this.__corners[e];r.x=Math.min(r.x,n.location.x),r.y=Math.min(r.y,n.location.y),t.x=Math.max(t.x,n.location.x),t.y=Math.max(t.y,n.location.y),this.__originalCornerPositions.push(n.location.clone())}this.__minPoint=r.clone(),this.__maxPoint=t.clone(),this.__size=t.clone().sub(r),this.__size.x=Math.abs(this.__size.x),this.__size.y=Math.abs(this.__size.y),this.__center=this.__size.clone().multiplyScalar(.5).add(r),this.__currentCenter=this.__size.clone().multiplyScalar(.5).add(r),this.__matrix=this.__matrix.identity()}},{key:"__applyTransformations",value:function(r,t,e){var n=e.clone().sub(this.__center),i=new fa().makeTranslation(n.x,n.y,0),o=new fa().makeTranslation(-e.x,-e.y,0),s=new fa().makeTranslation(e.x,e.y,0),a=s.clone().multiply(new fa().makeRotationAxis(new ba(0,0,1),t)).multiply(o),_=s.clone().multiply(new fa().makeScale(r.x,r.y,1)).multiply(o),l=a.multiply(_).multiply(i),u=0;for(u=0;u<this.__corners.length;u++){var c=this.__originalCornerPositions[u].clone(),h=new ba(c.x,c.y,0);h.applyMatrix4(l),this.__corners[u].move(h.x,h.y)}}},{key:"applyTransformations",value:function(r,t,e){this.__applyTransformations(r,t,e)}},{key:"contains",value:function(r){for(var t=0;t<this.__corners.length;t++)if(r.id===this.__corners[t].id)return!0;return!1}},{key:"update",value:function(){this.__update()}},{key:"destroy",value:function(){for(var r=0;r<this.__corners.length;r++)this.__corners[r].removeEventListener(Va,this.__cornerMovedEvent);this.__corners=[]}},{key:"matrix",get:function(){return this.__matrix},set:function(r){this.__matrix=r}},{key:"corners",get:function(){return this.__corners}},{key:"size",get:function(){return this.__size.clone()}},{key:"center",get:function(){return this.__center.clone()}}]),r}();var C_=function(){function r(t){XC(this,r),this.__groups=[],this.__floorplan=t,this.createGroups()}return ZC(r,[{key:"getContainingGroup",value:function(r){for(var t=0;t<this.__groups.length;t++)if(this.__groups[t].contains(r))return this.__groups[t];return null}},{key:"createGroups",value:function(){function r(t,e){var n=t.adjacentCorners();if(!e.includes(t)){e.push(t);for(var i=0;i<n.length;i++)e=r(n[i],e)}return e}function t(r,t){for(var e=0;e<r.length;e++)if(!t.includes(r[e]))return r[e];return null}if(this.__groups.forEach(function(r){r.destroy()}),this.__groups.length=0,this.__floorplan.corners.length){var e=this.__floorplan.corners[0],n=[[]];for(n[0]=r(e,n[0]);n.flat().length!==this.__floorplan.corners.length;){var i=t(this.__floorplan.corners,n.flat());if(!i)break;var o=n.push([])-1;n[o]=r(i,n[o])}for(var s=0;s<n.length;s++){var a=new B_(n[s]);this.__groups.push(a)}}}},{key:"groups",get:function(){return this.__groups}}]),r}();var Wt=10;var D_=function(e){SX(r,Qa);var t=UX(r);function r(){var e;return QX(this,r),(e=t.call(this)).walls=[],e.corners=[],e.rooms=[],e.__externalCorners=[],e.__externalWalls=[],e.__externalRooms=[],e.__roofPlanesForIntersection=[],e.__floorPlanesForIntersection=[],e.__wallPlanesForIntersection=[],e.metaroomsdata={},e.new_wall_callbacks=[],e.new_corner_callbacks=[],e.redraw_callbacks=[],e.updated_rooms=[],e.roomLoadedCallbacks=[],e.floorTextures={},e._carbonSheet=null,e.__updatesOn=!0,e.__cornerGroups=new C_(wj(e)),e.__wallAttributesChangedEvent=e.__wallAttributesChanged.bind(wj(e)),e.__wallDeletedEvent=e.__wallDeleted.bind(wj(e)),e.__cornerAttributesChangedOrMovedEvent=e.__cornerAttributesChangedOrMoved.bind(wj(e)),e.__cornerDeletedEvent=e.__cornerDeleted.bind(wj(e)),e}return RX(r,[{key:"externalWallEdges",value:function(){var e=[];return this.__externalWalls.forEach(function(t){t.frontEdge&&e.push(t.frontEdge),t.backEdge&&e.push(t.backEdge)}),e}},{key:"wallEdges",value:function(){var e=[];return this.walls.forEach(function(t){t.frontEdge&&e.push(t.frontEdge),t.backEdge&&e.push(t.backEdge)}),e}},{key:"__wallDeleted",value:function(e){var t=e.item;t.removeEventListener(rb,this.__wallDeletedEvent),t.removeEventListener(YB,this.__wallAttributesChangedEvent),this.removeWall(t)}},{key:"__wallAttributesChanged",value:function(e){this.dispatchEvent(e)}},{key:"__cornerDeleted",value:function(e){var t=e.item;t.removeEventListener(rb,this.__cornerDeletedEvent),t.removeEventListener(kg,this.__cornerAttributesChangedOrMovedEvent),t.removeEventListener(Va,this.__cornerAttributesChangedOrMovedEvent),this.removeCorner(t),this.update(),this.dispatchEvent({type:rb,item:this})}},{key:"__cornerAttributesChangedOrMoved",value:function(e){this.dispatchEvent(e);var t=e.item.adjacentCorners();t.push(e.item),this.update(!1,t)}},{key:"createRoofPlanes",value:function(){var e=[];return this.rooms.forEach(function(t){e.push(t.roofPlane)}),e}},{key:"createFloorPlanes",value:function(){return va.map(this.rooms,function(e){return e.floorPlane})}},{key:"createWallEdgePlanes",value:function(){var e=[];return this.walls.forEach(function(t){t.frontEdge&&(e.push(t.frontEdge.plane),t.frontEdge.exteriorPlane&&e.push(t.frontEdge.exteriorPlane)),t.backEdge&&(e.push(t.backEdge.plane),t.backEdge.exteriorPlane&&e.push(t.backEdge.exteriorPlane))}),e}},{key:"fireOnNewWall",value:function(e){this.new_wall_callbacks.add(e)}},{key:"fireOnNewCorner",value:function(e){this.new_corner_callbacks.add(e)}},{key:"fireOnRedraw",value:function(e){this.redraw_callbacks.add(e)}},{key:"fireOnUpdatedRooms",value:function(e){this.updated_rooms.add(e)}},{key:"newWallsForIntersections",value:function(e,t){for(var r=!1,o=new ca(e.getX(),e.getY()),n=new ca(t.getX(),t.getY()),i={p1:o,p2:n},a=[],s=0;s<this.walls.length;s++){var $,l=this.walls[s],h={x:l.getStartX(),y:l.getStartY()},c={x:l.getEndX(),y:l.getEndY()};if(l.wallType===za.CURVED?($=l.bezier.intersects(i)).length&&($=l.bezier.get($[0])):$=va.lineLineIntersectPoint(o,n,h,c),$){var u=this.newCorner($.x,$.y);a.push(u),u.mergeWithIntersected(!1),r=!0}}return this.update(),r}},{key:"newWall",value:function(e,t,r,o){var n=new Vt(e,t,r,o);return this.walls.push(n),n.addEventListener(rb,this.__wallDeletedEvent),n.addEventListener(YB,this.__wallAttributesChangedEvent),this.dispatchEvent({type:Vl,item:this,newItem:n}),this.update(),n}},{key:"newCorner",value:function(e,t,r){for(var o=new Tt(this,e,t,r),n=0;n<this.corners.length;n++){var i=this.corners[n];if(i.distanceFromCorner(o)<Pt)return this.dispatchEvent({type:Vl,item:this,newItem:i}),i}return this.corners.push(o),o.addEventListener(rb,this.__cornerDeletedEvent),o.addEventListener(kg,this.__cornerAttributesChangedOrMovedEvent),o.addEventListener(Va,this.__cornerAttributesChangedOrMovedEvent),this.dispatchEvent({type:Vl,item:this,newItem:o}),this.update(),o}},{key:"removeWall",value:function(e){va.removeValue(this.walls,e),this.update(),this.dispatchEvent({type:rb,item:this,deleted:e,item_type:"wall"})}},{key:"removeCorner",value:function(e){va.removeValue(this.corners,e),this.update(),this.dispatchEvent({type:rb,item:this,deleted:e,item_type:"corner"})}},{key:"getWalls",value:function(){return this.walls}},{key:"getCorners",value:function(){return this.corners}},{key:"getRooms",value:function(){return this.rooms}},{key:"overlappedRoom",value:function(e,t){for(var r=0;r<this.rooms.length;r++){var o=this.rooms[r];if(o.pointInRoom(new ca(e,t)))return o}return null}},{key:"overlappedControlPoint",value:function(e,t,r,o){return o=o||5*Wt,e.a.distanceTo(new ca(t,r))<o&&e.wallType===za.CURVED?e.a:e.b.distanceTo(new ca(t,r))<o&&e.wallType===za.CURVED?e.b:null}},{key:"overlappedCorner",value:function(e,t,r){r=r||Wt;for(var o=0;o<this.corners.length;o++)if(this.corners[o].distanceFrom(new ca(e,t))<r)return this.corners[o];return null}},{key:"overlappedWall",value:function(e,t,r){r=r||Wt;for(var o=0;o<this.walls.length;o++){var n=r;if(this.walls[o].distanceFrom(new ca(e,t))<n)return this.walls[o]}return null}},{key:"getMetaRoomData",value:function(){var e={};return this.rooms.forEach(function(t){var r={},o=t.roomByCornersId;r.name=t.name,e[o]=r}),e}},{key:"saveFloorplan",value:function(){var e={version:St.getTechnicalVersion(),corners:{},walls:[],rooms:{},wallTextures:[],floorTextures:{},newFloorTextures:{},carbonSheet:{}},t=[];return this.walls.forEach(function(r){r.getStart()&&r.getEnd()&&(e.walls.push({corner1:r.getStart().id,corner2:r.getEnd().id,frontTexture:r.frontTexture,backTexture:r.backTexture,wallType:r.wallType.description,a:{x:r.a.x,y:r.a.y},b:{x:r.b.x,y:r.b.y},thickness:ka.cmToMeasureRaw(r.thickness)}),t.push(r.getStart()),t.push(r.getEnd()))}),t.forEach(function(t){e.corners[t.id]={x:ka.cmToMeasureRaw(t.x),y:ka.cmToMeasureRaw(t.y),elevation:ka.cmToMeasureRaw(t.elevation)}}),e.rooms=this.metaroomsdata,this.carbonSheet&&(e.carbonSheet.url=this.carbonSheet.url,e.carbonSheet.transparency=this.carbonSheet.transparency,e.carbonSheet.x=this.carbonSheet.x,e.carbonSheet.y=this.carbonSheet.y,e.carbonSheet.anchorX=this.carbonSheet.anchorX,e.carbonSheet.anchorY=this.carbonSheet.anchorY,e.carbonSheet.width=this.carbonSheet.width,e.carbonSheet.height=this.carbonSheet.height),e.units=ha.getStringValue(wb),e.newFloorTextures=this.floorTextures,e}},{key:"loadFloorplan",value:function(e){this.reset(),this.__updatesOn=!1;var t={};if(null!==e&&"corners"in e&&"walls"in e){var r=ha.getStringValue(wb);if(e.units)switch(e.units){case If:ha.setValue(wb,If);break;case Jf:ha.setValue(wb,Jf);break;case Oe:ha.setValue(wb,Oe);break;case Rd:ha.setValue(wb,Rd);break;case Kf:ha.setValue(wb,Kf);}for(var o in e.corners){var n=e.corners[o];t[o]=this.newCorner(ka.cmFromMeasureRaw(n.x),ka.cmFromMeasureRaw(n.y),o),n.elevation&&(t[o].elevation=ka.cmFromMeasureRaw(n.elevation))}var i=this;e.walls.forEach(function(r){var o=i.newWall(t[r.corner1],t[r.corner2]);r.frontTexture&&(r.frontTexture.colormap?o.frontTexture=r.frontTexture:o.frontTexture=ri),r.backTexture&&(r.backTexture.colormap?o.backTexture=r.backTexture:o.backTexture=ri),r.thickness&&(o.thickness=ka.cmFromMeasureRaw(r.thickness)),St.isVersionHigherThan(e.version,"0.0.2a")&&(o.a=r.a,o.b=r.b,"CURVED"===r.wallType?o.wallType=za.CURVED:o.wallType=za.STRAIGHT)}),"newFloorTextures"in e&&(this.floorTextures=e.newFloorTextures),this.__updatesOn=!0,this.metaroomsdata=e.rooms,this.update(),ha.setValue(wb,r),this.dispatchEvent({type:Wl,item:this})}}},{key:"loadLockedFloorplan",value:function(e){var t=this;if(null!==e&&"corners"in e&&"walls"in e){var r=ha.getStringValue(wb);if(e.units)switch(e.units){case If:ha.setValue(wb,If);break;case Jf:ha.setValue(wb,Jf);break;case Oe:ha.setValue(wb,Oe);break;case Rd:ha.setValue(wb,Rd);break;case Kf:ha.setValue(wb,Kf);}var o={};for(var n in e.corners){var i=e.corners[n],a=new Tt(this,ka.cmFromMeasureRaw(i.x),ka.cmFromMeasureRaw(i.y));a.elevation=ka.cmFromMeasureRaw(i.elevation),a.isLocked=!0,o[n]=a,this.__externalCorners.push(a)}for(var s in e.walls.forEach(function(r){var n=o[r.corner1],i=o[r.corner2],a=new Vt(n,i);a.isLocked=!0,r.frontTexture&&(r.frontTexture.colormap?a.frontTexture=r.frontTexture:a.frontTexture=ri),r.backTexture&&(r.backTexture.colormap?a.backTexture=r.backTexture:a.backTexture=ri),r.thickness&&(a.thickness=ka.cmFromMeasureRaw(r.thickness)),St.isVersionHigherThan(e.version,"0.0.2a")&&(a.a=r.a,a.b=r.b,"CURVED"===r.wallType?a.wallType=za.CURVED:a.wallType=za.STRAIGHT),t.__externalWalls.push(a)}),e.rooms){for(var $=s.split(","),l=[],h=!0,c=0;c<$.length;c++){var u=$[c];if(!o[u]){h=!1;break}l.push(o[u])}if(h){var p=new Dp(this,l);p.updateArea(),p.isLocked=!0,this.__externalRooms.push(p)}}ha.setValue(wb,r),this.dispatchEvent({type:op,item:this})}}},{key:"getFloorTexture",value:function(e){if(e in this.floorTextures){var t=this.floorTextures[e];if(t.colormap)return t}return null}},{key:"setFloorTexture",value:function(e,t){this.floorTextures[e]=t}},{key:"updateFloorTextures",value:function(){var e=va.map(this.rooms,function(e){return e.getUuid()});for(var t in this.floorTextures)va.hasValue(e,t)||delete this.floorTextures[t]}},{key:"reset",value:function(){var e=this.corners.slice(0),t=this.walls.slice(0);e.forEach(function(e){e.remove()}),t.forEach(function(e){e.remove()}),this.corners=[],this.walls=[],this.__externalRooms=[],this.__externalCorners=[],this.__externalWalls=[],this.dispatchEvent({type:qp})}},{key:"roomNameChanged",value:function(e){this.metaroomsdata&&(this.metaroomsdata[e.item.roomByCornersId]=e.newname)}},{key:"getCenter",value:function(){return this.getDimensions(!0)}},{key:"getSize",value:function(){return this.getDimensions(!1)}},{key:"getSize3",value:function(){for(var e=this.getDimensions(),t=new ba(e.x,e.z,-Number.MAX_VALUE),r=0;r<this.corners.length;r++){var o=this.corners[r];t.z=Math.max(t.z,o.elevation)}return t}},{key:"setSize",value:function(e){var t=0,r=new fa,o=this.getSize3(),n=e.clone().divide(o);for(r.scale(n);t<this.corners.length;t++){var i=this.corners[t],a=new ba(i.location.x,i.location.y,i.elevation);a=a.applyMatrix4(r),i.elevation=a.z,i.move(a.x,a.y)}}},{key:"getDimensions",value:function(e){e=e||!1;var t=1/0,r=-1/0,o=1/0,n=-1/0;return this.corners.forEach(function(e){e.x<t&&(t=e.x),e.x>r&&(r=e.x),e.y<o&&(o=e.y),e.y>n&&(n=e.y)}),t===1/0||r===-1/0||o===1/0||n===-1/0?new ba:e?new ba(.5*(t+r),0,.5*(o+n)):new ba(r-t,0,n-o)}},{key:"assignOrphanEdges",value:function(){var e=[];this.walls.forEach(function(t){if(!t.backEdge&&!t.frontEdge){var r=new wp(null,t,!1),o=new wp(null,t,!0);t.orphan=!0,r.generatePlane(),o.generatePlane(),e.push(t)}})}},{key:"update",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.__updatesOn)if(null!=t&&t.forEach(function(e){e.updateAngles()}),e){var r=this;this.walls.forEach(function(e){e.resetFrontBack()}),this.rooms.forEach(function(e){e.destroy()});var o=this.findRooms(this.corners);this.rooms=[],this.corners.forEach(function(e){e.clearAttachedRooms()}),o.forEach(function(e){var t=new Dp(r,e);t.updateArea(),r.rooms.push(t),t.addEventListener(CX,function(e){r.roomNameChanged(e)}),t.addEventListener(lg,function(e){var t=e.item;r.dispatchEvent(e),r.metaroomsdata[t.roomByCornersId]?r.metaroomsdata[t.roomByCornersId].name=t.name:(r.metaroomsdata[t.roomByCornersId]={},r.metaroomsdata[t.roomByCornersId].name=t.name)}),r.metaroomsdata&&(r.metaroomsdata[t.roomByCornersId]?t.name=r.metaroomsdata[t.roomByCornersId].name:(r.metaroomsdata[t.roomByCornersId]={},r.metaroomsdata[t.roomByCornersId].name=t.name))}),this.__roofPlanesForIntersection.length=0,this.__floorPlanesForIntersection.length=0,this.__wallPlanesForIntersection.length=0,this.__roofPlanesForIntersection.push.apply(this.__roofPlanesForIntersection,this.createRoofPlanes()),this.__floorPlanesForIntersection.push.apply(this.__floorPlanesForIntersection,this.createFloorPlanes()),this.__wallPlanesForIntersection.push.apply(this.__wallPlanesForIntersection,this.createWallEdgePlanes()),this.__cornerGroups.createGroups(),this.assignOrphanEdges(),this.updateFloorTextures(),this.dispatchEvent({type:Fd,item:this}),this.dispatchEvent({type:Jt,item:this})}else this.dispatchEvent({type:Fd,item:this})}},{key:"findRooms",value:function(e){function t(e,t,r){return va.angle2pi(new ca(e.x-t.x,e.y-t.y),new ca(r.x-t.x,r.y-t.y))}var r=[];e.forEach(function(e){e.adjacentCorners().forEach(function(o){r.push(function(e,r){var o=[],n={corner:r,previousCorners:[e]},i={};for(i[e.id]=!0;n;){var a=n.corner;if(i[a.id]=!0,n.corner===e&&a!==r)return n.previousCorners;for(var s=[],$=n.corner.adjacentCorners(),l=0;l<$.length;l++){var h=$[l];h.id in i&&(h!==e||a===r)||s.push(h)}var c=n.previousCorners.slice(0);if(c.push(a),s.length>1){var u=n.previousCorners[n.previousCorners.length-1];s.sort(function(e,r){return t(u,a,r)-t(u,a,e)})}s.length>0&&s.forEach(function(e){o.push({corner:e,previousCorners:c})}),n=o.pop()}return[]}(e,o))})});var o=function(e){for(var t=[],r={},o=function(e){return e.id},n=0;n<e.length;n++){for(var i=!0,a=e[n],s=0;s<a.length;s++){var $=va.cycle(a,s),l=va.map($,o).join("-");r.hasOwnProperty(l)&&(i=!1)}i&&(t.push(e[n]),r[l]=!0)}return t}(r);return va.removeIf(o,va.isClockwise)}},{key:"carbonSheet",set:function(e){this._carbonSheet=e},get:function(){return this._carbonSheet}},{key:"roofPlanesForIntersection",get:function(){return this.__roofPlanesForIntersection}},{key:"floorPlanesForIntersection",get:function(){return this.__floorPlanesForIntersection}},{key:"wallPlanesForIntersection",get:function(){return this.__wallPlanesForIntersection}},{key:"cornerGroups",get:function(){return this.__cornerGroups}},{key:"externalCorners",get:function(){return this.__externalCorners}},{key:"externalWalls",get:function(){return this.__externalWalls}},{key:"externalRooms",get:function(){return this.__externalRooms}}]),r}();function E_(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function $C(e,r){for(var $=0;$<r.length;$++){var t=r[$];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function F_(e,r,$){return r&&$C(e.prototype,r),$&&$C(e,$),e}function G_(t){return(G_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function H_(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _C(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function I_(t,e,r){return e&&_C(t.prototype,e),r&&_C(t,r),t}function J_(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&K_(t,e)}function K_(t,e){return(K_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function L_(t){var e=O_();return function(){var r,o=aD(t);if(e){var n=aD(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return M_(this,r)}}function M_(t,e){return!e||"object"!==G_(e)&&"function"!=typeof e?N_(t):e}function N_(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O_(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function aD(t){return(aD=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var P_=function(t){J_(r,am);var e=L_(r);function r(t,o,n){var $;return H_(this,r),($=e.call(this,t,o,n))._freePosition=!1,$.__customIntersectionPlanes=$.__model.floorplan.floorPlanesForIntersection,$}return I_(r,[{key:"snapToPoint",value:function(t,e,r,o,n,$){var i=new ca(e.x,e.z),a=va.angle(_l,i);this.rotation=new ba(0,a,0),t.y=this.halfSize.y+5,this.position=t}}]),r}();function Q_(t){return(Q_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R_(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S_(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T_(t,e)}function T_(t,e){return(T_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function U_(t){var e=X_();return function(){var r,o=bD(t);if(e){var n=bD(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return V_(this,r)}}function V_(t,e){return!e||"object"!==Q_(e)&&"function"!=typeof e?W_(t):e}function W_(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function X_(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function bD(t){return(bD=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Y_=function(t){S_(r,am);var e=U_(r);function r(t,o,n){var c;return R_(this,r),(c=e.call(this,t,o,n)).receiveShadow=!0,c.__customIntersectionPlanes=c.__model.floorplan.floorPlanesForIntersection,c}return r}();function Z_(t){return(Z_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $_(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cD(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function aaa(t,e,r){return e&&cD(t.prototype,e),r&&cD(t,r),t}function baa(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&caa(t,e)}function caa(t,e){return(caa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function daa(t){var e=gaa();return function(){var r,o=dD(t);if(e){var n=dD(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return eaa(this,r)}}function eaa(t,e){return!e||"object"!==Z_(e)&&"function"!=typeof e?faa(t):e}function faa(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gaa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function dD(t){return(dD=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var haa=function(t){baa(r,am);var e=daa(r);function r(t,o,n){var $;return $_(this,r),($=e.call(this,t,o,n)).__customIntersectionPlanes=$.__model.floorplan.roofPlanesForIntersection,$}return aaa(r,[{key:"snapToPoint",value:function(t,e,r,o,n,$){t.y-=this.halfSize.y+5,this.position=t}}]),r}();var iaa={1:P_,2:bm,3:yp,7:Ap,8:Y_,9:Ut,0:am,4:haa};var jaa=function(){function e(){E_(this,e)}return F_(e,null,[{key:"getClass",value:function(e){return iaa[e]}}]),e}();var kaa=function(t){JX(r,Qa);var e=LX(r);function r(){var t;return HX(this,r),(t=e.call(this)).__floorplan=new D_,t.__roomItems=[],t}return IX(r,[{key:"switchWireframe",value:function(t){this.scene.switchWireframe(t)}},{key:"loadSerialized",value:function(t){this.dispatchEvent({type:xX,item:this});var e=JSON.parse(t);this.newDesign(e.floorplan,e.items),this.dispatchEvent({type:Wl,item:this})}},{key:"loadLockedSerialized",value:function(t){var e=JSON.parse(t);this.floorplan.loadLockedFloorplan(e.floorplan),this.dispatchEvent({type:op,item:this})}},{key:"exportSerialized",value:function(){var t=this.floorplan.saveFloorplan(),e=[];this.__roomItems.forEach(function(t){e.push(t.metadata)});var r={floorplan:t,items:e};return JSON.stringify(r)}},{key:"newDesign",value:function(t,e){this.__roomItems=[],this.floorplan.loadFloorplan(t);for(var r=0;r<e.length;r++){var o=e[r],a=o.itemType,n=new(jaa.getClass(a))(o,this,o.id);this.__roomItems.push(n)}}},{key:"reset",value:function(){this.floorplan.reset(),this.__roomItems.length=0,this.dispatchEvent({type:qp})}},{key:"getItems",value:function(){return this.__roomItems}},{key:"itemCount",value:function(){return this.__roomItems.length}},{key:"clearItems",value:function(){var t=this;this.__roomItems.forEach(function(e){t.removeItem(e,!1)}),this.__roomItems=[]}},{key:"removeItem",value:function(t,e){this.remove(t,e),this.dispatchEvent({type:zX,item:t})}},{key:"remove",value:function(t,e){(e=e||!1)||(t.destroy(),va.removeValue(this.__roomItems,t))}},{key:"addItemByMetaData",value:function(t){this.dispatchEvent({type:It,item:null})}},{key:"addItem",value:function(t){this.__roomItems.push(t),this.dispatchEvent({type:It,item:t})}},{key:"roomItems",get:function(){return this.__roomItems}},{key:"floorplan",get:function(){return this.__floorplan}}]),r}();function laa(e){return(laa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function maa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function naa(e,t,n){return t&&eD(e.prototype,t),n&&eD(e,n),e}function oaa(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&paa(e,t)}function paa(e,t){return(paa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qaa(e){var t=saa();return function(){var n,r=fD(e);if(t){var o=fD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return raa(this,n)}}function raa(e,t){return!t||"object"!==laa(t)&&"function"!=typeof t?df(e):t}function df(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function saa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function fD(e){return(fD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cm=function(e,t){var o,n,a,r,i,s;void 0===t&&console.warn("THREE.OrbitControls: The second parameter \"domElement\" is now mandatory."),t===document&&console.error("THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead."),this.object=e,this.domElement=t,this.enabled=!0,this.target=new ba,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:Lf.ROTATE,MIDDLE:Lf.DOLLY,RIGHT:Lf.PAN},this.touches={ONE:Mf.ROTATE,TWO:Mf.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return $.phi},this.getAzimuthalAngle=function(){return $.theta},this.saveState=function(){c.target0.copy(c.target),c.position0.copy(c.object.position),c.zoom0=c.object.zoom},this.reset=function(){c.target.copy(c.target0),c.object.position.copy(c.position0),c.object.zoom=c.zoom0,c.object.updateProjectionMatrix(),c.dispatchEvent(m),c.update(),h=l.NONE},this.update=(o=new ba,n=new yb().setFromUnitVectors(e.up,new ba(0,1,0)),a=n.clone().inverse(),r=new ba,i=new yb,s=2*Math.PI,function(){var e=c.object.position;o.copy(e).sub(c.target),o.applyQuaternion(n),$.setFromVector3(o),c.autoRotate&&h===l.NONE&&w(2*Math.PI/60/60*c.autoRotateSpeed),c.enableDamping?($.theta+=b.theta*c.dampingFactor,$.phi+=b.phi*c.dampingFactor):($.theta+=b.theta,$.phi+=b.phi);var t=c.minAzimuthAngle,p=c.maxAzimuthAngle;return isFinite(t)&&isFinite(p)&&(t<-Math.PI?t+=s:t>Math.PI&&(t-=s),p<-Math.PI?p+=s:p>Math.PI&&(p-=s),$.theta=t<p?Math.max(t,Math.min(p,$.theta)):$.theta>(t+p)/2?Math.max(t,$.theta):Math.min(p,$.theta)),$.phi=Math.max(c.minPolarAngle,Math.min(c.maxPolarAngle,$.phi)),$.makeSafe(),$.radius*=v,$.radius=Math.max(c.minDistance,Math.min(c.maxDistance,$.radius)),!0===c.enableDamping?c.target.addScaledVector(T,c.dampingFactor):c.target.add(T),o.setFromSpherical($),o.applyQuaternion(a),e.copy(c.target).add(o),c.object.lookAt(c.target),!0===c.enableDamping?(b.theta*=1-c.dampingFactor,b.phi*=1-c.dampingFactor,T.multiplyScalar(1-c.dampingFactor)):(b.set(0,0,0),T.set(0,0,0)),v=1,!!(E||r.distanceToSquared(c.object.position)>d||8*(1-i.dot(c.object.quaternion))>d)&&(c.dispatchEvent(m),r.copy(c.object.position),i.copy(c.object.quaternion),E=!1,!0)}),this.dispose=function(){c.domElement.removeEventListener("contextmenu",ee,!1),c.domElement.removeEventListener("mousedown",F,!1),c.domElement.removeEventListener("wheel",K,!1),c.domElement.removeEventListener("touchstart",q,!1),c.domElement.removeEventListener("touchend",J,!1),c.domElement.removeEventListener("touchmove",Q,!1),c.domElement.ownerDocument.removeEventListener("mousemove",Z,!1),c.domElement.ownerDocument.removeEventListener("mouseup",B,!1),c.domElement.removeEventListener("keydown",W,!1)};var c=this,m={type:"change"},p={type:"start"},u={type:"end"},l={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},h=l.NONE,d=1e-6,$=new Ct,b=new Ct,v=1,T=new ba,E=!1,O=new ca,x=new ca,f=new ca,g=new ca,y=new ca,P=new ca,G=new ca,L=new ca,A=new ca;function N(){return Math.pow(.95,c.zoomSpeed)}function w(e){b.theta-=e}function M(e){b.phi-=e}var j,C=(j=new ba,function(e,t){j.setFromMatrixColumn(t,0),j.multiplyScalar(-e),T.add(j)}),D=function(){var e=new ba;return function(t,o){!0===c.screenSpacePanning?e.setFromMatrixColumn(o,1):(e.setFromMatrixColumn(o,0),e.crossVectors(c.object.up,e)),e.multiplyScalar(t),T.add(e)}}(),R=function(){var e=new ba;return function(t,o){var n=c.domElement;if(c.object.isPerspectiveCamera){var a=c.object.position;e.copy(a).sub(c.target);var r=e.length();r*=Math.tan(c.object.fov/2*Math.PI/180),C(2*t*r/n.clientHeight,c.object.matrix),D(2*o*r/n.clientHeight,c.object.matrix)}else c.object.isOrthographicCamera?(C(t*(c.object.right-c.object.left)/c.object.zoom/n.clientWidth,c.object.matrix),D(o*(c.object.top-c.object.bottom)/c.object.zoom/n.clientHeight,c.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),c.enablePan=!1)}}();function S(e){c.object.isPerspectiveCamera?v/=e:c.object.isOrthographicCamera?(c.object.zoom=Math.max(c.minZoom,Math.min(c.maxZoom,c.object.zoom*e)),c.object.updateProjectionMatrix(),E=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),c.enableZoom=!1)}function k(e){c.object.isPerspectiveCamera?v*=e:c.object.isOrthographicCamera?(c.object.zoom=Math.max(c.minZoom,Math.min(c.maxZoom,c.object.zoom/e)),c.object.updateProjectionMatrix(),E=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),c.enableZoom=!1)}function Y(e){O.set(e.clientX,e.clientY)}function H(e){g.set(e.clientX,e.clientY)}function U(e){if(1==e.touches.length)O.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),o=.5*(e.touches[0].pageY+e.touches[1].pageY);O.set(t,o)}}function V(e){if(1==e.touches.length)g.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),o=.5*(e.touches[0].pageY+e.touches[1].pageY);g.set(t,o)}}function I(e){var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+o*o);G.set(0,n)}function z(e){if(1==e.touches.length)x.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),o=.5*(e.touches[0].pageY+e.touches[1].pageY);x.set(t,o)}f.subVectors(x,O).multiplyScalar(c.rotateSpeed);var n=c.domElement;w(2*Math.PI*f.x/n.clientHeight),M(2*Math.PI*f.y/n.clientHeight),O.copy(x)}function X(e){if(1==e.touches.length)y.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),o=.5*(e.touches[0].pageY+e.touches[1].pageY);y.set(t,o)}P.subVectors(y,g).multiplyScalar(c.panSpeed),R(P.x,P.y),g.copy(y)}function _(e){var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+o*o);L.set(0,n),A.set(0,Math.pow(L.y/G.y,c.zoomSpeed)),S(A.y),G.copy(L)}function F(e){if(!1!==c.enabled){var t;switch(e.preventDefault(),c.domElement.focus?c.domElement.focus():window.focus(),e.button){case 0:t=c.mouseButtons.LEFT;break;case 1:t=c.mouseButtons.MIDDLE;break;case 2:t=c.mouseButtons.RIGHT;break;default:t=-1;}switch(t){case Lf.DOLLY:if(!1===c.enableZoom)return;!function(e){G.set(e.clientX,e.clientY)}(e),h=l.DOLLY;break;case Lf.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===c.enablePan)return;H(e),h=l.PAN}else{if(!1===c.enableRotate)return;Y(e),h=l.ROTATE}break;case Lf.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===c.enableRotate)return;Y(e),h=l.ROTATE}else{if(!1===c.enablePan)return;H(e),h=l.PAN}break;default:h=l.NONE;}h!==l.NONE&&(c.domElement.ownerDocument.addEventListener("mousemove",Z,!1),c.domElement.ownerDocument.addEventListener("mouseup",B,!1),c.dispatchEvent(p))}}function Z(e){if(!1!==c.enabled)switch(e.preventDefault(),h){case l.ROTATE:if(!1===c.enableRotate)return;!function(e){x.set(e.clientX,e.clientY),f.subVectors(x,O).multiplyScalar(c.rotateSpeed);var t=c.domElement;w(2*Math.PI*f.x/t.clientHeight),M(2*Math.PI*f.y/t.clientHeight),O.copy(x),c.update()}(e);break;case l.DOLLY:if(!1===c.enableZoom)return;!function(e){L.set(e.clientX,e.clientY),A.subVectors(L,G),A.y>0?S(N()):A.y<0&&k(N()),G.copy(L),c.update()}(e);break;case l.PAN:if(!1===c.enablePan)return;!function(e){y.set(e.clientX,e.clientY),P.subVectors(y,g).multiplyScalar(c.panSpeed),R(P.x,P.y),g.copy(y),c.update()}(e);}}function B(e){!1!==c.enabled&&(c.domElement.ownerDocument.removeEventListener("mousemove",Z,!1),c.domElement.ownerDocument.removeEventListener("mouseup",B,!1),c.dispatchEvent(u),h=l.NONE)}function K(e){!1===c.enabled||!1===c.enableZoom||h!==l.NONE&&h!==l.ROTATE||(e.preventDefault(),e.stopPropagation(),c.dispatchEvent(p),function(e){e.deltaY<0?k(N()):e.deltaY>0&&S(N()),c.update()}(e),c.dispatchEvent(u))}function W(e){!1!==c.enabled&&!1!==c.enableKeys&&!1!==c.enablePan&&function(e){var t=!1;switch(e.keyCode){case c.keys.UP:R(0,c.keyPanSpeed),t=!0;break;case c.keys.BOTTOM:R(0,-c.keyPanSpeed),t=!0;break;case c.keys.LEFT:R(c.keyPanSpeed,0),t=!0;break;case c.keys.RIGHT:R(-c.keyPanSpeed,0),t=!0;}t&&(e.preventDefault(),c.update())}(e)}function q(e){if(!1!==c.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(c.touches.ONE){case Mf.ROTATE:if(!1===c.enableRotate)return;U(e),h=l.TOUCH_ROTATE;break;case Mf.PAN:if(!1===c.enablePan)return;V(e),h=l.TOUCH_PAN;break;default:h=l.NONE;}break;case 2:switch(c.touches.TWO){case Mf.DOLLY_PAN:if(!1===c.enableZoom&&!1===c.enablePan)return;!function(e){c.enableZoom&&I(e),c.enablePan&&V(e)}(e),h=l.TOUCH_DOLLY_PAN;break;case Mf.DOLLY_ROTATE:if(!1===c.enableZoom&&!1===c.enableRotate)return;!function(e){c.enableZoom&&I(e),c.enableRotate&&U(e)}(e),h=l.TOUCH_DOLLY_ROTATE;break;default:h=l.NONE;}break;default:h=l.NONE;}h!==l.NONE&&c.dispatchEvent(p)}}function Q(e){if(!1!==c.enabled)switch(e.preventDefault(),e.stopPropagation(),h){case l.TOUCH_ROTATE:if(!1===c.enableRotate)return;z(e),c.update();break;case l.TOUCH_PAN:if(!1===c.enablePan)return;X(e),c.update();break;case l.TOUCH_DOLLY_PAN:if(!1===c.enableZoom&&!1===c.enablePan)return;!function(e){c.enableZoom&&_(e),c.enablePan&&X(e)}(e),c.update();break;case l.TOUCH_DOLLY_ROTATE:if(!1===c.enableZoom&&!1===c.enableRotate)return;!function(e){c.enableZoom&&_(e),c.enableRotate&&z(e)}(e),c.update();break;default:h=l.NONE;}}function J(e){!1!==c.enabled&&(c.dispatchEvent(u),h=l.NONE)}function ee(e){!1!==c.enabled&&e.preventDefault()}c.domElement.addEventListener("contextmenu",ee,!1),c.domElement.addEventListener("mousedown",F,!1),c.domElement.addEventListener("wheel",K,!1),c.domElement.addEventListener("touchstart",q,!1),c.domElement.addEventListener("touchend",J,!1),c.domElement.addEventListener("touchmove",Q,!1),c.domElement.addEventListener("keydown",W,!1),-1===c.domElement.tabIndex&&(c.domElement.tabIndex=0),this.update()};cm.prototype=Object.create(Qa.prototype),cm.prototype.constructor=cm;var Xt=function(e,t){cm.call(this,e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=Lf.PAN,this.mouseButtons.RIGHT=Lf.ROTATE,this.touches.ONE=Mf.PAN,this.touches.TWO=Mf.DOLLY_ROTATE};Xt.prototype=Object.create(Qa.prototype),Xt.prototype.constructor=Xt;var Xa={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,FLOAT:5126,UNSIGNED_INT:5125,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},Pc={};Pc[Gb]=Xa.NEAREST,Pc[Uk]=Xa.NEAREST_MIPMAP_NEAREST,Pc[Vk]=Xa.NEAREST_MIPMAP_LINEAR,Pc[Qb]=Xa.LINEAR,Pc[Sn]=Xa.LINEAR_MIPMAP_NEAREST,Pc[Of]=Xa.LINEAR_MIPMAP_LINEAR,Pc[ec]=Xa.CLAMP_TO_EDGE,Pc[tc]=Xa.REPEAT,Pc[ui]=Xa.MIRRORED_REPEAT;var gD={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},dm=function(){};dm.prototype={constructor:dm,parse:function(e,t,r){var a={binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],forcePowerOfTwoTextures:!1,includeCustomExtensions:!1};(r=Object.assign({},a,r)).animations.length>0&&(r.trs=!0);var n,i={asset:{version:"2.0",generator:"GLTFExporter"}},s=0,o=[],l=[],u=new Map,p=[],m={},f={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},c=new Map,h=0;function g(e){return c.has(e)||c.set(e,h++),c.get(e)}function T(e,t){return e.length===t.length&&e.every(function(e,r){return e===t[r]})}function $(e){return 4*Math.ceil(e/4)}function E(e,t){t=t||0;var r=$(e.byteLength);if(r!==e.byteLength){var a=new Uint8Array(r);if(a.set(new Uint8Array(e)),0!==t)for(var n=e.byteLength;n<r;n++)a[n]=t;return a.buffer}return e}function v(e,t){if(0!==Object.keys(e.userData).length)try{var a=JSON.parse(JSON.stringify(e.userData));if(r.includeCustomExtensions&&a.gltfExtensions){for(var n in void 0===t.extensions&&(t.extensions={}),a.gltfExtensions)t.extensions[n]=a.gltfExtensions[n],m[n]=!0;delete a.gltfExtensions}Object.keys(a).length>0&&(t.extras=a)}catch(i){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+i.message)}}function d(e,t){var r=!1,a={};0===t.offset.x&&0===t.offset.y||(a.offset=t.offset.toArray(),r=!0),0!==t.rotation&&(a.rotation=t.rotation,r=!0),1===t.repeat.x&&1===t.repeat.y||(a.scale=t.repeat.toArray(),r=!0),r&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=a,m.KHR_texture_transform=!0)}function O(e){return i.buffers||(i.buffers=[{byteLength:0}]),o.push(e),0}function N(e,t,a,n){var o;if(e.array.constructor===Float32Array)o=Xa.FLOAT;else if(e.array.constructor===Uint32Array)o=Xa.UNSIGNED_INT;else if(e.array.constructor===Uint16Array)o=Xa.UNSIGNED_SHORT;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");o=Xa.UNSIGNED_BYTE}if(void 0===a&&(a=0),void 0===n&&(n=e.count),r.truncateDrawRange&&void 0!==t&&null===t.index){var l=a+n,u=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;a=Math.max(a,t.drawRange.start),(n=Math.min(l,u)-a)<0&&(n=0)}if(0===n)return null;var p,m=function(e,t,r){for(var a={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},n=t;n<t+r;n++)for(var i=0;i<e.itemSize;i++){var s=e.array[n*e.itemSize+i];a.min[i]=Math.min(a.min[i],s),a.max[i]=Math.max(a.max[i],s)}return a}(e,a,n);void 0!==t&&(p=e===t.index?Xa.ELEMENT_ARRAY_BUFFER:Xa.ARRAY_BUFFER);var f=function(e,t,r,a,n){var o;i.bufferViews||(i.bufferViews=[]),o=t===Xa.UNSIGNED_BYTE?1:t===Xa.UNSIGNED_SHORT?2:4;for(var l=$(a*e.itemSize*o),u=new DataView(new ArrayBuffer(l)),p=0,m=r;m<r+a;m++)for(var f=0;f<e.itemSize;f++){var c;e.itemSize>4?c=e.array[m*e.itemSize+f]:0===f?c=e.getX(m):1===f?c=e.getY(m):2===f?c=e.getZ(m):3===f&&(c=e.getW(m)),t===Xa.FLOAT?u.setFloat32(p,c,!0):t===Xa.UNSIGNED_INT?u.setUint32(p,c,!0):t===Xa.UNSIGNED_SHORT?u.setUint16(p,c,!0):t===Xa.UNSIGNED_BYTE&&u.setUint8(p,c),p+=o}var h={buffer:O(u.buffer),byteOffset:s,byteLength:l};return void 0!==n&&(h.target=n),n===Xa.ARRAY_BUFFER&&(h.byteStride=e.itemSize*o),s+=l,i.bufferViews.push(h),{id:i.bufferViews.length-1,byteLength:0}}(e,o,a,n,p),c={bufferView:f.id,byteOffset:f.byteOffset,componentType:o,count:n,max:m.max,min:m.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(c.normalized=!0),i.accessors||(i.accessors=[]),i.accessors.push(c),i.accessors.length-1}function S(e,t,a){f.images.has(e)||f.images.set(e,{});var o=f.images.get(e),u=t===Gc?"image/png":"image/jpeg",p=u+":flipY/"+a.toString();if(void 0!==o[p])return o[p];i.images||(i.images=[]);var m={mimeType:u};if(r.embedImages){var c=n=n||document.createElement("canvas");c.width=Math.min(e.width,r.maxTextureSize),c.height=Math.min(e.height,r.maxTextureSize),r.forcePowerOfTwoTextures&&!function(e){return ta.isPowerOfTwo(e.width)&&ta.isPowerOfTwo(e.height)}(c)&&(console.warn("GLTFExporter: Resized non-power-of-two image.",e),c.width=ta.floorPowerOfTwo(c.width),c.height=ta.floorPowerOfTwo(c.height));var h=c.getContext("2d");!0===a&&(h.translate(0,c.height),h.scale(1,-1)),h.drawImage(e,0,0,c.width,c.height),!0===r.binary?l.push(new Promise(function(e){c.toBlob(function(t){(function(e){return i.bufferViews||(i.bufferViews=[]),new Promise(function(t){var r=new window.FileReader;r.readAsArrayBuffer(e),r.onloadend=function(){var e=E(r.result),a={buffer:O(e),byteOffset:s,byteLength:e.byteLength};s+=e.byteLength,i.bufferViews.push(a),t(i.bufferViews.length-1)}})})(t).then(function(t){m.bufferView=t,e()})},u)})):m.uri=c.toDataURL(u)}else m.uri=e.src;i.images.push(m);var g=i.images.length-1;return o[p]=g,g}function y(e){i.samplers||(i.samplers=[]);var t={magFilter:Pc[e.magFilter],minFilter:Pc[e.minFilter],wrapS:Pc[e.wrapS],wrapT:Pc[e.wrapT]};return i.samplers.push(t),i.samplers.length-1}function A(e){if(f.textures.has(e))return f.textures.get(e);i.textures||(i.textures=[]);var t={sampler:y(e),source:S(e.image,e.format,e.flipY)};e.name&&(t.name=e.name),i.textures.push(t);var r=i.textures.length-1;return f.textures.set(e,r),r}function L(e){if(f.materials.has(e))return f.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);var t={pbrMetallicRoughness:{}};e.isMeshBasicMaterial?(t.extensions={KHR_materials_unlit:{}},m.KHR_materials_unlit=!0):e.isGLTFSpecularGlossinessMaterial?(t.extensions={KHR_materials_pbrSpecularGlossiness:{}},m.KHR_materials_pbrSpecularGlossiness=!0):e.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var r=e.color.toArray().concat([e.opacity]);if(T(r,[1,1,1,1])||(t.pbrMetallicRoughness.baseColorFactor=r),e.isMeshStandardMaterial?(t.pbrMetallicRoughness.metallicFactor=e.metalness,t.pbrMetallicRoughness.roughnessFactor=e.roughness):e.isMeshBasicMaterial?(t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9):(t.pbrMetallicRoughness.metallicFactor=.5,t.pbrMetallicRoughness.roughnessFactor=.5),e.isGLTFSpecularGlossinessMaterial){t.pbrMetallicRoughness.baseColorFactor&&(t.extensions.KHR_materials_pbrSpecularGlossiness.diffuseFactor=t.pbrMetallicRoughness.baseColorFactor);var a=[1,1,1];e.specular.toArray(a,0),t.extensions.KHR_materials_pbrSpecularGlossiness.specularFactor=a,t.extensions.KHR_materials_pbrSpecularGlossiness.glossinessFactor=e.glossiness}if(e.metalnessMap||e.roughnessMap)if(e.metalnessMap===e.roughnessMap){var n={index:A(e.metalnessMap)};d(n,e.metalnessMap),t.pbrMetallicRoughness.metallicRoughnessTexture=n}else console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(e.map){var s={index:A(e.map)};d(s,e.map),e.isGLTFSpecularGlossinessMaterial&&(t.extensions.KHR_materials_pbrSpecularGlossiness.diffuseTexture=s),t.pbrMetallicRoughness.baseColorTexture=s}if(e.isGLTFSpecularGlossinessMaterial&&e.specularMap){var o={index:A(e.specularMap)};d(o,e.specularMap),t.extensions.KHR_materials_pbrSpecularGlossiness.specularGlossinessTexture=o}if(e.emissive){var l=e.emissive.clone().multiplyScalar(e.emissiveIntensity).toArray();if(T(l,[0,0,0])||(t.emissiveFactor=l),e.emissiveMap){var u={index:A(e.emissiveMap)};d(u,e.emissiveMap),t.emissiveTexture=u}}if(e.normalMap){var p={index:A(e.normalMap)};e.normalScale&&-1!==e.normalScale.x&&(e.normalScale.x!==e.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),p.scale=e.normalScale.x),d(p,e.normalMap),t.normalTexture=p}if(e.aoMap){var c={index:A(e.aoMap),texCoord:1};1!==e.aoMapIntensity&&(c.strength=e.aoMapIntensity),d(c,e.aoMap),t.occlusionTexture=c}e.transparent?t.alphaMode="BLEND":e.alphaTest>0&&(t.alphaMode="MASK",t.alphaCutoff=e.alphaTest),e.side===Pb&&(t.doubleSided=!0),""!==e.name&&(t.name=e.name),v(e,t),i.materials.push(t);var h=i.materials.length-1;return f.materials.set(e,h),h}function _(e){var t=[e.geometry.uuid];if(Array.isArray(e.material))for(var r=0,a=e.material.length;r<a;r++)t.push(e.material[r].uuid);else t.push(e.material.uuid);var n=t.join(":");if(f.meshes.has(n))return f.meshes.get(n);var s,o=e.geometry;s=e.isLineSegments?Xa.LINES:e.isLineLoop?Xa.LINE_LOOP:e.isLine?Xa.LINE_STRIP:e.isPoints?Xa.POINTS:e.material.wireframe?Xa.LINES:Xa.TRIANGLES,o.isBufferGeometry||(console.warn("GLTFExporter: Exporting THREE.Geometry will increase file size. Use BufferGeometry instead."),o=new ia().setFromObject(e));var l={},u={},p=[],m=[],c={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},h=o.getAttribute("normal");void 0===h||function(e){if(f.attributesNormalized.has(e))return!1;for(var t=new ba,r=0,a=e.count;r<a;r++)if(Math.abs(t.fromArray(e.array,3*r).length()-1)>5e-4)return!1;return!0}(h)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),o.setAttribute("normal",function(e){if(f.attributesNormalized.has(e))return f.attributesNormalized.get(e);for(var t=e.clone(),r=new ba,a=0,n=t.count;a<n;a++)r.fromArray(t.array,3*a),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),r.toArray(t.array,3*a);return f.attributesNormalized.set(e,t),t}(h)));var T=null;for(var $ in o.attributes)if("morph"!==$.substr(0,5)){var E=o.attributes[$];$=c[$]||$.toUpperCase();if(/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test($)||($="_"+$),f.attributes.has(g(E)))u[$]=f.attributes.get(g(E));else{T=null;var d=E.array;"JOINTS_0"!==$||d instanceof Uint16Array||d instanceof Uint8Array||(console.warn("GLTFExporter: Attribute \"skinIndex\" converted to type UNSIGNED_SHORT."),T=new pa(new Uint16Array(d),E.itemSize,E.normalized));var O=N(T||E,o);null!==O&&(u[$]=O,f.attributes.set(g(E),O))}}if(void 0!==h&&o.setAttribute("normal",h),0===Object.keys(u).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){var S=[],y=[],A={};if(void 0!==e.morphTargetDictionary)for(var _ in e.morphTargetDictionary)A[e.morphTargetDictionary[_]]=_;for(r=0;r<e.morphTargetInfluences.length;++r){var C={},b=!1;for(var $ in o.morphAttributes)if("position"===$||"normal"===$){E=o.morphAttributes[$][r];var R=$.toUpperCase(),x=o.attributes[$];if(f.attributes.has(g(E)))C[R]=f.attributes.get(g(E));else{var w=E.clone();if(!o.morphTargetsRelative)for(var M=0,I=E.count;M<I;M++)w.setXYZ(M,E.getX(M)-x.getX(M),E.getY(M)-x.getY(M),E.getZ(M)-x.getZ(M));C[R]=N(w,o),f.attributes.set(g(x),C[R])}}else b||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),b=!0);m.push(C),S.push(e.morphTargetInfluences[r]),void 0!==e.morphTargetDictionary&&y.push(A[r])}l.weights=S,y.length>0&&(l.extras={},l.extras.targetNames=y)}var G=Array.isArray(e.material);if(G&&0===o.groups.length)return null;for(var j=G?e.material:[e.material],Z=G?o.groups:[{materialIndex:0,start:void 0,count:void 0}],B=(r=0,Z.length);r<B;r++){var F={mode:s,attributes:u};if(v(o,F),m.length>0&&(F.targets=m),null!==o.index){var P=g(o.index);void 0===Z[r].start&&void 0===Z[r].count||(P+=":"+Z[r].start+":"+Z[r].count),f.attributes.has(P)?F.indices=f.attributes.get(P):(F.indices=N(o.index,o,Z[r].start,Z[r].count),f.attributes.set(P,F.indices)),null===F.indices&&delete F.indices}var U=L(j[Z[r].materialIndex]);null!==U&&(F.material=U),p.push(F)}l.primitives=p,i.meshes||(i.meshes=[]),i.meshes.push(l);var H=i.meshes.length-1;return f.meshes.set(n,H),H}function C(e,t){i.animations||(i.animations=[]);for(var r=(e=dm.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,a=[],n=[],s=0;s<r.length;++s){var o=r[s],l=Ib.parseTrackName(o.name),p=Ib.findNode(t,l.nodeName),m=gD[l.propertyName];if("bones"===l.objectName&&(p=!0===p.isSkinnedMesh?p.skeleton.getBoneByName(l.objectIndex):void 0),!p||!m)return console.warn("THREE.GLTFExporter: Could not export animation track \"%s\".",o.name),null;var f,c=o.values.length/o.times.length;m===gD.morphTargetInfluences&&(c/=p.morphTargetInfluences.length),!0===o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(f="CUBICSPLINE",c/=3):f=o.getInterpolation()===Oz?"STEP":"LINEAR",n.push({input:N(new pa(o.times,1)),output:N(new pa(o.values,c)),interpolation:f}),a.push({sampler:n.length-1,target:{node:u.get(p),path:m}})}return i.animations.push({name:e.name||"clip_"+i.animations.length,samplers:n,channels:a}),i.animations.length-1}function b(e){var t=i.nodes[u.get(e)],r=e.skeleton;if(void 0===r)return null;var a=e.skeleton.bones[0];if(void 0===a)return null;for(var n=[],s=new Float32Array(16*r.bones.length),o=0;o<r.bones.length;++o)n.push(u.get(r.bones[o])),r.boneInverses[o].toArray(s,16*o);return void 0===i.skins&&(i.skins=[]),i.skins.push({inverseBindMatrices:N(new pa(s,16)),joints:n,skeleton:u.get(a)}),t.skin=i.skins.length-1}function R(e){var t={};e.name&&(t.name=e.name),t.color=e.color.toArray(),t.intensity=e.intensity,e.isDirectionalLight?t.type="directional":e.isPointLight?(t.type="point",e.distance>0&&(t.range=e.distance)):e.isSpotLight&&(t.type="spot",e.distance>0&&(t.range=e.distance),t.spot={},t.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,t.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1.");var r=i.extensions.KHR_lights_punctual.lights;return r.push(t),r.length-1}function x(e){i.nodes||(i.nodes=[]);var t={};if(r.trs){var a=e.quaternion.toArray(),n=e.position.toArray(),s=e.scale.toArray();T(a,[0,0,0,1])||(t.rotation=a),T(n,[0,0,0])||(t.translation=n),T(s,[1,1,1])||(t.scale=s)}else e.matrixAutoUpdate&&e.updateMatrix(),T(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(t.matrix=e.matrix.elements);if(""!==e.name&&(t.name=String(e.name)),v(e,t),e.isMesh||e.isLine||e.isPoints){var o=_(e);null!==o&&(t.mesh=o)}else if(e.isCamera)t.camera=function(e){i.cameras||(i.cameras=[]);var t=e.isOrthographicCamera,r={type:t?"orthographic":"perspective"};return t?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:ta.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),i.cameras.push(r),i.cameras.length-1}(e);else if(e.isDirectionalLight||e.isPointLight||e.isSpotLight)m.KHR_lights_punctual||(i.extensions=i.extensions||{},i.extensions.KHR_lights_punctual={lights:[]},m.KHR_lights_punctual=!0),t.extensions=t.extensions||{},t.extensions.KHR_lights_punctual={light:R(e)};else if(e.isLight)return console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e),null;if(e.isSkinnedMesh&&p.push(e),e.children.length>0){for(var l=[],f=0,c=e.children.length;f<c;f++){var h=e.children[f];if(h.visible||!1===r.onlyVisible){var g=x(h);null!==g&&l.push(g)}}l.length>0&&(t.children=l)}i.nodes.push(t);var $=i.nodes.length-1;return u.set(e,$),$}function w(e){i.scenes||(i.scenes=[],i.scene=0);var t={};""!==e.name&&(t.name=e.name),i.scenes.push(t);for(var a=[],n=0,s=e.children.length;n<s;n++){var o=e.children[n];if(o.visible||!1===r.onlyVisible){var l=x(o);null!==l&&a.push(l)}}a.length>0&&(t.nodes=a),v(e,t)}!function(e){e=e instanceof Array?e:[e];for(var t=[],a=0;a<e.length;a++)e[a]instanceof $g?w(e[a]):t.push(e[a]);for(t.length>0&&function(e){var t=new $g;t.name="AuxScene";for(var r=0;r<e.length;r++)t.children.push(e[r]);w(t)}(t),a=0;a<p.length;++a)b(p[a]);for(a=0;a<r.animations.length;++a)C(r.animations[a],e[0])}(e),Promise.all(l).then(function(){var e=new Blob(o,{type:"application/octet-stream"}),a=Object.keys(m);if(a.length>0&&(i.extensionsUsed=a),i.buffers&&i.buffers.length>0&&(i.buffers[0].byteLength=e.size),!0===r.binary){(n=new window.FileReader).readAsArrayBuffer(e),n.onloadend=function(){var e=E(n.result),r=new DataView(new ArrayBuffer(8));r.setUint32(0,e.byteLength,!0),r.setUint32(4,5130562,!0);var a=E(function(e){if(void 0!==window.TextEncoder)return new TextEncoder().encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,a=e.length;r<a;r++){var n=e.charCodeAt(r);t[r]=n>255?32:n}return t.buffer}(JSON.stringify(i)),32),s=new DataView(new ArrayBuffer(8));s.setUint32(0,a.byteLength,!0),s.setUint32(4,1313821514,!0);var o=new ArrayBuffer(12),l=new DataView(o);l.setUint32(0,1179937895,!0),l.setUint32(4,2,!0);var u=12+s.byteLength+a.byteLength+r.byteLength+e.byteLength;l.setUint32(8,u,!0);var p=new Blob([o,s,a,r,e],{type:"application/octet-stream"}),m=new window.FileReader;m.readAsArrayBuffer(p),m.onloadend=function(){t(m.result)}}}else{var n;if(i.buffers&&i.buffers.length>0)(n=new window.FileReader).readAsDataURL(e),n.onloadend=function(){var e=n.result;i.buffers[0].uri=e,t(i)};else t(i)}})}},dm.Utils={insertKeyframe:function(e,t){var r,a=e.getValueSize(),n=new e.TimeBufferType(e.times.length+1),i=new e.ValueBufferType(e.values.length+a),s=e.createInterpolant(new e.ValueBufferType(a));if(0===e.times.length){n[0]=t;for(var o=0;o<a;o++)i[o]=0;r=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<.001)return 0;n[0]=t,n.set(e.times,1),i.set(s.evaluate(t),0),i.set(e.values,a),r=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<.001)return e.times.length-1;n[n.length-1]=t,n.set(e.times,0),i.set(e.values,0),i.set(s.evaluate(t),e.values.length),r=n.length-1}else for(o=0;o<e.times.length;o++){if(Math.abs(e.times[o]-t)<.001)return o;if(e.times[o]<t&&e.times[o+1]>t){n.set(e.times.slice(0,o+1),0),n[o+1]=t,n.set(e.times.slice(o+1),o+2),i.set(e.values.slice(0,(o+1)*a),0),i.set(s.evaluate(t),(o+1)*a),i.set(e.values.slice((o+1)*a),(o+2)*a),r=o+1;break}}return e.times=n,e.values=i,r},mergeMorphTargetTracks:function(e,t){for(var r=[],a={},n=e.tracks,i=0;i<n.length;++i){var s=n[i],o=Ib.parseTrackName(s.name),l=Ib.findNode(t,o.nodeName);if("morphTargetInfluences"===o.propertyName&&void 0!==o.propertyIndex){if(s.createInterpolant!==s.InterpolantFactoryMethodDiscrete&&s.createInterpolant!==s.InterpolantFactoryMethodLinear){if(s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(s=s.clone()).setInterpolation(ls)}var u,p=l.morphTargetInfluences.length,m=l.morphTargetDictionary[o.propertyIndex];if(void 0===m)throw new Error("THREE.GLTFExporter: Morph target name not found: "+o.propertyIndex);if(void 0!==a[l.uuid]){var f=s.createInterpolant(new s.ValueBufferType(1));u=a[l.uuid];for(g=0;g<u.times.length;g++)u.values[g*p+m]=f.evaluate(u.times[g]);for(g=0;g<s.times.length;g++){var c=this.insertKeyframe(u,s.times[g]);u.values[c*p+m]=s.values[g]}}else{for(var h=new(u=s.clone()).ValueBufferType(p*u.times.length),g=0;g<u.times.length;g++)h[g*p+m]=u.values[g];u.name=o.nodeName+".morphTargetInfluences",u.values=h,a[l.uuid]=u,r.push(u)}}else r.push(s)}return e.tracks=r,e}};function taa(e){return(taa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uaa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hD(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function vaa(e,t,r){return t&&hD(e.prototype,t),r&&hD(e,r),e}function waa(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xaa(e,t)}function xaa(e,t){return(xaa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yaa(e){var t=Aaa();return function(){var r,o=jD(e);if(t){var n=jD(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return zaa(this,r)}}function zaa(e,t){return!t||"object"!==taa(t)&&"function"!=typeof t?iD(e):t}function iD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aaa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function jD(e){return(jD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Baa=function(e){waa(r,Qa);var t=yaa(r);function r(e,o){var n;uaa(this,r),(n=t.call(this)).defaultEnvironment="rooms/textures/envs/Garden.png",n.useEnvironment=!1,n.topColor=9614030,n.bottomColor=16777215,n.verticalOffset=400,n.exponent=.5;var i={topColor:{type:"c",value:new ga(n.topColor)},bottomColor:{type:"c",value:new ga(n.bottomColor)},offset:{type:"f",value:n.verticalOffset},exponent:{type:"f",value:n.exponent}};n.scene=e,n.renderer=o,n.sphereRadius=4e3,n.__gridSize=1e4,n.widthSegments=32,n.heightSegments=15,n.sky=null,n.plainVertexShader=["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );","}"].join("\n"),n.plainFragmentShader=["uniform vec3 bottomColor;","uniform vec3 topColor;","uniform float offset;","uniform float exponent;","varying vec3 vWorldPosition;","void main() {"," float h = normalize( vWorldPosition + offset ).y;"," gl_FragColor = vec4( mix( bottomColor, topColor, max( pow( max(h, 0.0 ), exponent ), 0.0 ) ), 1.0 );","}"].join("\n"),n.vertexShader=["varying vec2 vUV;","void main() {","  vUV=uv;","  vec4 pos = vec4(position, 1.0);","   gl_Position = projectionMatrix * modelViewMatrix * pos;","}"].join("\n"),n.fragmentShader=["uniform sampler2D texture;","varying vec2 vUV;","void main() {  ","vec4 sample = texture2D(texture, vUV);","gl_FragColor = vec4(sample.xyz, sample.w);","}"].join("\n"),n.texture=new Wd,n.plainSkyMat=new gc({vertexShader:n.plainVertexShader,fragmentShader:n.plainFragmentShader,uniforms:i,side:Pb}),n.plainSkyMat.name="PlainSkyMaterial",n.skyMat=void 0,n.skyGeo=new Dl(n.sphereRadius,n.widthSegments,n.heightSegments),n.sky=new Aa(n.skyGeo,n.skyMat),n.ground=new Rl(n.__gridSize,Math.round(n.__gridSize/ha.getNumericValue(tj)),986895,8421504),n.ground.position.y=-10,n.scene.add(n.ground);var a=new Tl(1e3);return n.scene.add(a),n.init(),ha.getInstance().addEventListener(gd,n.__updateGrid.bind(iD(n))),n}return vaa(r,[{key:"__updateGrid",value:function(e){this.scene.remove(this.ground),this.ground=new Rl(this.__gridSize,Math.round(this.__gridSize/ha.getNumericValue(tj)),986895,8421504),this.ground.position.y=-10,this.scene.add(this.ground),this.scene.needsUpdate=!0}},{key:"setEnabled",value:function(e){e?(this.scene.add(this.sky),this.scene.add(this.ground)):(this.scene.remove(this.sky),this.scene.remove(this.ground))}},{key:"toggleEnvironment",value:function(e){this.useEnvironment=e,e?(this.ground.visible=!1,this.skyMat?this.sky.material=this.skyMat:this.setEnvironmentMap(this.defaultEnvironment),this.sky.visible=!0):(this.ground.visible=!0,this.sky.material=this.plainSkyMat,this.sky.material.needsUpdate=!0),this.scene.needsUpdate=!0}},{key:"setEnvironmentMap",value:function(e){var t=this;t.texture.load(e,function(e){var r={texture:{type:"t",value:e}};t.skyMat=new gc({vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:r,side:Pb}),t.skyMat.name="SkyMaterial",t.toggleEnvironment(t.useEnvironment)},void 0,function(){console.log("ERROR LOADEING FILE")})}},{key:"init",value:function(){this.toggleEnvironment(!1)}}]),r}();function Caa(e){return(Caa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Daa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kD(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Eaa(e,t,i){return t&&kD(e.prototype,t),i&&kD(e,i),e}function Faa(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gaa(e,t)}function Gaa(e,t){return(Gaa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Haa(e){var t=Jaa();return function(){var i,n=lD(e);if(t){var r=lD(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Iaa(this,i)}}function Iaa(e,t){return!t||"object"!==Caa(t)&&"function"!=typeof t?zj(e):t}function zj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jaa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function lD(e){return(lD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kaa(t){return(Kaa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Laa(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Maa(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Naa(t,r)}function Naa(t,r){return(Naa=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function Oaa(t){var r=Raa();return function(){var e,o=mD(t);if(r){var n=mD(this).constructor;e=Reflect.construct(o,arguments,n)}else e=o.apply(this,arguments);return Paa(this,e)}}function Paa(t,r){return!r||"object"!==Kaa(r)&&"function"!=typeof r?Qaa(t):r}function Qaa(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Raa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function mD(t){return(mD=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Saa(e){return(Saa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Taa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nD(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Uaa(e,t,r){return t&&nD(e.prototype,t),r&&nD(e,r),e}function Vaa(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Waa(e,t)}function Waa(e,t){return(Waa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xaa(e){var t=$aa();return function(){var r,i=oD(e);if(t){var a=oD(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return Yaa(this,r)}}function Yaa(e,t){return!t||"object"!==Saa(t)&&"function"!=typeof t?Zaa(e):t}function Zaa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $aa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function oD(e){return(oD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pD=function(e){Vaa(r,Hb);var t=Xaa(r);function r(e,i,a){var _,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Taa(this,r),(_=t.call(this,e)).__scene=a,_.__reflectsScene=n,_.__mirrorCamera=null,_.__repeat=i.repeat?i.repeat:Yg,_.__repeatX=null,_.__repeatY=null,_.__reflectsScene&&(_.__mirrorCamera=_.__scene.environmentCamera,_.envMap=_.__mirrorCamera.renderTarget.texture,_.envMap.mapping=Rn),_.__textureMapPack=i,_.__uRatio=1,_.__vRatio=1,_.__dimensions=new ca,_.__repeatPerCentimeter=1/_.__repeat,_.__repeatPerCentimeterX=null,_.__repeatPerCentimeterY=null,_.__colorTexture=null,_.__normalTexture=null,_.__roughnessTexture=null,_.__ambientTexture=null,_.__bumpTexture=null,_.__metalTexture=null,_.textureMapPack=i,_}return Uaa(r,[{key:"__updateColorMap",value:function(e){this.__colorTexture&&(this.__colorTexture.encoding=vc,this.__colorTexture.wrapS=this.__colorTexture.wrapT=tc,this.__colorTexture.repeat.set(this.__uRatio,this.__vRatio),this.__colorTexture.needsUpdate=!0,this.map=this.__colorTexture),this.__updateTextures()}},{key:"__updateNormalMap",value:function(e){this.__normalTexture&&(this.__normalTexture.encoding=vc,this.__normalTexture.wrapS=this.__normalTexture.wrapT=tc,this.__normalTexture.repeat.set(this.__uRatio,this.__vRatio),this.__normalTexture.needsUpdate=!0,this.normalMap=this.__normalTexture),this.__updateTextures()}},{key:"__updateRoughnessMap",value:function(e){this.__roughnessTexture&&(this.__roughnessTexture.encoding=vc,this.__roughnessTexture.wrapS=this.__roughnessTexture.wrapT=tc,this.__roughnessTexture.repeat.set(this.__uRatio,this.__vRatio),this.__roughnessTexture.needsUpdate=!0,this.roughnessMap=this.__roughnessTexture),this.__updateTextures()}},{key:"__updateAmbientMap",value:function(e){this.__ambientTexture&&(this.__ambientTexture.encoding=vc,this.__ambientTexture.wrapS=this.__ambientTexture.wrapT=tc,this.__ambientTexture.repeat.set(this.__uRatio,this.__vRatio),this.__ambientTexture.needsUpdate=!0,this.aoMap=this.__ambientTexture),this.__updateTextures()}},{key:"__updateMetallicMap",value:function(e){this.__metalTexture&&(this.__metalTexture.encoding=vc,this.__metalTexture.wrapS=this.__metalTexture.wrapT=tc,this.__metalTexture.repeat.set(this.__uRatio,this.__vRatio),this.__metalTexture.needsUpdate=!0,this.metalnessMap=this.__metalTexture),this.__updateTextures()}},{key:"__updateBumpMap",value:function(e){this.__bumpTexture&&(this.__bumpTexture.encoding=vc,this.__bumpTexture.wrapS=this.__bumpTexture.wrapT=tc,this.__bumpTexture.repeat.set(this.__uRatio,this.__vRatio),this.__bumpTexture.needsUpdate=!0,this.displacementMap=this.__bumpTexture,this.displacementMap.needsUpdate=!0),this.__updateTextures()}},{key:"__updateTextures",value:function(){this.needsUpdate=!0,this.__scene.needsUpdate=!0}},{key:"__applyNewTextures",value:function(){this.__textureMapPack.colormap&&(this.__colorTexture=new Wd().load(this.__textureMapPack.colormap,this.__updateColorMap.bind(this))),this.__textureMapPack.normalmap&&(this.__normalTexture=new Wd().load(this.__textureMapPack.normalmap,this.__updateNormalMap.bind(this))),this.__textureMapPack.roughnessmap&&(this.__roughnessTexture=new Wd().load(this.__textureMapPack.roughnessmap,this.__updateRoughnessMap.bind(this))),this.__textureMapPack.ambientmap&&(this.__ambientTexture=new Wd().load(this.__textureMapPack.ambientmap,this.__updateAmbientMap.bind(this))),this.__textureMapPack.metalmap&&(this.__metalTexture=new Wd().load(this.__textureMapPack.metalmap,this.__updateMetallicMap.bind(this)))}},{key:"__scaleUV",value:function(e,t){this.__uRatio=e,this.__vRatio=t,this.__updateColorMap(),this.__updateNormalMap(),this.__updateRoughnessMap(),this.__updateMetallicMap(),this.__updateAmbientMap(),this.__updateBumpMap()}},{key:"__updateDimensions",value:function(e,t){var r=Math.max(e*this.__repeatPerCentimeter,1),i=Math.max(t*this.__repeatPerCentimeter,1);this.__scaleUV(r,i)}},{key:"envMapCamera",get:function(){return this.__mirrorCamera}},{key:"textureMapPack",get:function(){return this.__textureMapPack},set:function(e){this.__textureMapPack=e,e.color=e.color||"#FFFFFF",e.emissive=e.emissive||"#000000",e.reflective=e.reflective||.5,e.shininess=e.shininess||.5,this.color=new ga(e.color),this.emissive=new ga(e.emissive),this.roughness=e.reflective,this.metalness=e.shininess,this.__repeat=e.repeat?e.repeat:Yg,this.__repeatPerCentimeter=1/this.__repeat,this.__repeatX=e.repeatX||e.repeat,this.__repeatY=e.repeatY||e.repeat,this.__repeatPerCentimeterX=1/this.__repeatX,this.__repeatPerCentimeterY=1/this.__repeatY,this.__applyNewTextures()}},{key:"repeat",get:function(){return this.__repeat}},{key:"dimensions",get:function(){return this.__dimensions},set:function(e){this.__dimensions=e.clone(),this.__updateDimensions(this.__dimensions.x,this.__dimensions.y)}},{key:"isReflective",get:function(){return this.__reflectsScene}}]),r}();var _aa=function(t){Maa(e,pD);var r=Oaa(e);function e(t,o,n){return Laa(this,e),r.call(this,t,o,n,!1)}return e}();var qD=function(e){Faa(i,Qa);var t=Haa(i);function i(e,n,r,o){var a;Daa(this,i),(a=t.call(this)).name="edge",a.scene=e,a.edge=n,a.controls=r;var s={occludedWalls:!1};for(var l in s)s.hasOwnProperty(l)&&o.hasOwnProperty(l)&&(s[l]=o[l]);return a.__options=s,a.wall=n.wall,a.front=n.front,a.planes=[],a.phantomPlanes=[],a.basePlanes=[],a.__wallPlaneMesh=null,a.fillerColor=0,a.sideColor=3355443,a.baseColor=6710886,a.visible=!1,a.redrawevent=a.__redraw.bind(zj(a)),a.visibilityevent=a.__visibility.bind(zj(a)),a.showallevent=a.__showAll.bind(zj(a)),a.__edgeDeletedEvent=a.__edgeDeleted.bind(zj(a)),a.__updateTexturePackEvent=a.__updateTexturePack.bind(zj(a)),a.visibilityfactor=!0,a.__wallMaterial3D=null,a.__updateTexturePack(),a.init(),a}return Eaa(i,[{key:"__updateTexturePack",value:function(){var e=Math.max(this.wall.startElevation,this.wall.endElevation),t=this.edge.interiorDistance(),i=this.edge.getTexture();if(!this.__wallMaterial3D){var n=this.wall.isLocked||this.__options.occludedWalls?Pb:Pe;i.color||(i.color="#FF0000"),this.__wallMaterial3D=new _aa({color:i.color,side:n,transparent:!0,wireframe:!1},i,this.scene)}this.__wallMaterial3D.textureMapPack=i,this.__wallMaterial3D.dimensions=new ca(t,e),this.redraw(),this.scene.needsUpdate=!0}},{key:"__edgeDeleted",value:function(e){this.remove()}},{key:"__redraw",value:function(){this.redraw()}},{key:"__visibility",value:function(){this.updateVisibility()}},{key:"__showAll",value:function(){this.__showAll()}},{key:"init",value:function(){this.edge.addEventListener(rb,this.__edgeDeletedEvent),this.edge.addEventListener(sj,this.__updateTexturePackEvent),this.edge.addEventListener(pj,this.redrawevent),this.controls.addEventListener("change",this.visibilityevent),this.updateTexture(),this.updatePlanes(),this.addToScene()}},{key:"redraw",value:function(){this.removeFromScene(),this.updateTexture(),this.updatePlanes(),this.addToScene()}},{key:"removeFromScene",value:function(){var e=this;e.planes.forEach(function(t){e.scene.remove(t)}),e.basePlanes.forEach(function(t){e.scene.remove(t)}),e.phantomPlanes.forEach(function(t){e.scene.remove(t)}),e.planes=[],e.basePlanes=[]}},{key:"remove",value:function(){this.edge.removeEventListener(rb,this.__edgeDeletedEvent),this.edge.removeEventListener(sj,this.__updateTexturePackEvent),this.edge.removeEventListener(pj,this.redrawevent),this.controls.removeEventListener("change",this.visibilityevent),this.removeFromScene()}},{key:"addToScene",value:function(){var e=this;this.planes.forEach(function(t){e.scene.add(t)}),this.basePlanes.forEach(function(t){e.scene.add(t)}),this.phantomPlanes.forEach(function(t){e.scene.add(t)}),this.updateVisibility()}},{key:"showAll",value:function(){var e=this;e.visible=!0,e.planes.forEach(function(t){t.material.transparent=!e.visible,t.material.opacity=1,t.visible=e.visible}),this.wall.items.forEach(function(t){t.updateEdgeVisibility(e.visible,e.front)}),this.wall.onItems.forEach(function(t){t.updateEdgeVisibility(e.visible,e.front)})}},{key:"switchWireframe",value:function(e){this.visible=!0,this.planes.forEach(function(t){t.material.wireframe=e})}},{key:"updateVisibility",value:function(){if(!this.wall.isLocked&&!this.__options.occludedWalls){var e=this,t=e.edge.interiorStart(),i=e.edge.interiorEnd(),n=i.x-t.x,r=i.y-t.y,o=new ba(-r,0,n);o.normalize();var a=e.controls.object.position.clone(),s=new ba((t.x+i.x)/2,0,(t.y+i.y)/2),l=a.sub(s).normalize(),c=o.dot(l);e.visible=c>=0,e.planes.forEach(function(t){t.visible=e.visible}),e.updateObjectVisibility()}}},{key:"updateObjectVisibility",value:function(){var e=this;function t(t,i){return e.front?t.frontVisible=i:t.backVisible=i,t.frontVisible||t.backVisible}this.wall.inWallItems.forEach(function(i){var n=t(i,e.visible);i.visible=n}),this.wall.onWallItems.forEach(function(i){var n=t(i,e.visible);i.visible=n})}},{key:"updateTexture",value:function(e){if(null!==this.edge){var t=Math.max(this.wall.startElevation,this.wall.endElevation),i=this.edge.interiorDistance();this.__wallMaterial3D.dimensions=new ca(i,t)}}},{key:"updatePlanes",value:function(){var e=this.edge.getStart(),t=this.edge.getEnd();if(null!==e&&null!==t){var i=this.edge.interiorStart(),n=this.edge.interiorEnd(),r=this.edge.exteriorStart(),o=this.edge.exteriorEnd();if(this.edge.wall.start.getAttachedRooms().length<2||this.edge.wall.end.getAttachedRooms().length<2){var a=this.makeWall(r,o,this.edge.exteriorTransform,this.edge.invExteriorTransform,this.__wallMaterial3D);this.planes.push(a)}this.__wallPlaneMesh=this.makeWall(i,n,this.edge.interiorTransform,this.edge.invInteriorTransform,this.__wallMaterial3D),this.planes.push(this.__wallPlaneMesh),this.basePlanes.push(this.buildFillerUniformHeight(this.edge,0,Ob,this.baseColor)),this.planes.push(this.buildFillerVaryingHeights(this.edge,Pb,this.fillerColor)),this.planes.push(this.buildSideFillter(this.edge.interiorStart(),this.edge.exteriorStart(),e.elevation,this.sideColor)),this.planes.push(this.buildSideFillter(this.edge.interiorEnd(),this.edge.exteriorEnd(),t.elevation,this.sideColor))}}},{key:"makeWall",value:function(e,t,i,n,r){var o=this.toVec3(e),a=this.toVec3(t),s=a.clone(),l=o.clone();s.y=this.edge.getEnd().elevation,l.y=this.edge.getStart().elevation;var c=[o.clone(),a.clone(),s.clone(),l.clone()];c.forEach(function(e){e.applyMatrix4(i)});for(var v=[new ca(c[0].x,c[0].y),new ca(c[1].x,c[1].y),new ca(c[2].x,c[2].y),new ca(c[3].x,c[3].y)],$=new Oc(v),h=0;h<this.wall.inWallItems.length;h++){var u,d=this.wall.inWallItems[h],p=d.position.clone(),f=d.halfSize.clone(),m=f.clone().negate(),_=f.clone();p.applyMatrix4(i),m.add(p),_.add(p),u=[new ca(m.x,m.y),new ca(_.x,m.y),new ca(_.x,_.y),new ca(m.x,_.y)],$.holes.push(new Dd(u))}var y=new cd($);y.vertices.forEach(function(e){e.applyMatrix4(n)});var C=this.edge.interiorDistance(),w=Math.max(this.wall.startElevation,this.wall.endElevation);function b(e){var t=va.distance(new ca(o.x,o.z),new ca(e.x,e.z))/C,i=e.y/w;return new ca(t,i)}y.faceVertexUvs[0]=[],y.faces.forEach(function(e){var t=y.vertices[e.a],i=y.vertices[e.b],n=y.vertices[e.c];y.faceVertexUvs[0].push([b(t),b(i),b(n)])}),y.faceVertexUvs[1]=y.faceVertexUvs[0],y.computeFaceNormals(),y.computeVertexNormals();var E=new Aa(y,r);return E.name="wall",E}},{key:"buildSideFillter",value:function(e,t,i,n){var r=[this.toVec3(e),this.toVec3(t),this.toVec3(t,i),this.toVec3(e,i)],o=new oa;r.forEach(function(e){o.vertices.push(e)}),o.faces.push(new aa(0,1,2)),o.faces.push(new aa(0,2,3));var a=new kb({color:n,side:Pb});return new Aa(o,a)}},{key:"buildFillerVaryingHeights",value:function(e,t,i){var n=this.toVec3(e.exteriorStart(),this.edge.getStart().elevation),r=this.toVec3(e.exteriorEnd(),this.edge.getEnd().elevation),o=this.toVec3(e.interiorEnd(),this.edge.getEnd().elevation),a=this.toVec3(e.interiorStart(),this.edge.getStart().elevation),s=new kb({color:i,side:t}),l=new oa;return l.vertices.push(n,r,o,a),l.faces.push(new aa(0,1,2)),l.faces.push(new aa(0,2,3)),new Aa(l,s)}},{key:"buildFillerUniformHeight",value:function(e,t,i,n){var r=[this.toVec2(e.exteriorStart()),this.toVec2(e.exteriorEnd()),this.toVec2(e.interiorEnd()),this.toVec2(e.interiorStart())],o=new kb({color:n,side:i}),a=new Oc(r),s=new cd(a),l=new Aa(s,o);return l.rotation.set(Math.PI/2,0,0),l.position.y=t,l}},{key:"toVec2",value:function(e){return new ca(e.x,e.y)}},{key:"toVec3",value:function(e,t){return t=t||0,new ba(e.x,t,e.y)}}]),i}();function aba(e){return(aba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bba(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rD(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function cba(e,t,r){return t&&rD(e.prototype,t),r&&rD(e,r),e}function dba(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eba(e,t)}function eba(e,t){return(eba=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fba(e){var t=hba();return function(){var r,o=sD(e);if(t){var i=sD(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return gba(this,r)}}function gba(e,t){return!t||"object"!==aba(t)&&"function"!=typeof t?Ep(e):t}function Ep(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hba(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function sD(e){return(sD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iba(t){return(iba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jba(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function kba(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&lba(t,r)}function lba(t,r){return(lba=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function mba(t){var r=pba();return function(){var e,o=tD(t);if(r){var n=tD(this).constructor;e=Reflect.construct(o,arguments,n)}else e=o.apply(this,arguments);return nba(this,e)}}function nba(t,r){return!r||"object"!==iba(r)&&"function"!=typeof r?oba(t):r}function oba(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pba(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function tD(t){return(tD=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qba=function(t){kba(e,pD);var r=mba(e);function e(t,o,n){return jba(this,e),r.call(this,t,o,n,!1)}return e}();var uD=function(e){dba(r,Qa);var t=fba(r);function r(e,o,i,n){var a;bba(this,r),a=t.call(this);var s={occludedRoofs:!1};for(var $ in s)s.hasOwnProperty($)&&n.hasOwnProperty($)&&(s[$]=n[$]);return a.__options=s,a.scene=e,a.room=o,a.controls=i,a.floorPlane=null,a.roofPlane=null,a.changedevent=a.redraw.bind(Ep(a)),a.__materialChangedEvent=a.__updateTexturePack.bind(Ep(a)),a.__updateReflectionsEvent=a.__updateReflections.bind(Ep(a)),a.__floorMaterial3D=null,a.room.addEventListener(lg,a.changedevent),a.room.addEventListener(gd,a.changedevent),a.room.addEventListener(sj,a.__materialChangedEvent),a.controls.addEventListener("change",a.__updateReflectionsEvent),a.init(),a}return cba(r,[{key:"__updateReflections",value:function(){if(this.__floorMaterial3D&&this.__floorMaterial3D.isReflective&&this.scene.enabled){var e=this.room.floorRectangleSize.clone();this.floorPlane.visible=!1,this.__floorMaterial3D.envMapCamera.clear(this.scene.renderer),this.__floorMaterial3D.envMapCamera.position.set(e.x,0,e.y),this.__floorMaterial3D.envMapCamera.update(this.scene.renderer,this.scene),this.floorPlane.visible=!0,this.__floorMaterial3D.needsUpdate=!0}}},{key:"__updateTexturePack",value:function(){var e=this.room.floorRectangleSize.clone(),t=this.room.getTexture();this.__floorMaterial3D||(this.__floorMaterial3D=new qba({color:t.color,side:Pb},t,this.scene)),this.__floorMaterial3D.textureMapPack=t,this.__floorMaterial3D.dimensions=e,this.scene.needsUpdate=!0}},{key:"switchWireframe",value:function(e){this.floorPlane.visible=!e,this.roofPlane.visible=!e}},{key:"init",value:function(){this.__updateTexturePack(),this.redraw()}},{key:"redraw",value:function(){this.removeFromScene(),this.floorPlane=this.buildFloor(),this.roofPlane=this.buildRoofVaryingHeight(),this.addToScene()}},{key:"buildFloor",value:function(){var e=[];this.room.interiorCorners.forEach(function(t){e.push(new ca(t.x,t.y))});var t=this.room.floorRectangleSize.clone(),r=new Oc(e),o=new cd(r);function i(e){var r=e.x/t.x,o=e.y/t.y;return new ca(r,o)}o.faceVertexUvs[0]=[],o.faces.forEach(function(e){var t=o.vertices[e.a],r=o.vertices[e.b],n=o.vertices[e.c];o.faceVertexUvs[0].push([i(t),i(r),i(n)])}),o.faceVertexUvs[1]=o.faceVertexUvs[0],o.computeFaceNormals(),o.computeVertexNormals(),o.uvsNeedUpdate=!0;var n=new ia().fromGeometry(o);this.__floorMaterial3D.dimensions=t,this.__floorMaterial3D.envMapCamera&&this.__floorMaterial3D.envMapCamera.position.copy(new ba(t.x,0,t.y));var a=new Aa(n,this.__floorMaterial3D);return a.rotation.set(.5*Math.PI,0,0),a}},{key:"buildRoofVaryingHeight",value:function(){var e,t,r=this.room.isLocked||this.__options.occludedRoofs?Pb:Pe,o=new kb({side:r,color:15066597}),i=[];this.room.corners.forEach(function(e){i.push(new ca(e.x,e.y))}),e=new Oc(i);for(var n=(t=new cd(e)).vertices.length-1,a=0;a<t.vertices.length;a++){var s=this.room.corners[n],$=t.vertices[a];$.z=$.y,$.y=s.elevation+.1,n--}return new Aa(t,o)}},{key:"buildRoofUniformHeight",value:function(){var e=new kb({side:Pe,color:15066597}),t=[];this.room.interiorCorners.forEach(function(e){t.push(new ca(e.x,e.y))});var r=new Oc(t),o=new cd(r),i=new Aa(o,e);return i.rotation.set(Math.PI/2,0,0),i.position.y=ha.getNumericValue(up),i}},{key:"addToScene",value:function(){this.scene.add(this.floorPlane),this.scene.add(this.roofPlane)}},{key:"removeFromScene",value:function(){this.scene.remove(this.floorPlane),this.scene.remove(this.roofPlane)}},{key:"showRoof",value:function(e){console.log(e)}},{key:"destroy",value:function(){this.room.removeEventListener(gd,this.changedevent),this.room.removeEventListener(sj,this.__materialChangedEvent),this.controls.removeEventListener("change",this.__updateReflectionsEvent),this.removeFromScene()}}]),r}();function rba(t){return(rba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sba(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vD(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function tba(t,e,r){return e&&vD(t.prototype,e),r&&vD(t,r),t}function uba(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vba(t,e)}function vba(t,e){return(vba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wba(t){var e=zba();return function(){var r,i=wD(t);if(e){var o=wD(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return xba(this,r)}}function xba(t,e){return!e||"object"!==rba(e)&&"function"!=typeof e?yba(t):e}function yba(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zba(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function wD(t){return(wD=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Aba=function(t){uba(r,Qa);var e=wba(r);function r(t,i){var o;return sba(this,r),(o=e.call(this)).scene=t,o.floorplan=i,o.tol=1,o.height=1e3,o.dirLight=null,o.updatedroomsevent=function(){o.updateShadowCamera()},o.init(),o}return tba(r,[{key:"getDirLight",value:function(){return this.dirLight}},{key:"init",value:function(){var t=new Zo(16777215,8947848,.75);t.position.set(0,this.height,0),this.dirLight=new Ml(16777215,1.5),this.ambLight=new ap(4210752),this.ambLight.intensity=.5,this.dirLight.castShadow=!0,this.dirLight.shadow.mapSize.width=1024,this.dirLight.shadow.mapSize.height=1024,this.dirLight.shadow.camera.far=this.height+this.tol,this.dirLight.shadow.bias=-1e-4,this.dirLight.visible=!0,this.dirLight.intensity=.15,this.scene.add(t),this.scene.add(this.ambLight)}},{key:"updateShadowCamera",value:function(){var t=this.floorplan.getSize(),e=(Math.max(t.z,t.x)+this.tol)/2,r=this.floorplan.getCenter(),i=new ba(r.x,this.height,r.z);this.dirLight.position.copy(i),this.dirLight.target.position.copy(r),this.dirLight.shadow.camera.left=-e,this.dirLight.shadow.camera.right=e,this.dirLight.shadow.camera.top=e,this.dirLight.shadow.camera.bottom=-e,this.dirLight.shadowCamera&&(this.dirLight.shadow.camera.left=this.dirLight.shadowCameraLeft,this.dirLight.shadow.camera.right=this.dirLight.shadowCameraRight,this.dirLight.shadow.camera.top=this.dirLight.shadowCameraTop,this.dirLight.shadow.camera.bottom=this.dirLight.shadowCameraBottom,this.dirLight.shadowCamera.updateProjectionMatrix())}}]),r}();function Bba(t){return(Bba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cba(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xD(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Dba(t,e,o){return e&&xD(t.prototype,e),o&&xD(t,o),t}function Eba(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fba(t,e)}function Fba(t,e){return(Fba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gba(t){var e=Iba();return function(){var o,i=yD(t);if(e){var r=yD(this).constructor;o=Reflect.construct(i,arguments,r)}else o=i.apply(this,arguments);return Hba(this,o)}}function Hba(t,e){return!e||"object"!==Bba(e)&&"function"!=typeof e?em(t):e}function em(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Iba(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function yD(t){return(yD=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Jba=function(){function e(e){Pa.call(this,e),this.dracoLoader=null,this.ddsLoader=null,this.pluginCallbacks=[],this.register(function(e){return new n(e)})}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(Pa.prototype),{constructor:e,load:function(e,t,r,i){var a,s=this;a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:jh.extractUrlBase(e),s.manager.itemStart(e);var n=function(t){i?i(t):console.error(t),s.manager.itemError(e),s.manager.itemEnd(e)},o=new ed(s.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),"use-credentials"===s.crossOrigin&&o.setWithCredentials(!0),o.load(e,function(r){try{s.parse(r,a,function(r){t(r),s.manager.itemEnd(e)},n)}catch(i){n(i)}},r,n)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},register:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this},unregister:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this},parse:function(e,t,n,l){var p,h={},g={};if("string"==typeof e)p=e;else if(jh.decodeText(new Uint8Array(e,0,4))===o){try{h[r.KHR_BINARY_GLTF]=new c(e)}catch(O){return void(l&&l(O))}p=h[r.KHR_BINARY_GLTF].content}else p=jh.decodeText(new Uint8Array(e));var v=JSON.parse(p);if(void 0===v.asset||v.asset.version[0]<2)l&&l(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var $=new G(v,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager});$.fileLoader.setRequestHeader(this.requestHeader);for(var T=0;T<this.pluginCallbacks.length;T++){var M=this.pluginCallbacks[T]($);g[M.name]=M,h[M.name]=!0}if(v.extensionsUsed)for(T=0;T<v.extensionsUsed.length;++T){var y=v.extensionsUsed[T],S=v.extensionsRequired||[];switch(y){case r.KHR_LIGHTS_PUNCTUAL:h[y]=new a(v);break;case r.KHR_MATERIALS_UNLIT:h[y]=new s;break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:h[y]=new d;break;case r.KHR_DRACO_MESH_COMPRESSION:h[y]=new u(v,this.dracoLoader);break;case r.MSFT_TEXTURE_DDS:h[y]=new i(this.ddsLoader);break;case r.KHR_TEXTURE_TRANSFORM:h[y]=new m;break;case r.KHR_MESH_QUANTIZATION:h[y]=new f;break;default:S.indexOf(y)>=0&&void 0===g[y]&&console.warn("THREE.GLTFLoader: Unknown extension \""+y+"\".");}}$.setExtensions(h),$.setPlugins(g),$.parse(n,l)}}});var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function i(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=r.MSFT_TEXTURE_DDS,this.ddsLoader=e}function a(e){this.name=r.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[r.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function s(){this.name=r.KHR_MATERIALS_UNLIT}function n(e){this.parser=e,this.name=r.KHR_MATERIALS_CLEARCOAT}a.prototype.loadLight=function(e){var t,r=this.lightDefs[e],i=new ga(16777215);void 0!==r.color&&i.fromArray(r.color);var a=void 0!==r.range?r.range:0;switch(r.type){case"directional":(t=new Ml(i)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new _o(i)).distance=a;break;case"spot":(t=new $o(i)).distance=a,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,t.angle=r.spot.outerConeAngle,t.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type, \""+r.type+"\".");}return t.position.set(0,0,0),t.decay=2,void 0!==r.intensity&&(t.intensity=r.intensity),t.name=r.name||"light_"+e,Promise.resolve(t)},s.prototype.getMaterialType=function(){return kb},s.prototype.extendParams=function(e,t,r){var i=[];e.color=new ga(1,1,1),e.opacity=1;var a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){var s=a.baseColorFactor;e.color.fromArray(s),e.opacity=s[3]}void 0!==a.baseColorTexture&&i.push(r.assignTexture(e,"map",a.baseColorTexture))}return Promise.all(i)},n.prototype.getMaterialType=function(){return hh},n.prototype.extendMaterialParams=function(e,t){var r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();var a=[],s=i.extensions[this.name];if(void 0!==s.clearcoatFactor&&(t.clearcoat=s.clearcoatFactor),void 0!==s.clearcoatTexture&&a.push(r.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),void 0!==s.clearcoatRoughnessFactor&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),void 0!==s.clearcoatRoughnessTexture&&a.push(r.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),void 0!==s.clearcoatNormalTexture&&(a.push(r.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),void 0!==s.clearcoatNormalTexture.scale)){var n=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new ca(n,n)}return Promise.all(a)};var o="glTF",l=12,p={JSON:1313821514,BIN:5130562};function c(e){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,l);if(this.header={magic:jh.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==o)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var i=new DataView(e,l),a=0;a<i.byteLength;){var s=i.getUint32(a,!0);a+=4;var n=i.getUint32(a,!0);if(a+=4,n===p.JSON){var c=new Uint8Array(e,l+a,s);this.content=jh.decodeText(c)}else if(n===p.BIN){var u=l+a;this.body=e.slice(u,u+s)}a+=s}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function u(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function m(){this.name=r.KHR_TEXTURE_TRANSFORM}function h(e){Hb.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),r=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),a=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),s=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),n={specular:{value:new ga().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=n,this.onBeforeCompile=function(e){for(var o in n)e.uniforms[o]=n[o];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),e.fragmentShader=e.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_pars_fragment>",t),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_pars_fragment>",r),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_fragment>",i),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_fragment>",a),e.fragmentShader=e.fragmentShader.replace("#include <lights_physical_fragment>",s)},Object.defineProperties(this,{specular:{get:function(){return n.specular.value},set:function(e){n.specular.value=e}},specularMap:{get:function(){return n.specularMap.value},set:function(e){n.specularMap.value=e}},glossiness:{get:function(){return n.glossiness.value},set:function(e){n.glossiness.value=e}},glossinessMap:{get:function(){return n.glossinessMap.value},set:function(e){n.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function d(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return h},extendParams:function(e,t,r){var i=t.extensions[this.name];e.color=new ga(1,1,1),e.opacity=1;var a=[];if(Array.isArray(i.diffuseFactor)){var s=i.diffuseFactor;e.color.fromArray(s),e.opacity=s[3]}if(void 0!==i.diffuseTexture&&a.push(r.assignTexture(e,"map",i.diffuseTexture)),e.emissive=new ga(0,0,0),e.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,e.specular=new ga(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){var n=i.specularGlossinessTexture;a.push(r.assignTexture(e,"glossinessMap",n)),a.push(r.assignTexture(e,"specularMap",n))}return Promise.all(a)},createMaterial:function(e){var t=new h(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=Zg,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function f(){this.name=r.KHR_MESH_QUANTIZATION}function g(e,t,r,i){yc.call(this,e,t,r,i)}u.prototype.decodePrimitive=function(e,t){var r=this.json,i=this.dracoLoader,a=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,n={},o={},l={};for(var p in s){var c=E[p]||p.toLowerCase();n[c]=s[p]}for(p in e.attributes){c=E[p]||p.toLowerCase();if(void 0!==s[p]){var u=r.accessors[e.attributes[p]],m=x[u.componentType];l[c]=m,o[c]=!0===u.normalized}}return t.getDependency("bufferView",a).then(function(e){return new Promise(function(t){i.decodeDracoFile(e,function(e){for(var r in e.attributes){var i=e.attributes[r],a=o[r];void 0!==a&&(i.normalized=a)}t(e)},n,l)})})},m.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn("THREE.GLTFLoader: Custom UV sets in \""+this.name+"\" extension not yet supported."),e.needsUpdate=!0,e},h.prototype=Object.create(Hb.prototype),h.prototype.constructor=h,h.prototype.copy=function(e){return Hb.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},g.prototype=Object.create(yc.prototype),g.prototype.constructor=g,g.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,a=e*i*3+i,s=0;s!==i;s++)t[s]=r[a+s];return t},g.prototype.beforeStart_=g.prototype.copySampleValue_,g.prototype.afterEnd_=g.prototype.copySampleValue_,g.prototype.interpolate_=function(e,t,r,i){for(var a=this.resultBuffer,s=this.sampleValues,n=this.valueSize,o=2*n,l=3*n,p=i-t,c=(r-t)/p,u=c*c,m=u*c,h=e*l,d=h-l,f=-2*m+3*u,g=m-u,v=1-f,$=g-u+c,T=0;T!==n;T++){var M=s[d+T+n],y=s[d+T+o]*p,S=s[h+T+n],O=s[h+T]*p;a[T]=v*M+$*y+f*S+g*O}return a};var v=0,$=1,T=2,M=3,y=4,S=5,O=6,x={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},R={9728:Gb,9729:Qb,9984:Uk,9985:Sn,9986:Vk,9987:Of},L={33071:ec,33648:ui,10497:tc},_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},E={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},w={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},A={CUBICSPLINE:void 0,LINEAR:ls,STEP:Oz},b="OPAQUE",I="MASK",P="BLEND",C={"image/png":Gc,"image/jpeg":Sd};function F(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e)}function N(e,t,r){for(var i in r.extensions)void 0===e[i]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[i]=r.extensions[i])}function U(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function H(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,i=t.weights.length;r<i;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var a=t.extras.targetNames;if(e.morphTargetInfluences.length===a.length){e.morphTargetDictionary={};for(r=0,i=a.length;r<i;r++)e.morphTargetDictionary[a[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function D(e){for(var t="",r=Object.keys(e).sort(),i=0,a=r.length;i<a;i++)t+=r[i]+":"+e[r[i]]+";";return t}function G(e,r){this.json=e||{},this.extensions={},this.plugins={},this.options=r||{},this.cache=new t,this.associations=new Map,this.primitiveCache={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new xt(this.options.manager):this.textureLoader=new Wd(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new ed(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function k(e,t,r){var i=t.attributes,a=[];function s(t,i){return r.getDependency("accessor",t).then(function(t){e.setAttribute(i,t)})}for(var n in i){var o=E[n]||n.toLowerCase();o in e.attributes||a.push(s(i[n],o))}if(void 0!==t.indices&&!e.index){var l=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});a.push(l)}return U(e,t),function(e,t,r){var i=t.attributes,a=new wc;if(void 0!==i.POSITION){var s=(m=r.json.accessors[i.POSITION]).min,n=m.max;if(void 0!==s&&void 0!==n){a.set(new ba(s[0],s[1],s[2]),new ba(n[0],n[1],n[2]));var o=t.targets;if(void 0!==o){for(var l=new ba,p=new ba,c=0,u=o.length;c<u;c++){var m,h=o[c];if(void 0!==h.POSITION)s=(m=r.json.accessors[h.POSITION]).min,n=m.max,void 0!==s&&void 0!==n?(p.setX(Math.max(Math.abs(s[0]),Math.abs(n[0]))),p.setY(Math.max(Math.abs(s[1]),Math.abs(n[1]))),p.setZ(Math.max(Math.abs(s[2]),Math.abs(n[2]))),l.max(p)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}a.expandByVector(l)}e.boundingBox=a;var d=new Td;a.getCenter(d.center),d.radius=a.min.distanceTo(a.max)/2,e.boundingSphere=d}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,r),Promise.all(a).then(function(){return void 0!==t.targets?function(e,t,r){for(var i=!1,a=!1,s=0,n=t.length;s<n&&(void 0!==(p=t[s]).POSITION&&(i=!0),void 0!==p.NORMAL&&(a=!0),!i||!a);s++);if(!i&&!a)return Promise.resolve(e);var o=[],l=[];for(s=0,n=t.length;s<n;s++){var p=t[s];if(i){var c=void 0!==p.POSITION?r.getDependency("accessor",p.POSITION):e.attributes.position;o.push(c)}a&&(c=void 0!==p.NORMAL?r.getDependency("accessor",p.NORMAL):e.attributes.normal,l.push(c))}return Promise.all([Promise.all(o),Promise.all(l)]).then(function(t){var r=t[0],s=t[1];return i&&(e.morphAttributes.position=r),a&&(e.morphAttributes.normal=s),e.morphTargetsRelative=!0,e})}(e,t.targets,r):e})}function B(e,t){var r=e.getIndex();if(null===r){var i=[],a=e.getAttribute("position");if(void 0===a)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var s=0;s<a.count;s++)i.push(s);e.setIndex(i),r=e.getIndex()}var n=r.count-2,o=[];if(t===Pz)for(s=1;s<=n;s++)o.push(r.getX(0)),o.push(r.getX(s)),o.push(r.getX(s+1));else for(s=0;s<n;s++)s%2==0?(o.push(r.getX(s)),o.push(r.getX(s+1)),o.push(r.getX(s+2))):(o.push(r.getX(s+2)),o.push(r.getX(s+1)),o.push(r.getX(s)));o.length/3!==n&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var l=e.clone();return l.setIndex(o),l}return G.prototype.setExtensions=function(e){this.extensions=e},G.prototype.setPlugins=function(e){this.plugins=e},G.prototype.parse=function(e,t){var r=this,i=this.json,a=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(t){var s={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:r,userData:{}};N(a,s,i),U(s,i),e(s)}).catch(t)},G.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],i={},a={},s=0,n=t.length;s<n;s++)for(var o=t[s].joints,l=0,p=o.length;l<p;l++)e[o[l]].isBone=!0;for(var c=0,u=e.length;c<u;c++){var m=e[c];void 0!==m.mesh&&(void 0===i[m.mesh]&&(i[m.mesh]=a[m.mesh]=0),i[m.mesh]++,void 0!==m.skin&&(r[m.mesh].isSkinnedMesh=!0))}this.json.meshReferences=i,this.json.meshUses=a},G.prototype._invokeOne=function(e){var t=Object.values(this.plugins);t.push(this);for(var r=0;r<t.length;r++){var i=e(t[r]);if(i)return i}},G.prototype._invokeAll=function(e){var t=Object.values(this.plugins);t.unshift(this);for(var r=[],i=0;i<t.length;i++)r.push(e(t[i]));return Promise.all(r)},G.prototype.getDependency=function(e,t){var i=e+":"+t,a=this.cache.get(i);if(!a){switch(e){case"scene":a=this.loadScene(t);break;case"node":a=this.loadNode(t);break;case"mesh":a=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":a=this.loadAccessor(t);break;case"bufferView":a=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":a=this.loadBuffer(t);break;case"material":a=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":a=this.loadTexture(t);break;case"skin":a=this.loadSkin(t);break;case"animation":a=this.loadAnimation(t);break;case"camera":a=this.loadCamera(t);break;case"light":a=this.extensions[r.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e);}this.cache.add(i,a)}return a},G.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,i=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(i.map(function(t,i){return r.getDependency(e,i)})),this.cache.add(e,t)}return t},G.prototype.loadBuffer=function(e){var t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var a=this.options;return new Promise(function(e,r){i.load(F(t.uri,a.path),e,void 0,function(){r(new Error("THREE.GLTFLoader: Failed to load buffer \""+t.uri+"\"."))})})},G.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var r=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+r)})},G.prototype.loadAccessor=function(e){var t=this,r=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);var a=[];return void 0!==i.bufferView?a.push(this.getDependency("bufferView",i.bufferView)):a.push(null),void 0!==i.sparse&&(a.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(a).then(function(e){var a,s,n=e[0],o=_[i.type],l=x[i.componentType],p=l.BYTES_PER_ELEMENT,c=p*o,u=i.byteOffset||0,m=void 0!==i.bufferView?r.bufferViews[i.bufferView].byteStride:void 0,h=!0===i.normalized;if(m&&m!==c){var d=Math.floor(u/m),f="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+d+":"+i.count,g=t.cache.get(f);g||(a=new l(n,d*m,i.count*m/p),g=new Kc(a,m/p),t.cache.add(f,g)),s=new ag(g,o,u%m/p,h)}else a=null===n?new l(i.count*o):new l(n,u,i.count*o),s=new pa(a,o,h);if(void 0!==i.sparse){var v=_.SCALAR,$=x[i.sparse.indices.componentType],T=i.sparse.indices.byteOffset||0,M=i.sparse.values.byteOffset||0,y=new $(e[1],T,i.sparse.count*v),S=new l(e[2],M,i.sparse.count*o);null!==n&&(s=new pa(s.array.slice(),s.itemSize,s.normalized));for(var O=0,R=y.length;O<R;O++){var L=y[O];if(s.setX(L,S[O*o]),o>=2&&s.setY(L,S[O*o+1]),o>=3&&s.setZ(L,S[O*o+2]),o>=4&&s.setW(L,S[O*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return s})},G.prototype.loadTexture=function(e){var t,i=this,a=this.json,s=this.options,n=this.textureLoader,o=self.URL||self.webkitURL,l=a.textures[e],p=l.extensions||{},c=(t=p[r.MSFT_TEXTURE_DDS]?a.images[p[r.MSFT_TEXTURE_DDS].source]:a.images[l.source]).uri,u=!1;return void 0!==t.bufferView&&(c=i.getDependency("bufferView",t.bufferView).then(function(e){u=!0;var r=new Blob([e],{type:t.mimeType});return c=o.createObjectURL(r)})),Promise.resolve(c).then(function(e){var t=s.manager.getHandler(e);return t||(t=p[r.MSFT_TEXTURE_DDS]?i.extensions[r.MSFT_TEXTURE_DDS].ddsLoader:n),new Promise(function(r,i){var a=r;!0===t.isImageBitmapLoader&&(a=function(e){r(new sl(e))}),t.load(F(e,s.path),a,void 0,i)})}).then(function(r){!0===u&&o.revokeObjectURL(c),r.flipY=!1,l.name&&(r.name=l.name),t.mimeType in C&&(r.format=C[t.mimeType]);var s=(a.samplers||{})[l.sampler]||{};return r.magFilter=R[s.magFilter]||Qb,r.minFilter=R[s.minFilter]||Of,r.wrapS=L[s.wrapS]||tc,r.wrapT=L[s.wrapT]||tc,i.associations.set(r,{type:"textures",index:e}),r})},G.prototype.assignTexture=function(e,t,i){var a=this;return this.getDependency("texture",i.index).then(function(s){if(!s.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":s.format=Sd;}if(void 0===i.texCoord||0==i.texCoord||"aoMap"===t&&1==i.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),a.extensions[r.KHR_TEXTURE_TRANSFORM]){var n=void 0!==i.extensions?i.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;if(n){var o=a.associations.get(s);s=a.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(s,n),a.associations.set(s,o)}}e[t]=s})},G.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,i=void 0!==t.attributes.tangent,a=void 0!==t.attributes.color,s=void 0===t.attributes.normal,n=!0===e.isSkinnedMesh,o=Object.keys(t.morphAttributes).length>0,l=o&&void 0!==t.morphAttributes.normal;if(e.isPoints){var p="PointsMaterial:"+r.uuid,c=this.cache.get(p);c||(c=new bg,ua.prototype.copy.call(c,r),c.color.copy(r.color),c.map=r.map,c.sizeAttenuation=!1,this.cache.add(p,c)),r=c}else if(e.isLine){p="LineBasicMaterial:"+r.uuid;var u=this.cache.get(p);u||(u=new ob,ua.prototype.copy.call(u,r),u.color.copy(r.color),this.cache.add(p,u)),r=u}if(i||a||s||n||o){p="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(p+="specular-glossiness:"),n&&(p+="skinning:"),i&&(p+="vertex-tangents:"),a&&(p+="vertex-colors:"),s&&(p+="flat-shading:"),o&&(p+="morph-targets:"),l&&(p+="morph-normals:");var m=this.cache.get(p);m||(m=r.clone(),n&&(m.skinning=!0),i&&(m.vertexTangents=!0),a&&(m.vertexColors=!0),s&&(m.flatShading=!0),o&&(m.morphTargets=!0),l&&(m.morphNormals=!0),this.cache.add(p,m),this.associations.set(m,this.associations.get(r))),r=m}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),r.normalScale&&!i&&(r.normalScale.y=-r.normalScale.y),r.clearcoatNormalScale&&!i&&(r.clearcoatNormalScale.y=-r.clearcoatNormalScale.y),e.material=r},G.prototype.getMaterialType=function(){return Hb},G.prototype.loadMaterial=function(e){var t,i=this,a=this.json,s=this.extensions,n=a.materials[e],o={},l=n.extensions||{},p=[];if(l[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var c=s[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=c.getMaterialType(),p.push(c.extendParams(o,n,i))}else if(l[r.KHR_MATERIALS_UNLIT]){var u=s[r.KHR_MATERIALS_UNLIT];t=u.getMaterialType(),p.push(u.extendParams(o,n,i))}else{var m=n.pbrMetallicRoughness||{};if(o.color=new ga(1,1,1),o.opacity=1,Array.isArray(m.baseColorFactor)){var d=m.baseColorFactor;o.color.fromArray(d),o.opacity=d[3]}void 0!==m.baseColorTexture&&p.push(i.assignTexture(o,"map",m.baseColorTexture)),o.metalness=void 0!==m.metallicFactor?m.metallicFactor:1,o.roughness=void 0!==m.roughnessFactor?m.roughnessFactor:1,void 0!==m.metallicRoughnessTexture&&(p.push(i.assignTexture(o,"metalnessMap",m.metallicRoughnessTexture)),p.push(i.assignTexture(o,"roughnessMap",m.metallicRoughnessTexture))),t=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),p.push(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)}))}!0===n.doubleSided&&(o.side=Pb);var f=n.alphaMode||b;return f===P?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,f===I&&(o.alphaTest=void 0!==n.alphaCutoff?n.alphaCutoff:.5)),void 0!==n.normalTexture&&t!==kb&&(p.push(i.assignTexture(o,"normalMap",n.normalTexture)),o.normalScale=new ca(1,1),void 0!==n.normalTexture.scale&&o.normalScale.set(n.normalTexture.scale,n.normalTexture.scale)),void 0!==n.occlusionTexture&&t!==kb&&(p.push(i.assignTexture(o,"aoMap",n.occlusionTexture)),void 0!==n.occlusionTexture.strength&&(o.aoMapIntensity=n.occlusionTexture.strength)),void 0!==n.emissiveFactor&&t!==kb&&(o.emissive=new ga().fromArray(n.emissiveFactor)),void 0!==n.emissiveTexture&&t!==kb&&p.push(i.assignTexture(o,"emissiveMap",n.emissiveTexture)),Promise.all(p).then(function(){var a;return a=t===h?s[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new t(o),n.name&&(a.name=n.name),a.map&&(a.map.encoding=vc),a.emissiveMap&&(a.emissiveMap.encoding=vc),U(a,n),i.associations.set(a,{type:"materials",index:e}),n.extensions&&N(s,a,n),a})},G.prototype.loadGeometries=function(e){var t=this,i=this.extensions,a=this.primitiveCache;function s(e){return i[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(r){return k(r,e,t)})}for(var n,o,l=[],p=0,c=e.length;p<c;p++){var u,m=e[p],h=(o=void 0,(o=(n=m).extensions&&n.extensions[r.KHR_DRACO_MESH_COMPRESSION])?"draco:"+o.bufferView+":"+o.indices+":"+D(o.attributes):n.indices+":"+D(n.attributes)+":"+n.mode),d=a[h];if(d)l.push(d.promise);else u=m.extensions&&m.extensions[r.KHR_DRACO_MESH_COMPRESSION]?s(m):k(new ia,m,t),a[h]={primitive:m,promise:u},l.push(u)}return Promise.all(l)},G.prototype.loadMesh=function(e){for(var t,r=this,i=this.json.meshes[e],a=i.primitives,s=[],n=0,o=a.length;n<o;n++){var l=void 0===a[n].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new Hb({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Pe})),t.DefaultMaterial):this.getDependency("material",a[n].material);s.push(l)}return s.push(r.loadGeometries(a)),Promise.all(s).then(function(t){for(var s=t.slice(0,t.length-1),n=t[t.length-1],o=[],l=0,p=n.length;l<p;l++){var c,u=n[l],m=a[l],h=s[l];if(m.mode===y||m.mode===S||m.mode===O||void 0===m.mode)!0!==(c=!0===i.isSkinnedMesh?new so(u,h):new Aa(u,h)).isSkinnedMesh||c.geometry.attributes.skinWeight.normalized||c.normalizeSkinWeights(),m.mode===S?c.geometry=B(c.geometry,jS):m.mode===O&&(c.geometry=B(c.geometry,Pz));else if(m.mode===$)c=new ub(u,h);else if(m.mode===M)c=new Lc(u,h);else if(m.mode===T)c=new zo(u,h);else{if(m.mode!==v)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);c=new Co(u,h)}Object.keys(c.geometry.morphAttributes).length>0&&H(c,i),c.name=i.name||"mesh_"+e,n.length>1&&(c.name+="_"+l),U(c,i),r.assignFinalMaterial(c),o.push(c)}if(1===o.length)return o[0];var d=new _f;for(l=0,p=o.length;l<p;l++)d.add(o[l]);return d})},G.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],i=r[r.type];if(i)return"perspective"===r.type?t=new zb(ta.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===r.type&&(t=new kj(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(t.name=r.name),U(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},G.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return r.inverseBindMatrices=e,r})},G.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],i=[],a=[],s=[],n=[],o=0,l=t.channels.length;o<l;o++){var p=t.channels[o],c=t.samplers[p.sampler],u=p.target,m=void 0!==u.node?u.node:u.id,h=void 0!==t.parameters?t.parameters[c.input]:c.input,d=void 0!==t.parameters?t.parameters[c.output]:c.output;r.push(this.getDependency("node",m)),i.push(this.getDependency("accessor",h)),a.push(this.getDependency("accessor",d)),s.push(c),n.push(u)}return Promise.all([Promise.all(r),Promise.all(i),Promise.all(a),Promise.all(s),Promise.all(n)]).then(function(r){for(var i=r[0],a=r[1],s=r[2],n=r[3],o=r[4],l=[],p=0,c=i.length;p<c;p++){var u=i[p],m=a[p],h=s[p],d=n[p],f=o[p];if(void 0!==u){var v;switch(u.updateMatrix(),u.matrixAutoUpdate=!0,w[f.path]){case w.weights:v=hj;break;case w.rotation:v=Hl;break;case w.position:case w.scale:default:v=ij;}var $=u.name?u.name:u.uuid,T=void 0!==d.interpolation?A[d.interpolation]:ls,M=[];w[f.path]===w.weights?u.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&M.push(e.name?e.name:e.uuid)}):M.push($);var y=h.array;if(h.normalized){var S;if(y.constructor===Int8Array)S=1/127;else if(y.constructor===Uint8Array)S=1/255;else if(y.constructor==Int16Array)S=1/32767;else{if(y.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");S=1/65535}for(var O=new Float32Array(y.length),x=0,R=y.length;x<R;x++)O[x]=y[x]*S;y=O}for(x=0,R=M.length;x<R;x++){var L=new v(M[x]+"."+w[f.path],m.array,y,T);"CUBICSPLINE"===d.interpolation&&(L.createInterpolant=function(e){return new g(this.times,this.values,this.getValueSize()/3,e)},L.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(L)}}}var _=t.name?t.name:"animation_"+e;return new dd(_,void 0,l)})},G.prototype.loadNode=function(e){var t,i=this.json,a=this.extensions,s=this,n=i.meshReferences,o=i.meshUses,l=i.nodes[e];return(t=[],void 0!==l.mesh&&t.push(s.getDependency("mesh",l.mesh).then(function(e){var t;if(n[l.mesh]>1){var r=o[l.mesh]++;(t=e.clone()).name+="_instance_"+r}else t=e;return void 0!==l.weights&&t.traverse(function(e){if(e.isMesh)for(var t=0,r=l.weights.length;t<r;t++)e.morphTargetInfluences[t]=l.weights[t]}),t})),void 0!==l.camera&&t.push(s.getDependency("camera",l.camera)),l.extensions&&l.extensions[r.KHR_LIGHTS_PUNCTUAL]&&void 0!==l.extensions[r.KHR_LIGHTS_PUNCTUAL].light&&t.push(s.getDependency("light",l.extensions[r.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(t)).then(function(t){var r;if((r=!0===l.isBone?new Ys:t.length>1?new _f:1===t.length?t[0]:new ja)!==t[0])for(var i=0,n=t.length;i<n;i++)r.add(t[i]);if(l.name&&(r.userData.name=l.name,r.name=Ib.sanitizeNodeName(l.name)),U(r,l),l.extensions&&N(a,r,l),void 0!==l.matrix){var o=new fa;o.fromArray(l.matrix),r.applyMatrix4(o)}else void 0!==l.translation&&r.position.fromArray(l.translation),void 0!==l.rotation&&r.quaternion.fromArray(l.rotation),void 0!==l.scale&&r.scale.fromArray(l.scale);return s.associations.set(r,{type:"nodes",index:e}),r})},G.prototype.loadScene=function(){function e(t,r,i,a){var s=i.nodes[t];return a.getDependency("node",t).then(function(e){return void 0===s.skin?e:a.getDependency("skin",s.skin).then(function(e){for(var r=[],i=0,s=(t=e).joints.length;i<s;i++)r.push(a.getDependency("node",t.joints[i]));return Promise.all(r)}).then(function(r){return e.traverse(function(e){if(e.isMesh){for(var i=[],a=[],s=0,n=r.length;s<n;s++){var o=r[s];if(o){i.push(o);var l=new fa;void 0!==t.inverseBindMatrices&&l.fromArray(t.inverseBindMatrices.array,16*s),a.push(l)}else console.warn("THREE.GLTFLoader: Joint \"%s\" could not be found.",t.joints[s])}e.bind(new to(i,a),e.matrixWorld)}}),e});var t}).then(function(t){r.add(t);var n=[];if(s.children)for(var o=s.children,l=0,p=o.length;l<p;l++){var c=o[l];n.push(e(c,t,i,a))}return Promise.all(n)})}return function(t){var r=this.json,i=this.extensions,a=this.json.scenes[t],s=new _f;a.name&&(s.name=a.name),U(s,a),a.extensions&&N(i,s,a);for(var n=a.nodes||[],o=[],l=0,p=n.length;l<p;l++)o.push(e(n[l],s,r,this));return Promise.all(o).then(function(){return s})}}(),e}();function ef(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zD(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r}var Rb,ff,AD,Kba,Lba,Mba,fm,BD,hd={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Aj={duration:.5,overwrite:!1,delay:0},je=1e8,Ra=1/je,Yt=2*Math.PI,Nba=Yt/4,Oba=0,CD=Math.sqrt,Pba=Math.cos,Qba=Math.sin,ic=function(t){return"string"==typeof t},Xb=function(t){return"function"==typeof t},Gd=function(t){return"number"==typeof t},Zt=function(t){return void 0===t},gf=function(t){return"object"==typeof t},zc=function(t){return!1!==t},DD=function(){return"undefined"!=typeof window},ED=function(t){return Xb(t)||ic(t)},FD="function"==typeof ArrayBuffer?ArrayBuffer.isView:function(){},id=Array.isArray,$t=/(?:-?\.?\d|\.)+/gi,GD=/[-+=.]*\d+[.e\-+]*\d*[e\-\+]*\d*/g,Bj=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,_t=/[-+=.]*\d+(?:\.|e-|e)*\d*/gi,HD=/[+-]=-?[\.\d]+/,ID=/[#\-+.]*\b[a-z\d-=+%.]+/gi,Qc={},au={},JD=function(t){return(au=Cj(t,Qc))&&we},bu=function(t,r){return console.warn("Invalid property",t,"set to",r,"Missing plugin? gsap.registerPlugin()")},KD=function(t,r){return!r&&console.warn(t)},LD=function(t,r){return t&&(Qc[t]=r)&&au&&(au[t]=r)||Qc},gm=function(){return 0},cu={},qh=[],MD={},Rc={},du={},Rba=30,Fp=[],ND="",eu=function(t){var r,e,$=t[0];if(gf($)||Xb($)||(t=[t]),!(r=($._gsap||{}).harness)){for(e=Fp.length;e--&&!Fp[e].targetTest($););r=Fp[e]}for(e=t.length;e--;)t[e]&&(t[e]._gsap||(t[e]._gsap=new lE(t[e],r)))||t.splice(e,1);return t},rh=function(t){return t._gsap||eu(ke(t))[0]._gsap},OD=function(t,r,e){return(e=t[r])&&Xb(e)?t[r]():Zt(e)&&t.getAttribute&&t.getAttribute(r)||e},Sc=function(t,r){return(t=t.split(",")).forEach(r)||t},Ja=function(t){return Math.round(1e5*t)/1e5||0},Sba=function(t,r){for(var e=r.length,$=0;t.indexOf(r[$])<0&&++$<e;);return $<e},hm=function(t,r,e){var $,a=Gd(t[1]),i=(a?2:1)+(r<2?0:1),n=t[i];if(a&&(n.duration=t[1]),n.parent=e,r){for($=n;e&&!("immediateRender"in $);)$=e.vars.defaults||{},e=zc(e.vars.inherit)&&e.parent;n.immediateRender=zc($.immediateRender),r<2?n.runBackwards=1:n.startAt=t[i-1]}return n},Gp=function(){var t,r,e=qh.length,$=qh.slice(0);for(MD={},qh.length=0,t=0;t<e;t++)(r=$[t])&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},PD=function(t,r,e,$){qh.length&&Gp(),t.render(r,e,$),qh.length&&Gp()},QD=function(t){var r=parseFloat(t);return(r||0===r)&&(t+"").match(ID).length<2?r:ic(t)?t.trim():t},RD=function(t){return t},jd=function(t,r){for(var e in r)e in t||(t[e]=r[e]);return t},Tba=function(t,r){for(var e in r)e in t||"duration"===e||"ease"===e||(t[e]=r[e])},Cj=function(t,r){for(var e in r)t[e]=r[e];return t},SD=function t(r,e){for(var $ in e)r[$]=gf(e[$])?t(r[$]||(r[$]={}),e[$]):e[$];return r},fu=function(t,r){var e,$={};for(e in t)e in r||($[e]=t[e]);return $},Hp=function(t){var r=t.parent||Rb,e=t.keyframes?Tba:jd;if(zc(t.inherit))for(;r;)e(t,r.vars.defaults),r=r.parent||r._dp;return t},Uba=function(t,r){for(var e=t.length,$=e===r.length;$&&e--&&t[e]===r[e];);return e<0},Vba=function(t,r,e,$,a){void 0===e&&(e="_first"),void 0===$&&($="_last");var i,n=t[$];if(a)for(i=r[a];n&&n[a]>i;)n=n._prev;return n?(r._next=n._next,n._next=r):(r._next=t[e],t[e]=r),r._next?r._next._prev=r:t[$]=r,r._prev=n,r.parent=r._dp=t,r},Ip=function(t,r,e,$){void 0===e&&(e="_first"),void 0===$&&($="_last");var a=r._prev,i=r._next;a?a._next=i:t[e]===r&&(t[e]=i),i?i._prev=a:t[$]===r&&(t[$]=a),r._next=r._prev=r.parent=null},mg=function(t,r){t.parent&&(!r||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},sh=function(t,r){if(!r||r._end>t._dur||r._start<0)for(var e=t;e;)e._dirty=1,e=e.parent;return t},Wba=function(t){for(var r=t.parent;r&&r.parent;)r._dirty=1,r.totalDuration(),r=r.parent;return t},Xba=function t(r){return!r||r._ts&&t(r.parent)},TD=function(t){return t._repeat?Dj(t._tTime,t=t.duration()+t._rDelay)*t:0},Dj=function(t,r){return(t/=r)&&~~t===t?~~t-1:~~t},Jp=function(t,r){return(t-r._start)*r._ts+(r._ts>=0?0:r._dirty?r.totalDuration():r._tDur)},gu=function(t){return t._end=Ja(t._start+(t._tDur/Math.abs(t._ts||t._rts||Ra)||0))},UD=function(t,r){var e=t._dp;return e&&e.smoothChildTiming&&t._ts&&(t._start=Ja(t._dp._time-(t._ts>0?r/t._ts:((t._dirty?t.totalDuration():t._tDur)-r)/-t._ts)),gu(t),e._dirty||sh(e,t)),t},hu=function(t,r){var e;if((r._time||r._initted&&!r._dur)&&(e=Jp(t.rawTime(),r),(!r._dur||im(0,r.totalDuration(),e)-r._tTime>Ra)&&r.render(e,!0)),sh(t,r)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(e=t;e._dp;)e.rawTime()>=0&&e.totalTime(e._tTime),e=e._dp;t._zTime=-Ra}},hf=function(t,r,e,$){return r.parent&&mg(r),r._start=Ja(e+r._delay),r._end=Ja(r._start+(r.totalDuration()/Math.abs(r.timeScale())||0)),Vba(t,r,"_first","_last",t._sort?"_start":0),t._recent=r,$||hu(t,r),t},VD=function(t,r){return(Qc.ScrollTrigger||bu("scrollTrigger",r))&&Qc.ScrollTrigger.create(r,t)},WD=function(t,r,e,$){return qca(t,r),t._initted?!e&&t._pt&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&Mba!==kd.frame?(qh.push(t),t._lazy=[r,$],1):void 0:1},Yba=function(t,r,e,$){var a,i,n=t.ratio,o=r<0||!r&&n&&!t._start&&t._zTime>Ra&&!t._dp._lock||(t._ts<0||t._dp._ts<0)&&"isFromStart"!==t.data&&"isStart"!==t.data?0:1,s=t._rDelay,_=0;if(s&&t._repeat&&(_=im(0,t._tDur,r),Dj(_,s)!==(i=Dj(t._tTime,s))&&(n=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),t._initted||!WD(t,r,$,e))if(o!==n||$||t._zTime===Ra||!r&&t._zTime){for(i=t._zTime,t._zTime=r||(e?Ra:0),e||(e=r&&!i),t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=_,e||Tc(t,"onStart"),a=t._pt;a;)a.r(o,a.d),a=a._next;t._startAt&&r<0&&t._startAt.render(r,!0,!0),t._onUpdate&&!e&&Tc(t,"onUpdate"),_&&t._repeat&&!e&&t.parent&&Tc(t,"onRepeat"),(r>=t._tDur||r<0)&&t.ratio===o&&(o&&mg(t,1),e||(Tc(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=r)},Zba=function(t,r,e){var $;if(e>r)for($=t._first;$&&$._start<=e;){if(!$._dur&&"isPause"===$.data&&$._start>r)return $;$=$._next}else for($=t._last;$&&$._start>=e;){if(!$._dur&&"isPause"===$.data&&$._start<r)return $;$=$._prev}},Ej=function(t,r,e,$){var a=t._repeat,i=Ja(r)||0,n=t._tTime/t._tDur;return n&&!$&&(t._time*=i/t._dur),t._dur=i,t._tDur=a?a<0?1e10:Ja(i*(a+1)+t._rDelay*a):i,n&&!$?UD(t,t._tTime=t._tDur*n):t.parent&&gu(t),e||sh(t.parent,t),t},XD=function(t){return t instanceof Ac?sh(t):Ej(t,t._dur)},$ba={_start:0,endTime:gm},pc=function t(r,e){var $,a,i=r.labels,n=r._recent||$ba,o=r.duration()>=je?n.endTime(!1):r._dur;return ic(e)&&(isNaN(e)||e in i)?"<"===($=e.charAt(0))||">"===$?("<"===$?n._start:n.endTime(n._repeat>=0))+(parseFloat(e.substr(1))||0):($=e.indexOf("="))<0?(e in i||(i[e]=o),i[e]):(a=+(e.charAt($-1)+e.substr($+1)),$>1?t(r,e.substr(0,$-1))+a:o+a):null==e?o:+e},ng=function(t,r){return t||0===t?r(t):r},im=function(t,r,e){return e<t?t:e>r?r:e},jf=function(t){return(t+"").substr((parseFloat(t)+"").length)},_ba=function(t,r,e){return ng(e,function(e){return im(t,r,e)})},iu=[].slice,YD=function(t,r){return t&&gf(t)&&"length"in t&&(!r&&!t.length||t.length-1 in t&&gf(t[0]))&&!t.nodeType&&t!==ff},aca=function(t,r,e){return void 0===e&&(e=[]),t.forEach(function(t){var $;return ic(t)&&!r||YD(t,1)?($=e).push.apply($,ke(t)):e.push(t)})||e},ke=function(t,r){return!ic(t)||r||!AD&&Gj()?id(t)?aca(t,r):YD(t)?iu.call(t,0):t?[t]:[]:iu.call(Kba.querySelectorAll(t),0)},ZD=function(t){return t.sort(function(){return .5-Math.random()})},$D=function(t){if(Xb(t))return t;var r=gf(t)?t:{each:t},e=Hj(r.ease),$=r.from||0,a=parseFloat(r.base)||0,i={},n=$>0&&$<1,o=isNaN($)||n,s=r.axis,_=$,T=$;return ic($)?_=T={center:.5,edges:.5,end:1}[$]||0:!n&&o&&(_=$[0],T=$[1]),function(t,n,S){var p,u,N,l,v,h,c,f,d,m=(S||r).length,g=i[m];if(!g){if(!(d="auto"===r.grid?0:(r.grid||[1,je])[1])){for(c=-je;c<(c=S[d++].getBoundingClientRect().left)&&d<m;);d--}for(g=i[m]=[],p=o?Math.min(d,m)*_-.5:$%d,u=o?m*T/d-.5:$/d|0,c=0,f=je,h=0;h<m;h++)N=h%d-p,l=u-(h/d|0),g[h]=v=s?Math.abs("y"===s?l:N):CD(N*N+l*l),v>c&&(c=v),v<f&&(f=v);"random"===$&&ZD(g),g.max=c-f,g.min=f,g.v=m=(parseFloat(r.amount)||parseFloat(r.each)*(d>m?m-1:s?"y"===s?m/d:d:Math.max(d,m/d))||0)*("edges"===$?-1:1),g.b=m<0?a-m:a,g.u=jf(r.amount||r.each)||0,e=e&&m<0?iE(e):e}return m=(g[t]-g.min)/g.max||0,Ja(g.b+(e?e(m):m)*g.v)+g.u}},ju=function(t){var r=t<1?Math.pow(10,(t+"").length-2):1;return function(e){return Math.floor(Math.round(parseFloat(e)/t)*t*r)/r+(Gd(e)?0:jf(e))}},_D=function(t,r){var e,$,a=id(t);return!a&&gf(t)&&(e=a=t.radius||je,t.values?(t=ke(t.values),($=!Gd(t[0]))&&(e*=e)):t=ju(t.increment)),ng(r,a?Xb(t)?function(r){return $=t(r),Math.abs($-r)<=e?$:r}:function(r){for(var a,i,n=parseFloat($?r.x:r),o=parseFloat($?r.y:0),s=je,_=0,T=t.length;T--;)(a=$?(a=t[T].x-n)*a+(i=t[T].y-o)*i:Math.abs(t[T]-n))<s&&(s=a,_=T);return _=!e||s<=e?t[_]:r,$||_===r||Gd(r)?_:_+jf(r)}:ju(t))},aE=function(t,r,e,$){return ng(id(t)?!r:!0===e?!!(e=0):!$,function(){return id(t)?t[~~(Math.random()*t.length)]:(e=e||1e-5)&&($=e<1?Math.pow(10,(e+"").length-2):1)&&Math.floor(Math.round((t+Math.random()*(r-t))/e)*e*$)/$})},bca=function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return function(t){return r.reduce(function(t,r){return r(t)},t)}},cca=function(t,r){return function(e){return t(parseFloat(e))+(r||jf(e))}},dca=function(t,r,e){return cE(t,r,0,1,e)},bE=function(t,r,e){return ng(e,function(e){return t[~~r(e)]})},eca=function t(r,e,$){var a=e-r;return id(r)?bE(r,t(0,r.length),e):ng($,function(t){return(a+(t-r)%a)%a+r})},fca=function t(r,e,$){var a=e-r,i=2*a;return id(r)?bE(r,t(0,r.length-1),e):ng($,function(t){return r+((t=(i+(t-r)%i)%i||0)>a?i-t:t)})},Kp=function(t){for(var r,e,$,a,i=0,n="";~(r=t.indexOf("random(",i));)$=t.indexOf(")",r),a="["===t.charAt(r+7),e=t.substr(r+7,$-r-7).match(a?ID:$t),n+=t.substr(i,r-i)+aE(a?e:+e[0],a?0:+e[1],+e[2]||1e-5),i=$+1;return n+t.substr(i,t.length-i)},cE=function(t,r,e,$,a){var i=r-t,n=$-e;return ng(a,function(r){return e+((r-t)/i*n||0)})},gca=function t(r,e,$,a){var i=isNaN(r+e)?0:function(t){return(1-t)*r+t*e};if(!i){var n,o,s,_,T,S=ic(r),p={};if(!0===$&&(a=1)&&($=null),S)r={p:r},e={p:e};else if(id(r)&&!id(e)){for(s=[],_=r.length,T=_-2,o=1;o<_;o++)s.push(t(r[o-1],r[o]));_--,i=function(t){t*=_;var r=Math.min(T,~~t);return s[r](t-r)},$=e}else a||(r=Cj(id(r)?[]:{},r));if(!s){for(n in e)nu.call(p,r,n,"get",e[n]);i=function(t){return qu(t,p)||(S?r.p:r)}}}return ng($,i)},dE=function(t,r,e){var $,a,i,n=t.labels,o=je;for($ in n)(a=n[$]-r)<0==!!e&&a&&o>(a=Math.abs(a))&&(i=$,o=a);return i},Tc=function(t,r,e){var $,a,i=t.vars,n=i[r];if(n)return $=i[r+"Params"],a=i.callbackScope||t,e&&qh.length&&Gp(),$?n.apply(a,$):n.call(a)},jm=function(t){return mg(t),t.progress()<1&&Tc(t,"onInterrupt"),t},hca=function(t){var r=(t=!t.name&&t.default||t).name,e=Xb(t),$=r&&!e&&t.init?function(){this._props=[]}:t,a={init:gm,render:qu,add:nu,kill:xca,modifier:wca,rawVars:0},i={targetTest:0,get:0,getSetter:pu,aliases:{},register:0};if(Gj(),t!==$){if(Rc[r])return;jd($,jd(fu(t,a),i)),Cj($.prototype,Cj(a,fu(t,i))),Rc[$.prop=r]=$,t.targetTest&&(Fp.push($),cu[r]=1),r=("css"===r?"CSS":r.charAt(0).toUpperCase()+r.substr(1))+"Plugin"}LD(r,$),t.register&&t.register(we,$,Bc)},fb=255,km={aqua:[0,fb,fb],lime:[0,fb,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,fb],navy:[0,0,128],white:[fb,fb,fb],olive:[128,128,0],yellow:[fb,fb,0],orange:[fb,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[fb,0,0],pink:[fb,192,203],cyan:[0,fb,fb],transparent:[fb,fb,fb,0]},ku=function(t,r,e){return(6*(t=t<0?t+1:t>1?t-1:t)<1?r+(e-r)*t*6:t<.5?e:3*t<2?r+(e-r)*(2/3-t)*6:r)*fb+.5|0},eE=function(t,r,e){var $,a,i,n,o,s,_,T,S,p,u=t?Gd(t)?[t>>16,t>>8&fb,t&fb]:0:km.black;if(!u){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),km[t])u=km[t];else if("#"===t.charAt(0))4===t.length&&($=t.charAt(1),a=t.charAt(2),i=t.charAt(3),t="#"+$+$+a+a+i+i),u=[(t=parseInt(t.substr(1),16))>>16,t>>8&fb,t&fb];else if("hsl"===t.substr(0,3)){if(u=p=t.match($t),r){if(~t.indexOf("="))return u=t.match(GD),e&&u.length<4&&(u[3]=1),u}else n=+u[0]%360/360,o=+u[1]/100,$=2*(s=+u[2]/100)-(a=s<=.5?s*(o+1):s+o-s*o),u.length>3&&(u[3]*=1),u[0]=ku(n+1/3,$,a),u[1]=ku(n,$,a),u[2]=ku(n-1/3,$,a);}else u=t.match($t)||km.transparent;u=u.map(Number)}return r&&!p&&($=u[0]/fb,a=u[1]/fb,i=u[2]/fb,s=((_=Math.max($,a,i))+(T=Math.min($,a,i)))/2,_===T?n=o=0:(S=_-T,o=s>.5?S/(2-_-T):S/(_+T),n=_===$?(a-i)/S+(a<i?6:0):_===a?(i-$)/S+2:($-a)/S+4,n*=60),u[0]=~~(n+.5),u[1]=~~(100*o+.5),u[2]=~~(100*s+.5)),e&&u.length<4&&(u[3]=1),u},fE=function(t){var r=[],e=[],$=-1;return t.split(Fj).forEach(function(t){var a=t.match(Bj)||[];r.push.apply(r,a),e.push($+=a.length+1)}),r.c=e,r},gE=function(t,r,e){var $,a,i,n,o="",s=(t+o).match(Fj),_=r?"hsla(":"rgba(",T=0;if(!s)return t;if(s=s.map(function(t){return(t=eE(t,r,1))&&_+(r?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"}),e&&(i=fE(t),($=e.c).join(o)!==i.c.join(o)))for(n=(a=t.replace(Fj,"1").split(Bj)).length-1;T<n;T++)o+=a[T]+(~$.indexOf(T)?s.shift()||_+"0,0,0,0)":(i.length?i:s.length?s:e).shift());if(!a)for(n=(a=t.split(Fj)).length-1;T<n;T++)o+=a[T]+s[T];return o+a[n]},Fj=function(){var t,r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(t in km)r+="|"+t+"\\b";return new RegExp(r+")","gi")}(),ica=/hsl[a]?\(/,hE=function(t){var r,e=t.join(" ");if(Fj.lastIndex=0,Fj.test(e))return r=ica.test(e),t[1]=gE(t[1],r),t[0]=gE(t[0],r,fE(t[1])),!0},kd=function(){var t,r,e,$,a,i,n=Date.now,o=500,s=33,_=n(),T=_,S=1e3/240,p=S,u=[],N=function e(N){var l,v,h,c,f=n()-T,d=!0===N;if(f>o&&(_+=f-s),((l=(h=(T+=f)-_)-p)>0||d)&&(c=++$.frame,a=h-1e3*$.time,$.time=h/=1e3,p+=l+(l>=S?4:S-l),v=1),d||(t=r(e)),v)for(i=0;i<u.length;i++)u[i](h,a,c,N)};return $={time:0,frame:0,tick:function(){N(!0)},deltaRatio:function(t){return a/(1e3/(t||60))},wake:function(){Lba&&(!AD&&DD()&&(ff=AD=window,Kba=ff.document||{},Qc.gsap=we,(ff.gsapVersions||(ff.gsapVersions=[])).push(we.version),JD(au||ff.GreenSockGlobals||!ff.gsap&&ff||{}),e=ff.requestAnimationFrame),t&&$.sleep(),r=e||function(t){return setTimeout(t,p-1e3*$.time+1|0)},BD=1,N(2))},sleep:function(){(e?ff.cancelAnimationFrame:clearTimeout)(t),BD=0,r=gm},lagSmoothing:function(t,r){o=t||1/Ra,s=Math.min(r,o,0)},fps:function(t){S=1e3/(t||240),p=1e3*$.time+S},add:function(t){u.indexOf(t)<0&&u.push(t),Gj()},remove:function(t){var r;~(r=u.indexOf(t))&&u.splice(r,1)&&i>=r&&i--},_listeners:u}}(),Gj=function(){return!BD&&kd.wake()},Ma={},jca=/^[\d.\-M][\d.\-,\s]/,kca=/["']/g,lca=function(t){for(var r,e,$,a={},i=t.substr(1,t.length-3).split(":"),n=i[0],o=1,s=i.length;o<s;o++)e=i[o],r=o!==s-1?e.lastIndexOf(","):e.length,$=e.substr(0,r),a[n]=isNaN($)?$.replace(kca,"").trim():+$,n=e.substr(r+1).trim();return a},mca=function(t){var r=t.indexOf("(")+1,e=t.indexOf(")"),$=t.indexOf("(",r);return t.substring(r,~$&&$<e?t.indexOf(")",e+1):e)},nca=function(t){var r=(t+"").split("("),e=Ma[r[0]];return e&&r.length>1&&e.config?e.config.apply(null,~t.indexOf("{")?[lca(r[1])]:mca(t).split(",").map(QD)):Ma._CE&&jca.test(t)?Ma._CE("",t):e},iE=function(t){return function(r){return 1-t(1-r)}},jE=function t(r,e){for(var $,a=r._first;a;)a instanceof Ac?t(a,e):!a.vars.yoyoEase||a._yoyo&&a._repeat||a._yoyo===e||(a.timeline?t(a.timeline,e):($=a._ease,a._ease=a._yEase,a._yEase=$,a._yoyo=e)),a=a._next},Hj=function(t,r){return t&&(Xb(t)?t:Ma[t]||nca(t))||r},th=function(t,r,e,$){void 0===e&&(e=function(t){return 1-r(1-t)}),void 0===$&&($=function(t){return t<.5?r(2*t)/2:1-r(2*(1-t))/2});var a,i={easeIn:r,easeOut:e,easeInOut:$};return Sc(t,function(t){for(var r in Ma[t]=Qc[t]=i,Ma[a=t.toLowerCase()]=e,i)Ma[a+("easeIn"===r?".in":"easeOut"===r?".out":".inOut")]=Ma[t+"."+r]=i[r]}),i},kE=function(t){return function(r){return r<.5?(1-t(1-2*r))/2:.5+t(2*(r-.5))/2}},lu=function t(r,e,$){var a=e>=1?e:1,i=($||(r?.3:.45))/(e<1?e:1),n=i/Yt*(Math.asin(1/a)||0),o=function(t){return 1===t?1:a*Math.pow(2,-10*t)*Qba((t-n)*i)+1},s="out"===r?o:"in"===r?function(t){return 1-o(1-t)}:kE(o);return i=Yt/i,s.config=function(e,$){return t(r,e,$)},s},mu=function t(r,e){void 0===e&&(e=1.70158);var $=function(t){return t?--t*t*((e+1)*t+e)+1:0},a="out"===r?$:"in"===r?function(t){return 1-$(1-t)}:kE($);return a.config=function(e){return t(r,e)},a};Sc("Linear,Quad,Cubic,Quart,Quint,Strong",function(t,r){var e=r<5?r+1:r;th(t+",Power"+(e-1),r?function(t){return Math.pow(t,e)}:function(t){return t},function(t){return 1-Math.pow(1-t,e)},function(t){return t<.5?Math.pow(2*t,e)/2:1-Math.pow(2*(1-t),e)/2})}),Ma.Linear.easeNone=Ma.none=Ma.Linear.easeIn,th("Elastic",lu("in"),lu("out"),lu()),function(t,r){var e=1/r,$=function($){return $<e?t*$*$:$<.7272727272727273?t*Math.pow($-1.5/r,2)+.75:$<.9090909090909092?t*($-=2.25/r)*$+.9375:t*Math.pow($-2.625/r,2)+.984375};th("Bounce",function(t){return 1-$(1-t)},$)}(7.5625,2.75),th("Expo",function(t){return t?Math.pow(2,10*(t-1)):0}),th("Circ",function(t){return-(CD(1-t*t)-1)}),th("Sine",function(t){return 1===t?1:1-Pba(t*Nba)}),th("Back",mu("in"),mu("out"),mu()),Ma.SteppedEase=Ma.steps=Qc.SteppedEase={config:function(t,r){void 0===t&&(t=1);var e=1/t,$=t+(r?0:1),a=r?1:0,i=1-Ra;return function(t){return(($*im(0,i,t)|0)+a)*e}}},Aj.ease=Ma["quad.out"],Sc("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(t){return ND+=t+","+t+"Params,"});var lE=function(t,r){this.id=Oba++,t._gsap=this,this.target=t,this.harness=r,this.get=r?r.get:OD,this.set=r?r.getSetter:pu};var lm=function(){function t(t,r){var e=t.parent||Rb;this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Ej(this,+t.duration,1,1),this.data=t.data,BD||kd.wake(),e&&hf(e,this,r||0===r?r:e._time,1),t.reversed&&this.reverse(),t.paused&&this.paused(!0)}var r=t.prototype;return r.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},r.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},r.totalDuration=function(t){return arguments.length?(this._dirty=0,Ej(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},r.totalTime=function(t,r){if(Gj(),!arguments.length)return this._tTime;var e=this._dp;if(e&&e.smoothChildTiming&&this._ts){for(UD(this,t);e.parent;)e.parent._time!==e._start+(e._ts>=0?e._tTime/e._ts:(e.totalDuration()-e._tTime)/-e._ts)&&e.totalTime(e._tTime,!0),e=e.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&hf(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===Ra||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),PD(this,t,r)),this},r.time=function(t,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+TD(this))%this._dur||(t?this._dur:0),r):this._time},r.totalProgress=function(t,r){return arguments.length?this.totalTime(this.totalDuration()*t,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},r.progress=function(t,r){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+TD(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},r.iteration=function(t,r){var e=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*e,r):this._repeat?Dj(this._tTime,e)+1:1},r.timeScale=function(t){if(!arguments.length)return this._rts===-Ra?0:this._rts;if(this._rts===t)return this;var r=this.parent&&this._ts?Jp(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||t===-Ra?0:this._rts,Wba(this.totalTime(im(-this._delay,this._tDur,r),!0))},r.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Gj(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&(this._tTime-=Ra)&&Math.abs(this._zTime)!==Ra))),this):this._ps},r.startTime=function(t){if(arguments.length){this._start=t;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&hf(r,this,t-this._delay),this}return this._start},r.endTime=function(t){return this._start+(zc(t)?this.totalDuration():this.duration())/Math.abs(this._ts)},r.rawTime=function(t){var r=this.parent||this._dp;return r?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Jp(r.rawTime(t),this):this._tTime:this._tTime},r.globalTime=function(t){for(var r=this,e=arguments.length?t:r.rawTime();r;)e=r._start+e/(r._ts||1),r=r._dp;return e},r.repeat=function(t){return arguments.length?(this._repeat=t,XD(this)):this._repeat},r.repeatDelay=function(t){return arguments.length?(this._rDelay=t,XD(this)):this._rDelay},r.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},r.seek=function(t,r){return this.totalTime(pc(this,t),zc(r))},r.restart=function(t,r){return this.play().totalTime(t?-this._delay:0,zc(r))},r.play=function(t,r){return null!=t&&this.seek(t,r),this.reversed(!1).paused(!1)},r.reverse=function(t,r){return null!=t&&this.seek(t||this.totalDuration(),r),this.reversed(!0).paused(!1)},r.pause=function(t,r){return null!=t&&this.seek(t,r),this.paused(!0)},r.resume=function(){return this.paused(!1)},r.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-Ra:0)),this):this._rts<0},r.invalidate=function(){return this._initted=0,this._zTime=-Ra,this},r.isActive=function(){var t,r=this.parent||this._dp,e=this._start;return!(r&&!(this._ts&&this._initted&&r.isActive()&&(t=r.rawTime(!0))>=e&&t<this.endTime(!0)-Ra))},r.eventCallback=function(t,r,e){var $=this.vars;return arguments.length>1?(r?($[t]=r,e&&($[t+"Params"]=e),"onUpdate"===t&&(this._onUpdate=r)):delete $[t],this):$[t]},r.then=function(t){var r=this;return new Promise(function(e){var $=Xb(t)?t:RD,a=function(){var t=r.then;r.then=null,Xb($)&&($=$(r))&&($.then||$===r)&&(r.then=t),e($),r.then=t};r._initted&&1===r.totalProgress()&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},r.kill=function(){jm(this)},t}();jd(lm.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Ra,_prom:0,_ps:!1,_rts:1});var Ac=function(t){function r(r,e){var $;return void 0===r&&(r={}),($=t.call(this,r,e)||this).labels={},$.smoothChildTiming=!!r.smoothChildTiming,$.autoRemoveChildren=!!r.autoRemoveChildren,$._sort=zc(r.sortChildren),$.parent&&hu($.parent,ef($)),r.scrollTrigger&&VD(ef($),r.scrollTrigger),$}zD(r,t);var e=r.prototype;return e.to=function(t,r,e){return new Jb(t,hm(arguments,0,this),pc(this,Gd(r)?arguments[3]:e)),this},e.from=function(t,r,e){return new Jb(t,hm(arguments,1,this),pc(this,Gd(r)?arguments[3]:e)),this},e.fromTo=function(t,r,e,$){return new Jb(t,hm(arguments,2,this),pc(this,Gd(r)?arguments[4]:$)),this},e.set=function(t,r,e){return r.duration=0,r.parent=this,Hp(r).repeatDelay||(r.repeat=0),r.immediateRender=!!r.immediateRender,new Jb(t,r,pc(this,e),1),this},e.call=function(t,r,e){return hf(this,Jb.delayedCall(0,t,r),pc(this,e))},e.staggerTo=function(t,r,e,$,a,i,n){return e.duration=r,e.stagger=e.stagger||$,e.onComplete=i,e.onCompleteParams=n,e.parent=this,new Jb(t,e,pc(this,a)),this},e.staggerFrom=function(t,r,e,$,a,i,n){return e.runBackwards=1,Hp(e).immediateRender=zc(e.immediateRender),this.staggerTo(t,r,e,$,a,i,n)},e.staggerFromTo=function(t,r,e,$,a,i,n,o){return $.startAt=e,Hp($).immediateRender=zc($.immediateRender),this.staggerTo(t,r,$,a,i,n,o)},e.render=function(t,r,e){var $,a,i,n,o,s,_,T,S,p,u,N,l=this._time,v=this._dirty?this.totalDuration():this._tDur,h=this._dur,c=this!==Rb&&t>v-Ra&&t>=0?v:t<Ra?0:t,f=this._zTime<0!=t<0&&(this._initted||!h);if(c!==this._tTime||e||f){if(l!==this._time&&h&&(c+=this._time-l,t+=this._time-l),$=c,S=this._start,s=!(T=this._ts),f&&(h||(l=this._zTime),(t||!r)&&(this._zTime=t)),this._repeat&&(u=this._yoyo,o=h+this._rDelay,$=Ja(c%o),c===v?(n=this._repeat,$=h):((n=~~(c/o))&&n===c/o&&($=h,n--),$>h&&($=h)),p=Dj(this._tTime,o),!l&&this._tTime&&p!==n&&(p=n),u&&1&n&&($=h-$,N=1),n!==p&&!this._lock)){var d=u&&1&p,m=d===(u&&1&n);if(n<p&&(d=!d),l=d?0:h,this._lock=1,this.render(l||(N?0:Ja(n*o)),r,!h)._lock=0,!r&&this.parent&&Tc(this,"onRepeat"),this.vars.repeatRefresh&&!N&&(this.invalidate()._lock=1),l!==this._time||s!==!this._ts)return this;if(h=this._dur,v=this._tDur,m&&(this._lock=2,l=d?h+1e-4:-1e-4,this.render(l,!0),this.vars.repeatRefresh&&!N&&this.invalidate()),this._lock=0,!this._ts&&!s)return this;jE(this,N)}if(this._hasPause&&!this._forcing&&this._lock<2&&(_=Zba(this,Ja(l),Ja($)))&&(c-=$-($=_._start)),this._tTime=c,this._time=$,this._act=!T,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t),!l&&$&&!r&&Tc(this,"onStart"),$>=l&&t>=0)for(a=this._first;a;){if(i=a._next,(a._act||$>=a._start)&&a._ts&&_!==a){if(a.parent!==this)return this.render(t,r,e);if(a.render(a._ts>0?($-a._start)*a._ts:(a._dirty?a.totalDuration():a._tDur)+($-a._start)*a._ts,r,e),$!==this._time||!this._ts&&!s){_=0,i&&(c+=this._zTime=-Ra);break}}a=i}else{a=this._last;for(var g=t<0?t:$;a;){if(i=a._prev,(a._act||g<=a._end)&&a._ts&&_!==a){if(a.parent!==this)return this.render(t,r,e);if(a.render(a._ts>0?(g-a._start)*a._ts:(a._dirty?a.totalDuration():a._tDur)+(g-a._start)*a._ts,r,e),$!==this._time||!this._ts&&!s){_=0,i&&(c+=this._zTime=g?-Ra:Ra);break}}a=i}}if(_&&!r&&(this.pause(),_.render($>=l?0:-Ra)._zTime=$>=l?1:-1,this._ts))return this._start=S,gu(this),this.render(t,r,e);this._onUpdate&&!r&&Tc(this,"onUpdate",!0),(c===v&&v>=this.totalDuration()||!c&&l)&&(S!==this._start&&Math.abs(T)===Math.abs(this._ts)||this._lock||((t||!h)&&(c===v&&this._ts>0||!c&&this._ts<0)&&mg(this,1),r||t<0&&!l||!c&&!l||(Tc(this,c===v?"onComplete":"onReverseComplete",!0),this._prom&&!(c<v&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(t,r){var e=this;if(Gd(r)||(r=pc(this,r)),!(t instanceof lm)){if(id(t))return t.forEach(function(t){return e.add(t,r)}),this;if(ic(t))return this.addLabel(t,r);if(!Xb(t))return this;t=Jb.delayedCall(0,t)}return this!==t?hf(this,t,r):this},e.getChildren=function(t,r,e,$){void 0===t&&(t=!0),void 0===r&&(r=!0),void 0===e&&(e=!0),void 0===$&&($=-je);for(var a=[],i=this._first;i;)i._start>=$&&(i instanceof Jb?r&&a.push(i):(e&&a.push(i),t&&a.push.apply(a,i.getChildren(!0,r,e)))),i=i._next;return a},e.getById=function(t){for(var r=this.getChildren(1,1,1),e=r.length;e--;)if(r[e].vars.id===t)return r[e]},e.remove=function(t){return ic(t)?this.removeLabel(t):Xb(t)?this.killTweensOf(t):(Ip(this,t),t===this._recent&&(this._recent=this._last),sh(this))},e.totalTime=function(r,e){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Ja(kd.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),t.prototype.totalTime.call(this,r,e),this._forcing=0,this):this._tTime},e.addLabel=function(t,r){return this.labels[t]=pc(this,r),this},e.removeLabel=function(t){return delete this.labels[t],this},e.addPause=function(t,r,e){var $=Jb.delayedCall(0,r||gm,e);return $.data="isPause",this._hasPause=1,hf(this,$,pc(this,t))},e.removePause=function(t){var r=this._first;for(t=pc(this,t);r;)r._start===t&&"isPause"===r.data&&mg(r),r=r._next},e.killTweensOf=function(t,r,e){for(var $=this.getTweensOf(t,e),a=$.length;a--;)Lp!==$[a]&&$[a].kill(t,r);return this},e.getTweensOf=function(t,r){for(var e,$=[],a=ke(t),i=this._first,n=Gd(r);i;)i instanceof Jb?Sba(i._targets,a)&&(n?(!Lp||i._initted&&i._ts)&&i.globalTime(0)<=r&&i.globalTime(i.totalDuration())>r:!r||i.isActive())&&$.push(i):(e=i.getTweensOf(a,r)).length&&$.push.apply($,e),i=i._next;return $},e.tweenTo=function(t,r){r=r||{};var e=this,$=pc(e,t),a=r,i=a.startAt,n=a.onStart,o=a.onStartParams,s=Jb.to(e,jd(r,{ease:"none",lazy:!1,time:$,duration:r.duration||Math.abs(($-(i&&"time"in i?i.time:e._time))/e.timeScale())||Ra,onStart:function(){e.pause();var t=r.duration||Math.abs(($-e._time)/e.timeScale());s._dur!==t&&Ej(s,t,0,1).render(s._time,!0,!0),n&&n.apply(s,o||[])}}));return s},e.tweenFromTo=function(t,r,e){return this.tweenTo(r,jd({startAt:{time:pc(this,t)}},e))},e.recent=function(){return this._recent},e.nextLabel=function(t){return void 0===t&&(t=this._time),dE(this,pc(this,t))},e.previousLabel=function(t){return void 0===t&&(t=this._time),dE(this,pc(this,t),1)},e.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+Ra)},e.shiftChildren=function(t,r,e){void 0===e&&(e=0);for(var $,a=this._first,i=this.labels;a;)a._start>=e&&(a._start+=t,a._end+=t),a=a._next;if(r)for($ in i)i[$]>=e&&(i[$]+=t);return sh(this)},e.invalidate=function(){var r=this._first;for(this._lock=0;r;)r.invalidate(),r=r._next;return t.prototype.invalidate.call(this)},e.clear=function(t){void 0===t&&(t=!0);for(var r,e=this._first;e;)r=e._next,this.remove(e),e=r;return this._time=this._tTime=this._pTime=0,t&&(this.labels={}),sh(this)},e.totalDuration=function(t){var r,e,$,a=0,i=this._last,n=je;if(arguments.length)return this.timeScale((this._repeat<0?this.duration():this.totalDuration())/(this.reversed()?-t:t));if(this._dirty){for($=this.parent;i;)r=i._prev,i._dirty&&i.totalDuration(),(e=i._start)>n&&this._sort&&i._ts&&!this._lock?(this._lock=1,hf(this,i,e-i._delay,1)._lock=0):n=e,e<0&&i._ts&&(a-=e,(!$&&!this._dp||$&&$.smoothChildTiming)&&(this._start+=e/this._ts,this._time-=e,this._tTime-=e),this.shiftChildren(-e,!1,-Infinity),n=0),i._end>a&&i._ts&&(a=i._end),i=r;Ej(this,this===Rb&&this._time>a?this._time:a,1,1),this._dirty=0}return this._tDur},r.updateRoot=function(t){if(Rb._ts&&(PD(Rb,Jp(t,Rb)),Mba=kd.frame),kd.frame>=Rba){Rba+=hd.autoSleep||120;var r=Rb._first;if((!r||!r._ts)&&hd.autoSleep&&kd._listeners.length<2){for(;r&&!r._ts;)r=r._next;r||kd.sleep()}}},r}(lm);jd(Ac.prototype,{_lock:0,_hasPause:0,_forcing:0});var Lp,oca=function(t,r,e,$,a,i,n){var o,s,_,T,S,p,u,N,l=new Bc(this._pt,t,r,0,1,qE,null,a),v=0,h=0;for(l.b=e,l.e=$,e+="",(u=~($+="").indexOf("random("))&&($=Kp($)),i&&(i(N=[e,$],t,r),e=N[0],$=N[1]),s=e.match(_t)||[];o=_t.exec($);)T=o[0],S=$.substring(v,o.index),_?_=(_+1)%5:"rgba("===S.substr(-5)&&(_=1),T!==s[h++]&&(p=parseFloat(s[h-1])||0,l._pt={_next:l._pt,p:S||1===h?S:",",s:p,c:"="===T.charAt(1)?parseFloat(T.substr(2))*("-"===T.charAt(0)?-1:1):parseFloat(T)-p,m:_&&_<4?Math.round:0},v=_t.lastIndex);return l.c=v<$.length?$.substring(v,$.length):"",l.fp=n,(HD.test($)||u)&&(l.e=0),this._pt=l,l},nu=function(t,r,e,$,a,i,n,o,s){Xb($)&&($=$(a||0,t,i));var _,T=t[r],S="get"!==e?e:Xb(T)?s?t[r.indexOf("set")||!Xb(t["get"+r.substr(3)])?r:"get"+r.substr(3)](s):t[r]():T,p=Xb(T)?s?tca:oE:ou;if(ic($)&&(~$.indexOf("random(")&&($=Kp($)),"="===$.charAt(1)&&($=parseFloat(S)+parseFloat($.substr(2))*("-"===$.charAt(0)?-1:1)+(jf(S)||0))),S!==$)return isNaN(S*$)?(!T&&!(r in t)&&bu(r,$),oca.call(this,t,r,S,$,p,o||hd.stringFilter,s)):(_=new Bc(this._pt,t,r,+S||0,$-(S||0),"boolean"==typeof T?vca:pE,0,p),s&&(_.fp=s),n&&_.modifier(n,this,t),this._pt=_)},pca=function(t,r,e,$,a){if(Xb(t)&&(t=mm(t,a,r,e,$)),!gf(t)||t.style&&t.nodeType||id(t)||FD(t))return ic(t)?mm(t,a,r,e,$):t;var i,n={};for(i in t)n[i]=mm(t[i],a,r,e,$);return n},mE=function(t,r,e,$,a,i){var n,o,s,_;if(Rc[t]&&!1!==(n=new Rc[t]).init(a,n.rawVars?r[t]:pca(r[t],$,a,i,e),e,$,i)&&(e._pt=o=new Bc(e._pt,a,t,0,1,n.render,n,0,n.priority),e!==fm))for(s=e._ptLookup[e._targets.indexOf(a)],_=n._props.length;_--;)s[n._props[_]]=o;return n},qca=function t(r,e){var $,a,i,n,o,s,_,T,S,p,u,N,l,v=r.vars,h=v.ease,c=v.startAt,f=v.immediateRender,d=v.lazy,m=v.onUpdate,g=v.onUpdateParams,x=v.callbackScope,y=v.runBackwards,w=v.yoyoEase,b=v.keyframes,P=v.autoRevert,k=r._dur,E=r._startAt,A=r._targets,D=r.parent,C=D&&"nested"===D.data?D.parent._targets:A,F="auto"===r._overwrite,M=r.timeline;if(M&&(!b||!h)&&(h="none"),r._ease=Hj(h,Aj.ease),r._yEase=w?iE(Hj(!0===w?h:w,Aj.ease)):0,w&&r._yoyo&&!r._repeat&&(w=r._yEase,r._yEase=r._ease,r._ease=w),!M){if(N=(T=A[0]?rh(A[0]).harness:0)&&v[T.prop],$=fu(v,cu),E&&E.render(-1,!0).kill(),c){if(mg(r._startAt=Jb.set(A,jd({data:"isStart",overwrite:!1,parent:D,immediateRender:!0,lazy:zc(d),startAt:null,delay:0,onUpdate:m,onUpdateParams:g,callbackScope:x,stagger:0},c))),f)if(e>0)P||(r._startAt=0);else if(k&&!(e<0&&E))return void(e&&(r._zTime=e))}else if(y&&k)if(E)!P&&(r._startAt=0);else if(e&&(f=!1),i=jd({overwrite:!1,data:"isFromStart",lazy:f&&zc(d),immediateRender:f,stagger:0,parent:D},$),N&&(i[T.prop]=N),mg(r._startAt=Jb.set(A,i)),f){if(!e)return}else t(r._startAt,Ra);for(r._pt=0,d=k&&zc(d)||d&&!k,a=0;a<A.length;a++){if(_=(o=A[a])._gsap||eu(A)[a]._gsap,r._ptLookup[a]=p={},MD[_.id]&&Gp(),u=C===A?a:C.indexOf(o),T&&!1!==(S=new T).init(o,N||$,r,u,C)&&(r._pt=n=new Bc(r._pt,o,S.name,0,1,S.render,S,0,S.priority),S._props.forEach(function(t){p[t]=n}),S.priority&&(s=1)),!T||N)for(i in $)Rc[i]&&(S=mE(i,$,r,u,o,C))?S.priority&&(s=1):p[i]=n=nu.call(r,o,i,"get",$[i],u,C,0,v.stringFilter);r._op&&r._op[a]&&r.kill(o,r._op[a]),F&&r._pt&&(Lp=r,Rb.killTweensOf(o,p,r.globalTime(0)),l=!r.parent,Lp=0),r._pt&&d&&(MD[_.id]=1)}s&&rE(r),r._onInit&&r._onInit(r)}r._from=!M&&!!v.runBackwards,r._onUpdate=m,r._initted=(!r._op||r._pt)&&!l},rca=function(t,r){var e,$,a,i,n=t[0]?rh(t[0]).harness:0,o=n&&n.aliases;if(!o)return r;for($ in e=Cj({},r),o)if($ in e)for(a=(i=o[$].split(",")).length;a--;)e[i[a]]=e[$];return e},mm=function(t,r,e,$,a){return Xb(t)?t.call(r,e,$,a):ic(t)&&~t.indexOf("random(")?Kp(t):t},nE=ND+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",sca=(nE+",id,stagger,delay,duration,paused,scrollTrigger").split(","),Jb=function(t){function r(r,e,$,a){var i;"number"==typeof e&&($.duration=e,e=$,$=null);var n,o,s,_,T,S,p,u,N=(i=t.call(this,a?e:Hp(e),$)||this).vars,l=N.duration,v=N.delay,h=N.immediateRender,c=N.stagger,f=N.overwrite,d=N.keyframes,m=N.defaults,g=N.scrollTrigger,x=N.yoyoEase,y=i.parent,w=(id(r)||FD(r)?Gd(r[0]):"length"in e)?[r]:ke(r);if(i._targets=w.length?eu(w):KD("GSAP target "+r+" not found. https://greensock.com",!hd.nullTargetWarn)||[],i._ptLookup=[],i._overwrite=f,d||c||ED(l)||ED(v)){if(e=i.vars,(n=i.timeline=new Ac({data:"nested",defaults:m||{}})).kill(),n.parent=ef(i),d)jd(n.vars.defaults,{ease:"none"}),d.forEach(function(t){return n.to(w,t,">")});else{if(_=w.length,p=c?$D(c):gm,gf(c))for(T in c)~nE.indexOf(T)&&(u||(u={}),u[T]=c[T]);for(o=0;o<_;o++){for(T in s={},e)sca.indexOf(T)<0&&(s[T]=e[T]);s.stagger=0,x&&(s.yoyoEase=x),u&&Cj(s,u),S=w[o],s.duration=+mm(l,ef(i),o,S,w),s.delay=(+mm(v,ef(i),o,S,w)||0)-i._delay,!c&&1===_&&s.delay&&(i._delay=v=s.delay,i._start+=v,s.delay=0),n.to(S,s,p(o,S,w))}n.duration()?l=v=0:i.timeline=0}l||i.duration(l=n.duration())}else i.timeline=0;return!0===f&&(Lp=ef(i),Rb.killTweensOf(w),Lp=0),y&&hu(y,ef(i)),(h||!l&&!d&&i._start===Ja(y._time)&&zc(h)&&Xba(ef(i))&&"nested"!==y.data)&&(i._tTime=-Ra,i.render(Math.max(0,-v))),g&&VD(ef(i),g),i}zD(r,t);var e=r.prototype;return e.render=function(t,r,e){var $,a,i,n,o,s,_,T,S,p=this._time,u=this._tDur,N=this._dur,l=t>u-Ra&&t>=0?u:t<Ra?0:t;if(N){if(l!==this._tTime||!t||e||this._startAt&&this._zTime<0!=t<0){if($=l,T=this.timeline,this._repeat){if(n=N+this._rDelay,$=Ja(l%n),l===u?(i=this._repeat,$=N):((i=~~(l/n))&&i===l/n&&($=N,i--),$>N&&($=N)),(s=this._yoyo&&1&i)&&(S=this._yEase,$=N-$),o=Dj(this._tTime,n),$===p&&!e&&this._initted)return this;i!==o&&(T&&this._yEase&&jE(T,s),!this.vars.repeatRefresh||s||this._lock||(this._lock=e=1,this.render(Ja(n*i),!0).invalidate()._lock=0))}if(!this._initted){if(WD(this,t<0?t:$,e,r))return this._tTime=0,this;if(N!==this._dur)return this.render(t,r,e)}for(this._tTime=l,this._time=$,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=_=(S||this._ease)($/N),this._from&&(this.ratio=_=1-_),$&&!p&&!r&&Tc(this,"onStart"),a=this._pt;a;)a.r(_,a.d),a=a._next;T&&T.render(t<0?t:!$&&s?-Ra:T._dur*_,r,e)||this._startAt&&(this._zTime=t),this._onUpdate&&!r&&(t<0&&this._startAt&&this._startAt.render(t,!0,e),Tc(this,"onUpdate")),this._repeat&&i!==o&&this.vars.onRepeat&&!r&&this.parent&&Tc(this,"onRepeat"),l!==this._tDur&&l||this._tTime!==l||(t<0&&this._startAt&&!this._onUpdate&&this._startAt.render(t,!0,!0),(t||!N)&&(l===this._tDur&&this._ts>0||!l&&this._ts<0)&&mg(this,1),r||t<0&&!p||!l&&!p||(Tc(this,l===u?"onComplete":"onReverseComplete",!0),this._prom&&!(l<u&&this.timeScale()>0)&&this._prom()))}}else Yba(this,t,r,e);return this},e.targets=function(){return this._targets},e.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._act=this._lazy=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),t.prototype.invalidate.call(this)},e.kill=function(t,r){if(void 0===r&&(r="all"),!(t||r&&"all"!==r)&&(this._lazy=0,this.parent))return jm(this);if(this.timeline){var e=this.timeline.totalDuration();return this.timeline.killTweensOf(t,r,Lp&&!0!==Lp.vars.overwrite)._first||jm(this),this.parent&&e!==this.timeline.totalDuration()&&Ej(this,this._dur*this.timeline._tDur/e,0,1),this}var $,a,i,n,o,s,_,T=this._targets,S=t?ke(t):T,p=this._ptLookup,u=this._pt;if((!r||"all"===r)&&Uba(T,S))return"all"===r&&(this._pt=0),jm(this);for($=this._op=this._op||[],"all"!==r&&(ic(r)&&(o={},Sc(r,function(t){return o[t]=1}),r=o),r=rca(T,r)),_=T.length;_--;)if(~S.indexOf(T[_]))for(o in a=p[_],"all"===r?($[_]=r,n=a,i={}):(i=$[_]=$[_]||{},n=r),n)(s=a&&a[o])&&("kill"in s.d&&!0!==s.d.kill(o)||Ip(this,s,"_pt"),delete a[o]),"all"!==i&&(i[o]=1);return this._initted&&!this._pt&&u&&jm(this),this},r.to=function(t,e){return new r(t,e,arguments[2])},r.from=function(t,e){return new r(t,hm(arguments,1))},r.delayedCall=function(t,e,$,a){return new r(e,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:e,onReverseComplete:e,onCompleteParams:$,onReverseCompleteParams:$,callbackScope:a})},r.fromTo=function(t,e,$){return new r(t,hm(arguments,2))},r.set=function(t,e){return e.duration=0,e.repeatDelay||(e.repeat=0),new r(t,e)},r.killTweensOf=function(t,r,e){return Rb.killTweensOf(t,r,e)},r}(lm);jd(Jb.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Sc("staggerTo,staggerFrom,staggerFromTo",function(t){Jb[t]=function(){var r=new Ac,e=iu.call(arguments,0);return e.splice("staggerFromTo"===t?5:4,0,0),r[t].apply(r,e)}});var ou=function(t,r,e){return t[r]=e},oE=function(t,r,e){return t[r](e)},tca=function(t,r,e,$){return t[r]($.fp,e)},uca=function(t,r,e){return t.setAttribute(r,e)},pu=function(t,r){return Xb(t[r])?oE:Zt(t[r])&&t.setAttribute?uca:ou},pE=function(t,r){return r.set(r.t,r.p,Math.round(1e4*(r.s+r.c*t))/1e4,r)},vca=function(t,r){return r.set(r.t,r.p,!!(r.s+r.c*t),r)},qE=function(t,r){var e=r._pt,$="";if(!t&&r.b)$=r.b;else if(1===t&&r.e)$=r.e;else{for(;e;)$=e.p+(e.m?e.m(e.s+e.c*t):Math.round(1e4*(e.s+e.c*t))/1e4)+$,e=e._next;$+=r.c}r.set(r.t,r.p,$,r)},qu=function(t,r){for(var e=r._pt;e;)e.r(t,e.d),e=e._next},wca=function(t,r,e,$){for(var a,i=this._pt;i;)a=i._next,i.p===$&&i.modifier(t,r,e),i=a},xca=function(t){for(var r,e,$=this._pt;$;)e=$._next,$.p===t&&!$.op||$.op===t?Ip(this,$,"_pt"):$.dep||(r=1),$=e;return!r},yca=function(t,r,e,$){$.mSet(t,r,$.m.call($.tween,e,$.mt),$)},rE=function(t){for(var r,e,$,a,i=t._pt;i;){for(r=i._next,e=$;e&&e.pr>i.pr;)e=e._next;(i._prev=e?e._prev:a)?i._prev._next=i:$=i,(i._next=e)?e._prev=i:a=i,i=r}t._pt=$},Bc=function(){function t(t,r,e,$,a,i,n,o,s){this.t=r,this.s=$,this.c=a,this.p=e,this.r=i||pE,this.d=n||this,this.set=o||ou,this.pr=s||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,r,e){this.mSet=this.mSet||this.set,this.set=yca,this.m=t,this.mt=e,this.tween=r},t}();Sc(ND+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(t){return cu[t]=1}),Qc.TweenMax=Qc.TweenLite=Jb,Qc.TimelineLite=Qc.TimelineMax=Ac,Rb=new Ac({sortChildren:!1,defaults:Aj,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),hd.stringFilter=hE;var Mp={registerPlugin:function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];r.forEach(function(t){return hca(t)})},timeline:function(t){return new Ac(t)},getTweensOf:function(t,r){return Rb.getTweensOf(t,r)},getProperty:function(t,r,e,$){ic(t)&&(t=ke(t)[0]);var a=rh(t||{}).get,i=e?RD:QD;return"native"===e&&(e=""),t?r?i((Rc[r]&&Rc[r].get||a)(t,r,e,$)):function(r,e,$){return i((Rc[r]&&Rc[r].get||a)(t,r,e,$))}:t},quickSetter:function(t,r,e){if((t=ke(t)).length>1){var $=t.map(function(t){return we.quickSetter(t,r,e)}),a=$.length;return function(t){for(var r=a;r--;)$[r](t)}}t=t[0]||{};var i=Rc[r],n=rh(t),o=n.harness&&(n.harness.aliases||{})[r]||r,s=i?function(r){var $=new i;fm._pt=0,$.init(t,e?r+e:r,fm,0,[t]),$.render(1,$),fm._pt&&qu(1,fm)}:n.set(t,o);return i?s:function(r){return s(t,o,e?r+e:r,n,1)}},isTweening:function(t){return Rb.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Hj(t.ease,Aj.ease)),SD(Aj,t||{})},config:function(t){return SD(hd,t||{})},registerEffect:function(t){var r=t.name,e=t.effect,$=t.plugins,a=t.defaults,i=t.extendTimeline;($||"").split(",").forEach(function(t){return t&&!Rc[t]&&!Qc[t]&&KD(r+" effect requires "+t+" plugin.")}),du[r]=function(t,r,$){return e(ke(t),jd(r||{},a),$)},i&&(Ac.prototype[r]=function(t,e,$){return this.add(du[r](t,gf(e)?e:($=e)&&{},this),$)})},registerEase:function(t,r){Ma[t]=Hj(r)},parseEase:function(t,r){return arguments.length?Hj(t,r):Ma},getById:function(t){return Rb.getById(t)},exportRoot:function(t,r){void 0===t&&(t={});var e,$,a=new Ac(t);for(a.smoothChildTiming=zc(t.smoothChildTiming),Rb.remove(a),a._dp=0,a._time=a._tTime=Rb._time,e=Rb._first;e;)$=e._next,!r&&!e._dur&&e instanceof Jb&&e.vars.onComplete===e._targets[0]||hf(a,e,e._start-e._delay),e=$;return hf(Rb,a,0),a},utils:{wrap:eca,wrapYoyo:fca,distribute:$D,random:aE,snap:_D,normalize:dca,getUnit:jf,clamp:_ba,splitColor:eE,toArray:ke,mapRange:cE,pipe:bca,unitize:cca,interpolate:gca,shuffle:ZD},install:JD,effects:du,ticker:kd,updateRoot:Ac.updateRoot,plugins:Rc,globalTimeline:Rb,core:{PropTween:Bc,globals:LD,Tween:Jb,Timeline:Ac,Animation:lm,getCache:rh,_removeLinkedListItem:Ip}};Sc("to,from,fromTo,delayedCall,set,killTweensOf",function(t){return Mp[t]=Jb[t]}),kd.add(Ac.updateRoot),fm=Mp.to({},{duration:0});var zca=function(t,r){for(var e=t._pt;e&&e.p!==r&&e.op!==r&&e.fp!==r;)e=e._next;return e},Aca=function(t,r){var e,$,a,i=t._targets;for(e in r)for($=i.length;$--;)(a=t._ptLookup[$][e])&&(a=a.d)&&(a._pt&&(a=zca(a,e)),a&&a.modifier&&a.modifier(r[e],t,i[$],e))},ru=function(t,r){return{name:t,rawVars:1,init:function(t,e,$){$._onInit=function(t){var $,a;if(ic(e)&&($={},Sc(e,function(t){return $[t]=1}),e=$),r){for(a in $={},e)$[a]=r(e[a]);e=$}Aca(t,e)}}}},we=Mp.registerPlugin({name:"attr",init:function(t,r,e,$,a){var i,n;for(i in r)(n=this.add(t,"setAttribute",(t.getAttribute(i)||0)+"",r[i],$,a,0,0,i))&&(n.op=i),this._props.push(i)}},{name:"endArray",init:function(t,r){for(var e=r.length;e--;)this.add(t,e,t[e]||0,r[e])}},ru("roundProps",ju),ru("modifiers"),ru("snap",_D))||Mp;Jb.version=Ac.version=we.version="3.5.0",Lba=1,DD()&&Gj();var d=Ma.Power0,e=Ma.Power1,f=Ma.Power2,g=Ma.Power3,h=Ma.Power4,i=Ma.Linear,j=Ma.Quad,k=Ma.Cubic,l=Ma.Quart,m=Ma.Quint,n=Ma.Strong,o=Ma.Elastic,p=Ma.Back,q=Ma.SteppedEase,r=Ma.Bounce,s=Ma.Sine,t=Ma.Expo,u=Ma.Circ;var Bca,kf,nm,sE,Ij,Np,Cca,Dca,Eca=function(){return"undefined"!=typeof window},og={},uh=180/Math.PI,Jj=Math.PI/180,Kj=Math.atan2,tE=1e8,uE=/([A-Z])/g,Fca=/(?:left|right|width|margin|padding|x)/i,Gca=/[\s,\(]\S/,pg={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},vE=function(r,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*r))/1e4+t.u,t)},Hca=function(r,t){return t.set(t.t,t.p,1===r?t.e:Math.round(1e4*(t.s+t.c*r))/1e4+t.u,t)},Ica=function(r,t){return t.set(t.t,t.p,r?Math.round(1e4*(t.s+t.c*r))/1e4+t.u:t.b,t)},Jca=function(r,t){var $=t.s+t.c*r;t.set(t.t,t.p,~~($+($<0?-.5:.5))+t.u,t)},wE=function(r,t){return t.set(t.t,t.p,r?t.e:t.b,t)},xE=function(r,t){return t.set(t.t,t.p,1!==r?t.b:t.e,t)},Kca=function(r,t,$){return r.style[t]=$},Lca=function(r,t,$){return r.style.setProperty(t,$)},Mca=function(r,t,$){return r._gsap[t]=$},Nca=function(r,t,$){return r._gsap.scaleX=r._gsap.scaleY=$},Oca=function(r,t,$,e,p){var a=r._gsap;a.scaleX=a.scaleY=$,a.renderTransform(p,a)},Pca=function(r,t,$,e,p){var a=r._gsap;a[t]=$,a.renderTransform(p,a)},ld="transform",vh=ld+"Origin",su=function(r,t){var $=kf.createElementNS?kf.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),r):kf.createElement(r);return $.style?$:kf.createElement(r)},lf=function r(t,$,e){var p=getComputedStyle(t);return p[$]||p.getPropertyValue($.replace(uE,"-$1").toLowerCase())||p.getPropertyValue($)||!e&&r(t,Lj($)||$,1)||""},yE="O,Moz,ms,Ms,Webkit".split(","),Lj=function(r,t,$){var e=(t||Ij).style,p=5;if(r in e&&!$)return r;for(r=r.charAt(0).toUpperCase()+r.substr(1);p--&&!(yE[p]+r in e););return p<0?null:(3===p?"ms":p>=0?yE[p]:"")+r},tu=function(){Eca()&&window.document&&(Bca=window,kf=Bca.document,nm=kf.documentElement,Ij=su("div")||{style:{}},Np=su("div"),ld=Lj(ld),vh=ld+"Origin",Ij.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Dca=!!Lj("perspective"),sE=1)},uu=function r(t){var $,e=su("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),p=this.parentNode,a=this.nextSibling,n=this.style.cssText;if(nm.appendChild(e),e.appendChild(this),this.style.display="block",t)try{$=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=r}catch(o){}else this._gsapBBox&&($=this._gsapBBox());return p&&(a?p.insertBefore(this,a):p.appendChild(this)),nm.removeChild(e),this.style.cssText=n,$},zE=function(r,t){for(var $=t.length;$--;)if(r.hasAttribute(t[$]))return r.getAttribute(t[$])},AE=function(r){var t;try{t=r.getBBox()}catch($){t=uu.call(r,!0)}return t&&(t.width||t.height)||r.getBBox===uu||(t=uu.call(r,!0)),!t||t.width||t.x||t.y?t:{x:+zE(r,["x","cx","x1"])||0,y:+zE(r,["y","cy","y1"])||0,width:0,height:0}},BE=function(r){return!(!r.getCTM||r.parentNode&&!r.ownerSVGElement||!AE(r))},Op=function(r,t){if(t){var $=r.style;t in og&&t!==vh&&(t=ld),$.removeProperty?("ms"!==t.substr(0,2)&&"webkit"!==t.substr(0,6)||(t="-"+t),$.removeProperty(t.replace(uE,"-$1").toLowerCase())):$.removeAttribute(t)}},qg=function(r,t,$,e,p,a){var n=new Bc(r._pt,t,$,0,1,a?xE:wE);return r._pt=n,n.b=e,n.e=p,r._props.push($),n},CE={deg:1,rad:1,turn:1},wh=function r(t,$,e,p){var a,n,o,i,s=parseFloat(e)||0,b=(e+"").trim().substr((s+"").length)||"px",_=Ij.style,v=Fca.test($),Z="svg"===t.tagName.toLowerCase(),l=(Z?"client":"offset")+(v?"Width":"Height"),d="px"===p,c="%"===p;return p===b||!s||CE[p]||CE[b]?s:("px"!==b&&!d&&(s=r(t,$,e,"px")),i=t.getCTM&&BE(t),c&&(og[$]||~$.indexOf("adius"))?Ja(s/(i?t.getBBox()[v?"width":"height"]:t[l])*100):(_[v?"width":"height"]=100+(d?b:p),n=~$.indexOf("adius")||"em"===p&&t.appendChild&&!Z?t:t.parentNode,i&&(n=(t.ownerSVGElement||{}).parentNode),n&&n!==kf&&n.appendChild||(n=kf.body),(o=n._gsap)&&c&&o.width&&v&&o.time===kd.time?Ja(s/o.width*100):((c||"%"===b)&&(_.position=lf(t,"position")),n===t&&(_.position="static"),n.appendChild(Ij),a=Ij[l],n.removeChild(Ij),_.position="absolute",v&&c&&((o=rh(n)).time=kd.time,o.width=n[l]),Ja(d?a*s/100:a&&s?100/a*s:0))))},om=function(r,t,$,e){var p;return sE||tu(),t in pg&&"transform"!==t&&~(t=pg[t]).indexOf(",")&&(t=t.split(",")[0]),og[t]&&"transform"!==t?(p=Qp(r,e),p="transformOrigin"!==t?p[t]:Rp(lf(r,vh))+" "+p.zOrigin+"px"):(!(p=r.style[t])||"auto"===p||e||~(p+"").indexOf("calc("))&&(p=Pp[t]&&Pp[t](r,t,$)||lf(r,t)||OD(r,t)||("opacity"===t?1:0)),$&&!~(p+"").indexOf(" ")?wh(r,t,p,$)+$:p},Qca=function(r,t,$,e){if(!$||"none"===$){var p=Lj(t,r,1),a=p&&lf(r,p,1);a&&a!==$?(t=p,$=a):"borderColor"===t&&($=lf(r,"borderTopColor"))}var n,o,i,s,b,_,v,Z,l,d,c,m,f=new Bc(this._pt,r.style,t,0,1,qE),g=0,u=0;if(f.b=$,f.e=e,$+="","auto"===(e+="")&&(r.style[t]=e,e=lf(r,t)||e,r.style[t]=$),n=[$,e],hE(n),e=n[1],i=($=n[0]).match(Bj)||[],(e.match(Bj)||[]).length){for(;o=Bj.exec(e);)v=o[0],l=e.substring(g,o.index),b?b=(b+1)%5:"rgba("!==l.substr(-5)&&"hsla("!==l.substr(-5)||(b=1),v!==(_=i[u++]||"")&&(s=parseFloat(_)||0,c=_.substr((s+"").length),(m="="===v.charAt(1)?+(v.charAt(0)+"1"):0)&&(v=v.substr(2)),Z=parseFloat(v),d=v.substr((Z+"").length),g=Bj.lastIndex-d.length,d||(d=d||hd.units[t]||c,g===e.length&&(e+=d,f.e+=d)),c!==d&&(s=wh(r,t,_,d)||0),f._pt={_next:f._pt,p:l||1===u?l:",",s:s,c:m?m*Z:Z-s,m:b&&b<4?Math.round:0});f.c=g<e.length?e.substring(g,e.length):""}else f.r="display"===t&&"none"===e?xE:wE;return HD.test(e)&&(f.e=0),this._pt=f,f},DE={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Rca=function(r){var t=r.split(" "),$=t[0],e=t[1]||"50%";return"top"!==$&&"bottom"!==$&&"left"!==e&&"right"!==e||(r=$,$=e,e=r),t[0]=DE[$]||$,t[1]=DE[e]||e,t.join(" ")},Sca=function(r,t){if(t.tween&&t.tween._time===t.tween._dur){var $,e,p,a=t.t,n=a.style,o=t.u,i=a._gsap;if("all"===o||!0===o)n.cssText="",e=1;else for(p=(o=o.split(",")).length;--p>-1;)$=o[p],og[$]&&(e=1,$="transformOrigin"===$?vh:ld),Op(a,$);e&&(Op(a,ld),i&&(i.svg&&a.removeAttribute("transform"),Qp(a,1),i.uncache=1))}},Pp={clearProps:function(r,t,$,e,p){if("isFromStart"!==p.data){var a=r._pt=new Bc(r._pt,t,$,0,0,Sca);return a.u=e,a.pr=-10,a.tween=p,r._props.push($),1}}},pm=[1,0,0,1,0,0],EE={},FE=function(r){return"matrix(1, 0, 0, 1, 0, 0)"===r||"none"===r||!r},GE=function(r){var t=lf(r,ld);return FE(t)?pm:t.substr(7).match(GD).map(Ja)},vu=function(r,t){var $,e,p,a,n=r._gsap||rh(r),o=r.style,i=GE(r);return n.svg&&r.getAttribute("transform")?"1,0,0,1,0,0"===(i=[(p=r.transform.baseVal.consolidate().matrix).a,p.b,p.c,p.d,p.e,p.f]).join(",")?pm:i:(i!==pm||r.offsetParent||r===nm||n.svg||(p=o.display,o.display="block",($=r.parentNode)&&r.offsetParent||(a=1,e=r.nextSibling,nm.appendChild(r)),i=GE(r),p?o.display=p:Op(r,"display"),a&&(e?$.insertBefore(r,e):$?$.appendChild(r):nm.removeChild(r))),t&&i.length>6?[i[0],i[1],i[4],i[5],i[12],i[13]]:i)},wu=function(r,t,$,e,p,a){var n,o,i,s=r._gsap,b=p||vu(r,!0),_=s.xOrigin||0,v=s.yOrigin||0,Z=s.xOffset||0,l=s.yOffset||0,d=b[0],c=b[1],m=b[2],f=b[3],g=b[4],u=b[5],h=t.split(" "),x=parseFloat(h[0])||0,P=parseFloat(h[1])||0;$?b!==pm&&(o=d*f-c*m)&&(i=x*(-c/o)+P*(d/o)-(d*u-c*g)/o,x=x*(f/o)+P*(-m/o)+(m*u-f*g)/o,P=i):(x=(n=AE(r)).x+(~h[0].indexOf("%")?x/100*n.width:x),P=n.y+(~(h[1]||h[0]).indexOf("%")?P/100*n.height:P)),e||!1!==e&&s.smooth?(g=x-_,u=P-v,s.xOffset=Z+(g*d+u*m)-g,s.yOffset=l+(g*c+u*f)-u):s.xOffset=s.yOffset=0,s.xOrigin=x,s.yOrigin=P,s.smooth=!!e,s.origin=t,s.originIsAbsolute=!!$,r.style[vh]="0px 0px",a&&(qg(a,s,"xOrigin",_,x),qg(a,s,"yOrigin",v,P),qg(a,s,"xOffset",Z,s.xOffset),qg(a,s,"yOffset",l,s.yOffset)),r.setAttribute("data-svg-origin",x+" "+P)},Qp=function(r,t){var $=r._gsap||new lE(r);if("x"in $&&!t&&!$.uncache)return $;var e,p,a,n,o,i,s,b,_,v,Z,l,d,c,m,f,g,u,h,x,P,y,w,T,S,O,C,D,E,A,M,B,k=r.style,N=$.scaleX<0,z=lf(r,vh)||"0";return e=p=a=i=s=b=_=v=Z=0,n=o=1,$.svg=!(!r.getCTM||!BE(r)),c=vu(r,$.svg),$.svg&&(T=!$.uncache&&r.getAttribute("data-svg-origin"),wu(r,T||z,!!T||$.originIsAbsolute,!1!==$.smooth,c)),l=$.xOrigin||0,d=$.yOrigin||0,c!==pm&&(u=c[0],h=c[1],x=c[2],P=c[3],e=y=c[4],p=w=c[5],6===c.length?(n=Math.sqrt(u*u+h*h),o=Math.sqrt(P*P+x*x),i=u||h?Kj(h,u)*uh:0,(_=x||P?Kj(x,P)*uh+i:0)&&(o*=Math.cos(_*Jj)),$.svg&&(e-=l-(l*u+d*x),p-=d-(l*h+d*P))):(B=c[6],A=c[7],C=c[8],D=c[9],E=c[10],M=c[11],e=c[12],p=c[13],a=c[14],s=(m=Kj(B,E))*uh,m&&(T=y*(f=Math.cos(-m))+C*(g=Math.sin(-m)),S=w*f+D*g,O=B*f+E*g,C=y*-g+C*f,D=w*-g+D*f,E=B*-g+E*f,M=A*-g+M*f,y=T,w=S,B=O),b=(m=Kj(-x,E))*uh,m&&(f=Math.cos(-m),M=P*(g=Math.sin(-m))+M*f,u=T=u*f-C*g,h=S=h*f-D*g,x=O=x*f-E*g),i=(m=Kj(h,u))*uh,m&&(T=u*(f=Math.cos(m))+h*(g=Math.sin(m)),S=y*f+w*g,h=h*f-u*g,w=w*f-y*g,u=T,y=S),s&&Math.abs(s)+Math.abs(i)>359.9&&(s=i=0,b=180-b),n=Ja(Math.sqrt(u*u+h*h+x*x)),o=Ja(Math.sqrt(w*w+B*B)),m=Kj(y,w),_=Math.abs(m)>2e-4?m*uh:0,Z=M?1/(M<0?-M:M):0),$.svg&&(T=r.getAttribute("transform"),$.forceCSS=r.setAttribute("transform","")||!FE(lf(r,ld)),T&&r.setAttribute("transform",T))),Math.abs(_)>90&&Math.abs(_)<270&&(N?(n*=-1,_+=i<=0?180:-180,i+=i<=0?180:-180):(o*=-1,_+=_<=0?180:-180)),$.x=(($.xPercent=e&&Math.round(r.offsetWidth/2)===Math.round(-e)?-50:0)?0:e)+"px",$.y=(($.yPercent=p&&Math.round(r.offsetHeight/2)===Math.round(-p)?-50:0)?0:p)+"px",$.z=a+"px",$.scaleX=Ja(n),$.scaleY=Ja(o),$.rotation=Ja(i)+"deg",$.rotationX=Ja(s)+"deg",$.rotationY=Ja(b)+"deg",$.skewX=_+"deg",$.skewY=v+"deg",$.transformPerspective=Z+"px",($.zOrigin=parseFloat(z.split(" ")[2])||0)&&(k[vh]=Rp(z)),$.xOffset=$.yOffset=0,$.force3D=hd.force3D,$.renderTransform=$.svg?Uca:Dca?HE:Tca,$.uncache=0,$},Rp=function(r){return(r=r.split(" "))[0]+" "+r[1]},xu=function(r,t,$){var e=jf(t);return Ja(parseFloat(t)+parseFloat(wh(r,"x",$+"px",e)))+e},Tca=function(r,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,HE(r,t)},xh="0deg",qm="0px",yh=") ",HE=function(r,t){var $=t||this,e=$.xPercent,p=$.yPercent,a=$.x,n=$.y,o=$.z,i=$.rotation,s=$.rotationY,b=$.rotationX,_=$.skewX,v=$.skewY,Z=$.scaleX,l=$.scaleY,d=$.transformPerspective,c=$.force3D,m=$.target,f=$.zOrigin,g="",u="auto"===c&&r&&1!==r||!0===c;if(f&&(b!==xh||s!==xh)){var h,x=parseFloat(s)*Jj,P=Math.sin(x),y=Math.cos(x);x=parseFloat(b)*Jj,h=Math.cos(x),a=xu(m,a,P*h*-f),n=xu(m,n,-Math.sin(x)*-f),o=xu(m,o,y*h*-f+f)}d!==qm&&(g+="perspective("+d+yh),(e||p)&&(g+="translate("+e+"%, "+p+"%) "),(u||a!==qm||n!==qm||o!==qm)&&(g+=o!==qm||u?"translate3d("+a+", "+n+", "+o+") ":"translate("+a+", "+n+yh),i!==xh&&(g+="rotate("+i+yh),s!==xh&&(g+="rotateY("+s+yh),b!==xh&&(g+="rotateX("+b+yh),_===xh&&v===xh||(g+="skew("+_+", "+v+yh),1===Z&&1===l||(g+="scale("+Z+", "+l+yh),m.style[ld]=g||"translate(0, 0)"},Uca=function(r,t){var $,e,p,a,n,o=t||this,i=o.xPercent,s=o.yPercent,b=o.x,_=o.y,v=o.rotation,Z=o.skewX,l=o.skewY,d=o.scaleX,c=o.scaleY,m=o.target,f=o.xOrigin,g=o.yOrigin,u=o.xOffset,h=o.yOffset,x=o.forceCSS,P=parseFloat(b),y=parseFloat(_);v=parseFloat(v),Z=parseFloat(Z),(l=parseFloat(l))&&(Z+=l=parseFloat(l),v+=l),v||Z?(v*=Jj,Z*=Jj,$=Math.cos(v)*d,e=Math.sin(v)*d,p=Math.sin(v-Z)*-c,a=Math.cos(v-Z)*c,Z&&(l*=Jj,n=Math.tan(Z-l),p*=n=Math.sqrt(1+n*n),a*=n,l&&(n=Math.tan(l),$*=n=Math.sqrt(1+n*n),e*=n)),$=Ja($),e=Ja(e),p=Ja(p),a=Ja(a)):($=d,a=c,e=p=0),(P&&!~(b+"").indexOf("px")||y&&!~(_+"").indexOf("px"))&&(P=wh(m,"x",b,"px"),y=wh(m,"y",_,"px")),(f||g||u||h)&&(P=Ja(P+f-(f*$+g*p)+u),y=Ja(y+g-(f*e+g*a)+h)),(i||s)&&(n=m.getBBox(),P=Ja(P+i/100*n.width),y=Ja(y+s/100*n.height)),n="matrix("+$+","+e+","+p+","+a+","+P+","+y+")",m.setAttribute("transform",n),x&&(m.style[ld]=n)},Vca=function(r,t,$,e,p,a){var n,o,i=ic(p),s=parseFloat(p)*(i&&~p.indexOf("rad")?uh:1),b=a?s*a:s-e,_=e+b+"deg";return i&&("short"===(n=p.split("_")[1])&&(b%=360)!==b%180&&(b+=b<0?360:-360),"cw"===n&&b<0?b=(b+360*tE)%360-360*~~(b/360):"ccw"===n&&b>0&&(b=(b-360*tE)%360-360*~~(b/360))),r._pt=o=new Bc(r._pt,t,$,e,b,Hca),o.e=_,o.u="deg",r._props.push($),o},Wca=function(r,t,$){var e,p,a,n,o,i,s,b=Np.style,_=$._gsap;for(p in b.cssText=getComputedStyle($).cssText+";position:absolute;display:block;",b[ld]=t,kf.body.appendChild(Np),e=Qp(Np,1),og)(a=_[p])!==(n=e[p])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(p)<0&&(o=jf(a)!==(s=jf(n))?wh($,p,a,s):parseFloat(a),i=parseFloat(n),r._pt=new Bc(r._pt,_,p,o,i-o,vE),r._pt.u=s||0,r._props.push(p));kf.body.removeChild(Np)};Sc("padding,margin,Width,Radius",function(r,t){var $="Top",e="Right",p="Bottom",a="Left",n=(t<3?[$,e,p,a]:[$+a,$+e,p+e,p+a]).map(function($){return t<2?r+$:"border"+$+r});Pp[t>1?"border"+r:r]=function(r,t,$,e,p){var a,o;if(arguments.length<4)return a=n.map(function(t){return om(r,t,$)}),5===(o=a.join(" ")).split(a[0]).length?a[0]:o;a=(e+"").split(" "),o={},n.forEach(function(r,t){return o[r]=a[t]=a[t]||a[(t-1)/2|0]}),r.init(t,o,p)}});var IE={name:"css",register:tu,targetTest:function(r){return r.style&&r.nodeType},init:function(r,t,$,e,p){var a,n,o,i,s,b,_,v,Z,l,d,c,m,f,g,u=this._props,h=r.style;for(_ in sE||tu(),t)if("autoRound"!==_&&(n=t[_],!Rc[_]||!mE(_,t,$,e,r,p)))if(s=typeof n,b=Pp[_],"function"===s&&(s=typeof(n=n.call($,e,r,p))),"string"===s&&~n.indexOf("random(")&&(n=Kp(n)),b)b(this,r,_,n,$)&&(g=1);else if("--"===_.substr(0,2))this.add(h,"setProperty",getComputedStyle(r).getPropertyValue(_)+"",n+"",e,p,0,0,_);else if("undefined"!==s){if(a=om(r,_),i=parseFloat(a),(l="string"===s&&"="===n.charAt(1)?+(n.charAt(0)+"1"):0)&&(n=n.substr(2)),o=parseFloat(n),_ in pg&&("autoAlpha"===_&&(1===i&&"hidden"===om(r,"visibility")&&o&&(i=0),qg(this,h,"visibility",i?"inherit":"hidden",o?"inherit":"hidden",!o)),"scale"!==_&&"transform"!==_&&~(_=pg[_]).indexOf(",")&&(_=_.split(",")[0])),d=_ in og){if(c||((m=r._gsap).renderTransform||Qp(r),f=!1!==t.smoothOrigin&&m.smooth,(c=this._pt=new Bc(this._pt,h,ld,0,1,m.renderTransform,m,0,-1)).dep=1),"scale"===_)this._pt=new Bc(this._pt,m,"scaleY",m.scaleY,l?l*o:o-m.scaleY),u.push("scaleY",_),_+="X";else{if("transformOrigin"===_){n=Rca(n),m.svg?wu(r,n,0,f,0,this):((Z=parseFloat(n.split(" ")[2])||0)!==m.zOrigin&&qg(this,m,"zOrigin",m.zOrigin,Z),qg(this,h,_,Rp(a),Rp(n)));continue}if("svgOrigin"===_){wu(r,n,1,f,0,this);continue}if(_ in EE){Vca(this,m,_,i,n,l);continue}if("smoothOrigin"===_){qg(this,m,"smooth",m.smooth,n);continue}if("force3D"===_){m[_]=n;continue}if("transform"===_){Wca(this,n,r);continue}}}else _ in h||(_=Lj(_)||_);if(d||(o||0===o)&&(i||0===i)&&!Gca.test(n)&&_ in h)o||(o=0),(v=(a+"").substr((i+"").length))!==(Z=(n+"").substr((o+"").length)||(_ in hd.units?hd.units[_]:v))&&(i=wh(r,_,a,Z)),this._pt=new Bc(this._pt,d?m:h,_,i,l?l*o:o-i,"px"!==Z||!1===t.autoRound||d?vE:Jca),this._pt.u=Z||0,v!==Z&&(this._pt.b=a,this._pt.r=Ica);else if(_ in h)Qca.call(this,r,_,a,n);else{if(!(_ in r)){bu(_,n);continue}this.add(r,_,r[_],n,e,p)}u.push(_)}g&&rE(this)},get:om,aliases:pg,getSetter:function(r,t,$){var e=pg[t];return e&&e.indexOf(",")<0&&(t=e),t in og&&t!==vh&&(r._gsap.x||om(r,"x"))?$&&Cca===$?"scale"===t?Nca:Mca:(Cca=$||{})&&("scale"===t?Oca:Pca):r.style&&!Zt(r.style[t])?Kca:~t.indexOf("-")?Lca:pu(r,t)},core:{_removeProperty:Op,_getMatrix:vu}};we.utils.checkPrefix=Lj,function(r,t,$,e){var p=Sc("x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+t+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(r){og[r]=1});Sc(t,function(r){hd.units[r]="deg",EE[r]=1}),pg[p[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+t,Sc("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(r){var t=r.split(":");pg[t[1]]=p[t[0]]})}(0,"rotation,rotationX,rotationY,skewX,skewY"),Sc("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){hd.units[r]="px"}),we.registerPlugin(IE);var zh=we.registerPlugin(IE)||we,v=zh.core.Tween;var JE=function(t){Eba(o,Aa);var e=Gba(o);function o(t,i){var r;return Cba(this,o),(r=e.call(this)).__itemModel=t,r.__box=null,r.__center=null,r.__size=null,r.__selected=!1,r.__options=i,r.__selectedMaterial=new ob({color:240,linewidth:5}),r.__boxhelper=new ub(new gh(new Yf(1,1,1)),r.__selectedMaterial),r.__customIntersectionPlanes=[],r.__gltfLoader=new Jba,r.__gltfLoadingProgressEvent=r.__gltfLoadingProgress.bind(em(r)),r.__gltfLoadedEvent=r.__gltfLoaded.bind(em(r)),r.__itemUpdatedEvent=r.__itemUpdated.bind(em(r)),r.__parametricGeometryUpdateEvent=r.__parametricGeometryUpdate.bind(em(r)),r.__itemModel.addEventListener(Fd,r.__itemUpdatedEvent),r.add(r.__boxhelper),r.__boxhelper.material.linewidth=5,r.selected=!1,r.position.copy(r.__itemModel.position),r.__itemModel.isParametric?r.__createParametricItem():r.__loadItemModel(),r}return Dba(o,[{key:"__parametricGeometryUpdate",value:function(t){var e=new fa().getInverse(this.matrixWorld);this.__loadedItem.geometry=this.__itemModel.parametricClass.geometry,this.parent.needsUpdate=!0,this.__box=this.__loadedItem.geometry.boundingBox.clone(),this.__center=this.__box.getCenter(new ba),this.__size=this.__box.getSize(new ba);var o=this.__center.clone().applyMatrix4(e),i=new fa;i=i.makeTranslation(-o.x,-o.y,-o.z),this.__boxhelper.geometry=new gh(new Yf(this.__size.x,this.__size.y,this.__size.z)),this.__boxhelper.rotation.x=this.__itemModel.rotation.x,this.__boxhelper.rotation.y=this.__itemModel.rotation.y,this.__boxhelper.rotation.z=this.__itemModel.rotation.z}},{key:"__itemUpdated",value:function(t){var e=this;e.parent&&(this.__itemModel.offlineUpdate?("position"===t.property&&this.position.set(this.__itemModel.position.x,this.__itemModel.position.y,this.__itemModel.position.z),"rotation"===t.property&&(this.__loadedItem.rotation.set(this.__itemModel.rotation.x,this.__itemModel.rotation.y,this.__itemModel.rotation.z),this.__boxhelper.rotation.set(this.__itemModel.rotation.x,this.__itemModel.rotation.y,this.__itemModel.rotation.z))):("position"===t.property&&this.position.set(this.__itemModel.position.x,this.__itemModel.position.y,this.__itemModel.position.z),"rotation"===t.property&&(zh.to(this.__loadedItem.rotation,{duration:.25,x:this.__itemModel.rotation.x,onUpdate:function(){e.parent&&(e.parent.needsUpdate=!0)}}),zh.to(this.__loadedItem.rotation,{duration:.25,y:this.__itemModel.rotation.y}),zh.to(this.__loadedItem.rotation,{duration:.25,z:this.__itemModel.rotation.z}),zh.to(this.__boxhelper.rotation,{duration:.25,x:this.__itemModel.rotation.x}),zh.to(this.__boxhelper.rotation,{duration:.25,y:this.__itemModel.rotation.y}),zh.to(this.__boxhelper.rotation,{duration:.25,z:this.__itemModel.rotation.z}))),"visible"===t.property&&(this.visible=this.__itemModel.visible))}},{key:"__initializeChildItem",value:function(){this.__box=new wc().setFromObject(this.__loadedItem),this.__center=this.__box.getCenter(new ba),this.__size=this.__box.getSize(new ba),this.__boxhelper.geometry=new gh(new Yf(this.__size.x,this.__size.y,this.__size.z)),this.add(this.__loadedItem),this.geometry=new Yf(this.__size.x,this.__size.y,this.__size.z,1,1,1),this.geometry.computeBoundingBox(),this.material.visible=!1,this.__loadedItem.rotation.x=this.__itemModel.rotation.x,this.__loadedItem.rotation.y=this.__itemModel.rotation.y,this.__loadedItem.rotation.z=this.__itemModel.rotation.z,this.__boxhelper.rotation.x=this.__itemModel.rotation.x,this.__boxhelper.rotation.y=this.__itemModel.rotation.y,this.__boxhelper.rotation.z=this.__itemModel.rotation.z}},{key:"__loadItemModel",value:function(){this.__itemModel.modelURL&&void 0!==this.__itemModel.modelURL&&"undefined"!==this.__itemModel.modelURL&&(this.__loadedItem&&this.remove(this.__loadedItem),this.__gltfLoader.load(this.__itemModel.modelURL,this.__gltfLoadedEvent,this.__gltfLoadingProgressEvent))}},{key:"__gltfLoaded",value:function(t){this.__loadedItem=t.scene,this.__initializeChildItem(),this.dispatchEvent({type:VB})}},{key:"__gltfLoadingProgress",value:function(t){this.dispatchEvent({type:yX,loaded:t.loaded,total:t.total,percent:t.loaded/t.total*100,jsraw:t})}},{key:"__createParametricItem",value:function(){var t=this.__itemModel.parametricClass;t&&(this.__loadedItem=new Aa(t.geometry,t.material),this.__itemModel.parametricClass.addEventListener(tp,this.__parametricGeometryUpdateEvent),this.__initializeChildItem(),this.dispatchEvent({type:VB}))}},{key:"dispose",value:function(){this.__itemModel.dispose(),this.__itemModel.removeEventListener(Fd,this.__itemUpdatedEvent),this.parent.remove(this)}},{key:"snapToPoint",value:function(t,e,o){this.__itemModel.snapToPoint(t,e,o)}},{key:"snapToWall",value:function(t,e,o){this.__itemModel.snapToWall(t,e,o)}},{key:"selected",get:function(){return this.__selected},set:function(t){this.__selected=t,this.__boxhelper.visible=t}},{key:"location",set:function(t){this.__itemModel.position=t},get:function(){return this.__itemModel.position.clone()}},{key:"intersectionPlanes",get:function(){return this.__itemModel.intersectionPlanes}},{key:"itemModel",get:function(){return this.__itemModel}}]),o}();function Xca(e){return(Xca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yca(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KE(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function Zca(e,t,r){return t&&KE(e.prototype,t),r&&KE(e,r),e}function $ca(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_ca(e,t)}function _ca(e,t){return(_ca=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ada(e){var t=cda();return function(){var r,s=LE(e);if(t){var i=LE(this).constructor;r=Reflect.construct(s,arguments,i)}else r=s.apply(this,arguments);return bda(this,r)}}function bda(e,t){return!t||"object"!==Xca(t)&&"function"!=typeof t?Sp(e):t}function Sp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cda(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function LE(e){return(LE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dda(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function ME(e,r){for(var $=0;$<r.length;$++){var n=r[$];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function eda(e,r,$){return r&&ME(e.prototype,r),$&&ME(e,$),e}var fda=function(){function e(){dda(this,e)}return eda(e,null,[{key:"isTouchDevice",value:function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}}]),e}();var yu=fda.isTouchDevice();var gda=function(e){$ca(r,Qa);var t=ada(r);function r(e,s,i,n,o){var _;return Yca(this,r),(_=t.call(this)).__walls=e,_.__floors=s,_.__draggableItems=i,_.__camera=n,_.__domElement=o,_.__enabled=!0,_.__transformGroup=!1,_.__intersections=[],_.__plane=new xc,_.__raycaster=new At,_.__mouse=new ca,_.__offset=new ba,_.__intersection=new ba,_.__worldPosition=new ba,_.__inverseMatrix=new fa,_.__selected=null,_.__hovered=null,_.__timestamp=Date.now(),_.__pressListenerEvent=_.__pressListener.bind(Sp(_)),_.__releaseListenerEvent=_.__releaseListener.bind(Sp(_)),_.__moveListenerEvent=_.__moveListener.bind(Sp(_)),_.activate(),_}return Zca(r,[{key:"__pressListener",value:function(e){var t=Date.now(),r=t-this.__timestamp;this.__timestamp=t,e.preventDefault(),e=void 0!==e.changedTouches?e.changedTouches[0]:e,this.__intersections.length=0;for(var s=[],i=0;i<this.__draggableItems.length;i++)this.__draggableItems[i].visible&&s.push(this.__draggableItems[i]);if(this.__raycaster.setFromCamera(this.__mouse,this.__camera),this.__raycaster.intersectObjects(s,!1,this.__intersections),this.__intersections.length)return this.__selected=this.__transformGroup?this.__draggableItems[0]:this.__intersections[0].object,this.__raycaster.ray.intersectPlane(this.__plane,this.__intersection)&&(this.__inverseMatrix.getInverse(this.__selected.parent.matrixWorld),this.__plane.setFromNormalAndCoplanarPoint(this.__camera.getWorldDirection(this.__plane.normal),this.__worldPosition.setFromMatrixPosition(this.__selected.matrixWorld)),this.__offset.copy(this.__intersection).sub(this.__worldPosition.setFromMatrixPosition(this.__selected.matrixWorld))),this.__domElement.style.cursor="move",void this.dispatchEvent({type:Xl,item:this.__selected});r<300&&this.dispatchEvent({type:pp,item:this.__selected})}},{key:"__releaseListener",value:function(e){if(e.preventDefault(),this.__selected)this.dispatchEvent({type:XB,item:this.__selected}),this.__selected=null;else{e=void 0!==e.changedTouches?e.changedTouches[0]:e,this.__raycaster.setFromCamera(this.__mouse,this.__camera);var t=this.__raycaster.intersectObjects(this.__walls,!1),r=this.__raycaster.intersectObjects(this.__floors,!1);t.length?this.dispatchEvent({type:rp,item:t[0].object.edge,point:t[0].point,normal:t[0].face.normal}):r.length&&this.dispatchEvent({type:sp,item:r[0].object.room,point:r[0].point,normal:r[0].face.normal})}this.__domElement.style.cursor=this.__hovered?"pointer":"auto"}},{key:"__moveListener",value:function(e){e.preventDefault(),e=void 0!==e.changedTouches?e.changedTouches[0]:e;var t=this.__domElement.getBoundingClientRect();if(this.__mouse.x=(e.clientX-t.left)/t.width*2-1,this.__mouse.y=-(e.clientY-t.top)/t.height*2+1,this.__raycaster.setFromCamera(this.__mouse,this.__camera),this.__selected&&this.__enabled&&this.__selected.visible){if(this.__selected.intersectionPlanes.length){var r=this.__selected.intersectionPlanes,s=this.__raycaster.intersectObjects(r,!1);if(s.length){var i=s[0];this.__intersection=i.point;var n=i.point,o=i.face.normal,_=i.object;this.__selected.snapToPoint(n,o,_)}}else if(this.__raycaster.ray.intersectPlane(this.__plane,this.__intersection)){var a=this.__selected.location.clone().copy(this.__intersection.sub(this.__offset).applyMatrix4(this.__inverseMatrix));this.__selected.location=a}this.dispatchEvent({type:WB,item:this.__selected})}else if(!yu)if(this.__intersections.length=0,this.__raycaster.setFromCamera(this.__mouse,this.__camera),this.__raycaster.intersectObjects(this.__draggableItems,!1,this.__intersections),this.__intersections.length){var c=this.__intersections[0].object;this.__plane.setFromNormalAndCoplanarPoint(this.__camera.getWorldDirection(this.__plane.normal),this.__worldPosition.setFromMatrixPosition(c.matrixWorld)),this.__hovered!==c&&(this.__hovered=c,this.__domElement.style.cursor="pointer",this.dispatchEvent({type:AX,item:c}))}else null!==this.__hovered&&(this.__domElement.style.cursor="auto",this.dispatchEvent({type:BX,item:this.__hovered}),this.__hovered=null)}},{key:"dispose",value:function(){this.deactivate()}},{key:"activate",value:function(){this.__domElement.addEventListener("mousedown",this.__pressListenerEvent,!1),this.__domElement.addEventListener("touchstart",this.__pressListenerEvent,!1),this.__domElement.addEventListener("mousemove",this.__moveListenerEvent,!1),this.__domElement.addEventListener("touchmove",this.__moveListenerEvent,!1),this.__domElement.addEventListener("mouseup",this.__releaseListenerEvent,!1),this.__domElement.addEventListener("touchend",this.__releaseListenerEvent,!1)}},{key:"deactivate",value:function(){this.__domElement.removeEventListener("mousedown",this.__pressListenerEvent,!1),this.__domElement.removeEventListener("touchstart",this.__pressListenerEvent,!1),this.__domElement.removeEventListener("mousemove",this.__moveListenerEvent,!1),this.__domElement.removeEventListener("touchmove",this.__moveListenerEvent,!1),this.__domElement.removeEventListener("mouseup",this.__releaseListenerEvent,!1),this.__domElement.removeEventListener("touchend",this.__releaseListenerEvent,!1),this.__domElement.style.cursor=""}},{key:"enabled",get:function(){return this.__enabled},set:function(e){this.__enabled=e}},{key:"draggableItems",get:function(){return this.__draggableItems},set:function(e){this.__draggableItems=e}}]),r}();var hda=function(e){oaa(n,$g);var t=qaa(n);function n(e,r,o){var i;maa(this,n),i=t.call(this);var s={occludedRoofs:!1,occludedWalls:!1,resize:!0,pushHref:!1,spin:!0,spinSpeed:2e-5,clickPan:!0,canMoveFixedItems:!1};for(var a in s)s.hasOwnProperty(a)&&o.hasOwnProperty(a)&&(s[a]=o[a]);return i.__physicalRoomItems=[],i.__enabled=!0,i.model=e,i.floorplan=i.model.floorplan,i.__options=s,i.domElement=document.getElementById(r),i.perspectivecamera=null,i.camera=null,i.__environmentCamera=null,i.cameraNear=10,i.cameraFar=1e5,i.controls=null,i.renderer=null,i.controller=null,i.needsUpdate=!1,i.lastRender=Date.now(),i.heightMargin=null,i.widthMargin=null,i.elementHeight=null,i.elementWidth=null,i.pauseRender=!1,i.edges3d=[],i.floors3d=[],i.__externalEdges3d=[],i.__externalFloors3d=[],i.__currentItemSelected=null,i.needsUpdate=!0,i.__newItemEvent=i.__addNewItem.bind(df(i)),i.__wallSelectedEvent=i.__wallSelected.bind(df(i)),i.__roomSelectedEvent=i.__roomSelected.bind(df(i)),i.__roomItemSelectedEvent=i.__roomItemSelected.bind(df(i)),i.__roomItemUnselectedEvent=i.__roomItemUnselected.bind(df(i)),i.__roomItemDraggedEvent=i.__roomItemDragged.bind(df(i)),i.__roomItemDragFinishEvent=i.__roomItemDragFinish.bind(df(i)),i.__resetDesignEvent=i.__resetDesign.bind(df(i)),i.init(),i}return naa(n,[{key:"init",value:function(){var e=this;Qf.crossOrigin="",e.camera=new zb(45,10,e.cameraNear,e.cameraFar);var t=new Oi(16,{format:Sd,generateMipmaps:!0,minFilter:Of});e.__environmentCamera=new Ni(1,1e5,t),e.__environmentCamera.renderTarget.texture.encoding=vc,e.renderer=e.getARenderer(),e.domElement.appendChild(e.renderer.domElement),e.lights=new Aba(this,e.floorplan),e.dragcontrols=new gda(this.floorplan.wallPlanesForIntersection,this.floorplan.floorPlanesForIntersection,this.physicalRoomItems,e.camera,e.renderer.domElement),e.controls=new cm(e.camera,e.domElement),e.controls.enableDamping=!1,e.controls.dampingFactor=.1,e.controls.maxPolarAngle=1*Math.PI,e.controls.maxDistance=7500,e.controls.minDistance=10,e.controls.screenSpacePanning=!0,e.skybox=new Baa(this,e.renderer),e.camera.position.set(0,600,1500),e.controls.update(),e.axes=new Tl(500),e.updateWindowSize(),e.__options.resize&&(window.addEventListener("resize",function(){e.updateWindowSize()}),window.addEventListener("orientationchange",function(){e.updateWindowSize()})),e.model.addEventListener(It,e.__newItemEvent),e.model.addEventListener(qp,e.__resetDesignEvent),e.model.addEventListener(Wl,e.addRoomItems.bind(e)),e.floorplan.addEventListener(Jt,e.addRoomsAndWalls.bind(e)),e.floorplan.addEventListener(op,e.addExternalRoomsAndWalls.bind(e)),this.controls.addEventListener("change",function(){e.needsUpdate=!0}),e.dragcontrols.addEventListener(Xl,this.__roomItemSelectedEvent),e.dragcontrols.addEventListener(WB,this.__roomItemDraggedEvent),e.dragcontrols.addEventListener(XB,this.__roomItemDragFinishEvent),e.dragcontrols.addEventListener(pp,this.__roomItemUnselectedEvent),e.dragcontrols.addEventListener(rp,this.__wallSelectedEvent),e.dragcontrols.addEventListener(sp,this.__roomSelectedEvent),e.renderer.setAnimationLoop(e.render.bind(this)),e.render()}},{key:"__wallSelected",value:function(e){this.dispatchEvent(e)}},{key:"__roomSelected",value:function(e){this.dispatchEvent(e)}},{key:"__roomItemSelected",value:function(e){this.__currentItemSelected&&(this.__currentItemSelected.selected=!1),this.__currentItemSelected=e.item,this.__currentItemSelected.selected=!0,this.needsUpdate=!0,e.itemModel=this.__currentItemSelected.itemModel,this.dispatchEvent(e)}},{key:"__roomItemDragged",value:function(e){this.controls.enabled=!1,this.needsUpdate=!0}},{key:"__roomItemDragFinish",value:function(e){this.controls.enabled=!0}},{key:"__roomItemUnselected",value:function(e){this.controls.enabled=!0,this.__currentItemSelected&&(this.__currentItemSelected.selected=!1,this.__currentItemSelected=null,this.needsUpdate=!0),this.dispatchEvent(e)}},{key:"__addNewItem",value:function(e){if(e.item){var t=new JE(e.item,this.__options);this.add(t),this.__physicalRoomItems.push(t),this.__roomItemSelected({type:Xl,item:t})}}},{key:"__resetDesign",value:function(e){this.addRoomItems(),this.addRoomsAndWalls(),this.addExternalRoomsAndWalls()}},{key:"addRoomItems",value:function(e){for(var t=0;t<this.__physicalRoomItems.length;t++)this.__physicalRoomItems[t].dispose(),this.remove(this.__physicalRoomItems[t]);this.__physicalRoomItems.length=0;var n=this.model.roomItems;for(t=0;t<n.length;t++){var r=new JE(n[t],this.__options);this.add(r),this.__physicalRoomItems.push(r)}}},{key:"addRoomsAndWalls",value:function(){var e=0;this.floors3d.forEach(function(e){e.destroy(),e=null}),this.edges3d.forEach(function(e){e.remove(),e=null}),this.edges3d=[],this.floors3d=[];var t=this.floorplan.wallEdges(),n=this.floorplan.getRooms();for(e=0;e<n.length;e++){var r=new uD(this,n[e],this.controls,this.__options);this.floors3d.push(r)}for(e=0;e<t.length;e++){var o=new qD(this,t[e],this.controls,this.__options);this.edges3d.push(o)}this.shouldRender=!0;var i=this.floorplan.getDimensions(!0);this.controls.target=i.clone(),this.camera.position.set(i.x,300,5*i.z),this.controls.update()}},{key:"addExternalRoomsAndWalls",value:function(){var e=0;this.__externalFloors3d.forEach(function(e){e.destroy(),e=null}),this.__externalEdges3d.forEach(function(e){e.remove(),e=null}),this.__externalEdges3d=[],this.__externalFloors3d=[];var t=this.floorplan.externalWallEdges(),n=this.floorplan.externalRooms;for(e=0;e<n.length;e++){var r=new uD(this,n[e],this.controls,this.__options);this.__externalFloors3d.push(r)}for(e=0;e<t.length;e++){var o=new qD(this,t[e],this.controls,this.__options);this.__externalEdges3d.push(o)}this.shouldRender=!0;var i=this.floorplan.getDimensions(!0);this.controls.target=i.clone(),this.camera.position.set(i.x,300,5*i.z),this.controls.update()}},{key:"getARenderer",value:function(){var e=new ll({antialias:!0,alpha:!0});return e.shadowMap.enabled=!1,e.shadowMapSoft=!0,e.shadowMap.type=xz,e.setClearColor(16777215,1),e.localClippingEnabled=!1,e.outputEncoding=vc,e.setPixelRatio(window.devicePixelRatio),e}},{key:"updateWindowSize",value:function(){this.heightMargin=this.domElement.offsetTop,this.widthMargin=this.domElement.offsetLeft,this.elementWidth=this.domElement.clientWidth,this.__options.resize?this.elementHeight=window.innerHeight-this.heightMargin:this.elementHeight=this.domElement.clientHeight,this.camera.aspect=this.elementWidth/this.elementHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.elementWidth,this.elementHeight),this.needsUpdate=!0}},{key:"render",value:function(){if(this.enabled){this.needsUpdate&&(this.renderer.render(this,this.camera),this.lastRender=Date.now(),this.needsUpdate=!1)}}},{key:"exportSceneAsGTLF",value:function(){var e=this;new dm().parse(this,function(t){e.dispatchEvent({type:UB,gltf:JSON.stringify(t)})})}},{key:"forceRender",value:function(){this.renderer.render(this,this.camera),this.lastRender=Date.now()}},{key:"addRoomplanListener",value:function(e,t){this.addEventListener(e,t)}},{key:"removeRoomplanListener",value:function(e,t){this.removeEventListener(e,t)}},{key:"environmentCamera",get:function(){return this.__environmentCamera}},{key:"physicalRoomItems",get:function(){return this.__physicalRoomItems}},{key:"enabled",get:function(){return this.__enabled},set:function(e){this.__enabled=e,this.controls.enabled=e,e?this.dragcontrols.activate():this.dragcontrols.deactivate()}}]),n}();function ida(e){return(ida="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NE(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function OE(e,n){for(var o=0;o<n.length;o++){var r=n[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PE(e,n,o){return n&&OE(e.prototype,n),o&&OE(e,o),e}function QE(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&jda(e,n)}function jda(e,n){return(jda=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function RE(e){var n=lda();return function(){var o,r=SE(e);if(n){var t=SE(this).constructor;o=Reflect.construct(r,arguments,t)}else o=r.apply(this,arguments);return kda(this,o)}}function kda(e,n){return!n||"object"!==ida(n)&&"function"!=typeof n?Uc(e):n}function Uc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lda(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function SE(e){return(SE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ya={};var zu,mda,TE,rm={},w=arguments[0];!function(t){var n=t.Promise,e=n&&"resolve"in n&&"reject"in n&&"all"in n&&"race"in n&&function(){var t;return new n(function(n){t=n}),"function"==typeof t}();void 0!==rm&&rm?(mda=e?n:z,rm.Promise=mda,TE=z,rm.Polyfill=TE):"function"==typeof zu&&zu.amd?zu(function(){return e?n:z}):e||(t.Promise=z);var o="pending",r="sealed",i="fulfilled",a="rejected",f=function(){};function c(t){return"[object Array]"===Object.prototype.toString.call(t)}var u,s="undefined"!=typeof setImmediate?setImmediate:setTimeout,l=[];function $(){for(var t=0;t<l.length;t++)l[t][0](l[t][1]);l=[],u=!1}function h(t,n){l.push([t,n]),u||(u=!0,s($,0))}function p(t){var n=t.owner,e=n.state_,o=n.data_,r=t[e],f=t.then;if("function"==typeof r){e=i;try{o=r(o)}catch(c){v(f,c)}}d(f,o)||(e===i&&y(f,o),e===a&&v(f,o))}function d(t,n){var e;try{if(t===n)throw new TypeError("A promises callback cannot return that same promise.");if(n&&("function"==typeof n||"object"==typeof n)){var o=n.then;if("function"==typeof o)return o.call(n,function(o){e||(e=!0,n!==o?y(t,o):j(t,o))},function(n){e||(e=!0,v(t,n))}),!0}}catch(r){return e||v(t,r),!0}return!1}function y(t,n){t!==n&&d(t,n)||j(t,n)}function j(t,n){t.state_===o&&(t.state_=r,t.data_=n,h(w,t))}function v(t,n){t.state_===o&&(t.state_=r,t.data_=n,h(_,t))}function m(t){var n=t.then_;t.then_=void 0;for(var e=0;e<n.length;e++)p(n[e])}function w(t){t.state_=i,m(t)}function _(t){t.state_=a,m(t)}function z(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof z==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,n){function e(t){v(n,t)}try{t(function(t){y(n,t)},e)}catch(o){e(o)}}(t,this)}z.prototype={constructor:z,state_:o,then_:null,data_:void 0,then:function(t,n){var e={owner:this,then:new this.constructor(f),fulfilled:t,rejected:n};return this.state_===i||this.state_===a?h(p,e):this.then_.push(e),e.then},catch:function(t){return this.then(null,t)}},z.all=function(t){if(!c(t))throw new TypeError("You must pass an array to Promise.all().");return new this(function(n,e){var o=[],r=0;function i(t){return r++,function(e){o[t]=e,--r||n(o)}}for(var a,f=0;f<t.length;f++)(a=t[f])&&"function"==typeof a.then?a.then(i(f),e):o[f]=a;r||n(o)})},z.race=function(t){if(!c(t))throw new TypeError("You must pass an array to Promise.race().");return new this(function(n,e){for(var o,r=0;r<t.length;r++)(o=t[r])&&"function"==typeof o.then?o.then(n,e):n(o)})},z.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this(function(n){n(t)})},z.reject=function(t){return new this(function(n,e){e(t)})}}("undefined"!=typeof window?window:"undefined"!=typeof ab?ab:"undefined"!=typeof self?self:rm);var nda={},UE=Object.getOwnPropertySymbols,oda=Object.prototype.hasOwnProperty,pda=Object.prototype.propertyIsEnumerable;function qda(r){if(null==r)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function rda(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de","5"===Object.getOwnPropertyNames(r)[0])return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(r){return e[r]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(r){n[r]=r}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(o){return!1}}nda=rda()?Object.assign:function(r,e){for(var t,n,o=qda(r),a=1;a<arguments.length;a++){for(var $ in t=Object(arguments[a]))oda.call(t,$)&&(o[$]=t[$]);if(UE){n=UE(t);for(var s=0;s<n.length;s++)pda.call(t,n[s])&&(o[n[s]]=t[n[s]])}}return o};var sda=Wc(nda);window.Promise||(window.Promise=TE),Object.assign||(Object.assign=sda.d);var tda=16;if(Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()}),!window.performance||!window.performance.now){var uda=Date.now();window.performance||(window.performance={}),window.performance.now=function(){return Date.now()-uda}}for(var vda=Date.now(),VE=["ms","moz","webkit","o"],Au=0;Au<VE.length&&!window.requestAnimationFrame;++Au){var Bu=VE[Au];window.requestAnimationFrame=window[Bu+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Bu+"CancelAnimationFrame"]||window[Bu+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(r){if("function"!=typeof r)throw new TypeError(r+"is not a function");var n=Date.now(),e=tda+vda-n;return e<0&&(e=0),vda=n,window.setTimeout(function(){vda=Date.now(),r(performance.now())},e)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(r){return clearTimeout(r)}),Math.sign||(Math.sign=function(r){return 0===(r=Number(r))||isNaN(r)?r:r>0?1:-1}),Number.isInteger||(Number.isInteger=function(r){return"number"==typeof r&&isFinite(r)&&Math.floor(r)===r}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array);var Ca={};var Cu={};var Du=/iPhone/i,WE=/iPod/i,XE=/iPad/i,YE=/\biOS-universal(?:.+)Mac\b/i,Eu=/\bAndroid(?:.+)Mobile\b/i,ZE=/Android/i,Mj=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Tp=/Silk/i,mf=/Windows Phone/i,$E=/\bWindows(?:.+)ARM\b/i,_E=/BlackBerry/i,aF=/BB10/i,bF=/Opera Mini/i,cF=/\b(CriOS|Chrome)(?:.+)Mobile/i,dF=/Mobile(?:.+)Firefox\b/i,eF=function($){return void 0!==$&&"MacIntel"===$.platform&&"number"==typeof $.maxTouchPoints&&$.maxTouchPoints>1&&"undefined"==typeof MSStream};function wda($){return function(a){return a.test($)}}function xda($){var a={userAgent:"",platform:"",maxTouchPoints:0};$||"undefined"==typeof navigator?"string"==typeof $?a.userAgent=$:$&&$.userAgent&&(a={userAgent:$.userAgent,platform:$.platform,maxTouchPoints:$.maxTouchPoints||0}):a={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var e=a.userAgent,r=e.split("[FBAN");void 0!==r[1]&&(e=r[0]),void 0!==(r=e.split("Twitter"))[1]&&(e=r[0]);var o=wda(e),v={apple:{phone:o(Du)&&!o(mf),ipod:o(WE),tablet:!o(Du)&&(o(XE)||eF(a))&&!o(mf),universal:o(YE),device:(o(Du)||o(WE)||o(XE)||o(YE)||eF(a))&&!o(mf)},amazon:{phone:o(Mj),tablet:!o(Mj)&&o(Tp),device:o(Mj)||o(Tp)},android:{phone:!o(mf)&&o(Mj)||!o(mf)&&o(Eu),tablet:!o(mf)&&!o(Mj)&&!o(Eu)&&(o(Tp)||o(ZE)),device:!o(mf)&&(o(Mj)||o(Tp)||o(Eu)||o(ZE))||o(/\bokhttp\b/i)},windows:{phone:o(mf),tablet:o($E),device:o(mf)||o($E)},other:{blackberry:o(_E),blackberry10:o(aF),opera:o(bF),firefox:o(dF),chrome:o(cF),device:o(_E)||o(aF)||o(bF)||o(dF)||o(cF)},any:!1,phone:!1,tablet:!1};return v.any=v.apple.device||v.android.device||v.windows.device||v.other.device,v.phone=v.apple.phone||v.android.phone||v.windows.phone,v.tablet=v.apple.tablet||v.android.tablet||v.windows.tablet,v}var md=xda(window.navigator);function yda(e){var t=!0;if(md.tablet||md.phone){var o;if(md.apple.device)if(o=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(o[1],10)<11&&(t=!1);if(md.android.device)if(o=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(o[1],10)<7&&(t=!1)}return t?e:4}function zda(){return!md.apple.device}var ra={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:yda(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:md.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:zda(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};Cu.settings=ra,Cu.isMobile=md;var Ada={},Bda=Object.prototype.hasOwnProperty,Cc="~";function sm(){}function Cda(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function fF(e,t,r,n,$){if("function"!=typeof r)throw new TypeError("The listener must be a function");var v=new Cda(r,n||e,$),a=Cc?Cc+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],v]:e._events[a].push(v):(e._events[a]=v,e._eventsCount++),e}function Up(e,t){0==--e._eventsCount?e._events=new sm:delete e._events[t]}function jc(){this._events=new sm,this._eventsCount=0}Object.create&&(sm.prototype=Object.create(null),new sm().__proto__||(Cc=!1)),jc.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)Bda.call(e,t)&&r.push(Cc?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},jc.prototype.listeners=function(e){var t=Cc?Cc+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,$=r.length,v=new Array($);n<$;n++)v[n]=r[n].fn;return v},jc.prototype.listenerCount=function(e){var t=Cc?Cc+e:e,r=this._events[t];return r?r.fn?1:r.length:0},jc.prototype.emit=function(e,t,r,n,$,v){var a=Cc?Cc+e:e;if(!this._events[a])return!1;var i,J,l=this._events[a],s=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),s){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,n),!0;case 5:return l.fn.call(l.context,t,r,n,$),!0;case 6:return l.fn.call(l.context,t,r,n,$,v),!0;}for(J=1,i=new Array(s-1);J<s;J++)i[J-1]=arguments[J];l.fn.apply(l.context,i)}else{var o,f=l.length;for(J=0;J<f;J++)switch(l[J].once&&this.removeListener(e,l[J].fn,void 0,!0),s){case 1:l[J].fn.call(l[J].context);break;case 2:l[J].fn.call(l[J].context,t);break;case 3:l[J].fn.call(l[J].context,t,r);break;case 4:l[J].fn.call(l[J].context,t,r,n);break;default:if(!i)for(o=1,i=new Array(s-1);o<s;o++)i[o-1]=arguments[o];l[J].fn.apply(l[J].context,i);}}return!0},jc.prototype.on=function(e,t,r){return fF(this,e,t,r,!1)},jc.prototype.once=function(e,t,r){return fF(this,e,t,r,!0)},jc.prototype.removeListener=function(e,t,r,n){var $=Cc?Cc+e:e;if(!this._events[$])return this;if(!t)return Up(this,$),this;var v=this._events[$];if(v.fn)v.fn!==t||n&&!v.once||r&&v.context!==r||Up(this,$);else{for(var a=0,i=[],J=v.length;a<J;a++)(v[a].fn!==t||n&&!v[a].once||r&&v[a].context!==r)&&i.push(v[a]);i.length?this._events[$]=1===i.length?i[0]:i:Up(this,$)}return this},jc.prototype.removeAllListeners=function(e){var t;return e?(t=Cc?Cc+e:e,this._events[t]&&Up(this,t)):(this._events=new sm,this._eventsCount=0),this},jc.prototype.off=jc.prototype.removeListener,jc.prototype.addListener=jc.prototype.on,jc.prefixed=Cc,jc.EventEmitter=jc,Ada=jc;var Dda={};function Vp(v,r,e){e=e||2;var $,n,t,a,i,h,x,o=r&&r.length,w=o?r[0]*e:v.length,l=gF(v,0,w,e,!0),u=[];if(!l||l.next===l.prev)return u;if(o&&(l=Ida(v,r,l,e)),v.length>80*e){$=t=v[0],n=a=v[1];for(var s=e;s<w;s+=e)(i=v[s])<$&&($=i),(h=v[s+1])<n&&(n=h),i>t&&(t=i),h>a&&(a=h);x=0!==(x=Math.max(t-$,a-n))?1/x:0}return tm(l,u,e,$,n,x),u}function gF(v,r,e,$,n){var t,a;if(n===Hu(v,r,e,$)>0)for(t=r;t<e;t+=$)a=jF(t,v[t],v[t+1],a);else for(t=e-$;t>=r;t-=$)a=jF(t,v[t],v[t+1],a);return a&&Wp(a,a.next)&&(vm(a),a=a.next),a}function rg(v,r){if(!v)return v;r||(r=v);var e,$=v;do{if(e=!1,$.steiner||!Wp($,$.next)&&0!==sb($.prev,$,$.next))$=$.next;else{if(vm($),($=r=$.prev)===$.next)break;e=!0}}while(e||$!==r);return r}function tm(v,r,e,$,n,t,a){if(v){!a&&t&&Nda(v,$,n,t);for(var i,h,x=v;v.prev!==v.next;)if(i=v.prev,h=v.next,t?Fda(v,$,n,t):Eda(v))r.push(i.i/e),r.push(v.i/e),r.push(h.i/e),vm(v),v=h.next,x=h.next;else if((v=h)===x){a?1===a?tm(v=Gda(rg(v),r,e),r,e,$,n,t,2):2===a&&Hda(v,r,e,$,n,t):tm(rg(v),r,e,$,n,t,1);break}}}function Eda(v){var r=v.prev,e=v,$=v.next;if(sb(r,e,$)>=0)return!1;for(var n=v.next.next;n!==v.prev;){if(Nj(r.x,r.y,e.x,e.y,$.x,$.y,n.x,n.y)&&sb(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function Fda(v,r,e,$){var n=v.prev,t=v,a=v.next;if(sb(n,t,a)>=0)return!1;for(var i=n.x<t.x?n.x<a.x?n.x:a.x:t.x<a.x?t.x:a.x,h=n.y<t.y?n.y<a.y?n.y:a.y:t.y<a.y?t.y:a.y,x=n.x>t.x?n.x>a.x?n.x:a.x:t.x>a.x?t.x:a.x,o=n.y>t.y?n.y>a.y?n.y:a.y:t.y>a.y?t.y:a.y,w=Fu(i,h,r,e,$),l=Fu(x,o,r,e,$),u=v.prevZ,s=v.nextZ;u&&u.z>=w&&s&&s.z<=l;){if(u!==v.prev&&u!==v.next&&Nj(n.x,n.y,t.x,t.y,a.x,a.y,u.x,u.y)&&sb(u.prev,u,u.next)>=0)return!1;if(u=u.prevZ,s!==v.prev&&s!==v.next&&Nj(n.x,n.y,t.x,t.y,a.x,a.y,s.x,s.y)&&sb(s.prev,s,s.next)>=0)return!1;s=s.nextZ}for(;u&&u.z>=w;){if(u!==v.prev&&u!==v.next&&Nj(n.x,n.y,t.x,t.y,a.x,a.y,u.x,u.y)&&sb(u.prev,u,u.next)>=0)return!1;u=u.prevZ}for(;s&&s.z<=l;){if(s!==v.prev&&s!==v.next&&Nj(n.x,n.y,t.x,t.y,a.x,a.y,s.x,s.y)&&sb(s.prev,s,s.next)>=0)return!1;s=s.nextZ}return!0}function Gda(v,r,e){var $=v;do{var n=$.prev,t=$.next.next;!Wp(n,t)&&hF(n,$,$.next,t)&&um(n,t)&&um(t,n)&&(r.push(n.i/e),r.push($.i/e),r.push(t.i/e),vm($),vm($.next),$=v=t),$=$.next}while($!==v);return rg($)}function Hda(v,r,e,$,n,t){var a=v;do{for(var i=a.next.next;i!==a.prev;){if(a.i!==i.i&&Qda(a,i)){var h=iF(a,i);return a=rg(a,a.next),h=rg(h,h.next),tm(a,r,e,$,n,t),void tm(h,r,e,$,n,t)}i=i.next}a=a.next}while(a!==v)}function Ida(v,r,e,$){var n,t,a,i=[];for(n=0,t=r.length;n<t;n++)(a=gF(v,r[n]*$,n<t-1?r[n+1]*$:v.length,$,!1))===a.next&&(a.steiner=!0),i.push(Pda(a));for(i.sort(Jda),n=0;n<i.length;n++)Kda(i[n],e),e=rg(e,e.next);return e}function Jda(v,r){return v.x-r.x}function Kda(v,r){if(r=Lda(v,r)){var e=iF(r,v);rg(r,r.next),rg(e,e.next)}}function Lda(v,r){var e,$=r,n=v.x,t=v.y,a=-1/0;do{if(t<=$.y&&t>=$.next.y&&$.next.y!==$.y){var i=$.x+(t-$.y)*($.next.x-$.x)/($.next.y-$.y);if(i<=n&&i>a){if(a=i,i===n){if(t===$.y)return $;if(t===$.next.y)return $.next}e=$.x<$.next.x?$:$.next}}$=$.next}while($!==r);if(!e)return null;if(n===a)return e;var h,x=e,o=e.x,w=e.y,l=1/0;$=e;do{n>=$.x&&$.x>=o&&n!==$.x&&Nj(t<w?n:a,t,o,w,t<w?a:n,t,$.x,$.y)&&(h=Math.abs(t-$.y)/(n-$.x),um($,v)&&(h<l||h===l&&($.x>e.x||$.x===e.x&&Mda(e,$)))&&(e=$,l=h)),$=$.next}while($!==x);return e}function Mda(v,r){return sb(v.prev,v,r.prev)<0&&sb(r.next,v,v.next)<0}function Nda(v,r,e,$){var n=v;do{null===n.z&&(n.z=Fu(n.x,n.y,r,e,$)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==v);n.prevZ.nextZ=null,n.prevZ=null,Oda(n)}function Oda(v){var r,e,$,n,t,a,i,h,x=1;do{for(e=v,v=null,t=null,a=0;e;){for(a++,$=e,i=0,r=0;r<x&&(i++,$=$.nextZ);r++);for(h=x;i>0||h>0&&$;)0!==i&&(0===h||!$||e.z<=$.z)?(n=e,e=e.nextZ,i--):(n=$,$=$.nextZ,h--),t?t.nextZ=n:v=n,n.prevZ=t,t=n;e=$}t.nextZ=null,x*=2}while(a>1);return v}function Fu(v,r,e,$,n){return(v=1431655765&((v=858993459&((v=252645135&((v=16711935&((v=32767*(v-e)*n)|v<<8))|v<<4))|v<<2))|v<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-$)*n)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function Pda(v){var r=v,e=v;do{(r.x<e.x||r.x===e.x&&r.y<e.y)&&(e=r),r=r.next}while(r!==v);return e}function Nj(v,r,e,$,n,t,a,i){return(n-a)*(r-i)-(v-a)*(t-i)>=0&&(v-a)*($-i)-(e-a)*(r-i)>=0&&(e-a)*(t-i)-(n-a)*($-i)>=0}function Qda(v,r){return v.next.i!==r.i&&v.prev.i!==r.i&&!Rda(v,r)&&(um(v,r)&&um(r,v)&&Sda(v,r)&&(sb(v.prev,v,r.prev)||sb(v,r.prev,r))||Wp(v,r)&&sb(v.prev,v,v.next)>0&&sb(r.prev,r,r.next)>0)}function sb(v,r,e){return(r.y-v.y)*(e.x-r.x)-(r.x-v.x)*(e.y-r.y)}function Wp(v,r){return v.x===r.x&&v.y===r.y}function hF(v,r,e,$){var n=Yp(sb(v,r,e)),t=Yp(sb(v,r,$)),a=Yp(sb(e,$,v)),i=Yp(sb(e,$,r));return n!==t&&a!==i||!(0!==n||!Xp(v,e,r))||!(0!==t||!Xp(v,$,r))||!(0!==a||!Xp(e,v,$))||!(0!==i||!Xp(e,r,$))}function Xp(v,r,e){return r.x<=Math.max(v.x,e.x)&&r.x>=Math.min(v.x,e.x)&&r.y<=Math.max(v.y,e.y)&&r.y>=Math.min(v.y,e.y)}function Yp(v){return v>0?1:v<0?-1:0}function Rda(v,r){var e=v;do{if(e.i!==v.i&&e.next.i!==v.i&&e.i!==r.i&&e.next.i!==r.i&&hF(e,e.next,v,r))return!0;e=e.next}while(e!==v);return!1}function um(v,r){return sb(v.prev,v,v.next)<0?sb(v,r,v.next)>=0&&sb(v,v.prev,r)>=0:sb(v,r,v.prev)<0||sb(v,v.next,r)<0}function Sda(v,r){var e=v,$=!1,n=(v.x+r.x)/2,t=(v.y+r.y)/2;do{e.y>t!=e.next.y>t&&e.next.y!==e.y&&n<(e.next.x-e.x)*(t-e.y)/(e.next.y-e.y)+e.x&&($=!$),e=e.next}while(e!==v);return $}function iF(v,r){var e=new Gu(v.i,v.x,v.y),$=new Gu(r.i,r.x,r.y),n=v.next,t=r.prev;return v.next=r,r.prev=v,e.next=n,n.prev=e,$.next=e,e.prev=$,t.next=$,$.prev=t,$}function jF(v,r,e,$){var n=new Gu(v,r,e);return $?(n.next=$.next,n.prev=$,$.next.prev=n,$.next=n):(n.prev=n,n.next=n),n}function vm(v){v.next.prev=v.prev,v.prev.next=v.next,v.prevZ&&(v.prevZ.nextZ=v.nextZ),v.nextZ&&(v.nextZ.prevZ=v.prevZ)}function Gu(v,r,e){this.i=v,this.x=r,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Hu(v,r,e,$){for(var n=0,t=r,a=e-$;t<e;t+=$)n+=(v[a]-v[t])*(v[t+1]+v[a+1]),a=t;return n}(Dda=Vp).default=Vp,Vp.deviation=function(v,r,e,$){var n=r&&r.length,t=n?r[0]*e:v.length,a=Math.abs(Hu(v,0,t,e));if(n)for(var i=0,h=r.length;i<h;i++){var x=r[i]*e,o=i<h-1?r[i+1]*e:v.length;a-=Math.abs(Hu(v,x,o,e))}var w=0;for(i=0;i<$.length;i+=3){var l=$[i]*e,u=$[i+1]*e,s=$[i+2]*e;w+=Math.abs((v[l]-v[s])*(v[u+1]-v[l+1])-(v[l]-v[u])*(v[s+1]-v[l+1]))}return 0===a&&0===w?0:Math.abs((w-a)/a)},Vp.flatten=function(v){for(var r=v[0][0].length,e={vertices:[],holes:[],dimensions:r},$=0,n=0;n<v.length;n++){for(var t=0;t<v[n].length;t++)for(var a=0;a<r;a++)e.vertices.push(v[n][t][a]);n>0&&($+=v[n-1].length,e.holes.push($))}return e};var Tda=function(){var o=this,e={exports:this};return function(n){var r="object"==typeof o&&o&&!o.nodeType&&o,t="object"==typeof e&&e&&!e.nodeType&&e,i="object"==typeof ab&&ab;i.global!==i&&i.window!==i&&i.self!==i||(n=i);var u,f,c=2147483647,l=36,a=1,s=26,p=38,h=700,d=72,v=128,g="-",w=/^xn--/,x=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,C={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=l-a,j=Math.floor,A=String.fromCharCode;function $(o){throw new RangeError(C[o])}function I(o,e){for(var n=o.length,r=[];n--;)r[n]=e(o[n]);return r}function E(o,e){var n=o.split("@"),r="";return n.length>1&&(r=n[0]+"@",o=n[1]),r+I((o=o.replace(b,".")).split("."),e).join(".")}function F(o){for(var e,n,r=[],t=0,i=o.length;t<i;)(e=o.charCodeAt(t++))>=55296&&e<=56319&&t<i?56320==(64512&(n=o.charCodeAt(t++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),t--):r.push(e);return r}function O(o){return I(o,function(o){var e="";return o>65535&&(e+=A((o-=65536)>>>10&1023|55296),o=56320|1023&o),e+=A(o)}).join("")}function S(o,e){return o+22+75*(o<26)-((0!=e)<<5)}function T(o,e,n){var r=0;for(o=n?j(o/h):o>>1,o+=j(o/e);o>y*s>>1;r+=l)o=j(o/y);return j(r+(y+1)*o/(o+p))}function m(o){var e,n,r,t,i,u,f,p,h,w,x,b=[],C=o.length,y=0,A=v,I=d;for((n=o.lastIndexOf(g))<0&&(n=0),r=0;r<n;++r)o.charCodeAt(r)>=128&&$("not-basic"),b.push(o.charCodeAt(r));for(t=n>0?n+1:0;t<C;){for(i=y,u=1,f=l;t>=C&&$("invalid-input"),((p=(x=o.charCodeAt(t++))-48<10?x-22:x-65<26?x-65:x-97<26?x-97:l)>=l||p>j((c-y)/u))&&$("overflow"),y+=p*u,!(p<(h=f<=I?a:f>=I+s?s:f-I));f+=l)u>j(c/(w=l-h))&&$("overflow"),u*=w;I=T(y-i,e=b.length+1,0==i),j(y/e)>c-A&&$("overflow"),A+=j(y/e),y%=e,b.splice(y++,0,A)}return O(b)}function q(o){var e,n,r,t,i,u,f,p,h,w,x,b,C,y,I,E=[];for(b=(o=F(o)).length,e=v,n=0,i=d,u=0;u<b;++u)(x=o[u])<128&&E.push(A(x));for(r=t=E.length,t&&E.push(g);r<b;){for(f=c,u=0;u<b;++u)(x=o[u])>=e&&x<f&&(f=x);for(f-e>j((c-n)/(C=r+1))&&$("overflow"),n+=(f-e)*C,e=f,u=0;u<b;++u)if((x=o[u])<e&&++n>c&&$("overflow"),x==e){for(p=n,h=l;!(p<(w=h<=i?a:h>=i+s?s:h-i));h+=l)I=p-w,y=l-w,E.push(A(S(w+I%y,0))),p=j(I/y);E.push(A(S(p,0))),i=T(n,C,r==t),n=0,++r}++n,++e}return E.join("")}if(u={version:"1.4.1",ucs2:{decode:F,encode:O},decode:m,encode:q,toASCII:function(o){return E(o,function(o){return x.test(o)?"xn--"+q(o):o})},toUnicode:function(o){return E(o,function(o){return w.test(o)?m(o.slice(4).toLowerCase()):o})}},r&&t){if(e.exports==r)t.exports=u;else for(f in u)u.hasOwnProperty(f)&&(r[f]=u[f]);}else n.punycode=u}(this),e.exports}.call({});var ye={};ye={isString:function(n){return"string"==typeof n},isObject:function(n){return"object"==typeof n&&null!==n},isNull:function(n){return null===n},isNullOrUndefined:function(n){return null==n}};var Uda,Vda,Wda=false;function Xda(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Yda(){if(Wda)return;Wda=true;Uda={};Uda=function(r,e,t,a){e=e||"&",t=t||"=";var n={};if("string"!=typeof r||0===r.length)return n;var o=/\+/g;r=r.split(e);var s=1e3;a&&"number"==typeof a.maxKeys&&(s=a.maxKeys);var p=r.length;s>0&&p>s&&(p=s);for(var $=0;$<p;++$){var y,v,c,i,u=r[$].replace(o,"%20"),P=u.indexOf(t);P>=0?(y=u.substr(0,P),v=u.substr(P+1)):(y=u,v=""),c=decodeURIComponent(y),i=decodeURIComponent(v),Xda(n,c)?Vda(n[c])?n[c].push(i):n[c]=[n[c],i]:n[c]=i}return n};Vda=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)}}var Zda,wm,$da,_da,aea=false;function kF(r,e){if(r.map)return r.map(e);for(var t=[],n=0;n<r.length;n++)t.push(e(r[n],n));return t}function bea(){if(aea)return;aea=true;Zda={};wm=function(r){switch(typeof r){case"string":return r;case"boolean":return r?"true":"false";case"number":return isFinite(r)?r:"";default:return"";}};Zda=function(r,e,t,n){return e=e||"&",t=t||"=",null===r&&(r=void 0),"object"==typeof r?kF(_da(r),function(n){var i=encodeURIComponent(wm(n))+t;return $da(r[n])?kF(r[n],function(r){return i+encodeURIComponent(wm(r))}).join(e):i+encodeURIComponent(wm(r[n]))}).join(e):n?encodeURIComponent(wm(n))+t+encodeURIComponent(wm(r)):""};$da=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};_da=Object.keys||function(r){var e=[];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&e.push(t);return e}}var lF,cea,x=(lF=(Yda(),Uda));var y=(cea=(bea(),Zda));var Oj={},mF=xm;Oj.parse=mF;var dea=qea;Oj.resolve=dea;var eea=rea;Oj.resolveObject=eea;var fea=pea;Oj.format=fea;var gea=nd;function nd(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}Oj.Url=gea;var hea=/^([a-z0-9.+-]+:)/i,iea=/:[0-9]*$/,jea=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,kea=["<",">","\"","`"," ","\r","\n","\t"],lea=["{","}","|","\\","^","`"].concat(kea),Iu=["'"].concat(lea),nF=["%","/","?",";","#"].concat(Iu),oF=["/","?","#"],mea=255,pF=/^[+a-z0-9A-Z_-]{0,63}$/,nea=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,oea={javascript:!0,"javascript:":!0},Ju={javascript:!0,"javascript:":!0},Pj={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function xm(t,e,r){if(t&&ye.isObject(t)&&t instanceof nd)return t;var s=new nd;return s.parse(t,e,r),s}function pea(t){return ye.isString(t)&&(t=xm(t)),t instanceof nd?t.format():nd.prototype.format.call(t)}function qea(t,e){return xm(t,!1,!0).resolve(e)}function rea(t,e){return t?xm(t,!1,!0).resolveObject(e):e}nd.prototype.parse=function(t,e,r){if(!ye.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),a=-1!==s&&s<t.indexOf("#")?"?":"#",h=t.split(a);h[0]=h[0].replace(/\\/g,"/");var o=t=h.join(a);if(o=o.trim(),!r&&1===t.split("#").length){var $=jea.exec(o);if($)return this.path=o,this.href=o,this.pathname=$[1],$[2]?(this.search=$[2],this.query=e?lF(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var n=hea.exec(o);if(n){var i=(n=n[0]).toLowerCase();this.protocol=i,o=o.substr(n.length)}if(r||n||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===o.substr(0,2);!l||n&&Ju[n]||(o=o.substr(2),this.slashes=!0)}if(!Ju[n]&&(l||n&&!Pj[n])){for(var p,u,c=-1,v=0;v<oF.length;v++){-1!==(j=o.indexOf(oF[v]))&&(-1===c||j<c)&&(c=j)}-1!==(u=-1===c?o.lastIndexOf("@"):o.lastIndexOf("@",c))&&(p=o.slice(0,u),o=o.slice(u+1),this.auth=decodeURIComponent(p)),c=-1;for(v=0;v<nF.length;v++){var j;-1!==(j=o.indexOf(nF[v]))&&(-1===c||j<c)&&(c=j)}-1===c&&(c=o.length),this.host=o.slice(0,c),o=o.slice(c),this.parseHost(),this.hostname=this.hostname||"";var f="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!f)for(var m=this.hostname.split(/\./),M=(v=0,m.length);v<M;v++){var g=m[v];if(g&&!g.match(pF)){for(var y="",P=0,d=g.length;P<d;P++)g.charCodeAt(P)>127?y+="x":y+=g[P];if(!y.match(pF)){var x=m.slice(0,v),b=m.slice(v+1),q=g.match(nea);q&&(x.push(q[1]),b.unshift(q[2])),b.length&&(o="/"+b.join(".")+o),this.hostname=x.join(".");break}}}this.hostname.length>mea?this.hostname="":this.hostname=this.hostname.toLowerCase(),f||(this.hostname=Tda.toASCII(this.hostname));var O=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+O,this.href+=this.host,f&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!oea[i])for(v=0,M=Iu.length;v<M;v++){var C=Iu[v];if(-1!==o.indexOf(C)){var A=encodeURIComponent(C);A===C&&(A=escape(C)),o=o.split(C).join(A)}}var w=o.indexOf("#");-1!==w&&(this.hash=o.substr(w),o=o.slice(0,w));var E=o.indexOf("?");if(-1!==E?(this.search=o.substr(E),this.query=o.substr(E+1),e&&(this.query=lF(this.query)),o=o.slice(0,E)):e&&(this.search="",this.query={}),o&&(this.pathname=o),Pj[i]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){O=this.pathname||"";var I=this.search||"";this.path=O+I}return this.href=this.format(),this},nd.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",s=this.hash||"",a=!1,h="";this.host?a=t+this.host:this.hostname&&(a=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&ye.isObject(this.query)&&Object.keys(this.query).length&&(h=cea(this.query));var o=this.search||h&&"?"+h||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||Pj[e])&&!1!==a?(a="//"+(a||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):a||(a=""),s&&"#"!==s.charAt(0)&&(s="#"+s),o&&"?"!==o.charAt(0)&&(o="?"+o),e+a+(r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(o=o.replace("#","%23"))+s},nd.prototype.resolve=function(t){return this.resolveObject(xm(t,!1,!0)).format()},nd.prototype.resolveObject=function(t){if(ye.isString(t)){var e=new nd;e.parse(t,!1,!0),t=e}for(var r=new nd,s=Object.keys(this),a=0;a<s.length;a++){var h=s[a];r[h]=this[h]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),$=0;$<o.length;$++){var n=o[$];"protocol"!==n&&(r[n]=t[n])}return Pj[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!Pj[t.protocol]){for(var i=Object.keys(t),l=0;l<i.length;l++){var p=i[l];r[p]=t[p]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||Ju[t.protocol])r.pathname=t.pathname;else{for(var u=(t.pathname||"").split("/");u.length&&!(t.host=u.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==u[0]&&u.unshift(""),u.length<2&&u.unshift(""),r.pathname=u.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var c=r.pathname||"",v=r.search||"";r.path=c+v}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var j=r.pathname&&"/"===r.pathname.charAt(0),f=t.host||t.pathname&&"/"===t.pathname.charAt(0),m=f||j||r.host&&t.pathname,M=m,g=r.pathname&&r.pathname.split("/")||[],y=(u=t.pathname&&t.pathname.split("/")||[],r.protocol&&!Pj[r.protocol]);if(y&&(r.hostname="",r.port=null,r.host&&(""===g[0]?g[0]=r.host:g.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===u[0]?u[0]=t.host:u.unshift(t.host)),t.host=null),m=m&&(""===u[0]||""===g[0])),f)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,g=u;else if(u.length)g||(g=[]),g.pop(),g=g.concat(u),r.search=t.search,r.query=t.query;else if(!ye.isNullOrUndefined(t.search)){if(y)r.hostname=r.host=g.shift(),(q=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=q.shift(),r.host=r.hostname=q.shift());return r.search=t.search,r.query=t.query,ye.isNull(r.pathname)&&ye.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!g.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var P=g.slice(-1)[0],d=(r.host||t.host||g.length>1)&&("."===P||".."===P)||""===P,x=0,b=g.length;b>=0;b--)"."===(P=g[b])?g.splice(b,1):".."===P?(g.splice(b,1),x++):x&&(g.splice(b,1),x--);if(!m&&!M)for(;x--;x)g.unshift("..");!m||""===g[0]||g[0]&&"/"===g[0].charAt(0)||g.unshift(""),d&&"/"!==g.join("/").substr(-1)&&g.push("");var q,O=""===g[0]||g[0]&&"/"===g[0].charAt(0);y&&(r.hostname=r.host=O?"":g.length?g.shift():"",(q=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=q.shift(),r.host=r.hostname=q.shift()));return(m=m||r.host&&g.length)&&!O&&g.unshift(""),g.length?r.pathname=g.join("/"):(r.pathname=null,r.path=null),ye.isNull(r.pathname)&&ye.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},nd.prototype.parseHost=function(){var t=this.host,e=iea.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var sea,tea,uea,vea,wea,xea,yea,zea,Aea,Bea,Cea,Dea,Eea,Fea,Gea,Hea,Iea,ze,Qj,ym,sa,od,Rj,sg,Kb,Ae,nf,Sj,of,Hd,Zp,Id,Dc,Ah,Ka={};!function($){$[$.WEBGL_LEGACY=0]="WEBGL_LEGACY",$[$.WEBGL=1]="WEBGL",$[$.WEBGL2=2]="WEBGL2"}(ze||(xea=ze={},Ka.ENV=ze,xea)),function($){$[$.UNKNOWN=0]="UNKNOWN",$[$.WEBGL=1]="WEBGL",$[$.CANVAS=2]="CANVAS"}(Qj||(Eea=Qj={},Ka.RENDERER_TYPE=Qj,Eea)),function($){$[$.COLOR=16384]="COLOR",$[$.DEPTH=256]="DEPTH",$[$.STENCIL=1024]="STENCIL"}(ym||(uea=ym={},Ka.BUFFER_BITS=ym,uea)),function($){$[$.NORMAL=0]="NORMAL",$[$.ADD=1]="ADD",$[$.MULTIPLY=2]="MULTIPLY",$[$.SCREEN=3]="SCREEN",$[$.OVERLAY=4]="OVERLAY",$[$.DARKEN=5]="DARKEN",$[$.LIGHTEN=6]="LIGHTEN",$[$.COLOR_DODGE=7]="COLOR_DODGE",$[$.COLOR_BURN=8]="COLOR_BURN",$[$.HARD_LIGHT=9]="HARD_LIGHT",$[$.SOFT_LIGHT=10]="SOFT_LIGHT",$[$.DIFFERENCE=11]="DIFFERENCE",$[$.EXCLUSION=12]="EXCLUSION",$[$.HUE=13]="HUE",$[$.SATURATION=14]="SATURATION",$[$.COLOR=15]="COLOR",$[$.LUMINOSITY=16]="LUMINOSITY",$[$.NORMAL_NPM=17]="NORMAL_NPM",$[$.ADD_NPM=18]="ADD_NPM",$[$.SCREEN_NPM=19]="SCREEN_NPM",$[$.NONE=20]="NONE",$[$.SRC_OVER=0]="SRC_OVER",$[$.SRC_IN=21]="SRC_IN",$[$.SRC_OUT=22]="SRC_OUT",$[$.SRC_ATOP=23]="SRC_ATOP",$[$.DST_OVER=24]="DST_OVER",$[$.DST_IN=25]="DST_IN",$[$.DST_OUT=26]="DST_OUT",$[$.DST_ATOP=27]="DST_ATOP",$[$.ERASE=26]="ERASE",$[$.SUBTRACT=28]="SUBTRACT",$[$.XOR=29]="XOR"}(sa||(tea=sa={},Ka.BLEND_MODES=sa,tea)),function($){$[$.POINTS=0]="POINTS",$[$.LINES=1]="LINES",$[$.LINE_LOOP=2]="LINE_LOOP",$[$.LINE_STRIP=3]="LINE_STRIP",$[$.TRIANGLES=4]="TRIANGLES",$[$.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",$[$.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(od||(wea=od={},Ka.DRAW_MODES=od,wea)),function($){$[$.RGBA=6408]="RGBA",$[$.RGB=6407]="RGB",$[$.ALPHA=6406]="ALPHA",$[$.LUMINANCE=6409]="LUMINANCE",$[$.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",$[$.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",$[$.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Rj||(yea=Rj={},Ka.FORMATS=Rj,yea)),function($){$[$.TEXTURE_2D=3553]="TEXTURE_2D",$[$.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",$[$.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",$[$.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",$[$.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",$[$.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",$[$.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",$[$.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",$[$.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(sg||(Gea=sg={},Ka.TARGETS=sg,Gea)),function($){$[$.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",$[$.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",$[$.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",$[$.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",$[$.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",$[$.FLOAT=5126]="FLOAT",$[$.HALF_FLOAT=36193]="HALF_FLOAT"}(Kb||(Hea=Kb={},Ka.TYPES=Kb,Hea)),function($){$[$.NEAREST=0]="NEAREST",$[$.LINEAR=1]="LINEAR"}(Ae||(Fea=Ae={},Ka.SCALE_MODES=Ae,Fea)),function($){$[$.CLAMP=33071]="CLAMP",$[$.REPEAT=10497]="REPEAT",$[$.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(nf||(Iea=nf={},Ka.WRAP_MODES=nf,Iea)),function($){$[$.OFF=0]="OFF",$[$.POW2=1]="POW2",$[$.ON=2]="ON"}(Sj||(Bea=Sj={},Ka.MIPMAP_MODES=Sj,Bea)),function($){$[$.NPM=0]="NPM",$[$.UNPACK=1]="UNPACK",$[$.PMA=2]="PMA",$[$.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",$[$.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",$[$.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(of||(sea=of={},Ka.ALPHA_MODES=of,sea)),function($){$[$.NO=0]="NO",$[$.YES=1]="YES",$[$.AUTO=2]="AUTO",$[$.BLEND=0]="BLEND",$[$.CLEAR=1]="CLEAR",$[$.BLIT=2]="BLIT"}(Hd||(vea=Hd={},Ka.CLEAR_MODES=Hd,vea)),function($){$[$.AUTO=0]="AUTO",$[$.MANUAL=1]="MANUAL"}(Zp||(zea=Zp={},Ka.GC_MODES=Zp,zea)),function($){$.LOW="lowp",$.MEDIUM="mediump",$.HIGH="highp"}(Id||(Dea=Id={},Ka.PRECISION=Id,Dea)),function($){$[$.NONE=0]="NONE",$[$.SCISSOR=1]="SCISSOR",$[$.STENCIL=2]="STENCIL",$[$.SPRITE=3]="SPRITE"}(Dc||(Aea=Dc={},Ka.MASK_TYPES=Dc,Aea)),function($){$[$.NONE=0]="NONE",$[$.LOW=2]="LOW",$[$.MEDIUM=4]="MEDIUM",$[$.HIGH=8]="HIGH"}(Ah||(Cea=Ah={},Ka.MSAA_QUALITY=Ah,Cea)),Ka.WRAP_MODES=nf,Ka.TYPES=Kb,Ka.TARGETS=sg,Ka.SCALE_MODES=Ae,Ka.RENDERER_TYPE=Qj,Ka.PRECISION=Id,Ka.MSAA_QUALITY=Ah,Ka.MIPMAP_MODES=Sj,Ka.MASK_TYPES=Dc,Ka.GC_MODES=Zp,Ka.FORMATS=Rj,Ka.ENV=ze,Ka.DRAW_MODES=od,Ka.CLEAR_MODES=Hd,Ka.BUFFER_BITS=ym,Ka.BLEND_MODES=sa,Ka.ALPHA_MODES=of;var Tj=Wc(Ada);var Ku=Wc(Dda);var qF=Wc(Oj);Ca.isMobile=md,Ca.EventEmitter=Tj.d,Ca.earcut=Ku.d,Ca.url=qF.d,ra.RETINA_PREFIX=/@([0-9\.]+)x/,ra.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var rF,Jea=!1,sF="5.3.3";function Kea(){Jea=!0}function tF(e){var r;if(!Jea){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var t=["\n %c %c %c PixiJS "+sF+" - \u2730 "+e+" \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(r=window.console).log.apply(r,t)}else window.console&&window.console.log("PixiJS "+sF+" - "+e+" - http://www.pixijs.com/");Jea=!0}}function uF(){return void 0===rF&&(rF=function(){var e={stencil:!0,failIfMajorPerformanceCaveat:ra.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var r=document.createElement("canvas"),t=r.getContext("webgl",e)||r.getContext("experimental-webgl",e),$=!(!t||!t.getContextAttributes().stencil);if(t){var o=t.getExtension("WEBGL_lose_context");o&&o.loseContext()}return t=null,$}catch(n){return!1}}()),rF}function Bh(e,r){return void 0===r&&(r=[]),r[0]=(e>>16&255)/255,r[1]=(e>>8&255)/255,r[2]=(255&e)/255,r}function Lu(e){var r=e.toString(16);return"#"+(r="000000".substr(0,6-r.length)+r)}function $p(e){return"string"==typeof e&&"#"===e[0]&&(e=e.substr(1)),parseInt(e,16)}function Lea(e){return(255*e[0]<<16)+(255*e[1]<<8)+(255*e[2]|0)}function Mea(){for(var e=[],r=[],t=0;t<32;t++)e[t]=t,r[t]=t;e[sa.NORMAL_NPM]=sa.NORMAL,e[sa.ADD_NPM]=sa.ADD,e[sa.SCREEN_NPM]=sa.SCREEN,r[sa.NORMAL]=sa.NORMAL_NPM,r[sa.ADD]=sa.ADD_NPM,r[sa.SCREEN]=sa.SCREEN_NPM;var $=[];return $.push(r),$.push(e),$}var Mu=Mea();function Nu(e,r){return Mu[r?1:0][e]}function vF(e,r,t,$){return t=t||new Float32Array(4),$||void 0===$?(t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r):(t[0]=e[0],t[1]=e[1],t[2]=e[2]),t[3]=r,t}function _p(e,r){if(1===r)return(255*r<<24)+e;if(0===r)return 0;var t=e>>16&255,$=e>>8&255,o=255&e;return(255*r<<24)+((t=t*r+.5|0)<<16)+(($=$*r+.5|0)<<8)+(o=o*r+.5|0)}function Ou(e,r,t,$){return(t=t||new Float32Array(4))[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255,($||void 0===$)&&(t[0]*=r,t[1]*=r,t[2]*=r),t[3]=r,t}function wF(e,r){void 0===r&&(r=null);var t=6*e;if((r=r||new Uint16Array(t)).length!==t)throw new Error("Out buffer length is incorrect, got "+r.length+" and expected "+t);for(var $=0,o=0;$<t;$+=6,o+=4)r[$+0]=o+0,r[$+1]=o+1,r[$+2]=o+2,r[$+3]=o+0,r[$+4]=o+2,r[$+5]=o+3;return r}function xF(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}var Nea={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Oea(e,r){for(var t=0,$=0,o={},n=0;n<e.length;n++)$+=r[n],t+=e[n].length;var u=new ArrayBuffer(4*t),i=null,a=0;for(n=0;n<e.length;n++){var p=r[n],s=e[n],T=xF(s);o[T]||(o[T]=new Nea[T](u)),i=o[T];for(var c=0;c<s.length;c++){i[(c/p|0)*$+a+c%p]=s[c]}a+=p}return new Float32Array(u)}function zm(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1}function Pu(e){return!(e&e-1||!e)}function Qu(e){var r=(e>65535?1:0)<<4,t=((e>>>=r)>255?1:0)<<3;return r|=t,r|=t=((e>>>=t)>15?1:0)<<2,(r|=t=((e>>>=t)>3?1:0)<<1)|(e>>>=t)>>1}function Ch(e,r,t){var $,o=e.length;if(!(r>=o||0===t)){var n=o-(t=r+t>o?o-r:t);for($=r;$<n;++$)e[$]=e[$+t];e.length=n}}function Dh(e){return 0===e?0:e<0?-1:1}var Pea=0;function Eh(){return++Pea}var yF={};function ea(e,r,t){if(void 0===t&&(t=3),!yF[r]){var $=new Error().stack;void 0===$?console.warn("PixiJS Deprecation Warning: ",r+"\nDeprecated since v"+e):($=$.split("\n").splice(t).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",r+"\nDeprecated since v"+e),console.warn($),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",r+"\nDeprecated since v"+e),console.warn($))),yF[r]=!0}}var Ru={},Ec=Object.create(null),pd=Object.create(null);function Qea(){var e;for(e in Ec)Ec[e].destroy();for(e in pd)pd[e].destroy()}function Rea(){var e;for(e in Ec)delete Ec[e];for(e in pd)delete pd[e]}var Su=function(){function e(e,r,t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=t||ra.RESOLUTION,this.resize(e,r)}return e.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.resize=function(e,r){this.canvas.width=e*this.resolution,this.canvas.height=r*this.resolution},e.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=e},enumerable:!1,configurable:!0}),e}();function zF(e){var r,t,$,o=e.width,n=e.height,u=e.getContext("2d"),i=u.getImageData(0,0,o,n).data,a=i.length,p={top:null,left:null,right:null,bottom:null},s=null;for(r=0;r<a;r+=4)0!==i[r+3]&&(t=r/4%o,$=~~(r/4/o),null===p.top&&(p.top=$),null===p.left?p.left=t:t<p.left&&(p.left=t),null===p.right?p.right=t+1:p.right<t&&(p.right=t+1),null===p.bottom?p.bottom=$:p.bottom<$&&(p.bottom=$));return null!==p.top&&(o=p.right-p.left,n=p.bottom-p.top+1,s=u.getImageData(p.left,p.top,o,n)),{height:n,width:o,data:s}}var Tu,AF=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Sea(e){var r=AF.exec(e);if(r)return{mediaType:r[1]?r[1].toLowerCase():void 0,subType:r[2]?r[2].toLowerCase():void 0,charset:r[3]?r[3].toLowerCase():void 0,encoding:r[4]?r[4].toLowerCase():void 0,data:r[5]}}function BF(e,r){if(void 0===r&&(r=window.location),0===e.indexOf("data:"))return"";r=r||window.location,Tu||(Tu=document.createElement("a")),Tu.href=e;var t=mF(Tu.href),$=!t.port&&""===r.port||t.port===r.port;return t.hostname===r.hostname&&$&&t.protocol===r.protocol?"":"anonymous"}function Am(e,r){var t=ra.RETINA_PREFIX.exec(e);return t?parseFloat(t[1]):void 0!==r?r:1}Ca.uid=Eh,Ca.trimCanvas=zF,Ca.string2hex=$p,Ca.skipHello=Kea,Ca.sign=Dh,Ca.sayHello=tF,Ca.rgb2hex=Lea,Ca.removeItems=Ch,Ca.premultiplyTintToRgba=Ou,Ca.premultiplyTint=_p,Ca.premultiplyRgba=vF,Ca.premultiplyBlendMode=Mu,Ca.nextPow2=zm,Ca.log2=Qu,Ca.isWebGLSupported=uF,Ca.isPow2=Pu,Ca.interleaveTypedArrays=Oea,Ca.hex2string=Lu,Ca.hex2rgb=Bh,Ca.getResolutionOfUrl=Am,Ca.getBufferType=xF,Ca.determineCrossOrigin=BF,Ca.destroyTextureCache=Qea,Ca.deprecation=ea,Ca.decomposeDataUri=Sea,Ca.createIndicesForQuads=wF,Ca.correctBlendMode=Nu,Ca.clearTextureCache=Rea,Ca.TextureCache=Ec,Ca.ProgramCache=Ru,Ca.DATA_URI=AF,Ca.CanvasRenderTarget=Su,Ca.BaseTextureCache=pd;var Uu={};var Bm={};var Tea,xb,kc={},Uj=2*Math.PI,CF=180/Math.PI,DF=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(xb||(Tea=xb={},kc.SHAPES=xb,Tea));var La=function(){function t(t,i,o,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),this.x=Number(t),this.y=Number(i),this.width=Number(o),this.height=Number(s),this.type=xb.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,i){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&i>=this.y&&i<this.y+this.height},t.prototype.pad=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=t),this.x-=t,this.y-=i,this.width+=2*t,this.height+=2*i,this},t.prototype.fit=function(t){var i=Math.max(this.x,t.x),o=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),h=Math.min(this.y+this.height,t.y+t.height);return this.x=i,this.width=Math.max(o-i,0),this.y=s,this.height=Math.max(h-s,0),this},t.prototype.ceil=function(t,i){void 0===t&&(t=1),void 0===i&&(i=.001);var o=Math.ceil((this.x+this.width-i)*t)/t,s=Math.ceil((this.y+this.height-i)*t)/t;return this.x=Math.floor((this.x+i)*t)/t,this.y=Math.floor((this.y+i)*t)/t,this.width=o-this.x,this.height=s-this.y,this},t.prototype.enlarge=function(t){var i=Math.min(this.x,t.x),o=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),h=Math.max(this.y+this.height,t.y+t.height);return this.x=i,this.width=o-i,this.y=s,this.height=h-s,this},t}(),EF=function(){function t(t,i,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===o&&(o=0),this.x=t,this.y=i,this.radius=o,this.type=xb.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,i){if(this.radius<=0)return!1;var o=this.radius*this.radius,s=this.x-t,h=this.y-i;return(s*=s)+(h*=h)<=o},t.prototype.getBounds=function(){return new La(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}(),FF=function(){function t(t,i,o,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),this.x=t,this.y=i,this.width=o,this.height=s,this.type=xb.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,i){if(this.width<=0||this.height<=0)return!1;var o=(t-this.x)/this.width,s=(i-this.y)/this.height;return(o*=o)+(s*=s)<=1},t.prototype.getBounds=function(){return new La(this.x-this.width,this.y-this.height,this.width,this.height)},t}(),Vj=function(){function t(){for(var t=arguments,i=[],o=0;o<arguments.length;o++)i[o]=t[o];var s=Array.isArray(i[0])?i[0]:i;if("number"!=typeof s[0]){for(var h=[],r=0,e=s.length;r<e;r++)h.push(s[r].x,s[r].y);s=h}this.points=s,this.type=xb.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var i=new t(this.points.slice());return i.closeStroke=this.closeStroke,i},t.prototype.contains=function(t,i){for(var o=!1,s=this.points.length/2,h=0,r=s-1;h<s;r=h++){var e=this.points[2*h],n=this.points[2*h+1],a=this.points[2*r],$=this.points[2*r+1];n>i!=$>i&&t<(i-n)/($-n)*(a-e)+e&&(o=!o)}return o},t}(),GF=function(){function t(t,i,o,s,h){void 0===t&&(t=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===h&&(h=20),this.x=t,this.y=i,this.width=o,this.height=s,this.radius=h,this.type=xb.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,i){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&i>=this.y&&i<=this.y+this.height){if(i>=this.y+this.radius&&i<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var o=t-(this.x+this.radius),s=i-(this.y+this.radius),h=this.radius*this.radius;if(o*o+s*s<=h)return!0;if((o=t-(this.x+this.width-this.radius))*o+s*s<=h)return!0;if(o*o+(s=i-(this.y+this.height-this.radius))*s<=h)return!0;if((o=t-(this.x+this.radius))*o+s*s<=h)return!0}return!1},t}(),Da=function(){function t(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x=t,this.y=i}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=t),this.x=t,this.y=i,this},t}(),Fh=function(){function t(t,i,o,s){void 0===o&&(o=0),void 0===s&&(s=0),this._x=o,this._y=s,this.cb=t,this.scope=i}return t.prototype.clone=function(i,o){return void 0===i&&(i=this.cb),void 0===o&&(o=this.scope),new t(i,o,this._x,this._y)},t.prototype.set=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=t),this._x===t&&this._y===i||(this._x=t,this._y=i,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),Lb=function(){function t(t,i,o,s,h,r){void 0===t&&(t=1),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=1),void 0===h&&(h=0),void 0===r&&(r=0),this.array=null,this.a=t,this.b=i,this.c=o,this.d=s,this.tx=h,this.ty=r}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,i,o,s,h,r){return this.a=t,this.b=i,this.c=o,this.d=s,this.tx=h,this.ty=r,this},t.prototype.toArray=function(t,i){this.array||(this.array=new Float32Array(9));var o=i||this.array;return t?(o[0]=this.a,o[1]=this.b,o[2]=0,o[3]=this.c,o[4]=this.d,o[5]=0,o[6]=this.tx,o[7]=this.ty,o[8]=1):(o[0]=this.a,o[1]=this.c,o[2]=this.tx,o[3]=this.b,o[4]=this.d,o[5]=this.ty,o[6]=0,o[7]=0,o[8]=1),o},t.prototype.apply=function(t,i){i=i||new Da;var o=t.x,s=t.y;return i.x=this.a*o+this.c*s+this.tx,i.y=this.b*o+this.d*s+this.ty,i},t.prototype.applyInverse=function(t,i){i=i||new Da;var o=1/(this.a*this.d+this.c*-this.b),s=t.x,h=t.y;return i.x=this.d*o*s+-this.c*o*h+(this.ty*this.c-this.tx*this.d)*o,i.y=this.a*o*h+-this.b*o*s+(-this.ty*this.a+this.tx*this.b)*o,i},t.prototype.translate=function(t,i){return this.tx+=t,this.ty+=i,this},t.prototype.scale=function(t,i){return this.a*=t,this.d*=i,this.c*=t,this.b*=i,this.tx*=t,this.ty*=i,this},t.prototype.rotate=function(t){var i=Math.cos(t),o=Math.sin(t),s=this.a,h=this.c,r=this.tx;return this.a=s*i-this.b*o,this.b=s*o+this.b*i,this.c=h*i-this.d*o,this.d=h*o+this.d*i,this.tx=r*i-this.ty*o,this.ty=r*o+this.ty*i,this},t.prototype.append=function(t){var i=this.a,o=this.b,s=this.c,h=this.d;return this.a=t.a*i+t.b*s,this.b=t.a*o+t.b*h,this.c=t.c*i+t.d*s,this.d=t.c*o+t.d*h,this.tx=t.tx*i+t.ty*s+this.tx,this.ty=t.tx*o+t.ty*h+this.ty,this},t.prototype.setTransform=function(t,i,o,s,h,r,e,n,a){return this.a=Math.cos(e+a)*h,this.b=Math.sin(e+a)*h,this.c=-Math.sin(e-n)*r,this.d=Math.cos(e-n)*r,this.tx=t-(o*this.a+s*this.c),this.ty=i-(o*this.b+s*this.d),this},t.prototype.prepend=function(t){var i=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var o=this.a,s=this.c;this.a=o*t.a+this.b*t.c,this.b=o*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=i*t.a+this.ty*t.c+t.tx,this.ty=i*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var i=this.a,o=this.b,s=this.c,h=this.d,r=-Math.atan2(-s,h),e=Math.atan2(o,i),n=Math.abs(r+e);return n<1e-5||Math.abs(Uj-n)<1e-5?(t.rotation=e,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=r,t.skew.y=e),t.scale.x=Math.sqrt(i*i+o*o),t.scale.y=Math.sqrt(s*s+h*h),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,i=this.b,o=this.c,s=this.d,h=this.tx,r=t*s-i*o;return this.a=s/r,this.b=-i/r,this.c=-o/r,this.d=t/r,this.tx=(o*this.ty-s*h)/r,this.ty=-(t*this.ty-i*h)/r,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var i=new t;return i.a=this.a,i.b=this.b,i.c=this.c,i.d=this.d,i.tx=this.tx,i.ty=this.ty,i},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),Gh=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Hh=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ih=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Jh=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Vu=[],HF=[],aq=Math.sign;function Uea(){for(var t=0;t<16;t++){var i=[];Vu.push(i);for(var o=0;o<16;o++)for(var s=aq(Gh[t]*Gh[o]+Ih[t]*Hh[o]),h=aq(Hh[t]*Gh[o]+Jh[t]*Hh[o]),r=aq(Gh[t]*Ih[o]+Ih[t]*Jh[o]),e=aq(Hh[t]*Ih[o]+Jh[t]*Jh[o]),n=0;n<16;n++)if(Gh[n]===s&&Hh[n]===h&&Ih[n]===r&&Jh[n]===e){i.push(n);break}}for(t=0;t<16;t++){var a=new Lb;a.set(Gh[t],Hh[t],Ih[t],Jh[t],0,0),HF.push(a)}}Uea();var lb={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Gh[t]},uY:function(t){return Hh[t]},vX:function(t){return Ih[t]},vY:function(t){return Jh[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,i){return Vu[t][i]},sub:function(t,i){return Vu[t][lb.inv(i)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,i){return 2*Math.abs(t)<=Math.abs(i)?i>=0?lb.S:lb.N:2*Math.abs(i)<=Math.abs(t)?t>0?lb.E:lb.W:i>0?t>0?lb.SE:lb.SW:t>0?lb.NE:lb.NW},matrixAppendRotationInv:function(t,i,o,s){void 0===o&&(o=0),void 0===s&&(s=0);var h=HF[lb.inv(i)];h.tx=o,h.ty=s,t.append(h)}},Wu=function(){function t(){this.worldTransform=new Lb,this.localTransform=new Lb,this.position=new Fh(this.onChange,this,0,0),this.scale=new Fh(this.onChange,this,1,1),this.pivot=new Fh(this.onChange,this,0,0),this.skew=new Fh(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var i=this.localTransform;if(this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var o=t.worldTransform,s=this.worldTransform;s.a=i.a*o.a+i.b*o.c,s.b=i.a*o.b+i.b*o.d,s.c=i.c*o.a+i.d*o.c,s.d=i.c*o.b+i.d*o.d,s.tx=i.tx*o.a+i.ty*o.c+o.tx,s.ty=i.tx*o.b+i.ty*o.d+o.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}();kc.groupD8=lb,kc.Transform=Wu,kc.SHAPES=xb,kc.RoundedRectangle=GF,kc.Rectangle=La,kc.RAD_TO_DEG=CF,kc.Polygon=Vj,kc.Point=Da,kc.PI_2=Uj,kc.ObservablePoint=Fh,kc.Matrix=Lb,kc.Ellipse=FF,kc.DEG_TO_RAD=DF,kc.Circle=EF;ra.SORTABLE_CHILDREN=!1;var Cm=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?La.EMPTY:((t=t||new La(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addQuad=function(t){var e=this.minX,i=this.minY,n=this.maxX,r=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,n=s>n?s:n,r=o>r?o:r,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,n=s>n?s:n,r=o>r?o:r,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,n=s>n?s:n,r=o>r?o:r,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,n=s>n?s:n,r=o>r?o:r,this.minX=e,this.minY=i,this.maxX=n,this.maxY=r},t.prototype.addFrame=function(t,e,i,n,r){this.addFrameMatrix(t.worldTransform,e,i,n,r)},t.prototype.addFrameMatrix=function(t,e,i,n,r){var s=t.a,o=t.b,a=t.c,h=t.d,p=t.tx,l=t.ty,d=this.minX,m=this.minY,u=this.maxX,c=this.maxY,f=s*e+a*i+p,y=o*e+h*i+l;d=f<d?f:d,m=y<m?y:m,u=f>u?f:u,c=y>c?y:c,d=(f=s*n+a*i+p)<d?f:d,m=(y=o*n+h*i+l)<m?y:m,u=f>u?f:u,c=y>c?y:c,d=(f=s*e+a*r+p)<d?f:d,m=(y=o*e+h*r+l)<m?y:m,u=f>u?f:u,c=y>c?y:c,d=(f=s*n+a*r+p)<d?f:d,m=(y=o*n+h*r+l)<m?y:m,u=f>u?f:u,c=y>c?y:c,this.minX=d,this.minY=m,this.maxX=u,this.maxY=c},t.prototype.addVertexData=function(t,e,i){for(var n=this.minX,r=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],p=t[a+1];n=h<n?h:n,r=p<r?p:r,s=h>s?h:s,o=p>o?p:o}this.minX=n,this.minY=r,this.maxX=s,this.maxY=o},t.prototype.addVertices=function(t,e,i,n){this.addVerticesMatrix(t.worldTransform,e,i,n)},t.prototype.addVerticesMatrix=function(t,e,i,n,r,s){void 0===r&&(r=0),void 0===s&&(s=r);for(var o=t.a,a=t.b,h=t.c,p=t.d,l=t.tx,d=t.ty,m=this.minX,u=this.minY,c=this.maxX,f=this.maxY,y=i;y<n;y+=2){var b=e[y],x=e[y+1],$=o*b+h*x+l,v=p*x+a*b+d;m=Math.min(m,$-r),c=Math.max(c,$+r),u=Math.min(u,v-s),f=Math.max(f,v+s)}this.minX=m,this.minY=u,this.maxX=c,this.maxY=f},t.prototype.addBounds=function(t){var e=this.minX,i=this.minY,n=this.maxX,r=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>r?t.maxY:r},t.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,n=t.minY>e.minY?t.minY:e.minY,r=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=r&&n<=s){var o=this.minX,a=this.minY,h=this.maxX,p=this.maxY;this.minX=i<o?i:o,this.minY=n<a?n:a,this.maxX=r>h?r:h,this.maxY=s>p?s:p}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,n=t.minY>e.y?t.minY:e.y,r=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=r&&n<=s){var o=this.minX,a=this.minY,h=this.maxX,p=this.maxY;this.minX=i<o?i:o,this.minY=n<a?n:a,this.maxX=r>h?r:h,this.maxY=s>p?s:p}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,i,n,r,s){t-=r,e-=s,i+=r,n+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>n?this.maxY:n},t}(),Vea=function(t,e){return(Vea=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function Xu(t,e){function i(){this.constructor=t}Vea(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var Mb=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new Wu,e.alpha=1,e.visible=!0,e.renderable=!0,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Cm,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return Xu(e,t),e.mixin=function(t){for(var i=Object.keys(t),n=0;n<i.length;++n){var r=i[n];Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new La),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new La),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Cm);var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var n=this._bounds,r=this._boundsID;this._bounds=this._localBounds;var s=this.getBounds(!1,t);return this.parent=i,this.transform=e,this._bounds=n,this._bounds.updateID+=this._boundsID-r,s},e.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,i,n){return e&&(t=e.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,i,n,r,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===n&&(n=1),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=n||1,this.rotation=r,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Yu),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*CF},set:function(t){this.transform.rotation=t*DF},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){var e;this._mask&&((e=this._mask.maskObject||this._mask).renderable=!0,e.isMask=!1);(this._mask=t,this._mask)&&((e=this._mask.maskObject||this._mask).renderable=!1,e.isMask=!0)},enumerable:!1,configurable:!0}),e}(Tj.d),Yu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return Xu(e,t),e}(Mb);function Wea(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}Mb.prototype.displayObjectUpdateTransform=Mb.prototype.updateTransform;var qd=function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=ra.SORTABLE_CHILDREN,e.sortDirty=!1,e}return Xu(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(e.length>1)for(var n=0;n<e.length;n++)this.addChild(e[n]);else{var r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),n=this.getChildIndex(e);this.children[i]=e,this.children[n]=t,this.onChildrenChange(i<n?i:n)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);Ch(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(e.length>1)for(var n=0;n<e.length;n++)this.removeChild(e[n]);else{var r=e[0],s=this.children.indexOf(r);if(-1===s)return null;r.parent=null,r.transform._parentID=-1,Ch(this.children,s,1),this._boundsID++,this.onChildrenChange(s),r.emit("removed",this),this.emit("childRemoved",r,this,s)}return e[0]},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Ch(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var i,n=t,r=e-n;if(r>0&&r<=e){i=this.children.splice(n,r);for(var s=0;s<i.length;++s)i[s].parent=null,i[s].transform&&(i[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(s=0;s<i.length;++s)i[s].emit("removed",this),this.emit("childRemoved",i[s],this,s);return i}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var n=this.children[e];n._lastSortedIndex=e,t||0===n.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(Wea),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(e,i){void 0===i&&(i=!1);var n=t.prototype.getLocalBounds.call(this,e);if(!i)for(var r=0,s=this.children.length;r<s;++r){var o=this.children[r];o.visible&&o.updateTransform()}return n},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<e.length;n++)e[n].enabled&&this._enabledFilters.push(e[n]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);n=0;for(var r=this.children.length;n<r;n++)this.children[n].render(t);t.batch.flush(),i&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var i="boolean"==typeof e?e:e&&e.children,n=this.removeChildren(0,this.children.length);if(i)for(var r=0;r<n.length;++r)n[r].destroy(e)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),e}(Mb);qd.prototype.containerUpdateTransform=qd.prototype.updateTransform,Bm.TemporaryDisplayObject=Yu,Bm.DisplayObject=Mb,Bm.Container=qd,Bm.Bounds=Cm;var IF={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Mb.mixin(IF);var Xea=9,bq=100,Yea=0,Zea=0,JF=2,KF=1,$ea=-1e3,_ea=-1e3,afa=2,LF=function(){function e(e){this._hookDiv=null,(md.tablet||md.phone)&&this.createTouchHook();var t=document.createElement("div");t.style.width=bq+"px",t.style.height=bq+"px",t.style.position="absolute",t.style.top=Yea+"px",t.style.left=Zea+"px",t.style.zIndex=JF.toString(),this.div=t,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=e,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._isActive=!1,this._isMobileAccessibility=!1,this.androidUpdateCount=0,this.androidUpdateFrequency=500,window.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(e.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),e.prototype.createTouchHook=function(){var e=this,t=document.createElement("button");t.style.width=KF+"px",t.style.height=KF+"px",t.style.position="absolute",t.style.top=$ea+"px",t.style.left=_ea+"px",t.style.zIndex=afa.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessability for this content",t.addEventListener("focus",function(){e._isMobileAccessibility=!0,e.activate(),e.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t},e.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},e.prototype.activate=function(){this._isActive||(this._isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},e.prototype.deactivate=function(){this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},e.prototype.updateAccessibleObjects=function(e){if(e.visible&&e.accessibleChildren){e.accessible&&e.interactive&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);for(var t=e.children,i=0;i<t.length;i++)this.updateAccessibleObjects(t[i])}},e.prototype.update=function(){var e=performance.now();if(!(md.android.device&&e<this.androidUpdateCount)&&(this.androidUpdateCount=e+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),i=this.renderer.resolution,s=t.width/this.renderer.width*i,r=t.height/this.renderer.height*i,n=this.div;n.style.left=t.left+"px",n.style.top=t.top+"px",n.style.width=this.renderer.width+"px",n.style.height=this.renderer.height+"px";for(var o=0;o<this.children.length;o++){var a=this.children[o];if(a.renderId!==this.renderId)a._accessibleActive=!1,Ch(this.children,o,1),this.div.removeChild(a._accessibleDiv),this.pool.push(a._accessibleDiv),a._accessibleDiv=null,o--;else{n=a._accessibleDiv;var l=a.hitArea,c=a.worldTransform;a.hitArea?(n.style.left=(c.tx+l.x*c.a)*s+"px",n.style.top=(c.ty+l.y*c.d)*r+"px",n.style.width=l.width*c.a*s+"px",n.style.height=l.height*c.d*r+"px"):(l=a.getBounds(),this.capHitArea(l),n.style.left=l.x*s+"px",n.style.top=l.y*r+"px",n.style.width=l.width*s+"px",n.style.height=l.height*r+"px",n.title!==a.accessibleTitle&&null!==a.accessibleTitle&&(n.title=a.accessibleTitle),n.getAttribute("aria-label")!==a.accessibleHint&&null!==a.accessibleHint&&n.setAttribute("aria-label",a.accessibleHint)),a.accessibleTitle===n.title&&a.tabIndex===n.tabIndex||(n.title=a.accessibleTitle,n.tabIndex=a.tabIndex,this.debug&&this.updateDebugHTML(n))}}this.renderId++}},e.prototype.updateDebugHTML=function(e){e.innerHTML="type: "+e.type+"</br> title : "+e.title+"</br> tabIndex: "+e.tabIndex},e.prototype.capHitArea=function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0),e.x+e.width>this.renderer.width&&(e.width=this.renderer.width-e.x),e.y+e.height>this.renderer.height&&(e.height=this.renderer.height-e.y)},e.prototype.addChild=function(e){var t=this.pool.pop();t||((t=document.createElement("button")).style.width=bq+"px",t.style.height=bq+"px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=JF.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:e.accessibleHint&&null!==e.accessibleHint||(t.title="displayObject "+e.tabIndex),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex},e.prototype._onClick=function(e){var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"click",t.eventData),t.dispatchEvent(e.target.displayObject,"pointertap",t.eventData),t.dispatchEvent(e.target.displayObject,"tap",t.eventData)},e.prototype._onFocus=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive");var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"mouseover",t.eventData)},e.prototype._onFocusOut=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite");var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"mouseout",t.eventData)},e.prototype._onKeyDown=function(e){e.keyCode===Xea&&this.activate()},e.prototype._onMouseMove=function(e){0===e.movementX&&0===e.movementY||this.deactivate()},e.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},e}();Uu.accessibleTarget=IF,Uu.AccessibilityManager=LF;var Wj={};var bfa,Be,Dm={};ra.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(Be||(bfa=Be={},Dm.UPDATE_PRIORITY=Be,bfa));var Zu=function(){function t(t,e,i,s){void 0===e&&(e=null),void 0===i&&(i=0),void 0===s&&(s=!1),this.fn=t,this.context=e,this.priority=i,this.once=s,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),Nb=function(){function t(){var t=this;this._head=new Zu(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/ra.TARGET_FPMS,this.elapsedMS=1/ra.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,i){return void 0===i&&(i=Be.NORMAL),this._addListener(new Zu(t,e,i))},t.prototype.addOnce=function(t,e,i){return void 0===i&&(i=Be.NORMAL),this._addListener(new Zu(t,e,i,!0))},t.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*ra.TARGET_FPMS;for(var s=this._head,r=s.next;r;)r=r.emit(this.deltaTime);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,ra.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!1,configurable:!0}),t}(),MF=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Be.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Nb.shared:new Nb,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t}();Dm.UPDATE_PRIORITY=Be,Dm.TickerPlugin=MF,Dm.Ticker=Nb;var $u=function(){function t(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Da,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(t.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),t.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)},t.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},t}(),cfa=function(t,e){return(cfa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function dfa(t,e){function i(){this.constructor=t}cfa(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var NF=function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},t}(),cq=function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(t.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this._flags===t.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){return 0!=(this._flags&t.FLAGS.OVER)},set:function(e){this._doSet(t.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{get:function(){return 0!=(this._flags&t.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{get:function(){return 0!=(this._flags&t.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t}(),efa=function(){function t(){this._tempPoint=new Da}return t.prototype.recursiveFindHit=function(t,e,i,n,o){if(!e||!e.visible)return!1;var r=t.data.global,s=!1,a=o=e.interactive||o,c=!0;if(e.hitArea?(n&&(e.worldTransform.applyInverse(r,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:(n=!1,c=!1)),a=!1):e._mask&&n&&(e._mask.containsPoint&&e._mask.containsPoint(r)||(n=!1)),c&&e.interactiveChildren&&e.children)for(var p=e.children,h=p.length-1;h>=0;h--){var u=p[h],l=this.recursiveFindHit(t,u,i,n,a);if(l){if(!u.parent)continue;a=!1,l&&(t.target&&(n=!1),s=!0)}}return o&&(n&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(r)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),i&&i(t,e,!!s))),s},t.prototype.findHit=function(t,e,i,n){this.recursiveFindHit(t,e,i,n,!1)},t}(),OF={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};Mb.mixin(OF);var dq=1,eq={target:null,data:{global:null}},PF=function(t){function e(e,i){var n=t.call(this)||this;return i=i||{},n.renderer=e,n.autoPreventDefault=void 0===i.autoPreventDefault||i.autoPreventDefault,n.interactionFrequency=i.interactionFrequency||10,n.mouse=new $u,n.mouse.identifier=dq,n.mouse.global.set(-999999),n.activeInteractionData={},n.activeInteractionData[dq]=n.mouse,n.interactionDataPool=[],n.eventData=new NF,n.interactionDOMElement=null,n.moveWhenInside=!1,n.eventsAdded=!1,n.tickerAdded=!1,n.mouseOverRenderer=!1,n.supportsTouchEvents="ontouchstart"in window,n.supportsPointerEvents=!!window.PointerEvent,n.onPointerUp=n.onPointerUp.bind(n),n.processPointerUp=n.processPointerUp.bind(n),n.onPointerCancel=n.onPointerCancel.bind(n),n.processPointerCancel=n.processPointerCancel.bind(n),n.onPointerDown=n.onPointerDown.bind(n),n.processPointerDown=n.processPointerDown.bind(n),n.onPointerMove=n.onPointerMove.bind(n),n.processPointerMove=n.processPointerMove.bind(n),n.onPointerOut=n.onPointerOut.bind(n),n.processPointerOverOut=n.processPointerOverOut.bind(n),n.onPointerOver=n.onPointerOver.bind(n),n.cursorStyles={default:"inherit",pointer:"pointer"},n.currentCursorMode=null,n.cursor=null,n.resolution=1,n.delayedEvents=[],n.search=new efa,n._tempDisplayObject=new Yu,n._useSystemTicker=void 0===i.useSystemTicker||i.useSystemTicker,n.setTargetElement(n.renderer.view,n.renderer.resolution),n}return dfa(e,t),Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,e){return eq.target=null,eq.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive(eq,e,null,!0),eq.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(Nb.system.add(this.tickerUpdate,this,Be.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(Nb.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var i=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(typeof e){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e);}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,i){i.stopPropagationHint&&t!==i.stopsPropagatingAt||(i.currentTarget=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},e.prototype.delayDispatchEvent=function(t,e,i){this.delayedEvents.push({displayObject:t,eventString:e,eventData:i})},e.prototype.mapPositionToPoint=function(t,e,i){var n;n=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var o=1/this.resolution;t.x=(e-n.left)*(this.interactionDOMElement.width/n.width)*o,t.y=(i-n.top)*(this.interactionDOMElement.height/n.height)*o},e.prototype.processInteractive=function(t,e,i,n){var o=this.search.findHit(t,e,i,n),r=this.delayedEvents;if(!r.length)return o;t.stopPropagationHint=!1;var s=r.length;this.delayedEvents=[];for(var a=0;a<s;a++){var c=r[a],p=c.displayObject,h=c.eventString,u=c.eventData;u.stopsPropagatingAt===p&&(u.stopPropagationHint=!0),this.dispatchEvent(p,h,u)}return o},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var i=e.length,n=0;n<i;n++){var o=e[n],r=this.getInteractionDataForPointerId(o),s=this.configureInteractionEventForDOMEvent(this.eventData,o,r);if(s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===o.pointerType)this.emit("touchstart",s);else if("mouse"===o.pointerType||"pen"===o.pointerType){var a=2===o.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,i){var n=t.data,o=t.data.identifier;if(i)if(e.trackedPointers[o]||(e.trackedPointers[o]=new cq(o)),this.dispatchEvent(e,"pointerdown",t),"touch"===n.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===n.pointerType||"pen"===n.pointerType){var r=2===n.button;r?e.trackedPointers[o].rightDown=!0:e.trackedPointers[o].leftDown=!0,this.dispatchEvent(e,r?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,i){for(var n=this.normalizeToPointerData(t),o=n.length,r=t.target!==this.interactionDOMElement?"outside":"",s=0;s<o;s++){var a=n[s],c=this.getInteractionDataForPointerId(a),p=this.configureInteractionEventForDOMEvent(this.eventData,a,c);if(p.data.originalEvent=t,this.processInteractive(p,this.lastObjectRendered,i,e||!r),this.emit(e?"pointercancel":"pointerup"+r,p),"mouse"===a.pointerType||"pen"===a.pointerType){var h=2===a.button;this.emit(h?"rightup"+r:"mouseup"+r,p)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+r,p),this.releaseInteractionDataForPointerId(a.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var i=t.data,n=t.data.identifier;void 0!==e.trackedPointers[n]&&(delete e.trackedPointers[n],this.dispatchEvent(e,"pointercancel",t),"touch"===i.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,i){var n=t.data,o=t.data.identifier,r=e.trackedPointers[o],s="touch"===n.pointerType,a="mouse"===n.pointerType||"pen"===n.pointerType,c=!1;if(a){var p=2===n.button,h=cq.FLAGS,u=p?h.RIGHT_DOWN:h.LEFT_DOWN,l=void 0!==r&&r.flags&u;i?(this.dispatchEvent(e,p?"rightup":"mouseup",t),l&&(this.dispatchEvent(e,p?"rightclick":"click",t),c=!0)):l&&this.dispatchEvent(e,p?"rightupoutside":"mouseupoutside",t),r&&(p?r.rightDown=!1:r.leftDown=!1)}i?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),r&&(a&&!c||this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),r.over=!1))):r&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),r&&r.none&&delete e.trackedPointers[o]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var i=e.length,n=0;n<i;n++){var o=e[n],r=this.getInteractionDataForPointerId(o),s=this.configureInteractionEventForDOMEvent(this.eventData,o,r);s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",s),"touch"===o.pointerType&&this.emit("touchmove",s),"mouse"!==o.pointerType&&"pen"!==o.pointerType||this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,i){var n=t.data,o="touch"===n.pointerType,r="mouse"===n.pointerType||"pen"===n.pointerType;r&&this.processPointerOverOut(t,e,i),this.moveWhenInside&&!i||(this.dispatchEvent(e,"pointermove",t),o&&this.dispatchEvent(e,"touchmove",t),r&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var i=this.getInteractionDataForPointerId(e),n=this.configureInteractionEventForDOMEvent(this.eventData,e,i);n.data.originalEvent=e,this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",n),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",n):this.releaseInteractionDataForPointerId(i.identifier)}},e.prototype.processPointerOverOut=function(t,e,i){var n=t.data,o=t.data.identifier,r="mouse"===n.pointerType||"pen"===n.pointerType,s=e.trackedPointers[o];i&&!s&&(s=e.trackedPointers[o]=new cq(o)),void 0!==s&&(i&&this.mouseOverRenderer?(s.over||(s.over=!0,this.delayDispatchEvent(e,"pointerover",t),r&&this.delayDispatchEvent(e,"mouseover",t)),r&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),r&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[o]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],i=this.getInteractionDataForPointerId(e),n=this.configureInteractionEventForDOMEvent(this.eventData,e,i);n.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",n),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",n)},e.prototype.getInteractionDataForPointerId=function(t){var e,i=t.pointerId;return i===dq||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[i]?e=this.activeInteractionData[i]:((e=this.interactionDataPool.pop()||new $u).identifier=i,this.activeInteractionData[i]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,i){return t.data=i,this.mapPositionToPoint(i.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=i.global.x,e.globalY=i.global.y),i.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,n=t.changedTouches.length;i<n;i++){var o=t.changedTouches[i];void 0===o.button&&(o.button=t.touches.length?1:0),void 0===o.buttons&&(o.buttons=t.touches.length?1:0),void 0===o.isPrimary&&(o.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===o.width&&(o.width=o.radiusX||1),void 0===o.height&&(o.height=o.radiusY||1),void 0===o.tiltX&&(o.tiltX=0),void 0===o.tiltY&&(o.tiltY=0),void 0===o.pointerType&&(o.pointerType="touch"),void 0===o.pointerId&&(o.pointerId=o.identifier||0),void 0===o.pressure&&(o.pressure=o.force||.5),void 0===o.twist&&(o.twist=0),void 0===o.tangentialPressure&&(o.tangentialPressure=0),void 0===o.layerX&&(o.layerX=o.offsetX=o.clientX),void 0===o.layerY&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,e.push(o)}else if(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent)e.push(t);else{var r=t;void 0===r.isPrimary&&(r.isPrimary=!0),void 0===r.width&&(r.width=1),void 0===r.height&&(r.height=1),void 0===r.tiltX&&(r.tiltX=0),void 0===r.tiltY&&(r.tiltY=0),void 0===r.pointerType&&(r.pointerType="mouse"),void 0===r.pointerId&&(r.pointerId=dq),void 0===r.pressure&&(r.pressure=.5),void 0===r.twist&&(r.twist=0),void 0===r.tangentialPressure&&(r.tangentialPressure=0),r.isNormalized=!0,e.push(r)}return e},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e}(Tj.d);Wj.interactiveTarget=OF,Wj.InteractionTrackingData=cq,Wj.InteractionManager=PF,Wj.InteractionEvent=NF,Wj.InteractionData=$u;var QF={};var xa={};var RF={},bc=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,n,i,r,s,o,u){if(arguments.length>8)throw new Error("max arguments reached");var h=this.name,p=this.items;this._aliasCount++;for(var a=0,m=p.length;a<m;a++)p[a][h](t,e,n,i,r,s,o,u);return p===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(bc.prototype,{dispatch:{value:bc.prototype.emit},run:{value:bc.prototype.emit}}),RF.Runner=bc;ra.PREFER_ENV=md.any?ze.WEBGL:ze.WEBGL2,ra.STRICT_TEXTURE_CACHE=!1;var fq=[];function _u(e,t){if(!e)return null;var r="";if("string"==typeof e){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);i&&(r=i[1].toLowerCase())}for(var n=fq.length-1;n>=0;--n){var o=fq[n];if(o.test&&o.test(e,r))return new o(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}var ffa=function(e,t){return(ffa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function Ba(e,t){function r(){this.constructor=e}ffa(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Xj=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new bc("setRealSize"),this.onUpdate=new bc("update"),this.onError=new bc("onError")}return e.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},e.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},e.prototype.resize=function(e,t){e===this._width&&t===this._height||(this._width=e,this._height=t,this.onResize.emit(e,t))},Object.defineProperty(e.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),e.prototype.update=function(){this.destroyed||this.onUpdate.emit()},e.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e.prototype.style=function(e,t,r){return!1},e.prototype.dispose=function(){},e.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},e.test=function(e,t){return!1},e}(),gq=function(e){function t(t,r){var i=this,n=r||{},o=n.width,a=n.height;if(!o||!a)throw new Error("BufferResource width or height invalid");return(i=e.call(this,o,a)||this).data=t,i}return Ba(t,e),t.prototype.upload=function(e,t,r){var i=e.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===of.UNPACK),r.width===t.width&&r.height===t.height?i.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.type,this.data):(r.width=t.width,r.height=t.height,i.texImage2D(t.target,0,r.internalFormat,t.width,t.height,0,t.format,r.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},t}(Xj),gfa={scaleMode:Ae.NEAREST,format:Rj.RGBA,alphaMode:of.NPM},gb=function(e){function t(t,r){void 0===t&&(t=null),void 0===r&&(r=null);var i=e.call(this)||this,n=(r=r||{}).alphaMode,o=r.mipmap,a=r.anisotropicLevel,s=r.scaleMode,u=r.width,p=r.height,h=r.wrapMode,$=r.format,l=r.type,d=r.target,c=r.resolution,f=r.resourceOptions;return!t||t instanceof Xj||((t=_u(t,f)).internal=!0),i.width=u||0,i.height=p||0,i.resolution=c||ra.RESOLUTION,i.mipmap=void 0!==o?o:ra.MIPMAP_TEXTURES,i.anisotropicLevel=void 0!==a?a:ra.ANISOTROPIC_LEVEL,i.wrapMode=h||ra.WRAP_MODE,i.scaleMode=void 0!==s?s:ra.SCALE_MODE,i.format=$||Rj.RGBA,i.type=l||Kb.UNSIGNED_BYTE,i.target=d||sg.TEXTURE_2D,i.alphaMode=void 0!==n?n:of.UNPACK,void 0!==r.premultiplyAlpha&&(i.premultiplyAlpha=r.premultiplyAlpha),i.uid=Eh(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=u>0&&p>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(t),i}return Ba(t,e),Object.defineProperty(t.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),t.prototype.setStyle=function(e,t){var r;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this},t.prototype.setSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e,this.height=t,this._refreshPOT(),this.update(),this},t.prototype.setRealSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e/this.resolution,this.height=t/this.resolution,this._refreshPOT(),this.update(),this},t.prototype._refreshPOT=function(){this.isPowerOfTwo=Pu(this.realWidth)&&Pu(this.realHeight)},t.prototype.setResolution=function(e){var t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=this.width*t/e,this.height=this.height*t/e,this.emit("update",this)),this._refreshPOT(),this)},t.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},t.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},t.prototype.onError=function(e){this.emit("error",this,e)},t.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete pd[this.cacheId],delete Ec[this.cacheId],this.cacheId=null),this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},t.prototype.dispose=function(){this.emit("dispose",this)},t.prototype.castToBaseTexture=function(){return this},t.from=function(e,r,i){void 0===i&&(i=ra.STRICT_TEXTURE_CACHE);var n="string"==typeof e,o=null;n?o=e:(e._pixiId||(e._pixiId="pixiid_"+Eh()),o=e._pixiId);var a=pd[o];if(n&&i&&!a)throw new Error("The cacheId \""+o+"\" does not exist in BaseTextureCache.");return a||((a=new t(e,r)).cacheId=o,t.addToCache(a,o)),a},t.fromBuffer=function(e,r,i,n){e=e||new Float32Array(r*i*4);var o=new gq(e,{width:r,height:i}),a=e instanceof Float32Array?Kb.FLOAT:Kb.UNSIGNED_BYTE;return new t(o,Object.assign(gfa,n||{width:r,height:i,type:a}))},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),pd[t]&&console.warn("BaseTexture added to the cache with an id ["+t+"] that already had an entry"),pd[t]=e)},t.removeFromCache=function(e){if("string"==typeof e){var t=pd[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete pd[e],t}}else if(e&&e.textureCacheIds){for(var i=0;i<e.textureCacheIds.length;++i)delete pd[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null},t._globalBatch=0,t}(Tj.d),av=function(e){function t(t,r){var i=this,n=r||{},o=n.width,a=n.height;(i=e.call(this,o,a)||this).items=[],i.itemDirtyIds=[];for(var s=0;s<t;s++){var u=new gb;i.items.push(u),i.itemDirtyIds.push(-2)}return i.length=t,i._load=null,i.baseTexture=null,i}return Ba(t,e),t.prototype.initFromArray=function(e,t){for(var r=0;r<this.length;r++)e[r]&&(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):e[r]instanceof Xj?this.addResourceAt(e[r],r):this.addResourceAt(_u(e[r],t),r))},t.prototype.dispose=function(){for(var e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(e,t){if(!this.items[t])throw new Error("Index "+t+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this},t.prototype.bind=function(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");e.prototype.bind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)},t.prototype.unbind=function(t){e.prototype.unbind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.items.map(function(e){return e.resource}).filter(function(e){return e}).map(function(e){return e.load()});return this._load=Promise.all(t).then(function(){var t=e.items[0],r=t.realWidth,i=t.realHeight;return e.resize(r,i),Promise.resolve(e)}),this._load},t}(Xj),SF=function(e){function t(t,r){var i,n,o=this,a=r||{},s=a.width,u=a.height;return Array.isArray(t)?(i=t,n=t.length):n=t,o=e.call(this,n,{width:s,height:u})||this,i&&o.initFromArray(i,r),o}return Ba(t,e),t.prototype.addBaseTextureAt=function(e,t){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,t),this},t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=sg.TEXTURE_2D_ARRAY},t.prototype.upload=function(e,t,r){var i=this.length,n=this.itemDirtyIds,o=this.items,a=e.gl;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,t.format,this._width,this._height,i,0,t.format,t.type,null);for(var s=0;s<i;s++){var u=o[s];n[s]<u.dirtyId&&(n[s]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,s,u.resource.width,u.resource.height,1,t.format,t.type,u.resource.source))}return!0},t}(av),pf=function(e){function t(t){var r=this,i=t,n=i.naturalWidth||i.videoWidth||i.width,o=i.naturalHeight||i.videoHeight||i.height;return(r=e.call(this,n,o)||this).source=t,r.noSubImage=!1,r}return Ba(t,e),t.crossOrigin=function(e,t,r){void 0===r&&0!==t.indexOf("data:")?e.crossOrigin=BF(t):!1!==r&&(e.crossOrigin="string"==typeof r?r:"anonymous")},t.prototype.upload=function(e,t,r,i){var n=e.gl,o=t.realWidth,a=t.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===of.UNPACK),this.noSubImage||t.target!==n.TEXTURE_2D||r.width!==o||r.height!==a?(r.width=o,r.height=a,n.texImage2D(t.target,0,t.format,t.format,t.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.format,t.type,i),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source,r=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(r,i),e.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(Xj),bv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ba(t,e),t.test=function(e){var t=window.OffscreenCanvas;return!!(t&&e instanceof t)||e instanceof HTMLCanvasElement},t}(pf),TF=function(e){function t(r,i){var n=this,o=i||{},a=o.width,s=o.height,u=o.autoLoad,p=o.linkBaseTexture;if(r&&r.length!==t.SIDES)throw new Error("Invalid length. Got "+r.length+", expected 6");n=e.call(this,6,{width:a,height:s})||this;for(var h=0;h<t.SIDES;h++)n.items[h].target=sg.TEXTURE_CUBE_MAP_POSITIVE_X+h;return n.linkBaseTexture=!1!==p,r&&n.initFromArray(r,i),!1!==u&&n.load(),n}return Ba(t,e),t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=sg.TEXTURE_CUBE_MAP},t.prototype.addBaseTextureAt=function(e,t,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[t])throw new Error("Index "+t+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,t)}else e.target=sg.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this},t.prototype.upload=function(e,r,i){for(var n=this.itemDirtyIds,o=0;o<t.SIDES;o++){var a=this.items[o];n[o]<a.dirtyId&&(a.valid&&a.resource?(a.resource.upload(e,a,i),n[o]=a.dirtyId):n[o]<-1&&(e.gl.texImage2D(a.target,0,i.internalFormat,r.realWidth,r.realHeight,0,r.format,i.type,null),n[o]=-1))}return!0},t.test=function(e){return Array.isArray(e)&&e.length===t.SIDES},t.SIDES=6,t}(av),cv=function(e){function t(t,r){var i=this;if(r=r||{},!(t instanceof HTMLImageElement)){var n=new Image;pf.crossOrigin(n,t,r.crossorigin),n.src=t,t=n}return i=e.call(this,t)||this,!t.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=t.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(void 0!==r.createBitmap?r.createBitmap:ra.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,i.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(i.premultiplyAlpha=r.premultiplyAlpha),i.bitmap=null,i._load=null,!1!==r.autoLoad&&i.load(),i}return Ba(t,e),t.prototype.load=function(e){var t=this;return this._load?this._load:(void 0!==e&&(this.createBitmap=e),this._load=new Promise(function(e,r){var i=t.source;t.url=i.src;var n=function(){t.destroyed||(i.onload=null,i.onerror=null,t.resize(i.width,i.height),t._load=null,t.createBitmap?e(t.process()):e(t))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(e){r(e),t.onError.emit(e)})}),this._load)},t.prototype.process=function(){var e=this,t=this.source;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(t,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===of.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return e.prototype.upload.call(this,t,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(e.prototype.upload.call(this,t,r,i,this.bitmap),!this.preserveBitmap){var n=!0,o=r._glTextures;for(var a in o){var s=o[a];if(s!==i&&s.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,e.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t.test=function(e){return"string"==typeof e||e instanceof HTMLImageElement},t}(pf),UF=function(e){function t(t,r){var i=this;return r=r||{},(i=e.call(this,document.createElement("canvas"))||this)._width=0,i._height=0,i.svg=t,i.scale=r.scale||1,i._overrideWidth=r.width,i._overrideHeight=r.height,i._resolve=null,i._crossorigin=r.crossorigin,i._load=null,!1!==r.autoLoad&&i.load(),i}return Ba(t,e),t.prototype.load=function(){var e=this;return this._load?this._load:(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}),this._load)},t.prototype._loadSvg=function(){var e=this,t=new Image;pf.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=function(r){e._resolve&&(t.onerror=null,e.onError.emit(r))},t.onload=function(){if(e._resolve){var r=t.width,i=t.height;if(!r||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=r*e.scale,o=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*r,o=e._overrideHeight||e._overrideWidth/r*i),n=Math.round(n),o=Math.round(o);var a=e.source;a.width=n,a.height=o,a._pixiId="canvas_"+Eh(),a.getContext("2d").drawImage(t,0,0,r,i,0,0,n,o),e._resolve(),e._resolve=null}}},t.getSize=function(e){var r=t.SVG_SIZE.exec(e),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},t.test=function(e,t){return"svg"===t||"string"==typeof e&&0===e.indexOf("data:image/svg+xml;base64")||"string"==typeof e&&0===e.indexOf("<svg")},t.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,t}(pf),VF=function(e){function t(r,i){var n=this;if(i=i||{},!(r instanceof HTMLVideoElement)){var o=document.createElement("video");o.setAttribute("preload","auto"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),"string"==typeof r&&(r=[r]);var a=r[0].src||r[0];pf.crossOrigin(o,a,i.crossorigin);for(var s=0;s<r.length;++s){var u=document.createElement("source"),p=r[s],h=p.src,$=p.mime,l=(h=h||r[s]).split("?").shift().toLowerCase(),d=l.substr(l.lastIndexOf(".")+1);$=$||t.MIME_TYPES[d]||"video/"+d,u.src=h,u.type=$,o.appendChild(u)}r=o}return(n=e.call(this,r)||this).noSubImage=!0,n._autoUpdate=!0,n._isConnectedToTicker=!1,n._updateFPS=i.updateFPS||0,n._msToNextUpdate=0,n.autoPlay=!1!==i.autoPlay,n._load=null,n._resolve=null,n._onCanPlay=n._onCanPlay.bind(n),n._onError=n._onError.bind(n),!1!==i.autoLoad&&n.load(),n}return Ba(t,e),t.prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var r=Nb.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(e.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise(function(r){e.valid?r(e):(e._resolve=r,t.load())}),this._load},t.prototype._onError=function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)},t.prototype._isSourcePlaying=function(){var e=this.source;return e.currentTime>0&&!1===e.paused&&!1===e.ended&&e.readyState>2},t.prototype._isSourceReady=function(){var e=this.source;return 3===e.readyState||4===e.readyState},t.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Nb.shared.add(this.update,this),this._isConnectedToTicker=!0)},t.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Nb.shared.remove(this.update,this),this._isConnectedToTicker=!1)},t.prototype._onCanPlay=function(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},t.prototype.dispose=function(){this._isConnectedToTicker&&Nb.shared.remove(this.update,this);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Nb.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Nb.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e)},enumerable:!1,configurable:!0}),t.test=function(e,r){return e instanceof HTMLVideoElement||t.TYPES.indexOf(r)>-1},t.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],t.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},t}(pf),WF=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ba(t,e),t.test=function(e){return!!window.createImageBitmap&&e instanceof ImageBitmap},t}(pf);fq.push(cv,WF,bv,VF,UF,gq,TF,SF);var hfa={Resource:Xj,BaseImageResource:pf,INSTALLED:fq,autoDetectResource:_u,AbstractMultiResource:av,ArrayResource:SF,BufferResource:gq,CanvasResource:bv,CubeResource:TF,ImageResource:cv,SVGResource:UF,VideoResource:VF,ImageBitmapResource:WF},Fc=function(){function e(e){this.renderer=e}return e.prototype.destroy=function(){this.renderer=null},e}(),ifa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ba(t,e),t.prototype.upload=function(e,t,r){var i=e.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===of.UNPACK),r.width===t.width&&r.height===t.height?i.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.type,this.data):(r.width=t.width,r.height=t.height,i.texImage2D(t.target,0,1===e.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,t.width,t.height,0,t.format,t.type,this.data)),!0},t}(gq),hq=function(){function e(e,t){this.width=Math.ceil(e||100),this.height=Math.ceil(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new bc("disposeFramebuffer"),this.multisample=Ah.NONE}return Object.defineProperty(e.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),e.prototype.addColorTexture=function(e,t){return void 0===e&&(e=0),this.colorTextures[e]=t||new gb(null,{scaleMode:Ae.NEAREST,resolution:1,mipmap:Sj.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.addDepthTexture=function(e){return this.depthTexture=e||new gb(new ifa(null,{width:this.width,height:this.height}),{scaleMode:Ae.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Sj.OFF,format:Rj.DEPTH_COMPONENT,type:Kb.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.resize=function(e,t){if(e=Math.ceil(e),t=Math.ceil(t),e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(e/n,t/n)}if(this.depthTexture){n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,t/n)}}},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},e}(),Em=function(e){function t(t){var r=this;"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});r=e.call(this,null,t)||this;var i=t||{},n=i.width,o=i.height;return r.mipmap=0,r.width=Math.ceil(n)||100,r.height=Math.ceil(o)||100,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new hq(r.width*r.resolution,r.height*r.resolution).addColorTexture(0,r),r.maskStack=[],r.filterStack=[{}],r}return Ba(t,e),t.prototype.resize=function(e,t){e=Math.ceil(e),t=Math.ceil(t),this.framebuffer.resize(e*this.resolution,t*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),e.prototype.dispose.call(this)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},t}(gb),dv=function(){function e(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return e.prototype.set=function(e,t,r){var i=t.width,n=t.height;if(r){var o=e.width/2/i,a=e.height/2/n,s=e.x/i+o,u=e.y/n+a;r=lb.add(r,lb.NW),this.x0=s+o*lb.uX(r),this.y0=u+a*lb.uY(r),r=lb.add(r,2),this.x1=s+o*lb.uX(r),this.y1=u+a*lb.uY(r),r=lb.add(r,2),this.x2=s+o*lb.uX(r),this.y2=u+a*lb.uY(r),r=lb.add(r,2),this.x3=s+o*lb.uX(r),this.y3=u+a*lb.uY(r)}else this.x0=e.x/i,this.y0=e.y/n,this.x1=(e.x+e.width)/i,this.y1=e.y/n,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/n,this.x3=e.x/i,this.y3=(e.y+e.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},e}(),XF=new dv,ya=function(e){function t(r,i,n,o,a,s){var u=e.call(this)||this;if(u.noFrame=!1,i||(u.noFrame=!0,i=new La(0,0,1,1)),r instanceof t&&(r=r.baseTexture),u.baseTexture=r,u._frame=i,u.trim=o,u.valid=!1,u._uvs=XF,u.uvMatrix=null,u.orig=n||i,u._rotate=Number(a||0),!0===a)u._rotate=2;else if(u._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return u.defaultAnchor=s?new Da(s.x,s.y):new Da(0,0),u._updateID=0,u.textureCacheIds=[],r.valid?u.noFrame?r.valid&&u.onBaseTextureUpdated(r):u.frame=i:r.once("loaded",u.onBaseTextureUpdated,u),u.noFrame&&r.on("update",u.onBaseTextureUpdated,u),u}return Ba(t,e),t.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},t.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},t.prototype.destroy=function(e){if(this.baseTexture){if(e){var r=this.baseTexture;r&&r.url&&Ec[r.url]&&t.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){return new t(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},t.prototype.updateUvs=function(){this._uvs===XF&&(this._uvs=new dv),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.from=function(e,r,i){void 0===r&&(r={}),void 0===i&&(i=ra.STRICT_TEXTURE_CACHE);var n="string"==typeof e,o=null;n?o=e:(e._pixiId||(e._pixiId="pixiid_"+Eh()),o=e._pixiId);var a=Ec[o];if(n&&i&&!a)throw new Error("The cacheId \""+o+"\" does not exist in TextureCache.");return a||(r.resolution||(r.resolution=Am(e)),(a=new t(new gb(e,r))).baseTexture.cacheId=o,gb.addToCache(a.baseTexture,o),t.addToCache(a,o)),a},t.fromURL=function(e,r){var i=Object.assign({autoLoad:!1},null==r?void 0:r.resourceOptions),n=t.from(e,Object.assign({resourceOptions:i},r),!1),o=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):o.load().then(function(){return Promise.resolve(n)})},t.fromBuffer=function(e,r,i,n){return new t(gb.fromBuffer(e,r,i,n))},t.fromLoader=function(e,r,i){var n=new cv(e);n.url=r;var o=new t(new gb(n,{scaleMode:ra.SCALE_MODE,resolution:Am(r)}));return i||(i=r),gb.addToCache(o.baseTexture,i),t.addToCache(o,i),i!==r&&(gb.addToCache(o.baseTexture,r),t.addToCache(o,r)),o},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),Ec[t]&&console.warn("Texture added to the cache with an id ["+t+"] that already had an entry"),Ec[t]=e)},t.removeFromCache=function(e){if("string"==typeof e){var t=Ec[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete Ec[e],t}}else if(e&&e.textureCacheIds){for(var i=0;i<e.textureCacheIds.length;++i)Ec[e.textureCacheIds[i]]===e&&delete Ec[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null},Object.defineProperty(t.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var t=e.x,r=e.y,i=e.width,n=e.height,o=t+i>this.baseTexture.width,a=r+n>this.baseTexture.height;if(o||a){var s=o&&a?"and":"or",u="X: "+t+" + "+i+" = "+(t+i)+" > "+this.baseTexture.width,p="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+u+" "+s+" "+p)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=e),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),t.prototype.castToBaseTexture=function(){return this.baseTexture},t}(Tj.d);function jfa(){var e=document.createElement("canvas");e.width=16,e.height=16;var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,16,16),new ya(new gb(new bv(e)))}function iq(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}ya.EMPTY=new ya(new gb()),iq(ya.EMPTY),iq(ya.EMPTY.baseTexture),ya.WHITE=jfa(),iq(ya.WHITE),iq(ya.WHITE.baseTexture);var Kh=function(e){function t(t,r){var i=this,n=null;if(!(t instanceof Em)){var o=arguments[1],a=arguments[2],s=arguments[3],u=arguments[4];console.warn("Please use RenderTexture.create("+o+", "+a+") instead of the ctor directly."),n=arguments[0],r=null,t=new Em({width:o,height:a,scaleMode:s,resolution:u})}return(i=e.call(this,t,r)||this).legacyRenderer=n,i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return Ba(t,e),Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t,r){void 0===r&&(r=!0),e=Math.ceil(e),t=Math.ceil(t),this.valid=e>0&&t>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=t,r&&this.baseTexture.resize(e,t),this.updateUvs()},t.prototype.setResolution=function(e){var t=this.baseTexture;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))},t.create=function(e){return"number"==typeof e&&(e={width:e,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new t(new Em(e))},t}(ya),YF=function(){function e(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return e.prototype.createTexture=function(e,t){var r=new Em(Object.assign({width:e,height:t,resolution:1},this.textureOptions));return new Kh(r)},e.prototype.getOptimalTexture=function(t,r,i){void 0===i&&(i=1);var n=e.SCREEN_KEY;t*=i,r*=i,this.enableFullScreen&&t===this._pixelsWidth&&r===this._pixelsHeight||(n=(65535&(t=zm(t)))<<16|65535&(r=zm(r))),this.texturePool[n]||(this.texturePool[n]=[]);var o=this.texturePool[n].pop();return o||(o=this.createTexture(t,r)),o.filterPoolKey=n,o.setResolution(i),o},e.prototype.getFilterTexture=function(e,t){var r=this.getOptimalTexture(e.width,e.height,t||e.resolution);return r.filterFrame=e.filterFrame,r},e.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},e.prototype.returnFilterTexture=function(e){this.returnTexture(e)},e.prototype.clear=function(e){if(e=!1!==e)for(var t in this.texturePool){var r=this.texturePool[t];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},e.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var r=e.SCREEN_KEY,i=this.texturePool[r];if(this.enableFullScreen=t.width>0&&t.height>0,i)for(var n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[r]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},e.SCREEN_KEY="screen",e}(),ev=function(){function e(e,t,r,i,n,o,a){void 0===t&&(t=0),void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=e,this.size=t,this.normalized=r,this.type=i,this.stride=n,this.start=o,this.instance=a}return e.prototype.destroy=function(){this.buffer=null},e.from=function(t,r,i,n,o){return new e(t,r,i,n,o)},e}(),kfa=0,Yb=function(){function e(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=t,this.id=kfa++,this.disposeRunner=new bc("disposeBuffer")}return e.prototype.update=function(e){this.data=e||this.data,this._updateID++},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.data=null},e.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new e(t)},e}();function ZF(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}var lfa={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function mfa(e,t){for(var r=0,i=0,n={},o=0;o<e.length;o++)i+=t[o],r+=e[o].length;var a=new ArrayBuffer(4*r),s=null,u=0;for(o=0;o<e.length;o++){var p=t[o],h=e[o],$=ZF(h);n[$]||(n[$]=new lfa[$](a)),s=n[$];for(var l=0;l<h.length;l++){s[(l/p|0)*i+u+l%p]=h[l]}u+=p}return new Float32Array(a)}var $F={5126:4,5123:2,5121:1},nfa=0,ofa={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},Yj=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=nfa++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new bc("disposeGeometry"),this.refCount=0}return e.prototype.addAttribute=function(e,t,r,i,n,o,a,s){if(void 0===r&&(r=0),void 0===i&&(i=!1),void 0===s&&(s=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof Yb||(t instanceof Array&&(t=new Float32Array(t)),t=new Yb(t));var u=e.split("|");if(u.length>1){for(var p=0;p<u.length;p++)this.addAttribute(u[p],t,r,i,n);return this}var h=this.buffers.indexOf(t);return-1===h&&(this.buffers.push(t),h=this.buffers.length-1),this.attributes[e]=new ev(h,r,i,n,o,a,s),this.instanced=this.instanced||s,this},e.prototype.getAttribute=function(e){return this.attributes[e]},e.prototype.getBuffer=function(e){return this.buffers[this.getAttribute(e).buffer]},e.prototype.addIndex=function(e){return e instanceof Yb||(e instanceof Array&&(e=new Uint16Array(e)),e=new Yb(e)),e.index=!0,this.indexBuffer=e,-1===this.buffers.indexOf(e)&&this.buffers.push(e),this},e.prototype.getIndex=function(){return this.indexBuffer},e.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var e,t=[],r=[],i=new Yb;for(e in this.attributes){var n=this.attributes[e],o=this.buffers[n.buffer];t.push(o.data),r.push(n.size*$F[n.type]/4),n.buffer=0}for(i.data=mfa(t,r),e=0;e<this.buffers.length;e++)this.buffers[e]!==this.indexBuffer&&this.buffers[e].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},e.prototype.getSize=function(){for(var e in this.attributes){var t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},e.prototype.clone=function(){for(var t=new e,r=0;r<this.buffers.length;r++)t.buffers[r]=new Yb(this.buffers[r].data.slice(0));for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new ev(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},e.merge=function(t){for(var r,i=new e,n=[],o=[],a=[],s=0;s<t.length;s++){r=t[s];for(var u=0;u<r.buffers.length;u++)o[u]=o[u]||0,o[u]+=r.buffers[u].data.length,a[u]=0}for(s=0;s<r.buffers.length;s++)n[s]=new ofa[ZF(r.buffers[s].data)](o[s]),i.buffers[s]=new Yb(n[s]);for(s=0;s<t.length;s++){r=t[s];for(u=0;u<r.buffers.length;u++)n[u].set(r.buffers[u].data,a[u]),a[u]+=r.buffers[u].data.length}if(i.attributes=r.attributes,r.indexBuffer){i.indexBuffer=i.buffers[r.buffers.indexOf(r.indexBuffer)],i.indexBuffer.index=!0;var p=0,h=0,$=0,l=0;for(s=0;s<r.buffers.length;s++)if(r.buffers[s]!==r.indexBuffer){l=s;break}for(var s in r.attributes){var d=r.attributes[s];(0|d.buffer)===l&&(h+=d.size*$F[d.type]/4)}for(s=0;s<t.length;s++){var c=t[s].indexBuffer.data;for(u=0;u<c.length;u++)i.indexBuffer.data[u+$]+=p;p+=r.buffers[l].data.length/h,$+=c.length}}return i},e}(),_F=function(e){function t(){var t=e.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return Ba(t,e),t}(Yj),fv=function(e){function t(){var t=e.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new Yb(t.vertices),t.uvBuffer=new Yb(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return Ba(t,e),t.prototype.map=function(e,t){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+t.width/e.width,this.uvs[3]=i,this.uvs[4]=r+t.width/e.width,this.uvs[5]=i+t.height/e.height,this.uvs[6]=r,this.uvs[7]=i+t.height/e.height,r=t.x,i=t.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+t.width,this.vertices[3]=i,this.vertices[4]=r+t.width,this.vertices[5]=i+t.height,this.vertices[6]=r,this.vertices[7]=i+t.height,this.invalidate(),this},t.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},t}(Yj),pfa=0,tg=function(){function e(e,t){this.uniforms=e,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=pfa++,this.static=!!t}return e.prototype.update=function(){this.dirtyId++},e.prototype.add=function(t,r,i){this.uniforms[t]=new e(r,i)},e.from=function(t,r){return new e(t,r)},e}(),aG=function(){function e(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new La,this.destinationFrame=new La,this.filters=[]}return e.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},e}(),bG=function(e){function t(t){var r=e.call(this,t)||this;return r.defaultFilterStack=[{}],r.texturePool=new YF,r.texturePool.setScreenSize(t.view),r.statePool=[],r.quad=new _F,r.quadUv=new fv,r.tempRect=new La,r.activeState={},r.globalUniforms=new tg({outputFrame:r.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),r.forceClear=!1,r.useMaxPadding=!1,r}return Ba(t,e),t.prototype.push=function(e,t){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new aG,o=t[0].resolution,a=t[0].padding,s=t[0].autoFit,u=t[0].legacy,p=1;p<t.length;p++){var h=t[p];o=Math.min(o,h.resolution),a=this.useMaxPadding?Math.max(a,h.padding):a+h.padding,s=s||h.autoFit,u=u||h.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=o,n.legacy=u,n.target=e,n.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),n.sourceFrame.pad(a),s&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(o),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,o),n.filters=t,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;var $=this.tempRect;$.width=n.sourceFrame.width,$.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame,$),r.renderTexture.clear()},t.prototype.pop=function(){var e=this.defaultFilterStack,t=e.pop(),r=t.filters;this.activeState=t;var i=this.globalUniforms.uniforms;i.outputFrame=t.sourceFrame,i.resolution=t.resolution;var n=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(n[0]=t.destinationFrame.width,n[1]=t.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=n[0]*t.resolution,o[1]=n[1]*t.resolution,o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=t.sourceFrame.width*n[2]-.5*o[2],a[3]=t.sourceFrame.height*n[3]-.5*o[3],t.legacy){var s=i.filterArea;s[0]=t.destinationFrame.width,s[1]=t.destinationFrame.height,s[2]=t.sourceFrame.x,s[3]=t.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var u=e[e.length-1];if(t.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,t.renderTexture,u.renderTexture,Hd.BLEND,t),this.returnFilterTexture(t.renderTexture);else{var p=t.renderTexture,h=this.getOptimalFilterTexture(p.width,p.height,t.resolution);h.filterFrame=p.filterFrame;var $=0;for($=0;$<r.length-1;++$){r[$].apply(this,p,h,Hd.CLEAR,t);var l=p;p=h,h=l}r[$].apply(this,p,u.renderTexture,Hd.BLEND,t),this.returnFilterTexture(p),this.returnFilterTexture(h)}t.clear(),this.statePool.push(t)},t.prototype.bindAndClear=function(e,t){if(void 0===t&&(t=Hd.CLEAR),e&&e.filterFrame){var r=this.tempRect;r.width=e.filterFrame.width,r.height=e.filterFrame.height,this.renderer.renderTexture.bind(e,e.filterFrame,r)}else this.renderer.renderTexture.bind(e);"boolean"==typeof t&&(t=t?Hd.CLEAR:Hd.BLEND,ea("5.2.1","Use CLEAR_MODES when using clear applyFilter option")),(t===Hd.CLEAR||t===Hd.BLIT&&this.forceClear)&&this.renderer.renderTexture.clear()},t.prototype.applyFilter=function(e,t,r,i){var n=this.renderer;this.bindAndClear(r,i),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,n.state.set(e.state),n.shader.bind(e),e.legacy?(this.quadUv.map(t._frame,t.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(od.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(od.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(e,t){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,o=t._texture.orig,a=e.set(n.width,0,0,n.height,i.x,i.y),s=t.worldTransform.copyTo(Lb.TEMP_MATRIX);return s.invert(),a.prepend(s),a.scale(1/o.width,1/o.height),a.translate(t.anchor.x,t.anchor.y),a},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(e,t,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(e,t,r)},t.prototype.getFilterTexture=function(e,t){if("number"==typeof e){var r=e;e=t,t=r}e=e||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution);return i.filterFrame=e.filterFrame,i},t.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t}(Fc),Fm=function(){function e(e){this.renderer=e}return e.prototype.flush=function(){},e.prototype.destroy=function(){this.renderer=null},e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.render=function(e){},e}(),cG=function(e){function t(t){var r=e.call(this,t)||this;return r.emptyRenderer=new Fm(t),r.currentRenderer=r.emptyRenderer,r}return Ba(t,e),t.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(e,t){for(var r=this.renderer.texture.boundTextures,i=t-1;i>=0;--i)e[i]=r[i]||null,e[i]&&(e[i]._batchLocation=i)},t.prototype.boundArray=function(e,t,r,i){for(var n=e.elements,o=e.ids,a=e.count,s=0,u=0;u<a;u++){var p=n[u],h=p._batchLocation;if(h>=0&&h<i&&t[h]===p)o[u]=h;else for(;s<i;){var $=t[s];if(!$||$._batchEnabled!==r||$._batchLocation!==s){o[u]=s,p._batchLocation=s,t[s]=p;break}s++}}},t}(Fc),dG=0,eG=function(e){function t(t){var r=e.call(this,t)||this;return r.webGLVersion=1,r.extensions={},r.supports={uint32Indices:!1},r.handleContextLost=r.handleContextLost.bind(r),r.handleContextRestored=r.handleContextRestored.bind(r),t.view.addEventListener("webglcontextlost",r.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",r.handleContextRestored,!1),r}return Ba(t,e),Object.defineProperty(t.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=dG++,e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=dG++,this.renderer.runners.contextChange.emit(e)},t.prototype.initFromOptions=function(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)},t.prototype.createContext=function(e,t){var r;if(ra.PREFER_ENV>=ze.WEBGL2&&(r=e.getContext("webgl2",t)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl},t.prototype.getExtensions=function(){var e=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),loseContext:e.getExtension("WEBGL_lose_context"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:e.getExtension("EXT_color_buffer_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(e){e.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},t.prototype.destroy=function(){var e=this.renderer.view;e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(e){e.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var t="WebGL2RenderingContext"in window&&e instanceof window.WebGL2RenderingContext||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=t,t||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},t}(Fc),fG=function(){return function(e){this.framebuffer=e,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=Ah.NONE,this.msaaBuffer=null,this.blitFramebuffer=null}}(),qfa=new La,gG=function(e){function t(t){var r=e.call(this,t)||this;return r.managedFramebuffers=[],r.unknownFramebuffer=new hq(10,10),r.msaaSamples=null,r}return Ba(t,e),t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new La,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var t=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;ra.PREFER_ENV===ze.WEBGL_LEGACY&&(t=null,r=null),t?e.drawBuffers=function(e){return t.drawBuffersWEBGL(e)}:(this.hasMRT=!1,e.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},t.prototype.bind=function(e,t){var r=this.gl;if(e){var i=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==e.dirtyId&&(i.dirtyId=e.dirtyId,i.dirtyFormat!==e.dirtyFormat?(i.dirtyFormat=e.dirtyFormat,this.updateFramebuffer(e)):i.dirtySize!==e.dirtySize&&(i.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var n=0;n<e.colorTextures.length;n++){var o=e.colorTextures[n];this.renderer.texture.unbind(o.parentTextureArray||o)}e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,e.width,e.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(e,t,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===e&&n.y===t||(n.x=e,n.y=t,n.width=r,n.height=i,this.gl.viewport(e,t,r,i))},Object.defineProperty(t.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),t.prototype.clear=function(e,t,r,i,n){void 0===n&&(n=ym.COLOR|ym.DEPTH);var o=this.gl;o.clearColor(e,t,r,i),o.clear(n)},t.prototype.initFramebuffer=function(e){var t=this.gl,r=new fG(t.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r},t.prototype.resizeFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID];r.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));for(var i=e.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);e.depthTexture&&this.renderer.texture.bind(e.depthTexture,0)},t.prototype.updateFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID],i=e.colorTextures.length;t.drawBuffers||(i=Math.min(i,1)),r.multisample>1&&(r.msaaBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,t.RGBA8,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,r.msaaBuffer));for(var n=[],o=0;o<i;o++)if(!(0===o&&r.multisample>1)){var a=e.colorTextures[o],s=a.parentTextureArray||a;this.renderer.texture.bind(s,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+o,a.target,s._glTextures[this.CONTEXT_UID].texture,0),n.push(t.COLOR_ATTACHMENT0+o)}if((n.length>1&&t.drawBuffers(n),e.depthTexture)&&this.writeDepthTexture){var u=e.depthTexture;this.renderer.texture.bind(u,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,u._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!e.stencil&&!e.depth||(r.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height),e.depthTexture||t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r.stencil))},t.prototype.detectSamples=function(e){var t=this.msaaSamples,r=Ah.NONE;if(e<=1||null===t)return r;for(var i=0;i<t.length;i++)if(t[i]<=e){r=t[i];break}return 1===r&&(r=Ah.NONE),r},t.prototype.blit=function(e,t,r){var i=this.current,n=this.renderer,o=this.gl,a=this.CONTEXT_UID;if(2===n.context.webGLVersion&&i){var s=i.glFramebuffers[a];if(s){if(!e){if(s.multisample<=1)return;s.blitFramebuffer||(s.blitFramebuffer=new hq(i.width,i.height),s.blitFramebuffer.addColorTexture(0,i.colorTextures[0])),(e=s.blitFramebuffer).width=i.width,e.height=i.height}t||((t=qfa).width=i.width,t.height=i.height),r||(r=t);var u=t.width===r.width&&t.height===r.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,s.framebuffer),o.blitFramebuffer(t.x,t.y,t.width,t.height,r.x,r.y,r.width,r.height,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR)}}},t.prototype.disposeFramebuffer=function(e,t){var r=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete e.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(e);n>=0&&this.managedFramebuffers.splice(n,1),e.disposeRunner.remove(this),t||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},t.prototype.disposeAll=function(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<t.length;r++)this.disposeFramebuffer(t[r],e)},t.prototype.forceStencil=function(){var e=this.current;if(e){var t=e.glFramebuffers[this.CONTEXT_UID];if(t&&!t.stencil){e.enableStencil();var r=e.width,i=e.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),t.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new La},t}(Fc),rfa=function(){return function(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}(),gv={5126:4,5123:2,5121:1},hG=function(e){function t(t){var r=e.call(this,t)||this;return r._activeGeometry=null,r._activeVao=null,r.hasVao=!0,r.hasInstance=!0,r.canUseUInt32ElementIndex=!1,r.managedGeometries={},r.managedBuffers={},r}return Ba(t,e),t.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!e.createVertexArray){var r=this.renderer.context.extensions.vertexArrayObject;ra.PREFER_ENV===ze.WEBGL_LEGACY&&(r=null),r?(e.createVertexArray=function(){return r.createVertexArrayOES()},e.bindVertexArray=function(e){return r.bindVertexArrayOES(e)},e.deleteVertexArray=function(e){return r.deleteVertexArrayOES(e)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(!e.vertexAttribDivisor){var i=e.getExtension("ANGLE_instanced_arrays");i?(e.vertexAttribDivisor=function(e,t){return i.vertexAttribDivisorANGLE(e,t)},e.drawElementsInstanced=function(e,t,r,n,o){return i.drawElementsInstancedANGLE(e,t,r,n,o)},e.drawArraysInstanced=function(e,t,r,n){return i.drawArraysInstancedANGLE(e,t,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex},t.prototype.bind=function(e,t){t=t||this.renderer.shader.shader;var r=this.gl,i=e.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[t.program.id]||this.initGeometryVao(e,t.program);this._activeGeometry=e,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(e,t.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var e=this._activeGeometry,t=this.gl,r=0;r<e.buffers.length;r++){var i=e.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var o=i.index?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;if(t.bindBuffer(o,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)t.bufferSubData(o,0,i.data);else{var a=i.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,t.bufferData(o,i.data,a)}}}},t.prototype.checkCompatibility=function(e,t){var r=e.attributes,i=t.attributeData;for(var n in i)if(!r[n])throw new Error("shader and geometry incompatible, geometry missing the \""+n+"\" attribute")},t.prototype.getSignature=function(e,t){var r=e.attributes,i=t.attributeData,n=["g",e.id];for(var o in r)i[o]&&n.push(o);return n.join("-")},t.prototype.initGeometryVao=function(e,t){this.checkCompatibility(e,t);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(e,t),o=e.glVertexArrayObjects[this.CONTEXT_UID],a=o[n];if(a)return o[t.id]=a,a;var s=e.buffers,u=e.attributes,p={},h={};for(var $ in s)p[$]=0,h[$]=0;for(var $ in u)!u[$].size&&t.attributeData[$]?u[$].size=t.attributeData[$].size:u[$].size||console.warn("PIXI Geometry attribute '"+$+"' size cannot be determined (likely the bound shader does not have the attribute)"),p[u[$].buffer]+=u[$].size*gv[u[$].type];for(var $ in u){var l=u[$],d=l.size;void 0===l.stride&&(p[l.buffer]===d*gv[l.type]?l.stride=0:l.stride=p[l.buffer]),void 0===l.start&&(l.start=h[l.buffer],h[l.buffer]+=d*gv[l.type])}a=r.createVertexArray(),r.bindVertexArray(a);for(var c=0;c<s.length;c++){var f=s[c];f._glBuffers[i]||(f._glBuffers[i]=new rfa(r.createBuffer()),this.managedBuffers[f.id]=f,f.disposeRunner.add(this)),f._glBuffers[i].refCount++}return this.activateVao(e,t),this._activeVao=a,o[t.id]=a,o[n]=a,a},t.prototype.disposeBuffer=function(e,t){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var r=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),r&&(t||i.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(e,t){if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var r=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=e.buffers;if(e.disposeRunner.remove(this),r){for(var o=0;o<n.length;o++){var a=n[o]._glBuffers[this.CONTEXT_UID];a.refCount--,0!==a.refCount||t||this.disposeBuffer(n[o],t)}if(!t)for(var s in r)if("g"===s[0]){var u=r[s];this._activeVao===u&&this.unbind(),i.deleteVertexArray(u)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedGeometries),r=0;r<t.length;r++)this.disposeGeometry(this.managedGeometries[t[r]],e);t=Object.keys(this.managedBuffers);for(r=0;r<t.length;r++)this.disposeBuffer(this.managedBuffers[t[r]],e)},t.prototype.activateVao=function(e,t){var r=this.gl,i=this.CONTEXT_UID,n=e.buffers,o=e.attributes;e.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer._glBuffers[i].buffer);var a=null;for(var s in o){var u=o[s],p=n[u.buffer]._glBuffers[i];if(t.attributeData[s]){a!==p&&(r.bindBuffer(r.ARRAY_BUFFER,p.buffer),a=p);var h=t.attributeData[s].location;if(r.enableVertexAttribArray(h),r.vertexAttribPointer(h,u.size,u.type||r.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(h,1)}}}},t.prototype.draw=function(e,t,r,i){var n=this.gl,o=this._activeGeometry;if(o.indexBuffer){var a=o.indexBuffer.data.BYTES_PER_ELEMENT,s=2===a?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===a||4===a&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(e,t||o.indexBuffer.data.length,s,(r||0)*a,i||1):n.drawElements(e,t||o.indexBuffer.data.length,s,(r||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(e,r,t||o.getSize(),i||1):n.drawArrays(e,r,t||o.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t}(Fc),iG=function(){function e(e){void 0===e&&(e=null),this.type=Dc.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return e.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Dc.NONE,this.autoDetect=!0),this._target=null},e.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},e}();function jG(e,t,r){var i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}function kG(e,t,r,i){var n=jG(e,e.VERTEX_SHADER,t),o=jG(e,e.FRAGMENT_SHADER,r),a=e.createProgram();if(e.attachShader(a,n),e.attachShader(a,o),i)for(var s in i)e.bindAttribLocation(a,i[s],s);return e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)||(e.getShaderParameter(n,e.COMPILE_STATUS)||(console.warn(t),console.error(e.getShaderInfoLog(n))),e.getShaderParameter(o,e.COMPILE_STATUS)||(console.warn(r),console.error(e.getShaderInfoLog(o))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",e.getProgramParameter(a,e.VALIDATE_STATUS)),console.error("gl.getError()",e.getError()),""!==e.getProgramInfoLog(a)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(a)),e.deleteProgram(a),a=null),e.deleteShader(n),e.deleteShader(o),a}function hv(e){for(var t=new Array(e),r=0;r<t.length;r++)t[r]=!1;return t}function lG(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"bool":return!1;case"bvec2":return hv(2*t);case"bvec3":return hv(3*t);case"bvec4":return hv(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);}return null}var mG,nG={},jq=nG;function oG(){if(jq===nG||jq&&jq.isContextLost()){var e=document.createElement("canvas"),t=void 0;ra.PREFER_ENV>=ze.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),jq=t}return jq}function sfa(){if(!mG){mG=Id.MEDIUM;var e=oG();if(e&&e.getShaderPrecisionFormat){var t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);mG=t.precision?Id.HIGH:Id.MEDIUM}}return mG}function pG(e,t,r){if("precision"!==e.substring(0,9)){var i=t;return t===Id.HIGH&&r!==Id.HIGH&&(i=Id.MEDIUM),"precision "+i+" float;\n"+e}return r!==Id.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}var tfa={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function ufa(e){return tfa[e]}var iv=null,qG={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function rG(e,t){if(!iv){var r=Object.keys(qG);iv={};for(var i=0;i<r.length;++i){var n=r[i];iv[e[n]]=qG[n]}}return iv[t]}var kq=[{test:function(e){return"float"===e.type&&1===e.size},code:function(e){return"\n            if(uv[\""+e+"\"] !== ud[\""+e+"\"].value)\n            {\n                ud[\""+e+"\"].value = uv[\""+e+"\"]\n                gl.uniform1f(ud[\""+e+"\"].location, uv[\""+e+"\"])\n            }\n            "}},{test:function(e){return("sampler2D"===e.type||"samplerCube"===e.type||"sampler2DArray"===e.type)&&1===e.size&&!e.isArray},code:function(e){return"t = syncData.textureCount++;\n\n            renderer.texture.bind(uv[\""+e+"\"], t);\n\n            if(ud[\""+e+"\"].value !== t)\n            {\n                ud[\""+e+"\"].value = t;\n                gl.uniform1i(ud[\""+e+"\"].location, t);\n; // eslint-disable-line max-len\n            }"}},{test:function(e,t){return"mat3"===e.type&&1===e.size&&void 0!==t.a},code:function(e){return"\n            gl.uniformMatrix3fv(ud[\""+e+"\"].location, false, uv[\""+e+"\"].toArray(true));\n            "}},{test:function(e,t){return"vec2"===e.type&&1===e.size&&void 0!==t.x},code:function(e){return"\n                cv = ud[\""+e+"\"].value;\n                v = uv[\""+e+"\"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud[\""+e+"\"].location, v.x, v.y);\n                }"}},{test:function(e){return"vec2"===e.type&&1===e.size},code:function(e){return"\n                cv = ud[\""+e+"\"].value;\n                v = uv[\""+e+"\"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud[\""+e+"\"].location, v[0], v[1]);\n                }\n            "}},{test:function(e,t){return"vec4"===e.type&&1===e.size&&void 0!==t.width},code:function(e){return"\n                cv = ud[\""+e+"\"].value;\n                v = uv[\""+e+"\"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud[\""+e+"\"].location, v.x, v.y, v.width, v.height)\n                }"}},{test:function(e){return"vec4"===e.type&&1===e.size},code:function(e){return"\n                cv = ud[\""+e+"\"].value;\n                v = uv[\""+e+"\"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud[\""+e+"\"].location, v[0], v[1], v[2], v[3])\n                }"}}],vfa={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},wfa={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function xfa(e,t){var r=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var i in e.uniforms){var n=t[i];if(n){for(var o=e.uniforms[i],a=!1,s=0;s<kq.length;s++)if(kq[s].test(n,o)){r.push(kq[s].code(i,o)),a=!0;break}if(!a){var u=(1===n.size?vfa:wfa)[n.type].replace("location","ud[\""+i+"\"].location");r.push("\n            cv = ud[\""+i+"\"].value;\n            v = uv[\""+i+"\"];\n            "+u+";")}}else e.uniforms[i].group&&r.push("\n                    renderer.shader.syncUniformGroup(uv[\""+i+"\"], syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r.join("\n"))}var jv,yfa=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function zfa(e){for(var t="",r=0;r<e;++r)r>0&&(t+="\nelse "),r<e-1&&(t+="if(test == "+r+".0){}");return t}function sG(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=t.createShader(t.FRAGMENT_SHADER);;){var i=yfa.replace(/%forloop%/gi,zfa(e));if(t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0}return e}function Afa(){if("boolean"==typeof jv)return jv;try{var e=new Function("param1","param2","param3","return param1[param2] === param3;");jv=!0===e({a:"b"},"a","b")}catch(t){jv=!1}return jv}var Bfa="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}",Cfa="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n",Dfa=0,lq={},Gm=function(){function e(t,r,i){void 0===i&&(i="pixi-shader"),this.id=Dfa++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=r||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),lq[i]?(lq[i]++,i+="-"+lq[i]):lq[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=pG(this.vertexSrc,ra.PRECISION_VERTEX,Id.HIGH),this.fragmentSrc=pG(this.fragmentSrc,ra.PRECISION_FRAGMENT,sfa())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return e.prototype.extractData=function(e,t){var r=oG();if(r){var i=kG(r,e,t);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},e.prototype.getAttributeData=function(e,t){for(var r={},i=[],n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;o<n;o++){var a=t.getActiveAttrib(e,o),s=rG(t,a.type),u={type:s,name:a.name,size:ufa(s),location:0};r[a.name]=u,i.push(u)}i.sort(function(e,t){return e.name>t.name?1:-1});for(o=0;o<i.length;o++)i[o].location=o;return r},e.prototype.getUniformData=function(e,t){for(var r={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),n=0;n<i;n++){var o=t.getActiveUniform(e,n),a=o.name.replace(/\[.*?\]$/,""),s=o.name.match(/\[.*?\]$/),u=rG(t,o.type);r[a]={type:u,size:o.size,isArray:s,value:lG(u,o.size)}}return r},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return Cfa},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return Bfa},enumerable:!1,configurable:!0}),e.from=function(t,r,i){var n=t+r,o=Ru[n];return o||(Ru[n]=o=new e(t,r,i)),o},e}(),ug=function(){function e(e,t){for(var r in this.program=e,this.uniformGroup=t?t instanceof tg?t:new tg(t):new tg({}),e.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))}return e.prototype.checkUniformExists=function(e,t){if(t.uniforms[e])return!0;for(var r in t.uniforms){var i=t.uniforms[r];if(i.group&&this.checkUniformExists(e,i))return!0}return!1},e.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(e.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),e.from=function(t,r,i){return new e(Gm.from(t,r),i)},e}(),kv=0,lv=1,mv=2,nv=3,ov=4,vg=function(){function e(){this.data=0,this.blendMode=sa.NORMAL,this.polygonOffset=0,this.blend=!0}return Object.defineProperty(e.prototype,"blend",{get:function(){return!!(this.data&1<<kv)},set:function(e){!!(this.data&1<<kv)!==e&&(this.data^=1<<kv)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsets",{get:function(){return!!(this.data&1<<lv)},set:function(e){!!(this.data&1<<lv)!==e&&(this.data^=1<<lv)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culling",{get:function(){return!!(this.data&1<<mv)},set:function(e){!!(this.data&1<<mv)!==e&&(this.data^=1<<mv)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return!!(this.data&1<<nv)},set:function(e){!!(this.data&1<<nv)!==e&&(this.data^=1<<nv)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<ov)},set:function(e){!!(this.data&1<<ov)!==e&&(this.data^=1<<ov)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==sa.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e},enumerable:!1,configurable:!0}),e.for2d=function(){var t=new e;return t.depthTest=!1,t.blend=!0,t},e}(),Efa="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",Ffa="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n",qf=function(e){function t(r,i,n){var o=this,a=Gm.from(r||t.defaultVertexSrc,i||t.defaultFragmentSrc);return(o=e.call(this,a,n)||this).padding=0,o.resolution=ra.FILTER_RESOLUTION,o.enabled=!0,o.autoFit=!0,o.legacy=!!o.program.attributeData.aTextureCoord,o.state=new vg,o}return Ba(t,e),t.prototype.apply=function(e,t,r,i,n){e.applyFilter(this,t,r,i)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultVertexSrc",{get:function(){return Efa},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return Ffa},enumerable:!1,configurable:!0}),t}(ug),Gfa="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",Hfa="varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",tG=new Lb,mq=function(){function e(e,t){this._texture=e,this.mapCoord=new Lb,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===t?.5:t,this.isSimple=!1}return Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1},enumerable:!1,configurable:!0}),e.prototype.multiplyUvs=function(e,t){void 0===t&&(t=e);for(var r=this.mapCoord,i=0;i<e.length;i+=2){var n=e[i],o=e[i+1];t[i]=n*r.a+o*r.c+r.tx,t[i+1]=n*r.b+o*r.d+r.ty}return t},e.prototype.update=function(e){var t=this._texture;if(!t||!t.valid)return!1;if(!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=t.orig,n=t.trim;n&&(tG.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(tG));var o=t.baseTexture,a=this.uClampFrame,s=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(t._frame.x+s+u)/o.width,a[1]=(t._frame.y+s+u)/o.height,a[2]=(t._frame.x+t._frame.width-s+u)/o.width,a[3]=(t._frame.y+t._frame.height-s+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&0===t.rotate,!0},e}(),uG=function(e){function t(t){var r=this,i=new Lb;return r=e.call(this,Gfa,Hfa)||this,t.renderable=!1,r.maskSprite=t,r.maskMatrix=i,r}return Ba(t,e),t.prototype.apply=function(e,t,r,i){var n=this.maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new mq(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,t,r,i))},t}(qf),vG=function(e){function t(t){var r=e.call(this,t)||this;return r.enableScissor=!1,r.alphaMaskPool=[],r.maskDataPool=[],r.maskStack=[],r.alphaMaskIndex=0,r}return Ba(t,e),t.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},t.prototype.push=function(e,t){var r=t;if(!r.isMaskData){var i=this.maskDataPool.pop()||new iG;i.pooled=!0,i.maskObject=t,r=i}switch(r.autoDetect&&this.detect(r),r.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),r._target=e,r.type){case Dc.SCISSOR:this.maskStack.push(r),this.renderer.scissor.push(r);break;case Dc.STENCIL:this.maskStack.push(r),this.renderer.stencil.push(r);break;case Dc.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r),this.maskStack.push(r);}},t.prototype.pop=function(e){var t=this.maskStack.pop();if(t&&t._target===e){switch(t.type){case Dc.SCISSOR:this.renderer.scissor.pop();break;case Dc.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case Dc.SPRITE:this.popSpriteMask();}t.reset(),t.pooled&&this.maskDataPool.push(t)}},t.prototype.detect=function(e){var t=e.maskObject;if(t.isSprite)e.type=Dc.SPRITE;else if(e.type=Dc.STENCIL,this.enableScissor&&t.isFastRect&&t.isFastRect()){var r=t.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(e.type=Dc.SCISSOR)}},t.prototype.pushSpriteMask=function(e){var t=e.maskObject,r=e._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new uG(t)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=t;var n=r.filterArea;r.filterArea=t.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(Fc),wG=function(e){function t(t){var r=e.call(this,t)||this;return r.maskStack=[],r.glConst=0,r}return Ba(t,e),t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(e){var t=this.renderer.gl,r=this.getStackLength();this.maskStack=e;var i=this.getStackLength();i!==r&&(0===i?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.maskStack=null},t}(Fc),xG=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.SCISSOR_TEST,r}return Ba(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},t.prototype.push=function(e){var t=e.maskObject;t.renderable=!0;var r=e._scissorRect,i=t.getBounds(!0),n=this.renderer.gl;t.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=i,this._useCurrent()},t.prototype.pop=function(){var e=this.renderer.gl;this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},t.prototype._useCurrent=function(){var e=this.maskStack[this.maskStack.length-1]._scissorRect,t=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,o=r.destinationFrame,a=t?t.resolution:this.renderer.resolution,s=(e.x-n.x)*a+o.x,u=(e.y-n.y)*a+o.y,p=e.width*a,h=e.height*a;i&&(s+=i.tx*a,u+=i.ty*a),t||(u=this.renderer.height-h-u),this.renderer.gl.scissor(s,u,p,h)},t}(wG),yG=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.STENCIL_TEST,r}return Ba(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},t.prototype.push=function(e){var t=e.maskObject,r=this.renderer.gl,i=e._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),e._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent()},t.prototype.pop=function(e){var t=this.renderer.gl;0===this.getStackLength()?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.getStackLength(),this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(wG),zG=function(e){function t(t){var r=e.call(this,t)||this;return r.destinationFrame=null,r.sourceFrame=null,r.defaultFrame=null,r.projectionMatrix=new Lb,r.transform=null,r}return Ba(t,e),t.prototype.update=function(e,t,r,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(e,t,r,i){var n=this.projectionMatrix,o=i?-1:1;n.identity(),n.a=1/t.width*2,n.d=o*(1/t.height*2),n.tx=-1-t.x*n.a,n.ty=-o-t.y*n.d},t.prototype.setTransform=function(e){},t}(Fc),Lh=new La,Hm=new La,Im=new La,AG=function(e){function t(t){var r=e.call(this,t)||this;return r.clearColor=t._backgroundColorRgba,r.defaultMaskStack=[],r.current=null,r.sourceFrame=new La,r.destinationFrame=new La,r}return Ba(t,e),t.prototype.bind=function(e,t,r){void 0===e&&(e=null);var i,n,o,a=this.renderer;this.current=e,e?(o=(i=e.baseTexture).resolution,t||(Lh.width=e.frame.width,Lh.height=e.frame.height,t=Lh),r||(Hm.x=e.frame.x,Hm.y=e.frame.y,Hm.width=t.width,Hm.height=t.height,r=Hm),n=i.framebuffer):(o=a.resolution,t||(Lh.width=a.screen.width,Lh.height=a.screen.height,t=Lh),r||((r=Lh).width=t.width,r.height=t.height)),Im.x=r.x*o,Im.y=r.y*o,Im.width=r.width*o,Im.height=r.height*o,this.renderer.framebuffer.bind(n,Im),this.renderer.projection.update(r,t,o,!n),e?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(r)},t.prototype.clear=function(e,t){e=this.current?e||this.current.baseTexture.clearColor:e||this.clearColor,this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],t)},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(Fc),Ifa=function(){return function(){}}(),BG=function(){function e(e,t){this.program=e,this.uniformData=t,this.uniformGroups={}}return e.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},e}(),Jfa=0,CG={textureCount:0},DG=function(e){function t(t){var r=e.call(this,t)||this;return r.destroyed=!1,r.systemCheck(),r.gl=null,r.shader=null,r.program=null,r.cache={},r.id=Jfa++,r}return Ba(t,e),t.prototype.systemCheck=function(){if(!Afa())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(e){this.gl=e,this.reset()},t.prototype.bind=function(e,t){e.uniforms.globals=this.renderer.globalUniforms;var r=e.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),t||(CG.textureCount=0,this.syncUniformGroup(e.uniformGroup,CG)),i},t.prototype.setUniforms=function(e){var t=this.shader.program,r=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(r.uniformData,e,this.renderer)},t.prototype.syncUniformGroup=function(e,t){var r=this.getglProgram();e.static&&e.dirtyId===r.uniformGroups[e.id]||(r.uniformGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,t))},t.prototype.syncUniforms=function(e,t,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,r)},t.prototype.createSyncGroups=function(e){var t=this.getSignature(e,this.shader.program.uniformData);return this.cache[t]||(this.cache[t]=xfa(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(e,t){var r=e.uniforms,i=[];for(var n in r)i.push(n),t[n]&&i.push(t[n].type);return i.join("-")},t.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(e){var t=this.gl,r=e.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var o=kG(t,r.vertexSrc,r.fragmentSrc,i),a={};for(var n in r.uniformData){var s=r.uniformData[n];a[n]={location:t.getUniformLocation(o,n),value:lG(s.type,s.size)}}var u=new BG(o,a);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(Fc);function Kfa(e,t){return void 0===t&&(t=[]),t[sa.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.ADD]=[e.ONE,e.ONE],t[sa.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.NONE]=[0,0],t[sa.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[sa.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[sa.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[sa.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[sa.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[sa.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[sa.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[sa.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[sa.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[sa.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[sa.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}var EG=function(e){function t(t){var r=e.call(this,t)||this;return r.gl=null,r.stateId=0,r.polygonOffset=0,r.blendMode=sa.NONE,r._blendEq=!1,r.map=[],r.checks=[],r.defaultState=new vg,r.defaultState.blend=!0,r}return Ba(t,e),t.prototype.contextChange=function(e){this.gl=e,this.blendModes=Kfa(e),this.set(this.defaultState),this.reset()},t.prototype.set=function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,r=0;t;)1&t&&this.map[r].call(this,!!(e.data&1<<r)),t>>=1,r++;this.stateId=e.data}for(r=0;r<this.checks.length;r++)this.checks[r](this,e)},t.prototype.forceState=function(e){e=e||this.defaultState;for(var t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setCullFace=function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},t.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var t=this.blendModes[e],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},t.prototype.setPolygonOffset=function(e,t){this.gl.polygonOffset(e,t)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(e,t){var r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):t||-1===r||this.checks.splice(r,1)},t.checkBlendMode=function(e,t){e.setBlendMode(t.blendMode)},t.checkPolygonOffset=function(e,t){e.setPolygonOffset(1,t.polygonOffset)},t}(Fc),FG=function(e){function t(t){var r=e.call(this,t)||this;return r.count=0,r.checkCount=0,r.maxIdle=ra.GC_MAX_IDLE,r.checkCountMax=ra.GC_MAX_CHECK_COUNT,r.mode=ra.GC_MODE,r}return Ba(t,e),t.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Zp.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var e=this.renderer.texture,t=e.managedTextures,r=!1,i=0;i<t.length;i++){var n=t[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[i]=null,r=!0)}if(r){var o=0;for(i=0;i<t.length;i++)null!==t[i]&&(t[o++]=t[i]);t.length=o}},t.prototype.unload=function(e){var t,r=this.renderer.texture;(null===(t=e._texture)||void 0===t?void 0:t.framebuffer)&&r.destroyTexture(e._texture);for(var i=e.children.length-1;i>=0;i--)this.unload(e.children[i])},t}(Fc),nq=function(){return function(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}}(),GG=function(e){function t(t){var r=e.call(this,t)||this;return r.boundTextures=[],r.currentLocation=-1,r.managedTextures=[],r._unknownBoundTextures=!1,r.unknownTexture=new gb,r}return Ba(t,e),t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var r=0;r<t;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new nq(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new nq(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(r=0;r<6;r++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(r=0;r<this.boundTextures.length;r++)this.bind(null,r)},t.prototype.bind=function(e,t){void 0===t&&(t=0);var r=this.gl;if(e){if((e=e.castToBaseTexture()).parentTextureArray)return;if(e.valid){e.touched=this.renderer.textureGC.count;var i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),this.updateTexture(e)),this.boundTextures[t]=e}}else this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[t]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture},t.prototype.unbind=function(e){var t=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<r.length;i++)r[i]===e&&(this.currentLocation!==i&&(t.activeTexture(t.TEXTURE0+i),this.currentLocation=i),t.bindTexture(t.TEXTURE_2D,this.emptyTextures[e.target].texture),r[i]=null)},t.prototype.initTexture=function(e){var t=new nq(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t},t.prototype.initTextureType=function(e,t){if(t.internalFormat=e.format,t.type=e.type,2===this.webGLVersion){var r=this.renderer.gl;e.type===r.FLOAT&&e.format===r.RGBA&&(t.internalFormat=r.RGBA32F),e.type===Kb.HALF_FLOAT&&(t.type=r.HALF_FLOAT),t.type===r.HALF_FLOAT&&e.format===r.RGBA&&(t.internalFormat=r.RGBA16F)}},t.prototype.updateTexture=function(e){var t=e._glTextures[this.CONTEXT_UID];if(t){var r=this.renderer;if(this.initTextureType(e,t),e.resource&&e.resource.upload(r,e,t));else{var i=e.realWidth,n=e.realHeight,o=r.gl;(t.width!==i||t.height!==n||t.dirtyId<0)&&(t.width=i,t.height=n,o.texImage2D(e.target,0,t.internalFormat,i,n,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}},t.prototype.destroyTexture=function(e,t){var r=this.gl;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var i=this.managedTextures.indexOf(e);-1!==i&&Ch(this.managedTextures,i,1)}},t.prototype.updateTextureStyle=function(e){var t=e._glTextures[this.CONTEXT_UID];t&&(e.mipmap!==Sj.POW2&&2===this.webGLVersion||e.isPowerOfTwo?t.mipmap=e.mipmap>=1:t.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?t.wrapMode=e.wrapMode:t.wrapMode=nf.CLAMP,e.resource&&e.resource.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)},t.prototype.setStyle=function(e,t){var r=this.gl;if(t.mipmap&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,t.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===Ae.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===Ae.LINEAR){var n=Math.min(e.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===Ae.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===Ae.LINEAR?r.LINEAR:r.NEAREST)},t}(Fc),Lfa={FilterSystem:bG,BatchSystem:cG,ContextSystem:eG,FramebufferSystem:gG,GeometrySystem:hG,MaskSystem:vG,ScissorSystem:xG,StencilSystem:yG,ProjectionSystem:zG,RenderTextureSystem:AG,ShaderSystem:DG,StateSystem:EG,TextureGCSystem:FG,TextureSystem:GG},pv=new Lb,HG=function(e){function t(t,r){void 0===t&&(t=Qj.UNKNOWN);var i=e.call(this)||this;return(r=Object.assign({},ra.RENDER_OPTIONS,r)).roundPixels&&(ra.ROUND_PIXELS=r.roundPixels,ea("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),i.options=r,i.type=t,i.screen=new La(0,0,r.width,r.height),i.view=r.view||document.createElement("canvas"),i.resolution=r.resolution||ra.RESOLUTION,i.transparent=r.transparent,i.autoDensity=r.autoDensity||r.autoResize||!1,i.preserveDrawingBuffer=r.preserveDrawingBuffer,i.clearBeforeRender=r.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,0],i._backgroundColorString="#000000",i.backgroundColor=r.backgroundColor||i._backgroundColor,i._lastObjectRendered=null,i.plugins={},i}return Ba(t,e),t.prototype.initPlugins=function(e){for(var t in e)this.plugins[t]=new e[t](this)},Object.defineProperty(t.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t){this.screen.width=e,this.screen.height=t,this.view.width=e*this.resolution,this.view.height=t*this.resolution,this.autoDensity&&(this.view.style.width=e+"px",this.view.style.height=t+"px"),this.emit("resize",e,t)},t.prototype.generateTexture=function(e,t,r,i){0===(i=i||e.getLocalBounds(null,!0)).width&&(i.width=1),0===i.height&&(i.height=1);var n=Kh.create({width:0|i.width,height:0|i.height,scaleMode:t,resolution:r});return pv.tx=-i.x,pv.ty=-i.y,this.render(e,n,!1,pv,!!e.parent),n},t.prototype.destroy=function(e){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);this.plugins=null,this.type=Qj.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=Lu(e),Bh(e,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),t}(Tj.d),rf=function(e){function t(r){var i=e.call(this,Qj.WEBGL,r)||this;return r=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new bc("destroy"),contextChange:new bc("contextChange"),reset:new bc("reset"),update:new bc("update"),postrender:new bc("postrender"),prerender:new bc("prerender"),resize:new bc("resize")},i.globalUniforms=new tg({projectionMatrix:new Lb},!0),i.addSystem(vG,"mask").addSystem(eG,"context").addSystem(EG,"state").addSystem(DG,"shader").addSystem(GG,"texture").addSystem(hG,"geometry").addSystem(gG,"framebuffer").addSystem(xG,"scissor").addSystem(yG,"stencil").addSystem(zG,"projection").addSystem(FG,"textureGC").addSystem(bG,"filter").addSystem(AG,"renderTexture").addSystem(cG,"batch"),i.initPlugins(t.__plugins),r.context?i.context.initFromContext(r.context):i.context.initFromOptions({alpha:!!i.transparent,antialias:r.antialias,premultipliedAlpha:i.transparent&&"notMultiplied"!==i.transparent,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,tF(2===i.context.webGLVersion?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return Ba(t,e),t.create=function(e){if(uF())return new t(e);throw new Error("WebGL unsupported in this browser, use \"pixi.js-legacy\" for fallback canvas2d support.")},t.prototype.addSystem=function(e,t){t||(t=e.name);var r=new e(this);if(this[t])throw new Error("Whoops! The name \""+t+"\" is already in use");for(var i in this[t]=r,this.runners)this.runners[i].add(r);return this},t.prototype.render=function(e,t,r,i,n){if(this.renderingToScreen=!t,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=i,!this.context.isLost){if(t||(this._lastObjectRendered=e),!n){var o=e.enableTempParent();e.updateTransform(),e.disableTempParent(o)}this.renderTexture.bind(t),this.batch.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),t&&t.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this.runners.resize.emit(t,r)},t.prototype.reset=function(){return this.runners.reset.emit(),this},t.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},t.prototype.destroy=function(t){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();e.prototype.destroy.call(this,t),this.gl=null},t.registerPlugin=function(e,r){t.__plugins=t.__plugins||{},t.__plugins[e]=r},t}(HG);function IG(e){return rf.create(e)}var JG="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",qv="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",oq=function(){return function(){this.texArray=null,this.blend=0,this.type=od.TRIANGLES,this.start=0,this.size=0,this.data=null}}(),pq=function(){function e(){this.elements=[],this.ids=[],this.count=0}return e.prototype.clear=function(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0},e}(),KG=function(){function e(e){this.rawBinaryData=new ArrayBuffer(e),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(e.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),e.prototype.view=function(e){return this[e+"View"]},e.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},e.sizeOf=function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type");}},e}(),LG=function(e){function t(t){var r=e.call(this,t)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=vg.for2d(),r.size=4*ra.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),t.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return Ba(t,e),t.prototype.contextChange=function(){var e=this.renderer.gl;ra.PREFER_ENV===ze.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),ra.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=sG(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()},t.prototype.initFlushBuffers=function(){for(var e=t._drawCallPool,r=t._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;e.length<i;)e.push(new oq);for(;r.length<n;)r.push(new pq);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},t.prototype.onPrerender=function(){this._flushId=0},t.prototype.render=function(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)},t.prototype.buildTexturesAndDrawCalls=function(){var e=this._bufferedTextures,r=this.MAX_TEXTURES,i=t._textureArrayPool,n=this.renderer.batch,o=this._tempBoundTextures,a=this.renderer.textureGC.count,s=++gb._globalBatch,u=0,p=i[0],h=0;n.copyBoundTextures(o,r);for(var $=0;$<this._bufferSize;++$){var l=e[$];e[$]=null,l._batchEnabled!==s&&(p.count>=r&&(n.boundArray(p,o,s,r),this.buildDrawCalls(p,h,$),h=$,p=i[++u],++s),l._batchEnabled=s,l.touched=a,p.elements[p.count++]=l)}p.count>0&&(n.boundArray(p,o,s,r),this.buildDrawCalls(p,h,this._bufferSize),++u,++s);for($=0;$<o.length;$++)o[$]=null;gb._globalBatch=s},t.prototype.buildDrawCalls=function(e,r,i){var n=this._bufferedElements,o=this._attributeBuffer,a=this._indexBuffer,s=this.vertexSize,u=t._drawCallPool,p=this._dcIndex,h=this._aIndex,$=this._iIndex,l=u[p];l.start=this._iIndex,l.texArray=e;for(var d=r;d<i;++d){var c=n[d],f=c._texture.baseTexture,m=Mu[f.alphaMode?1:0][c.blendMode];n[d]=null,r<d&&l.blend!==m&&(l.size=$-l.start,r=d,(l=u[++p]).texArray=e,l.start=$),this.packInterleavedGeometry(c,o,a,h,$),h+=c.vertexData.length/2*s,$+=c.indices.length,l.blend=m}r<i&&(l.size=$-l.start,++p),this._dcIndex=p,this._aIndex=h,this._iIndex=$},t.prototype.bindAndClearTexArray=function(e){for(var t=this.renderer.texture,r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0},t.prototype.updateGeometry=function(){var e=this._packedGeometries,t=this._attributeBuffer,r=this._indexBuffer;ra.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},t.prototype.drawBatches=function(){for(var e=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,o=t._drawCallPool,a=null,s=0;s<e;s++){var u=o[s],p=u.texArray,h=u.type,$=u.size,l=u.start,d=u.blend;a!==p&&(a=p,this.bindAndClearTexArray(p)),this.state.blendMode=d,n.set(this.state),i.drawElements(h,$,i.UNSIGNED_SHORT,2*l)}},t.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},t.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),ra.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},t.prototype.getAttributeBuffer=function(e){var t=zm(Math.ceil(e/8)),r=Qu(t),i=8*t;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new KG(i*this.vertexSize*4)),n},t.prototype.getIndexBuffer=function(e){var t=zm(Math.ceil(e/12)),r=Qu(t),i=12*t;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},t.prototype.packInterleavedGeometry=function(e,t,r,i,n){for(var o=t.uint32View,a=t.float32View,s=i/this.vertexSize,u=e.uvs,p=e.indices,h=e.vertexData,$=e._texture.baseTexture._batchLocation,l=Math.min(e.worldAlpha,1),d=l<1&&e._texture.baseTexture.alphaMode?_p(e._tintRGB,l):e._tintRGB+(255*l<<24),c=0;c<h.length;c+=2)a[i++]=h[c],a[i++]=h[c+1],a[i++]=u[c],a[i++]=u[c+1],o[i++]=d,a[i++]=$;for(c=0;c<p.length;c++)r[n++]=s+p[c]},t._drawCallPool=[],t._textureArrayPool=[],t}(Fm),MG=function(){function e(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error("Fragment template must contain \"%count%\".");if(t.indexOf("%forloop%")<0)throw new Error("Fragment template must contain \"%forloop%\".")}return e.prototype.generateShader=function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),r=0;r<e;r++)t[r]=r;this.defaultGroupCache[e]=tg.from({uSamplers:t},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+e)).replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Gm(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Lb,default:this.defaultGroupCache[e]};return new ug(this.programCache[e],n)},e.prototype.generateSampleSrc=function(e){var t="";t+="\n",t+="\n";for(var r=0;r<e;r++)r>0&&(t+="\nelse "),r<e-1&&(t+="if(vTextureId < "+r+".5)"),t+="\n{",t+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",t+="\n}";return t+="\n",t+="\n"},e}(),rv=function(e){function t(t){void 0===t&&(t=!1);var r=e.call(this)||this;return r._buffer=new Yb(null,t,!1),r._indexBuffer=new Yb(null,t,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,Kb.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,Kb.FLOAT).addAttribute("aColor",r._buffer,4,!0,Kb.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,Kb.FLOAT).addIndex(r._indexBuffer),r}return Ba(t,e),t}(Yj),NG="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",OG="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",PG=function(){function e(){}return e.create=function(e){var t=Object.assign({vertex:NG,fragment:OG,geometryClass:rv,vertexSize:6},e),r=t.vertex,i=t.fragment,n=t.vertexSize,o=t.geometryClass;return function(e){function t(t){var a=e.call(this,t)||this;return a.shaderGenerator=new MG(r,i),a.geometryClass=o,a.vertexSize=n,a}return Ba(t,e),t}(LG)},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return NG},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentTemplate",{get:function(){return OG},enumerable:!1,configurable:!0}),e}(),QG=PG.create();xa.uniformParsers=kq,xa.systems=Lfa,xa.resources=hfa,xa.defaultVertex=JG,xa.defaultFilterVertex=qv,xa.checkMaxIfStatementsInShader=sG,xa.autoDetectRenderer=IG,xa.ViewableBuffer=KG,xa.UniformGroup=tg,xa.TextureUvs=dv,xa.TextureMatrix=mq,xa.Texture=ya,xa.System=Fc,xa.State=vg,xa.SpriteMaskFilter=uG,xa.Shader=ug,xa.Renderer=rf,xa.RenderTexturePool=YF,xa.RenderTexture=Kh,xa.QuadUv=fv,xa.Quad=_F,xa.Program=Gm,xa.ObjectRenderer=Fm,xa.MaskData=iG,xa.IGLUniformData=Ifa,xa.Geometry=Yj,xa.GLTexture=nq,xa.GLProgram=BG,xa.GLFramebuffer=fG,xa.Framebuffer=hq,xa.FilterState=aG,xa.Filter=qf,xa.Buffer=Yb,xa.BatchTextureArray=pq,xa.BatchShaderGenerator=MG,xa.BatchRenderer=QG,xa.BatchPluginFactory=PG,xa.BatchGeometry=rv,xa.BatchDrawCall=oq,xa.BaseTexture=gb,xa.BaseRenderTexture=Em,xa.Attribute=ev,xa.AbstractRenderer=HG,xa.AbstractBatchRenderer=LG;var Zj=function(){function e(i){var r=this;i=Object.assign({forceCanvas:!1},i),this.renderer=IG(i),this.stage=new qd,e._plugins.forEach(function(e){e.init.call(r,i)})}return e.registerPlugin=function(i){e._plugins.push(i)},e.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(e.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),e.prototype.destroy=function(i,r){var n=this,t=e._plugins.slice(0);t.reverse(),t.forEach(function(e){e.destroy.call(n)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(i),this.renderer=null},e}();Zj._plugins=[];var Mfa=function(){function e(){}return e.init=function(e){var i=this;Object.defineProperty(this,"resizeTo",{set:function(e){window.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(window.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){i._resizeTo&&(i.cancelResize(),i._resizeId=requestAnimationFrame(function(){return i.resize()}))},this.cancelResize=function(){i._resizeId&&(cancelAnimationFrame(i._resizeId),i._resizeId=null)},this.resize=function(){if(i._resizeTo){var e,r;if(i.cancelResize(),i._resizeTo===window)e=window.innerWidth,r=window.innerHeight;else{var n=i._resizeTo;e=n.clientWidth,r=n.clientHeight}i.renderer.resize(e,r)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null},e.destroy=function(){this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},e}();Zj.registerPlugin(Mfa),QF.Application=Zj;var RG={};var SG=new La,TG=4,UG=function(){function r(r){this.renderer=r,r.extract=this}return r.prototype.image=function(r,e,t){var a=new Image;return a.src=this.base64(r,e,t),a},r.prototype.base64=function(r,e,t){return this.canvas(r).toDataURL(e,t)},r.prototype.canvas=function(e){var t,a,n,i=this.renderer,h=!1,o=!1;e&&(e instanceof Kh?n=e:(n=this.renderer.generateTexture(e),o=!0)),n?(t=n.baseTexture.resolution,a=n.frame,h=!1,i.renderTexture.bind(n)):(t=this.renderer.resolution,h=!0,(a=SG).width=this.renderer.width,a.height=this.renderer.height,i.renderTexture.bind(null));var x=Math.floor(a.width*t+1e-4),$=Math.floor(a.height*t+1e-4),s=new Su(x,$,1),d=new Uint8Array(TG*x*$),u=i.gl;u.readPixels(a.x*t,a.y*t,x,$,u.RGBA,u.UNSIGNED_BYTE,d);var c=s.context.getImageData(0,0,x,$);if(r.arrayPostDivide(d,c.data),s.context.putImageData(c,0,0),h){var p=new Su(s.width,s.height,1);p.context.scale(1,-1),p.context.drawImage(s.canvas,0,-$),s.destroy(),s=p}return o&&n.destroy(!0),s.canvas},r.prototype.pixels=function(e){var t,a,n,i=this.renderer,h=!1;e&&(e instanceof Kh?n=e:(n=this.renderer.generateTexture(e),h=!0)),n?(t=n.baseTexture.resolution,a=n.frame,i.renderTexture.bind(n)):(t=i.resolution,(a=SG).width=i.width,a.height=i.height,i.renderTexture.bind(null));var o=a.width*t,x=a.height*t,$=new Uint8Array(TG*o*x),s=i.gl;return s.readPixels(a.x*t,a.y*t,o,x,s.RGBA,s.UNSIGNED_BYTE,$),h&&n.destroy(!0),r.arrayPostDivide($,$),$},r.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},r.arrayPostDivide=function(r,e){for(var t=0;t<r.length;t+=4){var a=e[t+3]=r[t+3];0!==a?(e[t]=Math.round(Math.min(255*r[t]/a,255)),e[t+1]=Math.round(Math.min(255*r[t+1]/a,255)),e[t+2]=Math.round(Math.min(255*r[t+2]/a,255))):(e[t]=r[t],e[t+1]=r[t+1],e[t+2]=r[t+2])}},r}();RG.Extract=UG;var Jm={};function Mh(){}function VG(e,t,r,s){var o=0,i=e.length;!function n(a){a||o===i?r&&r(a):s?setTimeout(function(){t(e[o++],n)},1):t(e[o++],n)}()}function Nfa(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function Ofa(e,t){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var r=0,s={_tasks:[],concurrency:t,saturated:Mh,unsaturated:Mh,buffer:t/4,empty:Mh,drain:Mh,error:Mh,started:!1,paused:!1,push:function(e,t){o(e,!1,t)},kill:function(){r=0,s.drain=Mh,s.started=!1,s._tasks=[]},unshift:function(e,t){o(e,!0,t)},process:function(){for(;!s.paused&&r<s.concurrency&&s._tasks.length;){var t=s._tasks.shift();0===s._tasks.length&&s.empty(),(r+=1)===s.concurrency&&s.saturated(),e(t.data,Nfa(i(t)))}},length:function(){return s._tasks.length},running:function(){return r},idle:function(){return s._tasks.length+r===0},pause:function(){!0!==s.paused&&(s.paused=!0)},resume:function(){if(!1!==s.paused){s.paused=!1;for(var e=1;e<=s.concurrency;e++)s.process()}}};function o(e,t,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(s.started=!0,null==e&&s.idle())setTimeout(function(){return s.drain()},1);else{var o={data:e,callback:"function"==typeof r?r:Mh};t?s._tasks.unshift(o):s._tasks.push(o),setTimeout(function(){return s.process()},1)}}function i(e){return function(){r-=1,e.callback.apply(e,arguments),null!=arguments[0]&&s.error(arguments[0],e.data),r<=s.concurrency-s.buffer&&s.unsaturated(),s.idle()&&s.drain(),s.process()}}return s}var WG={};function Pfa(r,e){if(r){e=e||{};for(var s={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},o=s.parser[e.strictMode?"strict":"loose"].exec(r),a={},t=14;t--;)a[s.key[t]]=o[t]||"";return a[s.q.name]={},a[s.key[12]].replace(s.q.parser,function(r,e,o){e&&(a[s.q.name][e]=o)}),a}}WG=Pfa;var XG={};Object.defineProperty(XG,"__esModule",{value:!0});var YG=function(){function n(n,i){for(var t=0;t<i.length;t++){var e=i[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(i,t,e){return t&&n(i.prototype,t),e&&n(i,e),i}}();function ZG(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}var Km=function(){function n(i,t,e){void 0===t&&(t=!1),ZG(this,n),this._fn=i,this._once=t,this._thisArg=e,this._next=this._prev=this._owner=null}return YG(n,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),n}();function $G(n,i){return n._head?(n._tail._next=i,i._prev=n._tail,n._tail=i):(n._head=i,n._tail=i),i._owner=n,i}var _G=function(){function n(){ZG(this,n),this._head=this._tail=void 0}return YG(n,[{key:"handlers",value:function(){var n=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],i=this._head;if(n)return!!i;for(var t=[];i;)t.push(i),i=i._next;return t}},{key:"has",value:function(n){if(!(n instanceof Km))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return n._owner===this}},{key:"dispatch",value:function(){var n=this._head;if(!n)return!1;for(;n;)n._once&&this.detach(n),n._fn.apply(n._thisArg,arguments),n=n._next;return!0}},{key:"add",value:function(n){var i=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof n)throw new Error("MiniSignal#add(): First arg must be a Function.");return $G(this,new Km(n,!1,i))}},{key:"once",value:function(n){var i=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof n)throw new Error("MiniSignal#once(): First arg must be a Function.");return $G(this,new Km(n,!0,i))}},{key:"detach",value:function(n){if(!(n instanceof Km))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return n._owner!==this?this:(n._prev&&(n._prev._next=n._next),n._next&&(n._next._prev=n._prev),n===this._head?(this._head=n._next,null===n._next&&(this._tail=null)):n===this._tail&&(this._tail=n._prev,this._tail._next=null),n._owner=null,this)}},{key:"detachAll",value:function(){var n=this._head;if(!n)return this;for(this._head=this._tail=null;n;)n._owner=null,n=n._next;return this}}]),n}();_G.MiniSignalBinding=Km;var Jd=_G;XG.default=Jd,XG=Jd;var sv={};function Qfa(e,t){var r=this;sv[e.url]?(e.data=sv[e.url],e.complete()):e.onComplete.once(function(){return sv[r.url]=r.data}),t()}function aH(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function bH(e,t,r){return t&&aH(e.prototype,t),r&&aH(e,r),e}var Rfa=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),tv=null,Sfa=0,cH=200,Tfa=204,Ufa=1223,Vfa=2;function Wfa(){}var wa=function(){function e(t,r,s){if("string"!=typeof t||"string"!=typeof r)throw new Error("Both name and url are required for constructing a resource.");s=s||{},this._flags=0,this._setFlag(e.STATUS_FLAGS.DATA_URL,0===r.indexOf("data:")),this.name=t,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===s.crossOrigin?"anonymous":s.crossOrigin,this.timeout=s.timeout||0,this.loadType=s.loadType||this._determineLoadType(),this.xhrType=s.xhrType,this.metadata=s.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=e.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=Wfa,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Jd,this.onProgress=new Jd,this.onComplete=new Jd,this.onAfterMiddleware=new Jd}e.setExtensionLoadType=function(t,r){dH(e._loadTypeMap,t,r)},e.setExtensionXhrType=function(t,r){dH(e._xhrTypeMap,t,r)};var t=e.prototype;return t.complete=function(){this._clearEvents(),this._finish()},t.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=e.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.load=function(t){var r=this;if(!this.isLoading)if(this.isComplete)t&&setTimeout(function(){return t(r)},1);else switch(t&&this.onComplete.once(t),this._setFlag(e.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case e.LOAD_TYPE.IMAGE:this.type=e.TYPE.IMAGE,this._loadElement("image");break;case e.LOAD_TYPE.AUDIO:this.type=e.TYPE.AUDIO,this._loadSourceElement("audio");break;case e.LOAD_TYPE.VIDEO:this.type=e.TYPE.VIDEO,this._loadSourceElement("video");break;case e.LOAD_TYPE.XHR:default:Rfa&&this.crossOrigin?this._loadXdr():this._loadXhr();}},t._hasFlag=function(e){return 0!=(this._flags&e)},t._setFlag=function(e,t){this._flags=t?this._flags|e:this._flags&~e},t._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(e.STATUS_FLAGS.COMPLETE,!0),this._setFlag(e.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t._loadElement=function(e){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===e&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(e),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t._loadSourceElement=function(e){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===e&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(e),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var t=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(e,this.url[r],Array.isArray(t)?t[r]:t));else{var s=this.metadata.mimeType;this.data.appendChild(this._createSource(e,this.url,Array.isArray(s)?s[0]:s))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+e)},t._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===e.XHR_RESPONSE_TYPE.JSON||this.xhrType===e.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=e.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},t._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XDomainRequest;e.timeout=this.timeout||5e3,e.onerror=this._boundXhrOnError,e.ontimeout=this._boundXhrOnTimeout,e.onprogress=this._boundOnProgress,e.onload=this._boundXhrOnLoad,e.open("GET",this.url,!0),setTimeout(function(){return e.send()},1)},t._createSource=function(e,t,r){r||(r=e+"/"+this._getExtension(t));var s=document.createElement("source");return s.src=t,s.type=r,s},t._onError=function(e){this.abort("Failed to load element using: "+e.target.nodeName)},t._onProgress=function(e){e&&e.lengthComputable&&this.onProgress.dispatch(this,e.loaded/e.total)},t._onTimeout=function(){this.abort("Load timed out.")},t._xhrOnError=function(){var e=this.xhr;this.abort(uv(e)+" Request failed. Status: "+e.status+", text: \""+e.statusText+"\"")},t._xhrOnTimeout=function(){var e=this.xhr;this.abort(uv(e)+" Request timed out.")},t._xhrOnAbort=function(){var e=this.xhr;this.abort(uv(e)+" Request was aborted by the user.")},t._xhrOnLoad=function(){var t=this.xhr,r="",s=void 0===t.status?cH:t.status;if(""!==t.responseType&&"text"!==t.responseType&&void 0!==t.responseType||(r=t.responseText),s===Sfa&&(r.length>0||t.responseType===e.XHR_RESPONSE_TYPE.BUFFER)?s=cH:s===Ufa&&(s=Tfa),(s/100|0)===Vfa){if(this.xhrType===e.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=e.TYPE.TEXT;else if(this.xhrType===e.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=e.TYPE.JSON}catch(n){return void this.abort("Error trying to parse loaded json: "+n)}else if(this.xhrType===e.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var o=new DOMParser;this.data=o.parseFromString(r,"text/xml")}else{var i=document.createElement("div");i.innerHTML=r,this.data=i}this.type=e.TYPE.XML}catch(n){return void this.abort("Error trying to parse loaded xml: "+n)}else this.data=t.response||r;this.complete()}else this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL)},t._determineCrossOrigin=function(e,t){if(0===e.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";t=t||window.location,tv||(tv=document.createElement("a")),tv.href=e;var $sX7F$$interop$default=Wc(WG);var r=!(e=$sX7F$$interop$default.d(tv.href,{strictMode:!0})).port&&""===t.port||e.port===t.port,s=e.protocol?e.protocol+":":"";return e.host===t.hostname&&r&&s===t.protocol?"":"anonymous"},t._determineXhrType=function(){return e._xhrTypeMap[this.extension]||e.XHR_RESPONSE_TYPE.TEXT},t._determineLoadType=function(){return e._loadTypeMap[this.extension]||e.LOAD_TYPE.XHR},t._getExtension=function(){var e=this.url,t="";if(this.isDataUrl){var r=e.indexOf("/");t=e.substring(r+1,e.indexOf(";",r))}else{var s=e.indexOf("?"),o=e.indexOf("#"),i=Math.min(s>-1?s:e.length,o>-1?o:e.length);t=(e=e.substring(0,i)).substring(e.lastIndexOf(".")+1)}return t.toLowerCase()},t._getMimeFromXhrType=function(t){switch(t){case e.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case e.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case e.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case e.XHR_RESPONSE_TYPE.JSON:return"application/json";case e.XHR_RESPONSE_TYPE.DEFAULT:case e.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain";}},bH(e,[{key:"isDataUrl",get:function(){return this._hasFlag(e.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(e.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(e.STATUS_FLAGS.LOADING)}}]),e}();function dH(e,t,r){t&&0===t.indexOf(".")&&(t=t.substring(1)),t&&(e[t]=r)}function uv(e){return e.toString().replace("object ","")}wa.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},wa.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},wa.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},wa.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},wa._loadTypeMap={gif:wa.LOAD_TYPE.IMAGE,png:wa.LOAD_TYPE.IMAGE,bmp:wa.LOAD_TYPE.IMAGE,jpg:wa.LOAD_TYPE.IMAGE,jpeg:wa.LOAD_TYPE.IMAGE,tif:wa.LOAD_TYPE.IMAGE,tiff:wa.LOAD_TYPE.IMAGE,webp:wa.LOAD_TYPE.IMAGE,tga:wa.LOAD_TYPE.IMAGE,svg:wa.LOAD_TYPE.IMAGE,"svg+xml":wa.LOAD_TYPE.IMAGE,mp3:wa.LOAD_TYPE.AUDIO,ogg:wa.LOAD_TYPE.AUDIO,wav:wa.LOAD_TYPE.AUDIO,mp4:wa.LOAD_TYPE.VIDEO,webm:wa.LOAD_TYPE.VIDEO},wa._xhrTypeMap={xhtml:wa.XHR_RESPONSE_TYPE.DOCUMENT,html:wa.XHR_RESPONSE_TYPE.DOCUMENT,htm:wa.XHR_RESPONSE_TYPE.DOCUMENT,xml:wa.XHR_RESPONSE_TYPE.DOCUMENT,tmx:wa.XHR_RESPONSE_TYPE.DOCUMENT,svg:wa.XHR_RESPONSE_TYPE.DOCUMENT,tsx:wa.XHR_RESPONSE_TYPE.DOCUMENT,gif:wa.XHR_RESPONSE_TYPE.BLOB,png:wa.XHR_RESPONSE_TYPE.BLOB,bmp:wa.XHR_RESPONSE_TYPE.BLOB,jpg:wa.XHR_RESPONSE_TYPE.BLOB,jpeg:wa.XHR_RESPONSE_TYPE.BLOB,tif:wa.XHR_RESPONSE_TYPE.BLOB,tiff:wa.XHR_RESPONSE_TYPE.BLOB,webp:wa.XHR_RESPONSE_TYPE.BLOB,tga:wa.XHR_RESPONSE_TYPE.BLOB,json:wa.XHR_RESPONSE_TYPE.JSON,text:wa.XHR_RESPONSE_TYPE.TEXT,txt:wa.XHR_RESPONSE_TYPE.TEXT,ttf:wa.XHR_RESPONSE_TYPE.BUFFER,otf:wa.XHR_RESPONSE_TYPE.BUFFER},wa.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var Xfa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Yfa(e){for(var t="",r=0;r<e.length;){for(var s=[0,0,0],o=[0,0,0,0],i=0;i<s.length;++i)r<e.length?s[i]=255&e.charCodeAt(r++):s[i]=0;switch(o[0]=s[0]>>2,o[1]=(3&s[0])<<4|s[1]>>4,o[2]=(15&s[1])<<2|s[2]>>6,o[3]=63&s[2],r-(e.length-1)){case 2:o[3]=64,o[2]=64;break;case 1:o[3]=64;}for(var n=0;n<o.length;++n)t+=Xfa.charAt(o[n])}return t}var eH=window.URL||window.webkitURL;function Zfa(e,t){if(e.data){if(e.xhr&&e.xhrType===wa.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof e.data){if(0===e.data.type.indexOf("image")){var r=eH.createObjectURL(e.data);return e.blob=e.data,e.data=new Image,e.data.src=r,e.type=wa.TYPE.IMAGE,void(e.data.onload=function(){eH.revokeObjectURL(r),e.data.onload=null,t()})}}else{var s=e.xhr.getResponseHeader("content-type");if(s&&0===s.indexOf("image"))return e.data=new Image,e.data.src="data:"+s+";base64,"+Yfa(e.xhr.responseText),e.type=wa.TYPE.IMAGE,void(e.data.onload=function(){e.data.onload=null,t()})}t()}else t()}var $fa={caching:Qfa,parsing:Zfa},vv=100,_fa=/(#[\w-]+)?$/,sf=function(){function e(t,r){var s=this;void 0===t&&(t=""),void 0===r&&(r=10),this.baseUrl=t,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(e,t){return s._loadResource(e,t)},this._queue=Ofa(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new Jd,this.onError=new Jd,this.onLoad=new Jd,this.onStart=new Jd,this.onComplete=new Jd;for(var o=0;o<e._defaultBeforeMiddleware.length;++o)this.pre(e._defaultBeforeMiddleware[o]);for(var i=0;i<e._defaultAfterMiddleware.length;++i)this.use(e._defaultAfterMiddleware[i])}var t=e.prototype;return t.add=function(e,t,r,s){if(Array.isArray(e)){for(var o=0;o<e.length;++o)this.add(e[o]);return this}if("object"==typeof e&&(s=t||e.callback||e.onComplete,r=e,t=e.url,e=e.name||e.key||e.url),"string"!=typeof t&&(s=r,r=t,t=e),"string"!=typeof t)throw new Error("No url passed to add resource to loader.");if("function"==typeof r&&(s=r,r=null),this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[e])throw new Error("Resource named \""+e+"\" already exists.");if(t=this._prepareUrl(t),this.resources[e]=new wa(e,t,r),"function"==typeof s&&this.resources[e].onAfterMiddleware.once(s),this.loading){for(var i=r.parentResource,n=[],a=0;a<i.children.length;++a)i.children[a].isComplete||n.push(i.children[a]);var h=i.progressChunk*(n.length+1)/(n.length+2);i.children.push(this.resources[e]),i.progressChunk=h;for(var u=0;u<n.length;++u)n[u].progressChunk=h;this.resources[e].progressChunk=h}return this._queue.push(this.resources[e]),this},t.pre=function(e){return this._beforeMiddleware.push(e),this},t.use=function(e){return this._afterMiddleware.push(e),this},t.reset=function(){for(var e in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var t=this.resources[e];t._onLoadBinding&&t._onLoadBinding.detach(),t.isLoading&&t.abort()}return this.resources={},this},t.load=function(e){if("function"==typeof e&&this.onComplete.once(e),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var t=this._queue._tasks.length,r=vv/t,s=0;s<this._queue._tasks.length;++s)this._queue._tasks[s].data.progressChunk=r;this._onStart(),this._queue.resume()}return this},t._prepareUrl=function(e){var $sX7F$$interop$default=Wc(WG);var t,r=$sX7F$$interop$default.d(e,{strictMode:!0});if(t=r.protocol||!r.path||0===e.indexOf("//")?e:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==e.charAt(0)?this.baseUrl+"/"+e:this.baseUrl+e,this.defaultQueryString){var s=_fa.exec(t)[0];-1!==(t=t.substr(0,t.length-s.length)).indexOf("?")?t+="&"+this.defaultQueryString:t+="?"+this.defaultQueryString,t+=s}return t},t._loadResource=function(e,t){var r=this;e._dequeue=t,VG(this._beforeMiddleware,function(t,s){t.call(r,e,function(){s(e.isComplete?{}:null)})},function(){e.isComplete?r._onLoad(e):(e._onLoadBinding=e.onComplete.once(r._onLoad,r),e.load())},!0)},t._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t._onComplete=function(){this.progress=vv,this.loading=!1,this.onComplete.dispatch(this,this.resources)},t._onLoad=function(e){var t=this;e._onLoadBinding=null,this._resourcesParsing.push(e),e._dequeue(),VG(this._afterMiddleware,function(r,s){r.call(t,e,s)},function(){e.onAfterMiddleware.dispatch(e),t.progress=Math.min(vv,t.progress+e.progressChunk),t.onProgress.dispatch(t,e),e.error?t.onError.dispatch(e.error,t,e):t.onLoad.dispatch(t,e),t._resourcesParsing.splice(t._resourcesParsing.indexOf(e),1),t._queue.idle()&&0===t._resourcesParsing.length&&t._onComplete()},!0)},bH(e,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(e){this._queue.concurrency=e}}]),e}();sf._defaultBeforeMiddleware=[],sf._defaultAfterMiddleware=[],sf.pre=function(e){return sf._defaultBeforeMiddleware.push(e),sf},sf.use=function(e){return sf._defaultAfterMiddleware.push(e),sf};var Lm=wa,aga=function(e,r){return(aga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)};function bga(e,r){function t(){this.constructor=e}aga(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var fH=function(){function e(){}return e.use=function(e,r){e.data&&e.type===wa.TYPE.IMAGE&&(e.texture=ya.fromLoader(e.data,e.url,e.name)),r()},e}(),Nh=function(e){function r(t,o){for(var $=e.call(this,t,o)||this,n=0;n<r._plugins.length;++n){var a=r._plugins[n],i=a.pre,u=a.use;i&&$.pre(i),u&&$.use(u)}return $._protected=!1,$}return bga(r,e),r.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(r,"shared",{get:function(){var e=r._shared;return e||((e=new r)._protected=!0,r._shared=e),e},enumerable:!1,configurable:!0}),r.registerPlugin=function(e){return r._plugins.push(e),e.add&&e.add(),r},r._plugins=[],r}(sf);Nh.registerPlugin({use:$fa.parsing}),Nh.registerPlugin(fH);var gH=function(){function e(){}return e.init=function(e){e=Object.assign({sharedLoader:!1},e),this.loader=e.sharedLoader?Nh.shared:new Nh},e.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},e}();Jm.TextureLoader=fH,Jm.LoaderResource=Lm,Jm.Loader=Nh,Jm.AppLoaderPlugin=gH;var wv={};var cga=function(t,e){return(cga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function hH(t,e){function i(){this.constructor=t}cga(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var dga=function(t){function e(e,i,r,o){void 0===e&&(e=1500),void 0===r&&(r=16384),void 0===o&&(o=!1);var a=t.call(this)||this;return r>16384&&(r=16384),a._properties=[!1,!0,!1,!1,!1],a._maxSize=e,a._batchSize=r,a._buffers=null,a._bufferUpdateIDs=[],a._updateID=0,a.interactiveChildren=!1,a.blendMode=sa.NORMAL,a.autoResize=o,a.roundPixels=!0,a.baseTexture=null,a.setProperties(i),a._tint=0,a.tintRgb=new Float32Array(4),a.tint=16777215,a}return hH(e,t),e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,Bh(t,this.tintRgb)},enumerable:!1,configurable:!0}),e.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return e.onChildrenChange(0)})),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},e}(qd),iH=function(){function t(t,e,i){this.geometry=new Yj,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<t.length;++r){var o=t[r];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||Kb.FLOAT,offset:o.offset},e[r]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return t.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new Yb(wF(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){(n=this.dynamicProperties[i]).offset=e,e+=n.size,this.dynamicStride+=n.size}var r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new Yb(this.dynamicData,!1,!1);var o=0;this.staticStride=0;for(i=0;i<this.staticProperties.length;++i){(n=this.staticProperties[i]).offset=o,o+=n.size,this.staticStride+=n.size}var a=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(a),this.staticDataUint32=new Uint32Array(a),this.staticBuffer=new Yb(this.staticData,!0,!1);for(i=0;i<this.dynamicProperties.length;++i){var n=this.dynamicProperties[i];t.addAttribute(n.attributeName,this.dynamicBuffer,0,n.type===Kb.UNSIGNED_BYTE,n.type,4*this.dynamicStride,4*n.offset)}for(i=0;i<this.staticProperties.length;++i){n=this.staticProperties[i];t.addAttribute(n.attributeName,this.staticBuffer,0,n.type===Kb.UNSIGNED_BYTE,n.type,4*this.staticStride,4*n.offset)}},t.prototype.uploadDynamic=function(t,e,i){for(var r=0;r<this.dynamicProperties.length;r++){var o=this.dynamicProperties[r];o.uploadFunction(t,e,i,o.type===Kb.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++},t.prototype.uploadStatic=function(t,e,i){for(var r=0;r<this.staticProperties.length;r++){var o=this.staticProperties[r];o.uploadFunction(t,e,i,o.type===Kb.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++},t.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},t}(),ega="varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",fga="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n",jH=function(t){function e(e){var i=t.call(this,e)||this;return i.shader=null,i.properties=null,i.tempMatrix=new Lb,i.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:i.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:i.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:i.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:i.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Kb.UNSIGNED_BYTE,uploadFunction:i.uploadTint,offset:0}],i.shader=ug.from(fga,ega,{}),i.state=vg.for2d(),i}return hH(e,t),e.prototype.render=function(t){var e=t.children,i=t._maxSize,r=t._batchSize,o=this.renderer,a=e.length;if(0!==a){a>i&&!t.autoResize&&(a=i);var n=t._buffers;n||(n=t._buffers=this.generateBuffers(t));var s=e[0]._texture.baseTexture;this.state.blendMode=Nu(t.blendMode,s.alphaMode),o.state.set(this.state);var p=o.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=vF(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,s.alphaMode),this.shader.uniforms.uSampler=s,this.renderer.shader.bind(this.shader);for(var h=!1,c=0,l=0;c<a;c+=r,l+=1){var f=a-c;f>r&&(f=r),l>=n.length&&n.push(this._generateOneMoreBuffer(t));var d=n[l];d.uploadDynamic(e,c,f);var $=t._bufferUpdateIDs[l]||0;(h=h||d._updateID<$)&&(d._updateID=t._updateID,d.uploadStatic(e,c,f)),o.geometry.bind(d.geometry),p.drawElements(p.TRIANGLES,6*f,p.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var e=[],i=t._maxSize,r=t._batchSize,o=t._properties,a=0;a<i;a+=r)e.push(new iH(this.properties,o,r));return e},e.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,i=t._properties;return new iH(this.properties,i,e)},e.prototype.uploadVertices=function(t,e,i,r,o,a){for(var n=0,s=0,p=0,u=0,h=0;h<i;++h){var c=t[e+h],l=c._texture,f=c.scale.x,d=c.scale.y,$=l.trim,y=l.orig;$?(n=(s=$.x-c.anchor.x*y.width)+$.width,p=(u=$.y-c.anchor.y*y.height)+$.height):(n=y.width*(1-c.anchor.x),s=y.width*-c.anchor.x,p=y.height*(1-c.anchor.y),u=y.height*-c.anchor.y),r[a]=s*f,r[a+1]=u*d,r[a+o]=n*f,r[a+o+1]=u*d,r[a+2*o]=n*f,r[a+2*o+1]=p*d,r[a+3*o]=s*f,r[a+3*o+1]=p*d,a+=4*o}},e.prototype.uploadPosition=function(t,e,i,r,o,a){for(var n=0;n<i;n++){var s=t[e+n].position;r[a]=s.x,r[a+1]=s.y,r[a+o]=s.x,r[a+o+1]=s.y,r[a+2*o]=s.x,r[a+2*o+1]=s.y,r[a+3*o]=s.x,r[a+3*o+1]=s.y,a+=4*o}},e.prototype.uploadRotation=function(t,e,i,r,o,a){for(var n=0;n<i;n++){var s=t[e+n].rotation;r[a]=s,r[a+o]=s,r[a+2*o]=s,r[a+3*o]=s,a+=4*o}},e.prototype.uploadUvs=function(t,e,i,r,o,a){for(var n=0;n<i;++n){var s=t[e+n]._texture._uvs;s?(r[a]=s.x0,r[a+1]=s.y0,r[a+o]=s.x1,r[a+o+1]=s.y1,r[a+2*o]=s.x2,r[a+2*o+1]=s.y2,r[a+3*o]=s.x3,r[a+3*o+1]=s.y3,a+=4*o):(r[a]=0,r[a+1]=0,r[a+o]=0,r[a+o+1]=0,r[a+2*o]=0,r[a+2*o+1]=0,r[a+3*o]=0,r[a+3*o+1]=0,a+=4*o)}},e.prototype.uploadTint=function(t,e,i,r,o,a){for(var n=0;n<i;++n){var s=t[e+n],p=s._texture.baseTexture.alphaMode>0,u=s.alpha,h=u<1&&p?_p(s._tintRGB,u):s._tintRGB+(255*u<<24);r[a]=h,r[a+o]=h,r[a+2*o]=h,r[a+3*o]=h,a+=4*o}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e}(Fm);wv.ParticleRenderer=jH,wv.ParticleContainer=dga;var Mm={};var gga,hga,Oh,tf,rd={};(function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round"})(Oh||(hga=Oh={},rd.LINE_JOIN=Oh,hga)),function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square"}(tf||(gga=tf={},rd.LINE_CAP=tf,gga));var $j={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},xv=function(){function t(){this.color=16777215,this.alpha=1,this.texture=ya.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=ya.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),iga=function(t,e){return(iga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function qq(t,e){function r(){this.constructor=t}iga(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var yv={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var r=t.points,i=t.holes,a=e.points,n=e.indices;if(r.length>=6){for(var s=[],l=0;l<i.length;l++){var o=i[l];s.push(r.length/2),r=r.concat(o.points)}var h=Ku.d(r,s,2);if(!h)return;var $=a.length/2;for(l=0;l<h.length;l+=3)n.push(h[l]+$),n.push(h[l+1]+$),n.push(h[l+2]+$);for(l=0;l<r.length;l++)a.push(r[l])}}},zv={build:function(t){var e,r,i=t.shape,a=t.points,n=i.x,s=i.y;if(a.length=0,t.type===xb.CIRC)e=i.radius,r=i.radius;else{var l=t.shape;e=l.width,r=l.height}if(0!==e&&0!==r){var o=Math.floor(30*Math.sqrt(i.radius))||Math.floor(15*Math.sqrt(e+r));o/=2.3;for(var h=2*Math.PI/o,$=0;$<o-.5;$++)a.push(n+Math.sin(-h*$)*e,s+Math.cos(-h*$)*r);a.push(a[0],a[1])}},triangulate:function(t,e){var r=t.points,i=e.points,a=e.indices,n=i.length/2,s=n,l=t.shape,o=t.matrix,h=l.x,$=l.y;i.push(t.matrix?o.a*h+o.c*$+o.tx:h,t.matrix?o.b*h+o.d*$+o.ty:$);for(var u=0;u<r.length;u+=2)i.push(r[u],r[u+1]),a.push(n++,s,n)}},kH={build:function(t){var e=t.shape,r=e.x,i=e.y,a=e.width,n=e.height,s=t.points;s.length=0,s.push(r,i,r+a,i,r+a,i+n,r,i+n)},triangulate:function(t,e){var r=t.points,i=e.points,a=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(a,a+1,a+2,a+1,a+2,a+3)}};function _j(t,e,r){return t+(e-t)*r}function rq(t,e,r,i,a,n,s){void 0===s&&(s=[]);for(var l=s,o=0,h=0,$=0,u=0,p=0,c=0,x=0,d=0;x<=20;++x)o=_j(t,r,d=x/20),h=_j(e,i,d),$=_j(r,a,d),u=_j(i,n,d),p=_j(o,$,d),c=_j(h,u,d),l.push(p,c);return l}var lH={build:function(t){var e=t.shape,r=t.points,i=e.x,a=e.y,n=e.width,s=e.height,l=Math.max(0,Math.min(e.radius,Math.min(n,s)/2));r.length=0,l?(rq(i,a+l,i,a,i+l,a,r),rq(i+n-l,a,i+n,a,i+n,a+l,r),rq(i+n,a+s-l,i+n,a+s,i+n-l,a+s,r),rq(i+l,a+s,i,a+s,i,a+s-l,r)):r.push(i,a,i+n,a,i+n,a+s,i,a+s)},triangulate:function(t,e){for(var r=t.points,i=e.points,a=e.indices,n=i.length/2,s=Ku.d(r,null,2),l=0,o=s.length;l<o;l+=3)a.push(s[l]+n),a.push(s[l+1]+n),a.push(s[l+2]+n);for(l=0,o=r.length;l<o;l++)i.push(r[l],r[++l])}};function mH(t,e,r,i,a,n,s,l){var o,h;s?(o=i,h=-r):(o=-i,h=r);var $=t-r*a+o,u=e-i*a+h,p=t+r*n+o,c=e+i*n+h;return l.push($,u),l.push(p,c),2}function sq(t,e,r,i,a,n,s,l){var o=r-t,h=i-e,$=Math.atan2(o,h),u=Math.atan2(a-t,n-e);l&&$<u?$+=2*Math.PI:!l&&$>u&&(u+=2*Math.PI);var p=$,c=u-$,x=Math.abs(c),d=Math.sqrt(o*o+h*h),v=1+(15*x*Math.sqrt(d)/Math.PI>>0),f=c/v;if(p+=f,l){s.push(t,e),s.push(r,i);for(var y=1,N=p;y<v;y++,N+=f)s.push(t,e),s.push(t+Math.sin(N)*d,e+Math.cos(N)*d);s.push(t,e),s.push(a,n)}else{s.push(r,i),s.push(t,e);for(y=1,N=p;y<v;y++,N+=f)s.push(t+Math.sin(N)*d,e+Math.cos(N)*d),s.push(t,e);s.push(a,n),s.push(t,e)}return 2*v}function jga(t,e){var r=t.shape,i=t.points||r.points.slice(),a=e.closePointEps;if(0!==i.length){var n=t.lineStyle,s=new Da(i[0],i[1]),l=new Da(i[i.length-2],i[i.length-1]),o=r.type!==xb.POLY||r.closeStroke,h=Math.abs(s.x-l.x)<a&&Math.abs(s.y-l.y)<a;if(o){i=i.slice(),h&&(i.pop(),i.pop(),l.set(i[i.length-2],i[i.length-1]));var $=.5*(s.x+l.x),u=.5*(l.y+s.y);i.unshift($,u),i.push($,u)}var p=e.points,c=i.length/2,x=i.length,d=p.length/2,v=n.width/2,f=v*v,y=n.miterLimit*n.miterLimit,N=i[0],g=i[1],m=i[2],K=i[3],b=0,_=0,P=-(g-K),S=N-m,A=0,w=0,L=Math.sqrt(P*P+S*S);P/=L,S/=L,P*=v,S*=v;var M=n.alignment,C=2*(1-M),E=2*M;o||(n.cap===tf.ROUND?x+=sq(N-P*(C-E)*.5,g-S*(C-E)*.5,N-P*C,g-S*C,N+P*E,g+S*E,p,!0)+2:n.cap===tf.SQUARE&&(x+=mH(N,g,P,S,C,E,!0,p))),p.push(N-P*C,g-S*C),p.push(N+P*E,g+S*E);for(var D=1;D<c-1;++D){N=i[2*(D-1)],g=i[2*(D-1)+1],m=i[2*D],K=i[2*D+1],b=i[2*(D+1)],_=i[2*(D+1)+1],P=-(g-K),S=N-m,P/=L=Math.sqrt(P*P+S*S),S/=L,P*=v,S*=v,A=-(K-_),w=m-b,A/=L=Math.sqrt(A*A+w*w),w/=L,A*=v,w*=v;var I=m-N,T=g-K,R=m-b,O=_-K,B=T*R-O*I,U=B<0;if(Math.abs(B)<.1)p.push(m-P*C,K-S*C),p.push(m+P*E,K+S*E);else{var H=(-P+N)*(-S+K)-(-P+m)*(-S+g),F=(-A+b)*(-w+K)-(-A+m)*(-w+_),G=(I*F-R*H)/B,q=(O*H-T*F)/B,z=(G-m)*(G-m)+(q-K)*(q-K),j=m+(G-m)*C,W=K+(q-K)*C,k=m-(G-m)*E,V=K-(q-K)*E;n.join===Oh.BEVEL||z/f>y?(U?(p.push(j,W),p.push(m+P*E,K+S*E),p.push(j,W),p.push(m+A*E,K+w*E)):(p.push(m-P*C,K-S*C),p.push(k,V),p.push(m-A*C,K-w*C),p.push(k,V)),x+=2):n.join===Oh.ROUND?U?(p.push(j,W),p.push(m+P*E,K+S*E),x+=sq(m,K,m+P*E,K+S*E,m+A*E,K+w*E,p,!0)+4,p.push(j,W),p.push(m+A*E,K+w*E)):(p.push(m-P*C,K-S*C),p.push(k,V),x+=sq(m,K,m-P*C,K-S*C,m-A*C,K-w*C,p,!1)+4,p.push(m-A*C,K-w*C),p.push(k,V)):(p.push(j,W),p.push(k,V))}}N=i[2*(c-2)],g=i[2*(c-2)+1],m=i[2*(c-1)],P=-(g-(K=i[2*(c-1)+1])),S=N-m,P/=L=Math.sqrt(P*P+S*S),S/=L,P*=v,S*=v,p.push(m-P*C,K-S*C),p.push(m+P*E,K+S*E),o||(n.cap===tf.ROUND?x+=sq(m-P*(C-E)*.5,K-S*(C-E)*.5,m-P*C,K-S*C,m+P*E,K+S*E,p,!1)+2:n.cap===tf.SQUARE&&(x+=mH(m,K,P,S,C,E,!1,p)));var J=e.indices,Y=$j.epsilon*$j.epsilon;for(D=d;D<x+d-2;++D)N=p[2*D],g=p[2*D+1],m=p[2*(D+1)],K=p[2*(D+1)+1],b=p[2*(D+2)],_=p[2*(D+2)+1],Math.abs(N*(K-_)+m*(_-g)+b*(g-K))<Y||J.push(D,D+1,D+2)}}function kga(t,e){var r=0,i=t.shape,a=t.points||i.points,n=i.type!==xb.POLY||i.closeStroke;if(0!==a.length){var s=e.points,l=e.indices,o=a.length/2,h=s.length/2,$=h;for(s.push(a[0],a[1]),r=1;r<o;r++)s.push(a[2*r],a[2*r+1]),l.push($,$+1),$++;n&&l.push($,h)}}function Av(t,e){t.lineStyle.native?kga(t,e):jga(t,e)}var Nm,nH=function(t){function e(e,r,i,a,n,s){void 0===s&&(s=0);n=n||a/2;for(var l=-1*Math.PI/2+s,o=2*i,h=Uj/o,$=[],u=0;u<o;u++){var p=u%2?n:a,c=u*h+l;$.push(e+p*Math.cos(c),r+p*Math.sin(c))}return t.call(this,$)||this}return qq(e,t),e}(Vj),Bv=function(){function t(){}return t.curveTo=function(t,e,r,i,a,n){var s=n[n.length-2],l=n[n.length-1]-e,o=s-t,h=i-e,$=r-t,u=Math.abs(l*$-o*h);if(u<1e-8||0===a)return n[n.length-2]===t&&n[n.length-1]===e||n.push(t,e),null;var p=l*l+o*o,c=h*h+$*$,x=l*h+o*$,d=a*Math.sqrt(p)/u,v=a*Math.sqrt(c)/u,f=d*x/p,y=v*x/c,N=d*$+v*o,g=d*h+v*l,m=o*(v+f),K=l*(v+f),b=$*(d+y),_=h*(d+y);return{cx:N+t,cy:g+e,radius:a,startAngle:Math.atan2(K-g,m-N),endAngle:Math.atan2(_-g,b-N),anticlockwise:o*h>$*l}},t.arc=function(t,e,r,i,a,n,s,l,o){for(var h=s-n,$=$j._segmentsCount(Math.abs(h)*a,40*Math.ceil(Math.abs(h)/Uj)),u=h/(2*$),p=2*u,c=Math.cos(u),x=Math.sin(u),d=$-1,v=d%1/d,f=0;f<=d;++f){var y=u+n+p*(f+v*f),N=Math.cos(y),g=-Math.sin(y);o.push((c*N+x*g)*a+r,(c*-g+x*N)*a+i)}},t}(),oH=function(){function t(){}return t.curveLength=function(t,e,r,i,a,n,s,l){for(var o=0,h=0,$=0,u=0,p=0,c=0,x=0,d=0,v=0,f=0,y=0,N=t,g=e,m=1;m<=10;++m)f=N-(d=(x=(c=(p=1-(h=m/10))*p)*p)*t+3*c*h*r+3*p*($=h*h)*a+(u=$*h)*s),y=g-(v=x*e+3*c*h*i+3*p*$*n+u*l),N=d,g=v,o+=Math.sqrt(f*f+y*y);return o},t.curveTo=function(e,r,i,a,n,s,l){var o=l[l.length-2],h=l[l.length-1];l.length-=2;var $=$j._segmentsCount(t.curveLength(o,h,e,r,i,a,n,s)),u=0,p=0,c=0,x=0,d=0;l.push(o,h);for(var v=1,f=0;v<=$;++v)c=(p=(u=1-(f=v/$))*u)*u,d=(x=f*f)*f,l.push(c*o+3*p*f*e+3*u*x*i+d*n,c*h+3*p*f*r+3*u*x*a+d*s)},t}(),pH=function(){function t(){}return t.curveLength=function(t,e,r,i,a,n){var s=t-2*r+a,l=e-2*i+n,o=2*r-2*t,h=2*i-2*e,$=4*(s*s+l*l),u=4*(s*o+l*h),p=o*o+h*h,c=2*Math.sqrt($+u+p),x=Math.sqrt($),d=2*$*x,v=2*Math.sqrt(p),f=u/x;return(d*c+x*u*(c-v)+(4*p*$-u*u)*Math.log((2*x+f+c)/(f+v)))/(4*d)},t.curveTo=function(e,r,i,a,n){for(var s=n[n.length-2],l=n[n.length-1],o=$j._segmentsCount(t.curveLength(s,l,e,r,i,a)),h=0,$=0,u=1;u<=o;++u){var p=u/o;h=s+(e-s)*p,$=l+(r-l)*p,n.push(h+(e+(i-e)*p-h)*p,$+(r+(a-r)*p-$)*p)}},t}(),qH=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),tq=((Nm={})[xb.POLY]=yv,Nm[xb.CIRC]=zv,Nm[xb.ELIP]=zv,Nm[xb.RECT]=kH,Nm[xb.RREC]=lH,Nm),Cv=[],Om=[],lga={buildPoly:yv,buildCircle:zv,buildRectangle:kH,buildRoundedRectangle:lH,FILL_COMMANDS:tq,BATCH_POOL:Cv,DRAW_CALL_POOL:Om,buildLine:Av,Star:nH,ArcUtils:Bv,BezierUtils:oH,QuadraticUtils:pH,BatchPart:qH},Dv=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null),this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=i,this.type=t.type,this.points=[],this.holes=[]}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),ak=new Da,mga=new Cm,rH=function(t){function e(){var e=t.call(this)||this;return e.uvsFloat32=null,e.indicesUint16=null,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.dirty=0,e.batchDirty=-1,e.cacheDirty=-1,e.clearDirty=0,e.drawCalls=[],e.batches=[],e.shapeIndex=0,e._bounds=new Cm,e.boundsDirty=-1,e.boundsPadding=0,e.batchable=!1,e.indicesUint16=null,e.uvsFloat32=null,e.closePointEps=1e-4,e}return qq(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Om.push(this.drawCalls[t]);this.drawCalls.length=0;for(t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),Cv.push(e)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null);var a=new Dv(t,e,r,i);return this.graphicsData.push(a),this.dirty++,this},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var r=new Dv(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,r=0;r<e.length;++r){var i=e[r];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(t,ak):ak.copyFrom(t),i.shape.contains(ak.x,ak.y))){var a=!1;if(i.holes)for(var n=0;n<i.holes.length;n++){if(i.holes[n].shape.contains(ak.x,ak.y)){a=!0;break}}if(!a)return!0}}return!1},e.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,r=this.graphicsData,i=null,a=null;this.batches.length>0&&(a=(i=this.batches[this.batches.length-1]).style);for(var n=this.shapeIndex;n<r.length;n++){this.shapeIndex++;var s=r[n],l=s.fillStyle,o=s.lineStyle;tq[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix);for(var h=0;h<2;h++){var $=0===h?l:o;if($.visible){var u=$.texture.baseTexture,p=this.indices.length,c=this.points.length/2;u.wrapMode=nf.REPEAT,0===h?this.processFill(s):this.processLine(s);var x=this.points.length/2-c;0!==x&&(i&&!this._compareStyles(a,$)&&(i.end(p,c),i=null),i||((i=Cv.pop()||new qH).begin($,p,c),this.batches.push(i),a=$),this.addUvs(this.points,e,$.texture,c,x,$.matrix))}}}var d=this.indices.length,v=this.points.length/2;if(i&&i.end(d,v),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var f=v>65535&&t;this.indicesUint16=f?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&t.texture.baseTexture===e.texture.baseTexture&&t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var r=this.graphicsData[t],i=r.fillStyle,a=r.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(a&&!a.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,r=t.length;e<r;e++)for(var i=t[e],a=0;a<i.size;a++){var n=i.start+a;this.indicesUint16[n]=this.indicesUint16[n]-i.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,r=0;r<t.length;r++)if(t[r].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++gb._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Om.push(this.drawCalls[e]);this.drawCalls.length=0;var r=this.colors,i=this.textureIds,a=Om.pop();a||((a=new oq).texArray=new pq),a.texArray.count=0,a.start=0,a.size=0,a.type=od.TRIANGLES;var n=0,s=null,l=0,o=!1,h=od.TRIANGLES,$=0;this.drawCalls.push(a);for(e=0;e<this.batches.length;e++){var u=this.batches[e],p=u.style,c=p.texture.baseTexture;o!==!!p.native&&(h=(o=!!p.native)?od.LINES:od.TRIANGLES,s=null,n=8,t++),s!==c&&(s=c,c._batchEnabled!==t&&(8===n&&(t++,n=0,a.size>0&&((a=Om.pop())||((a=new oq).texArray=new pq),this.drawCalls.push(a)),a.start=$,a.size=0,a.texArray.count=0,a.type=h),c.touched=1,c._batchEnabled=t,c._batchLocation=n,c.wrapMode=10497,a.texArray.elements[a.texArray.count++]=c,n++)),a.size+=u.size,$+=u.size,l=c._batchLocation,this.addColors(r,p.color,p.alpha,u.attribSize),this.addTextureIds(i,l,u.attribSize)}gb._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,r=this.colors,i=this.textureIds,a=new ArrayBuffer(3*t.length*4),n=new Float32Array(a),s=new Uint32Array(a),l=0,o=0;o<t.length/2;o++)n[l++]=t[2*o],n[l++]=t[2*o+1],n[l++]=e[2*o],n[l++]=e[2*o+1],s[l++]=r[o],n[l++]=i[o];this._buffer.update(a),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),yv.triangulate(t,this)):tq[t.type].triangulate(t,this)},e.prototype.processLine=function(t){Av(t,this);for(var e=0;e<t.holes.length;e++)Av(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var r=t[e];tq[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=mga,r=Lb.IDENTITY;this._bounds.clear(),e.clear();for(var i=0;i<this.graphicsData.length;i++){var a=this.graphicsData[i],n=a.shape,s=a.type,l=a.lineStyle,o=a.matrix||Lb.IDENTITY,h=0;if(l&&l.visible){var $=l.alignment;h=l.width,s===xb.POLY?h*=.5+Math.abs(.5-$):h*=Math.max(0,$)}if(r!==o&&(e.isEmpty()||(t.addBoundsMatrix(e,r),e.clear()),r=o),s===xb.RECT||s===xb.RREC){var u=n;e.addFramePad(u.x,u.y,u.x+u.width,u.y+u.height,h,h)}else if(s===xb.CIRC){var p=n;e.addFramePad(p.x,p.y,p.x,p.y,p.radius+h,p.radius+h)}else if(s===xb.ELIP){var c=n;e.addFramePad(c.x,c.y,c.x,c.y,c.width+h,c.height+h)}else{var x=n;t.addVerticesMatrix(r,x.points,0,x.points.length,h,h)}}e.isEmpty()||t.addBoundsMatrix(e,r),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var r=0;r<t.length/2;r++){var i=t[2*r],a=t[2*r+1];t[2*r]=e.a*i+e.c*a+e.tx,t[2*r+1]=e.b*i+e.d*a+e.ty}},e.prototype.addColors=function(t,e,r,i){for(var a=_p((e>>16)+(65280&e)+((255&e)<<16),r);i-->0;)t.push(a)},e.prototype.addTextureIds=function(t,e,r){for(;r-->0;)t.push(e)},e.prototype.addUvs=function(t,e,r,i,a,n){void 0===n&&(n=null);for(var s=0,l=e.length,o=r.frame;s<a;){var h=t[2*(i+s)],$=t[2*(i+s)+1];if(n){var u=n.a*h+n.c*$+n.tx;$=n.b*h+n.d*$+n.ty,h=u}s++,e.push(h/o.width,$/o.height)}var p=r.baseTexture;(o.width<p.width||o.height<p.height)&&this.adjustUvs(e,r,l,a)},e.prototype.adjustUvs=function(t,e,r,i){for(var a=e.baseTexture,n=r+2*i,s=e.frame,l=s.width/a.width,o=s.height/a.height,h=s.x/s.width,$=s.y/s.height,u=Math.floor(t[r]+1e-6),p=Math.floor(t[r+1]+1e-6),c=r+2;c<n;c+=2)u=Math.min(u,Math.floor(t[c]+1e-6)),p=Math.min(p,Math.floor(t[c+1]+1e-6));h-=u,$-=p;for(c=r;c<n;c+=2)t[c]=(t[c]+h)*l,t[c+1]=(t[c+1]+$)*o},e.BATCHABLE_SIZE=100,e}(rv),sH=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=tf.BUTT,e.join=Oh.MITER,e.miterLimit=10,e}return qq(e,t),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(xv),nga=new Float32Array(3),Ev={},sd=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r._geometry=e||new rH,r._geometry.refCount++,r.shader=null,r.state=vg.for2d(),r._fillStyle=new xv,r._lineStyle=new sH,r._matrix=null,r._holeMode=!1,r.currentPath=null,r.batches=[],r.batchTint=-1,r.batchDirty=-1,r.vertexData=null,r.pluginName="batch",r._transformID=-1,r.tint=16777215,r.blendMode=sa.NORMAL,r}return qq(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t){if(void 0===t&&(t=null),"number"==typeof t){var e=arguments;t={width:e[0]||0,color:e[1]||0,alpha:void 0!==e[2]?e[2]:1,alignment:void 0!==e[3]?e[3]:.5,native:!!e[4]}}return this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){if("number"==typeof t){ea("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var e=arguments,r=e[0],i=e[1],a=e[2],n=e[3],s=e[4],l=e[5],o=e[6];t={width:r,texture:i,color:a,alpha:n,matrix:s,alignment:l,native:o},Object.keys(t).forEach(function(e){return void 0===t[e]&&delete t[e]})}t=Object.assign({width:0,texture:ya.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:tf.BUTT,join:Oh.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var h=t.width>0&&t.alpha>0;return h?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:h},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Vj,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Vj,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,i=r[r.length-2],a=r[r.length-1];return i===t&&a===e||r.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,r,i){this._initCurve();var a=this.currentPath.points;return 0===a.length&&this.moveTo(0,0),pH.curveTo(t,e,r,i,a),this},e.prototype.bezierCurveTo=function(t,e,r,i,a,n){return this._initCurve(),oH.curveTo(t,e,r,i,a,n,this.currentPath.points),this},e.prototype.arcTo=function(t,e,r,i,a){this._initCurve(t,e);var n=this.currentPath.points,s=Bv.curveTo(t,e,r,i,a,n);if(s){var l=s.cx,o=s.cy,h=s.radius,$=s.startAngle,u=s.endAngle,p=s.anticlockwise;this.arc(l,o,h,$,u,p)}return this},e.prototype.arc=function(t,e,r,i,a,n){if(void 0===n&&(n=!1),i===a)return this;if(!n&&a<=i?a+=Uj:n&&i<=a&&(i+=Uj),0===a-i)return this;var s=t+Math.cos(i)*r,l=e+Math.sin(i)*r,o=this._geometry.closePointEps,h=this.currentPath?this.currentPath.points:null;if(h){var $=Math.abs(h[h.length-2]-s),u=Math.abs(h[h.length-1]-l);$<o&&u<o||h.push(s,l)}else this.moveTo(s,l),h=this.currentPath.points;return Bv.arc(s,l,t,e,r,i,a,n,h),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:ya.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){if(t instanceof ya){ea("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var e=arguments,r=e[0],i=e[1],a=e[2],n=e[3];t={texture:r,color:i,alpha:a,matrix:n},Object.keys(t).forEach(function(e){return void 0===t[e]&&delete t[e]})}t=Object.assign({texture:ya.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var s=t.alpha>0;return s?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:s},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,r,i){return this.drawShape(new La(t,e,r,i))},e.prototype.drawRoundedRect=function(t,e,r,i,a){return this.drawShape(new GF(t,e,r,i,a))},e.prototype.drawCircle=function(t,e,r){return this.drawShape(new EF(t,e,r))},e.prototype.drawEllipse=function(t,e,r,i){return this.drawShape(new FF(t,e,r,i))},e.prototype.drawPolygon=function(){for(var t,e=arguments,r=[],i=0;i<arguments.length;i++)r[i]=e[i];var a=!0,n=r[0];n.points?(a=n.closeStroke,t=n.points):t=Array.isArray(r[0])?r[0]:r;var s=new Vj(t);return s.closeStroke=a,this.drawShape(s),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.drawStar=function(t,e,r,i,a,n){return void 0===n&&(n=0),this.drawPolygon(new nH(t,e,r,i,a,n))},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return 1===t.length&&t[0].shape.type===xb.RECT&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var e=this._geometry,r=t.context.supports.uint32Indices;e.updateBatches(r),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(var i=0;i<r;i++){var a=t.batches[i],n=a.style.color,s=new Float32Array(this.vertexData.buffer,4*a.attribStart*2,2*a.attribSize),l=new Float32Array(t.uvsFloat32.buffer,4*a.attribStart*2,2*a.attribSize),o={vertexData:s,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*a.start,a.size),uvs:l,_batchRGB:Bh(n),_tintRGB:n,_texture:a.style.texture,alpha:a.style.alpha,worldAlpha:1};this.batches[i]=o}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,r=this.batches.length;e<r;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),r=this._geometry,i=this.tint,a=this.worldAlpha,n=e.uniforms,s=r.drawCalls;n.translationMatrix=this.transform.worldTransform,n.tint[0]=(i>>16&255)/255*a,n.tint[1]=(i>>8&255)/255*a,n.tint[2]=(255&i)/255*a,n.tint[3]=a,t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(var l=0,o=s.length;l<o;l++)this._renderDrawCallDirect(t,r.drawCalls[l])},e.prototype._renderDrawCallDirect=function(t,e){for(var r=e.texArray,i=e.type,a=e.size,n=e.start,s=r.count,l=0;l<s;l++)t.texture.bind(r.elements[l],l);t.geometry.draw(i,a,n)},e.prototype._resolveDirectShader=function(t){var e=this.shader,r=this.pluginName;if(!e){if(!Ev[r]){for(var i=new Int32Array(16),a=0;a<16;a++)i[a]=a;var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Lb,default:tg.from({uSamplers:i},!0)},s=t.plugins[r]._shader.program;Ev[r]=new ug(s,n)}e=Ev[r]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,r=e.minX,i=e.minY,a=e.maxX,n=e.maxY;this._bounds.addFrame(this.transform,r,i,a,n)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=Bh(this.tint,nga),e=0;e<this.batches.length;e++){var r=this.batches[e],i=r._batchRGB,a=(t[0]*i[0]*255<<16)+(t[1]*i[1]*255<<8)+(0|t[2]*i[2]*255);r._tintRGB=(a>>16)+(65280&a)+((255&a)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,r=e.a,i=e.b,a=e.c,n=e.d,s=e.tx,l=e.ty,o=this._geometry.points,h=this.vertexData,$=0,u=0;u<o.length;u+=2){var p=o[u],c=o[u+1];h[$++]=r*p+a*c+s,h[$++]=n*c+i*p+l}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},e._TEMP_POINT=new Da,e}(qd);rd.graphicsUtils=lga,rd.LineStyle=sH,rd.LINE_JOIN=Oh,rd.LINE_CAP=tf,rd.GraphicsGeometry=rH,rd.GraphicsData=Dv,rd.Graphics=sd,rd.GRAPHICS_CURVES=$j,rd.FillStyle=xv;var oga,bk={};var tH={};var pga=function(t,e){return(pga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function qga(t,e){function i(){this.constructor=t}pga(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var Pm=new Da,rga=new Uint16Array([0,1,2,0,2,3]),Ph=function(t){function e(e){var i=t.call(this)||this;return i._anchor=new Fh(i._onAnchorUpdate,i,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),i._texture=null,i._width=0,i._height=0,i._tint=null,i._tintRGB=null,i.tint=16777215,i.blendMode=sa.NORMAL,i._cachedTint=16777215,i.uvs=null,i.texture=e||ya.EMPTY,i.vertexData=new Float32Array(8),i.vertexTrimmedData=null,i._transformID=-1,i._textureID=-1,i._transformTrimmedID=-1,i._textureTrimmedID=-1,i.indices=rga,i.pluginName="batch",i.isSprite=!0,i._roundPixels=ra.ROUND_PIXELS,i}return qga(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Dh(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Dh(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,o=e.d,s=e.tx,h=e.ty,u=this.vertexData,a=t.trim,c=t.orig,_=this._anchor,p=0,d=0,l=0,$=0;if(a?(p=(d=a.x-_._x*c.width)+a.width,l=($=a.y-_._y*c.height)+a.height):(p=(d=-_._x*c.width)+c.width,l=($=-_._y*c.height)+c.height),u[0]=i*d+n*$+s,u[1]=o*$+r*d+h,u[2]=i*p+n*$+s,u[3]=o*$+r*p+h,u[4]=i*p+n*l+s,u[5]=o*l+r*p+h,u[6]=i*d+n*l+s,u[7]=o*l+r*d+h,this._roundPixels)for(var x=ra.RESOLUTION,m=0;m<u.length;++m)u[m]=Math.round((u[m]*x|0)/x)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,i=t.orig,r=this._anchor,n=this.transform.worldTransform,o=n.a,s=n.b,h=n.c,u=n.d,a=n.tx,c=n.ty,_=-r._x*i.width,p=_+i.width,d=-r._y*i.height,l=d+i.height;e[0]=o*_+h*d+a,e[1]=u*d+s*_+c,e[2]=o*p+h*d+a,e[3]=u*d+s*p+c,e[4]=o*p+h*l+a,e[5]=u*l+s*p+c,e[6]=o*_+h*l+a,e[7]=u*l+s*_+c},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new La),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Pm);var e=this._texture.orig.width,i=this._texture.orig.height,r=-e*this.anchor.x,n=0;return Pm.x>=r&&Pm.x<r+e&&(n=-i*this.anchor.y,Pm.y>=n&&Pm.y<n+i)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var i="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!i)}this._texture=null},e.from=function(t,i){return new e(t instanceof ya?t:ya.from(t,i))},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=Dh(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=Dh(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||ya.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}(qd);tH.Sprite=Ph;var ck,sga=function(t,e){return(sga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function tga(t,e){function i(){this.constructor=t}sga(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}!function(t){t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"}(ck||(oga=ck={},bk.TEXT_GRADIENT=ck,oga));var Fv={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:ck.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},uga=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Qh=function(){function t(t){this.styleID=0,this.reset(),Hv(this,t,t)}return t.prototype.clone=function(){var e={};return Hv(e,this,Fv),new t(e)},t.prototype.reset=function(){Hv(this,Fv,Fv)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=Gv(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=Gv(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){vga(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=Gv(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var i=e.length-1;i>=0;i--){var r=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&uga.indexOf(r)<0&&(r="\""+r+"\""),e[i]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},t}();function uH(t){return"number"==typeof t?Lu(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function Gv(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=uH(t[e]);return t}return uH(t)}function vga(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}function Hv(t,e,i){for(var r in i)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}var td=function(){function t(t,e,i,r,n,o,s,a,h){this.text=t,this.style=e,this.width=i,this.height=r,this.lines=n,this.lineWidths=o,this.lineHeight=s,this.maxLineWidth=a,this.fontProperties=h}return t.measureText=function(e,i,r,n){void 0===n&&(n=t._canvas),r=null==r?i.wordWrap:r;var o=i.toFontString(),s=t.measureFont(o);0===s.fontSize&&(s.fontSize=i.fontSize,s.ascent=i.fontSize);var a=n.getContext("2d");a.font=o;for(var h=(r?t.wordWrap(e,i,n):e).split(/(?:\r\n|\r|\n)/),l=new Array(h.length),c=0,p=0;p<h.length;p++){var u=a.measureText(h[p]).width+(h[p].length-1)*i.letterSpacing;l[p]=u,c=Math.max(c,u)}var f=c+i.strokeThickness;i.dropShadow&&(f+=i.dropShadowDistance);var d=i.lineHeight||s.fontSize+i.strokeThickness,g=Math.max(d,s.fontSize+i.strokeThickness)+(h.length-1)*(d+i.leading);return i.dropShadow&&(g+=i.dropShadowDistance),new t(e,i,f,g,h,l,d+i.leading,c,s)},t.wordWrap=function(e,i,r){void 0===r&&(r=t._canvas);for(var n=r.getContext("2d"),o=0,s="",a="",h={},l=i.letterSpacing,c=i.whiteSpace,p=t.collapseSpaces(c),u=t.collapseNewlines(c),f=!p,d=i.wordWrapWidth+l,g=t.tokenize(e),$=0;$<g.length;$++){var y=g[$];if(t.isNewline(y)){if(!u){a+=t.addLine(s),f=!p,s="",o=0;continue}y=" "}if(p){var _=t.isBreakingSpace(y),T=t.isBreakingSpace(s[s.length-1]);if(_&&T)continue}var x=t.getFromCache(y,l,h,n);if(x>d){if(""!==s&&(a+=t.addLine(s),s="",o=0),t.canBreakWords(y,i.breakWords))for(var S=t.wordWrapSplit(y),b=0;b<S.length;b++){for(var m=S[b],v=1;S[b+v];){var w=S[b+v],I=m[m.length-1];if(t.canBreakChars(I,w,y,b,i.breakWords))break;m+=w,v++}b+=m.length-1;var k=t.getFromCache(m,l,h,n);k+o>d&&(a+=t.addLine(s),f=!1,s="",o=0),s+=m,o+=k}else{s.length>0&&(a+=t.addLine(s),s="",o=0);var A=$===g.length-1;a+=t.addLine(y,!A),f=!1,s="",o=0}}else x+o>d&&(f=!1,a+=t.addLine(s),s="",o=0),(s.length>0||!t.isBreakingSpace(y)||f)&&(s+=y,o+=x)}return a+=t.addLine(s,!1)},t.addLine=function(e,i){return void 0===i&&(i=!0),e=t.trimRight(e),e=i?e+"\n":e},t.getFromCache=function(t,e,i,r){var n=i[t];if(void 0===n){var o=t.length*e;n=r.measureText(t).width+o,i[t]=n}return n},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var i=e.length-1;i>=0;i--){var r=e[i];if(!t.isBreakingSpace(r))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var i=[],r="";if("string"!=typeof e)return i;for(var n=0;n<e.length;n++){var o=e[n];t.isBreakingSpace(o)||t.isNewline(o)?(""!==r&&(i.push(r),r=""),i.push(o)):r+=o}return""!==r&&i.push(r),i},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,i,r,n){return!0},t.wordWrapSplit=function(t){return t.split("")},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var i={ascent:0,descent:0,fontSize:0},r=t._canvas,n=t._context;n.font=e;var o=t.METRICS_STRING+t.BASELINE_SYMBOL,s=Math.ceil(n.measureText(o).width),a=Math.ceil(n.measureText(t.BASELINE_SYMBOL).width),h=2*a;a=a*t.BASELINE_MULTIPLIER|0,r.width=s,r.height=h,n.fillStyle="#f00",n.fillRect(0,0,s,h),n.font=e,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(o,0,a);var l=n.getImageData(0,0,s,h).data,c=l.length,p=4*s,u=0,f=0,d=!1;for(u=0;u<a;++u){for(var g=0;g<p;g+=4)if(255!==l[f+g]){d=!0;break}if(d)break;f+=p}for(i.ascent=a-u,f=c-p,d=!1,u=h;u>a;--u){for(g=0;g<p;g+=4)if(255!==l[f+g]){d=!0;break}if(d)break;f-=p}return i.descent=u-a,i.fontSize=i.ascent+i.descent,t._fonts[e]=i,i},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={}},t}(),uq=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(i){return document.createElement("canvas")}}();uq.width=uq.height=10,td._canvas=uq,td._context=uq.getContext("2d"),td._fonts={},td.METRICS_STRING="|\xC9q\xC5",td.BASELINE_SYMBOL="M",td.BASELINE_MULTIPLIER=1.4,td._newlines=[10,13],td._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var wga={texture:!0,children:!1,baseTexture:!0},wg=function(t){function e(e,i,r){var n=this,o=!1;r||(r=document.createElement("canvas"),o=!0),r.width=3,r.height=3;var s=ya.from(r);return s.orig=new La,s.trim=new La,(n=t.call(this,s)||this)._ownCanvas=o,n.canvas=r,n.context=n.canvas.getContext("2d"),n._resolution=ra.RESOLUTION,n._autoResolution=!0,n._text=null,n._style=null,n._styleListener=null,n._font="",n.text=e,n.style=i,n.localStyleID=-1,n}return tga(e,t),e.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var i,r,n=this.context,o=td.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=o.width,a=o.height,h=o.lines,l=o.lineHeight,c=o.lineWidths,p=o.maxLineWidth,u=o.fontProperties;this.canvas.width=Math.ceil((Math.max(1,s)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,a)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=e.strokeThickness,n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit;for(var f=e.dropShadow?2:1,d=0;d<f;++d){var g=e.dropShadow&&0===d,$=g?2*a:0,y=$*this.resolution;if(g){n.fillStyle="black",n.strokeStyle="black";var _=e.dropShadowColor,T=Bh("number"==typeof _?_:$p(_));n.shadowColor="rgba("+255*T[0]+","+255*T[1]+","+255*T[2]+","+e.dropShadowAlpha+")",n.shadowBlur=e.dropShadowBlur,n.shadowOffsetX=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance+y}else n.fillStyle=this._generateFillStyle(e,h,o),n.strokeStyle=e.stroke,n.shadowColor="0",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;for(var x=0;x<h.length;x++)i=e.strokeThickness/2,r=e.strokeThickness/2+x*l+u.ascent,"right"===e.align?i+=p-c[x]:"center"===e.align&&(i+=(p-c[x])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(h[x],i+e.padding,r+e.padding-$,!0),e.fill&&this.drawLetterSpacing(h[x],i+e.padding,r+e.padding-$)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,i,r){void 0===r&&(r=!1);var n=this._style.letterSpacing;if(0!==n)for(var o=e,s=Array.from?Array.from(t):t.split(""),a=this.context.measureText(t).width,h=0,l=0;l<s.length;++l){var c=s[l];r?this.context.strokeText(c,o,i):this.context.fillText(c,o,i),o+=a-(h=this.context.measureText(t.substring(l+1)).width)+n,a=h}else r?this.context.strokeText(t,e,i):this.context.fillText(t,e,i)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=zF(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var i=this._texture,r=this._style,n=r.trim?0:r.padding,o=i.baseTexture;i.trim.width=i._frame.width=Math.ceil(t.width/this._resolution),i.trim.height=i._frame.height=Math.ceil(t.height/this._resolution),i.trim.x=-n,i.trim.y=-n,i.orig.width=i._frame.width-2*n,i.orig.height=i._frame.height-2*n,this._onTextureUpdate(),o.setRealSize(t.width,t.height,this._resolution),this._recursivePostUpdateTransform(),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,e,i){var r,n=t.fill;if(!Array.isArray(n))return n;if(1===n.length)return n[0];var o=t.dropShadow?t.dropShadowDistance:0,s=t.padding||0,a=Math.ceil(this.canvas.width/this._resolution)-o-2*s,h=Math.ceil(this.canvas.height/this._resolution)-o-2*s,l=n.slice(),c=t.fillGradientStops.slice();if(!c.length)for(var p=l.length+1,u=1;u<p;++u)c.push(u/p);if(l.unshift(n[0]),c.unshift(0),l.push(n[n.length-1]),c.push(1),t.fillGradientType===ck.LINEAR_VERTICAL){r=this.context.createLinearGradient(a/2,s,a/2,h+s);var f=0,d=(i.fontProperties.fontSize+t.strokeThickness)/h;for(u=0;u<e.length;u++)for(var g=i.lineHeight*u,$=0;$<l.length;$++){var y=g/h+("number"==typeof c[$]?c[$]:$/l.length)*d,_=Math.max(f,y);_=Math.min(_,1),r.addColorStop(_,l[$]),f=_}}else{r=this.context.createLinearGradient(s,h/2,a+s,h/2);var T=l.length+1,x=1;for(u=0;u<l.length;u++){var S=void 0;S="number"==typeof c[u]?c[u]:x/T,r.addColorStop(S,l[u]),x++}}return r},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},wga,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=Dh(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=Dh(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof Qh?t:new Qh(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e}(Ph);bk.TextStyle=Qh,bk.TextMetrics=td,bk.Text=wg,bk.TEXT_GRADIENT=ck;ra.UPLOADS_PER_FRAME=4;var xga=function(e,t){return(xga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function yga(e,t){function r(){this.constructor=e}xga(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var vH=function(){function e(e){this.maxItemsPerFrame=e,this.itemsLeft=0}return e.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},e.prototype.allowedToUpload=function(){return this.itemsLeft-->0},e}();function zga(e,t){var r=!1;if(e&&e._textures&&e._textures.length)for(var i=0;i<e._textures.length;i++)if(e._textures[i]instanceof ya){var o=e._textures[i].baseTexture;-1===t.indexOf(o)&&(t.push(o),r=!0)}return r}function Aga(e,t){if(e.baseTexture instanceof gb){var r=e.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function Bga(e,t){if(e._texture&&e._texture instanceof ya){var r=e._texture.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function Cga(e,t){return t instanceof wg&&(t.updateText(!0),!0)}function Dga(e,t){if(t instanceof Qh){var r=t.toFontString();return td.measureFont(r),!0}return!1}function Ega(e,t){if(e instanceof wg){-1===t.indexOf(e.style)&&t.push(e.style),-1===t.indexOf(e)&&t.push(e);var r=e._texture.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function Fga(e,t){return e instanceof Qh&&(-1===t.indexOf(e)&&t.push(e),!0)}var wH=function(){function e(e){var t=this;this.limiter=new vH(ra.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){t.queue&&t.prepareItems()},this.registerFindHook(Ega),this.registerFindHook(Fga),this.registerFindHook(zga),this.registerFindHook(Aga),this.registerFindHook(Bga),this.registerUploadHook(Cga),this.registerUploadHook(Dga)}return e.prototype.upload=function(e,t){"function"==typeof e&&(t=e,e=null),e&&this.add(e),this.queue.length?(t&&this.completes.push(t),this.ticking||(this.ticking=!0,Nb.system.addOnce(this.tick,this,Be.UTILITY))):t&&t()},e.prototype.tick=function(){setTimeout(this.delayedTick,0)},e.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],t=!1;if(e&&!e._destroyed)for(var r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}t||this.queue.shift()}if(this.queue.length)Nb.system.addOnce(this.tick,this,Be.UTILITY);else{this.ticking=!1;var o=this.completes.slice(0);this.completes.length=0;for(r=0,i=o.length;r<i;r++)o[r]()}},e.prototype.registerFindHook=function(e){return e&&this.addHooks.push(e),this},e.prototype.registerUploadHook=function(e){return e&&this.uploadHooks.push(e),this},e.prototype.add=function(e){for(var t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof qd)for(t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this},e.prototype.destroy=function(){this.ticking&&Nb.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},e}();function xH(e,t){return t instanceof gb&&(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0)}function Gga(e,t){if(!(t instanceof sd))return!1;var r=t.geometry;t.finishPoly(),r.updateBatches();for(var i=r.batches,o=0;o<i.length;o++){var n=i[o].style.texture;n&&xH(e,n.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function Hga(e,t){return e instanceof sd&&(t.push(e),!0)}var yH=function(e){function t(t){var r=e.call(this,t)||this;return r.uploadHookHelper=r.renderer,r.registerFindHook(Hga),r.registerUploadHook(xH),r.registerUploadHook(Gga),r}return yga(t,e),t}(wH),Iga=function(){function e(e){this.maxMilliseconds=e,this.frameStart=0}return e.prototype.beginFrame=function(){this.frameStart=Date.now()},e.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},e}();Mm.TimeLimiter=Iga,Mm.Prepare=yH,Mm.CountLimiter=vH,Mm.BasePrepare=wH;var Iv={};var zH=function(){function t(t,e,r){void 0===r&&(r=null),this._texture=t instanceof ya?t:null,this.baseTexture=t instanceof gb?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var s=this.baseTexture.resource;this.resolution=this._updateResolution(r||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return t.prototype._updateResolution=function(t){void 0===t&&(t=null);var e=this.data.meta.scale,r=Am(t,null);return null===r&&(r=void 0!==e?parseFloat(e):1),1!==r&&this.baseTexture.setResolution(r),r},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},t.prototype._processFrames=function(e){for(var r=e,s=t.BATCH_SIZE;r-e<s&&r<this._frameKeys.length;){var i=this._frameKeys[r],o=this._frames[i],a=o.frame;if(a){var n=null,h=null,l=!1!==o.trimmed&&o.sourceSize?o.sourceSize:o.frame,u=new La(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);n=o.rotated?new La(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):new La(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),!1!==o.trimmed&&o.spriteSourceSize&&(h=new La(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[i]=new ya(this.baseTexture,n,u,h,o.rotated?2:0,o.anchor),ya.addToCache(this.textures[i],i)}r++}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var r=0;r<t[e].length;r++){var s=t[e][r];this.animations[e].push(this.textures[s])}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())},0)},t.prototype.destroy=function(t){var e;for(var r in void 0===t&&(t=!1),this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(e=this._texture)||void 0===e||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},t.BATCH_SIZE=1e3,t}(),AH=function(){function t(){}return t.use=function(e,r){var s=e.name+"_image";if(e.data&&e.type===Lm.TYPE.JSON&&e.data.frames&&!this.resources[s]){var i={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},o=t.getResourcePath(e,this.baseUrl);this.add(s,o,i,function(t){if(t.error)r(t.error);else{var s=new zH(t.texture,e.data,e.url);s.parse(function(){e.spritesheet=s,e.textures=s.textures,r()})}})}else r()},t.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:qF.d.resolve(t.url.replace(e,""),t.data.meta.image)},t}();Iv.SpritesheetLoader=AH,Iv.Spritesheet=zH;var Jv={};var Jga=function(t,r){return(Jga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(t,r)};function BH(t,r){function e(){this.constructor=t}Jga(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}var Qm=new Da,Kga=function(t){function r(r,e,i){void 0===e&&(e=100),void 0===i&&(i=100);var o=t.call(this,r)||this;return o.tileTransform=new Wu,o._width=e,o._height=i,o.uvMatrix=r.uvMatrix||new mq(r),o.pluginName="tilingSprite",o.uvRespectAnchor=!1,o}return BH(r,t),Object.defineProperty(r.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),r.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},r.prototype._render=function(t){var r=this._texture;r&&r.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},r.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,r=this._height*-this._anchor._y,e=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,r,e,i)},r.prototype.getLocalBounds=function(r){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),r||(this._localBoundsRect||(this._localBoundsRect=new La),r=this._localBoundsRect),this._bounds.getRectangle(r)):t.prototype.getLocalBounds.call(this,r)},r.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Qm);var r=this._width,e=this._height,i=-r*this.anchor._x;if(Qm.x>=i&&Qm.x<i+r){var o=-e*this.anchor._y;if(Qm.y>=o&&Qm.y<o+e)return!0}return!1},r.prototype.destroy=function(r){t.prototype.destroy.call(this,r),this.tileTransform=null,this.uvMatrix=null},r.from=function(t,e){return"number"==typeof e&&(ea("5.3.0","TilingSprite.from use options instead of width and height args"),e={width:e,height:arguments[2]}),new r(ya.from(t,e),e.width,e.height)},Object.defineProperty(r.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),r}(Ph),CH="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",Lga="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord - floor(vTextureCoord - uClampOffset);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n",Mga="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",vq=new Lb,DH=function(t){function r(r){var e=t.call(this,r)||this,i={globals:e.renderer.globalUniforms};return e.shader=ug.from(CH,Lga,i),e.simpleShader=ug.from(CH,Mga,i),e.quad=new fv,e.state=vg.for2d(),e}return BH(r,t),r.prototype.render=function(t){var r=this.renderer,e=this.quad,i=e.vertices;i[0]=i[6]=t._width*-t.anchor.x,i[1]=i[3]=t._height*-t.anchor.y,i[2]=i[4]=t._width*(1-t.anchor.x),i[5]=i[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((i=e.uvs)[0]=i[6]=-t.anchor.x,i[1]=i[3]=-t.anchor.y,i[2]=i[4]=1-t.anchor.x,i[5]=i[7]=1-t.anchor.y),e.invalidate();var o=t._texture,n=o.baseTexture,a=t.tileTransform.localTransform,p=t.uvMatrix,s=n.isPowerOfTwo&&o.frame.width===n.width&&o.frame.height===n.height;s&&(n._glTextures[r.CONTEXT_UID]?s=n.wrapMode!==nf.CLAMP:n.wrapMode===nf.CLAMP&&(n.wrapMode=nf.REPEAT));var u=s?this.simpleShader:this.shader,h=o.width,$=o.height,M=t._width,m=t._height;vq.set(a.a*h/M,a.b*h/m,a.c*$/M,a.d*$/m,a.tx/M,a.ty/m),vq.invert(),s?vq.prepend(p.mapCoord):(u.uniforms.uMapCoord=p.mapCoord.toArray(!0),u.uniforms.uClampFrame=p.uClampFrame,u.uniforms.uClampOffset=p.uClampOffset),u.uniforms.uTransform=vq.toArray(!0),u.uniforms.uColor=Ou(t.tint,t.worldAlpha,u.uniforms.uColor,n.alphaMode),u.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),u.uniforms.uSampler=o,r.shader.bind(u),r.geometry.bind(e),this.state.blendMode=Nu(t.blendMode,n.alphaMode),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},r}(Fm);Jv.TilingSpriteRenderer=DH,Jv.TilingSprite=Kga;var Rm={};var Sm={};var Nga=function(t,e){return(Nga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function Kv(t,e){function r(){this.constructor=t}Nga(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var EH=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},t}(),Lv=new Da,FH=new Vj,dk=function(t){function e(e,r,a,i){void 0===i&&(i=od.TRIANGLES);var n=t.call(this)||this;return n.geometry=e,e.refCount++,n.shader=r,n.state=a||vg.for2d(),n.drawMode=i,n.start=0,n.size=0,n.uvs=null,n.indices=null,n.vertexData=new Float32Array(1),n.vertexDirty=0,n._transformID=-1,n.tint=16777215,n.blendMode=sa.NORMAL,n._roundPixels=ra.ROUND_PIXELS,n.batchUvs=null,n}return Kv(e,t),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this.shader.tint},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===od.TRIANGLES&&r.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var r=this.transform.worldTransform,a=r.a,i=r.b,n=r.c,o=r.d,s=r.tx,h=r.ty,u=this.vertexData,p=0;p<u.length/2;p++){var l=e[2*p],$=e[2*p+1];u[2*p]=a*l+n*$+s,u[2*p+1]=i*l+o*$+h}if(this._roundPixels){var d=ra.RESOLUTION;for(p=0;p<u.length;++p)u[p]=Math.round((u[p]*d|0)/d)}this.vertexDirty=t.vertexDirtyId}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new EH(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Lv);for(var e=this.geometry.getBuffer("aVertexPosition").data,r=FH.points,a=this.geometry.getIndex().data,i=a.length,n=4===this.drawMode?3:1,o=0;o+2<i;o+=n){var s=2*a[o],h=2*a[o+1],u=2*a[o+2];if(r[0]=e[s],r[1]=e[s+1],r[2]=e[h],r[3]=e[h+1],r[4]=e[u],r[5]=e[u+1],FH.contains(Lv.x,Lv.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}(qd),Oga="varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n",Pga="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n",Tm=function(t){function e(e,r){var a=this,i={uSampler:e,alpha:1,uTextureMatrix:Lb.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r)).uniforms&&Object.assign(i,r.uniforms),(a=t.call(this,r.program||Gm.from(Pga,Oga),i)||this)._colorDirty=!1,a.uvMatrix=new mq(e),a.batchable=void 0===r.program,a.pluginName=r.pluginName,a.tint=r.tint,a.alpha=r.alpha,a}return Kv(e,t),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;Ou(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(ug),Um=function(t){function e(e,r,a){var i=t.call(this)||this,n=new Yb(e),o=new Yb(r,!0),s=new Yb(a,!0,!0);return i.addAttribute("aVertexPosition",n,2,!1,Kb.FLOAT).addAttribute("aTextureCoord",o,2,!1,Kb.FLOAT).addIndex(s),i._updateId=-1,i}return Kv(e,t),Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(Yj);Sm.MeshMaterial=Tm,Sm.MeshGeometry=Um,Sm.MeshBatchUvs=EH,Sm.Mesh=dk;var Qga=function(t,e){return(Qga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function Rga(t,e){function r(){this.constructor=t}Qga(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Vm=function(){return function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]}}(),Sga=function(){function t(){}return t.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=")},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[]};for(var i in e){var a=e[i].match(/^[a-z]+/gm)[0],n=e[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(var s in n){var h=n[s].split("="),l=h[0],p=h[1].replace(/"/gm,""),f=parseFloat(p),c=isNaN(f)?p:f;o[l]=c}r[a].push(o)}var u=new Vm;return r.info.forEach(function(t){return u.info.push({face:t.face,size:parseInt(t.size,10)})}),r.common.forEach(function(t){return u.common.push({lineHeight:parseInt(t.lineHeight,10)})}),r.page.forEach(function(t){return u.page.push({id:parseInt(t.id,10),file:t.file})}),r.char.forEach(function(t){return u.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})}),r.kerning.forEach(function(t){return u.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})}),u},t}(),Tga=function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},t.parse=function(t){for(var e=new Vm,r=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),a=t.getElementsByTagName("page"),n=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning"),s=0;s<r.length;s++)e.info.push({face:r[s].getAttribute("face"),size:parseInt(r[s].getAttribute("size"),10)});for(s=0;s<i.length;s++)e.common.push({lineHeight:parseInt(i[s].getAttribute("lineHeight"),10)});for(s=0;s<a.length;s++)e.page.push({id:parseInt(a[s].getAttribute("id"),10)||0,file:a[s].getAttribute("file")});for(s=0;s<n.length;s++){var h=n[s];e.char.push({id:parseInt(h.getAttribute("id"),10),page:parseInt(h.getAttribute("page"),10)||0,x:parseInt(h.getAttribute("x"),10),y:parseInt(h.getAttribute("y"),10),width:parseInt(h.getAttribute("width"),10),height:parseInt(h.getAttribute("height"),10),xoffset:parseInt(h.getAttribute("xoffset"),10),yoffset:parseInt(h.getAttribute("yoffset"),10),xadvance:parseInt(h.getAttribute("xadvance"),10)})}for(s=0;s<o.length;s++)e.kerning.push({first:parseInt(o[s].getAttribute("first"),10),second:parseInt(o[s].getAttribute("second"),10),amount:parseInt(o[s].getAttribute("amount"),10)});return e},t}(),Mv=[Sga,Tga];function GH(t){for(var e=0;e<Mv.length;e++)if(Mv[e].test(t))return Mv[e];return null}function HH(t,e,r,i,a,n){var o,s=r.fill;if(!Array.isArray(s))return s;if(1===s.length)return s[0];var h=r.dropShadow?r.dropShadowDistance:0,l=r.padding||0,p=Math.ceil(t.width/i)-h-2*l,f=Math.ceil(t.height/i)-h-2*l,c=s.slice(),u=r.fillGradientStops.slice();if(!u.length)for(var x=c.length+1,$=1;$<x;++$)u.push($/x);if(c.unshift(s[0]),u.unshift(0),c.push(s[s.length-1]),u.push(1),r.fillGradientType===ck.LINEAR_VERTICAL){o=e.createLinearGradient(p/2,l,p/2,f+l);var g=0,d=(n.fontProperties.fontSize+r.strokeThickness)/f;for($=0;$<a.length;$++)for(var m=n.lineHeight*$,v=0;v<c.length;v++){var w=m/f+("number"==typeof u[v]?u[v]:v/c.length)*d,y=Math.max(g,w);y=Math.min(y,1),o.addColorStop(y,c[v]),g=y}}else{o=e.createLinearGradient(l,f/2,p+l,f/2);var O=c.length+1,L=1;for($=0;$<c.length;$++){var b=void 0;b="number"==typeof u[$]?u[$]:L/O,o.addColorStop(b,c[$]),L++}}return o}function Uga(t,e,r,i,a,n,o){var s=r.text,h=r.fontProperties;e.translate(i,a),e.scale(n,n);var l=o.strokeThickness/2,p=-o.strokeThickness/2;e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=HH(t,e,o,n,[s],r),e.strokeStyle=o.stroke,e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=HH(t,e,o,n,[s],r),e.strokeStyle=o.stroke;var f=o.dropShadowColor,c=Bh("number"==typeof f?f:$p(f));o.dropShadow?(e.shadowColor="rgba("+255*c[0]+","+255*c[1]+","+255*c[2]+","+o.dropShadowAlpha+")",e.shadowBlur=o.dropShadowBlur,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*o.dropShadowDistance,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*o.dropShadowDistance):(e.shadowColor="0",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),o.stroke&&o.strokeThickness&&e.strokeText(s,l,p+r.lineHeight-h.descent),o.fill&&e.fillText(s,l,p+r.lineHeight-h.descent),e.setTransform(),e.fillStyle="rgba(0, 0, 0, 0)"}function Vga(t){"string"==typeof t&&(t=[t]);for(var e=[],r=0,i=t.length;r<i;r++){var a=t[r];if(Array.isArray(a)){if(2!==a.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+a.length+".");var n=a[0].charCodeAt(0),o=a[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(var s=n,h=o;s<=h;s++)e.push(String.fromCharCode(s))}else e.push.apply(e,a.split(""))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}var xg=function(){function t(t,e){var r=t.info[0],i=t.common[0],a=t.page[0],n=Am(a.file),o={};this.font=r.face,this.size=r.size,this.lineHeight=i.lineHeight/n,this.chars={},this.pageTextures=o;for(var s=0;s<t.page.length;s++){var h=t.page[s],l=h.id,p=h.file;o[l]=e instanceof Array?e[s]:e[p]}for(s=0;s<t.char.length;s++){var f=t.char[s],c=(l=f.id,f.page),u=t.char[s],x=u.x,$=u.y,g=u.width,d=u.height,m=u.xoffset,v=u.yoffset,w=u.xadvance;$/=n,g/=n,d/=n,m/=n,v/=n,w/=n;var y=new La((x/=n)+o[c].frame.x/n,$+o[c].frame.y/n,g,d);this.chars[l]={xOffset:m,yOffset:v,xAdvance:w,kerning:{},texture:new ya(o[c].baseTexture,y),page:c}}for(s=0;s<t.kerning.length;s++){var O=t.kerning[s],L=O.first,b=O.second,_=O.amount;L/=n,b/=n,_/=n,this.chars[b]&&(this.chars[b].kerning[L]=_)}}return t.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},t.install=function(e,r){var i;if(e instanceof Vm)i=e;else{var a=GH(e);if(!a)throw new Error("Unrecognized data format for font.");i=a.parse(e)}r instanceof ya&&(r=[r]);var n=new t(i,r);return t.available[n.font]=n,n},t.uninstall=function(e){var r=t.available[e];if(!r)throw new Error("No font found named '"+e+"'");r.destroy(),delete t.available[e]},t.from=function(e,r,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var a=Object.assign({},t.defaultOptions,i),n=a.chars,o=a.padding,s=a.resolution,h=a.textureWidth,l=a.textureHeight,p=Vga(n),f=r instanceof Qh?r:new Qh(r),c=h,u=new Vm;u.info[0]={face:f.fontFamily,size:f.fontSize},u.common[0]={lineHeight:f.fontSize};for(var x,$,g,d=0,m=0,v=0,w=[],y=0;y<p.length;y++){x||((x=document.createElement("canvas")).width=h,x.height=l,$=x.getContext("2d"),g=new gb(x,{resolution:s}),w.push(new ya(g)),u.page.push({id:w.length-1,file:""}));var O=td.measureText(p[y],f,!1,x),L=O.width,b=Math.ceil(O.height),_=Math.ceil(("italic"===f.fontStyle?2:1)*L);if(m>=l-b*s){if(0===m)throw new Error("[BitmapFont] textureHeight "+l+"px is too small for "+f.fontSize+"px fonts");--y,x=null,$=null,g=null,m=0,d=0,v=0}else if(v=Math.max(b+O.fontProperties.descent,v),_*s+d>=c)--y,m+=v*s,m=Math.ceil(m),d=0,v=0;else{Uga(x,$,O,d,m,s,f);var S=O.text.charCodeAt(0);u.char.push({id:S,page:w.length-1,x:d/s,y:m/s,width:_,height:b,xoffset:0,yoffset:0,xadvance:Math.ceil(L-(f.dropShadow?f.dropShadowDistance:0)-(f.stroke?f.strokeThickness:0))}),d+=(_+2*o)*s,d=Math.ceil(d)}}var T=new t(u,w);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=T,T},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t}(),IH=[],JH=[],Wga=function(t){function e(r,i){void 0===i&&(i={});var a=t.call(this)||this;a._tint=16777215,i.font&&(ea("5.3.0","PIXI.BitmapText constructor style.font property is deprecated."),a._upgradeStyle(i));var n=Object.assign({},e.styleDefaults,i),o=n.align,s=n.tint,h=n.maxWidth,l=n.letterSpacing,p=n.fontName,f=n.fontSize;if(!xg.available[p])throw new Error("Missing BitmapFont \""+p+"\"");return a._activePagesMeshData=[],a._textWidth=0,a._textHeight=0,a._align=o,a._tint=s,a._fontName=p,a._fontSize=f||xg.available[p].size,a._text=r,a._maxWidth=h,a._maxLineHeight=0,a._letterSpacing=l,a._anchor=new Fh(function(){a.dirty=!0},a,0,0),a.roundPixels=ra.ROUND_PIXELS,a.dirty=!0,a}return Rga(e,t),e.prototype.updateText=function(){for(var t,e=xg.available[this._fontName],r=this._fontSize/e.size,i=new Da,a=[],n=[],o=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",s=o.length,h=this._maxWidth*e.size/this._fontSize,l=null,p=0,f=0,c=0,u=-1,x=0,$=0,g=0,d=0;d<s;d++){var m=o.charCodeAt(d),v=o.charAt(d);if(/(?:\s)/.test(v)&&(u=d,x=p),"\r"!==v&&"\n"!==v){var w=e.chars[m];if(w){l&&w.kerning[l]&&(i.x+=w.kerning[l]);var y=JH.pop()||{texture:ya.EMPTY,line:0,charCode:0,position:new Da};y.texture=w.texture,y.line=c,y.charCode=m,y.position.x=i.x+w.xOffset+this._letterSpacing/2,y.position.y=i.y+w.yOffset,a.push(y),i.x+=w.xAdvance+this._letterSpacing,p=i.x,g=Math.max(g,w.yOffset+w.texture.height),l=m,-1!==u&&h>0&&i.x>h&&(++$,Ch(a,1+u-$,1+d-u),d=u,u=-1,n.push(x),f=Math.max(f,x),c++,i.x=0,i.y+=e.lineHeight,l=null)}}else n.push(p),f=Math.max(f,p),++c,++$,i.x=0,i.y+=e.lineHeight,l=null}var O=o.charAt(o.length-1);"\r"!==O&&"\n"!==O&&(/(?:\s)/.test(O)&&(p=x),n.push(p),f=Math.max(f,p));var L=[];for(d=0;d<=c;d++){var b=0;"right"===this._align?b=f-n[d]:"center"===this._align&&(b=(f-n[d])/2),L.push(b)}var _=a.length,S={},T=[],A=this._activePagesMeshData;for(d=0;d<A.length;d++)IH.push(A[d]);for(d=0;d<_;d++){var B=(M=a[d].texture).baseTexture.uid;if(!S[B]){if(!(N=IH.pop())){var I=new Um,F=new Tm(ya.EMPTY);N={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new dk(I,F),vertices:null,uvs:null,indices:null}}N.index=0,N.indexCount=0,N.vertexCount=0,N.uvsCount=0,N.total=0,N.mesh.texture=new ya(M.baseTexture),N.mesh.tint=this._tint,T.push(N),S[B]=N}S[B].total++}for(d=0;d<A.length;d++)-1===T.indexOf(A[d])&&this.removeChild(A[d].mesh);for(d=0;d<T.length;d++)T[d].mesh.parent!==this&&this.addChild(T[d].mesh);for(var d in this._activePagesMeshData=T,S){var P=(N=S[d]).total;(null===(t=N.indices)||void 0===t?void 0:t.length)>6*P&&!(N.vertices.length<2*dk.BATCHABLE_SIZE)||(N.vertices=new Float32Array(8*P),N.uvs=new Float32Array(8*P),N.indices=new Uint16Array(6*P)),N.mesh.size=6*P}for(d=0;d<_;d++){var M,E=((v=a[d]).position.x+L[v.line])*r,k=v.position.y*r,z=S[(M=v.texture).baseTexture.uid],D=M.frame,C=M._uvs,H=z.index++;z.indices[6*H+0]=0+4*H,z.indices[6*H+1]=1+4*H,z.indices[6*H+2]=2+4*H,z.indices[6*H+3]=0+4*H,z.indices[6*H+4]=2+4*H,z.indices[6*H+5]=3+4*H,z.vertices[8*H+0]=E,z.vertices[8*H+1]=k,z.vertices[8*H+2]=E+D.width*r,z.vertices[8*H+3]=k,z.vertices[8*H+4]=E+D.width*r,z.vertices[8*H+5]=k+D.height*r,z.vertices[8*H+6]=E,z.vertices[8*H+7]=k+D.height*r,z.uvs[8*H+0]=C.x0,z.uvs[8*H+1]=C.y0,z.uvs[8*H+2]=C.x1,z.uvs[8*H+3]=C.y1,z.uvs[8*H+4]=C.x2,z.uvs[8*H+5]=C.y2,z.uvs[8*H+6]=C.x3,z.uvs[8*H+7]=C.y3}for(var d in this._textWidth=f*r,this._textHeight=(i.y+e.lineHeight)*r,S){var N=S[d];if(0!==this.anchor.x||0!==this.anchor.y)for(var j=0,R=this._textWidth*this.anchor.x,U=this._textHeight*this.anchor.y,W=0;W<N.total;W++)N.vertices[j++]-=R,N.vertices[j++]-=U,N.vertices[j++]-=R,N.vertices[j++]-=U,N.vertices[j++]-=R,N.vertices[j++]-=U,N.vertices[j++]-=R,N.vertices[j++]-=U;this._maxLineHeight=g*r;var X=N.mesh.geometry.getBuffer("aVertexPosition"),q=N.mesh.geometry.getBuffer("aTextureCoord"),G=N.mesh.geometry.getIndex();X.data=N.vertices,q.data=N.uvs,G.data=N.indices,X.update(),q.update(),G.update()}for(d=0;d<a.length;d++)JH.push(a[d])},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!xg.available[t])throw new Error("Missing BitmapFont \""+t+"\"");this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),e.prototype._upgradeStyle=function(t){if("string"==typeof t.font){var e=t.font.split(" ");t.fontName=1===e.length?e[0]:e.slice(1).join(" "),e.length>=2&&(t.fontSize=parseInt(e[0],10))}else t.fontName=t.font.name,t.fontSize="number"==typeof t.font.size?t.font.size:parseInt(t.font.size,10)},e.registerFont=function(t,e){return ea("5.3.0","PIXI.BitmapText.registerFont is deprecated, use PIXI.BitmapFont.install"),xg.install(t,e)},Object.defineProperty(e,"fonts",{get:function(){return ea("5.3.0","PIXI.BitmapText.fonts is deprecated, use PIXI.BitmapFont.available"),xg.available},enumerable:!1,configurable:!0}),e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},e}(qd),KH=function(){function t(){}return t.add=function(){Lm.setExtensionXhrType("fnt",Lm.XHR_RESPONSE_TYPE.DOCUMENT)},t.use=function(e,r){var i=GH(e.data);if(i)for(var a=t.getBaseUrl(this,e),n=i.parse(e.data),o={},s=function(t){o[t.metadata.pageFile]=t.texture,Object.keys(o).length===n.page.length&&(e.bitmapFont=xg.install(n,o),r())},h=0;h<n.page.length;++h){var l=n.page[h].file,p=a+l,f=!1;for(var c in this.resources){var u=this.resources[c];if(u.url===p){u.metadata.pageFile=l,u.texture?s(u):u.onAfterMiddleware.add(s),f=!0;break}}if(!f){var x={crossOrigin:e.crossOrigin,loadType:Lm.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:l},e.metadata.imageMetadata),parentResource:e};this.add(p,x,s)}}else r()},t.getBaseUrl=function(e,r){var i=r.isDataUrl?"":t.dirname(r.url);return r.isDataUrl&&("."===i&&(i=""),e.baseUrl&&i&&"/"===e.baseUrl.charAt(e.baseUrl.length-1)&&(i+="/")),(i=i.replace(e.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/"),i},t.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},t}();Rm.BitmapText=Wga,Rm.BitmapFontLoader=KH,Rm.BitmapFontData=Vm,Rm.BitmapFont=xg;var Xga=function(t,r){return(Xga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(t,r)};function Yga(t,r){function e(){this.constructor=t}Xga(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}var Zga="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",$ga=function(t){function r(r){void 0===r&&(r=1);var e=t.call(this,JG,Zga,{uAlpha:1})||this;return e.alpha=r,e}return Yga(r,t),Object.defineProperty(r.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),r}(qf);var _ga=function(r,t){return(_ga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e])})(r,t)};function LH(r,t){function e(){this.constructor=r}_ga(r,t),r.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}var aha="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }";function bha(r,t){var e,i=Math.ceil(r/2),n=aha,E="";e=t?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var $=0;$<r;$++){var a=e.replace("%index%",$.toString());E+=a=a.replace("%sampleIndex%",$-(i-1)+".0"),E+="\n"}return n=(n=n.replace("%blur%",E)).replace("%size%",r.toString())}var cha,dha,eha,fha,gha,hha,iha,jha,kha,lha,mha,nha,wq,oha,pha,qha,rha,sha={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},tha=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");function uha(r){for(var t,e=sha[r],i=e.length,n=tha,E="",$=0;$<r;$++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",$.toString());t=$,$>=i&&(t=r-$-1),E+=a=a.replace("%value%",e[t].toString()),E+="\n"}return n=(n=n.replace("%blur%",E)).replace("%size%",r.toString())}!function(r){r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2"}(cha||(cha={})),function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS"}(dha||(dha={})),function(r){r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL"}(eha||(eha={})),function(r){r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR"}(fha||(fha={})),function(r){r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(gha||(gha={})),function(r){r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(hha||(hha={})),function(r){r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(iha||(iha={})),function(r){r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.FLOAT=5126]="FLOAT",r[r.HALF_FLOAT=36193]="HALF_FLOAT"}(jha||(jha={})),function(r){r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR"}(kha||(kha={})),function(r){r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(lha||(lha={})),function(r){r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON"}(mha||(mha={})),function(r){r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(nha||(nha={})),function(r){r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT"}(wq||(wq={})),function(r){r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL"}(oha||(oha={})),function(r){r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp"}(pha||(pha={})),function(r){r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE"}(qha||(qha={})),function(r){r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH"}(rha||(rha={}));var Nv=function(r){function t(t,e,i,n,E){void 0===e&&(e=8),void 0===i&&(i=4),void 0===n&&(n=ra.RESOLUTION),void 0===E&&(E=5);var $=this,a=bha(E,t),o=uha(E);return($=r.call(this,a,o)||this).horizontal=t,$.resolution=n,$._quality=0,$.quality=i,$.blur=e,$}return LH(t,r),t.prototype.apply=function(r,t,e,i){if(e?this.horizontal?this.uniforms.strength=1/e.width*(e.width/t.width):this.uniforms.strength=1/e.height*(e.height/t.height):this.horizontal?this.uniforms.strength=1/r.renderer.width*(r.renderer.width/t.width):this.uniforms.strength=1/r.renderer.height*(r.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)r.applyFilter(this,t,e,i);else{var n=r.getFilterTexture(),E=r.renderer,$=t,a=n;this.state.blend=!1,r.applyFilter(this,$,a,wq.CLEAR);for(var o=1;o<this.passes-1;o++){r.bindAndClear($,wq.BLIT),this.uniforms.uSampler=a;var _=a;a=$,$=_,E.shader.bind(this),E.geometry.draw(5)}this.state.blend=!0,r.applyFilter(this,a,e,i),r.returnFilterTexture(n)}},Object.defineProperty(t.prototype,"blur",{get:function(){return this.strength},set:function(r){this.padding=1+2*Math.abs(r),this.strength=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this._quality},set:function(r){this._quality=r,this.passes=r},enumerable:!1,configurable:!0}),t}(qf),vha=function(r){function t(t,e,i,n){void 0===t&&(t=8),void 0===e&&(e=4),void 0===i&&(i=ra.RESOLUTION),void 0===n&&(n=5);var E=r.call(this)||this;return E.blurXFilter=new Nv(!0,t,e,i,n),E.blurYFilter=new Nv(!1,t,e,i,n),E.resolution=i,E.quality=e,E.blur=t,E.repeatEdgePixels=!1,E}return LH(t,r),t.prototype.apply=function(r,t,e,i){var n=Math.abs(this.blurXFilter.strength),E=Math.abs(this.blurYFilter.strength);if(n&&E){var $=r.getFilterTexture();this.blurXFilter.apply(r,t,$,wq.CLEAR),this.blurYFilter.apply(r,$,e,i),r.returnFilterTexture($)}else E?this.blurYFilter.apply(r,t,e,i):this.blurXFilter.apply(r,t,e,i)},t.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(t.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(r){this.blurXFilter.blur=this.blurYFilter.blur=r,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(r){this.blurXFilter.quality=this.blurYFilter.quality=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(r){this.blurXFilter.blur=r,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(r){this.blurYFilter.blur=r,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(r){this.blurYFilter.blendMode=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(r){this._repeatEdgePixels=r,this.updatePadding()},enumerable:!1,configurable:!0}),t}(qf);var wha=function(t,r){return(wha=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])})(t,r)};function xha(t,r){function o(){this.constructor=t}wha(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}var yha="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",Ov=function(t){function r(){var r=this,o={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(r=t.call(this,qv,yha,o)||this).alpha=1,r}return xha(r,t),r.prototype._loadMatrix=function(t,r){void 0===r&&(r=!1);var o=t;r&&(this._multiply(o,this.uniforms.m,t),o=this._colorMatrix(o)),this.uniforms.m=o},r.prototype._multiply=function(t,r,o){return t[0]=r[0]*o[0]+r[1]*o[5]+r[2]*o[10]+r[3]*o[15],t[1]=r[0]*o[1]+r[1]*o[6]+r[2]*o[11]+r[3]*o[16],t[2]=r[0]*o[2]+r[1]*o[7]+r[2]*o[12]+r[3]*o[17],t[3]=r[0]*o[3]+r[1]*o[8]+r[2]*o[13]+r[3]*o[18],t[4]=r[0]*o[4]+r[1]*o[9]+r[2]*o[14]+r[3]*o[19]+r[4],t[5]=r[5]*o[0]+r[6]*o[5]+r[7]*o[10]+r[8]*o[15],t[6]=r[5]*o[1]+r[6]*o[6]+r[7]*o[11]+r[8]*o[16],t[7]=r[5]*o[2]+r[6]*o[7]+r[7]*o[12]+r[8]*o[17],t[8]=r[5]*o[3]+r[6]*o[8]+r[7]*o[13]+r[8]*o[18],t[9]=r[5]*o[4]+r[6]*o[9]+r[7]*o[14]+r[8]*o[19]+r[9],t[10]=r[10]*o[0]+r[11]*o[5]+r[12]*o[10]+r[13]*o[15],t[11]=r[10]*o[1]+r[11]*o[6]+r[12]*o[11]+r[13]*o[16],t[12]=r[10]*o[2]+r[11]*o[7]+r[12]*o[12]+r[13]*o[17],t[13]=r[10]*o[3]+r[11]*o[8]+r[12]*o[13]+r[13]*o[18],t[14]=r[10]*o[4]+r[11]*o[9]+r[12]*o[14]+r[13]*o[19]+r[14],t[15]=r[15]*o[0]+r[16]*o[5]+r[17]*o[10]+r[18]*o[15],t[16]=r[15]*o[1]+r[16]*o[6]+r[17]*o[11]+r[18]*o[16],t[17]=r[15]*o[2]+r[16]*o[7]+r[17]*o[12]+r[18]*o[17],t[18]=r[15]*o[3]+r[16]*o[8]+r[17]*o[13]+r[18]*o[18],t[19]=r[15]*o[4]+r[16]*o[9]+r[17]*o[14]+r[18]*o[19]+r[19],t},r.prototype._colorMatrix=function(t){var r=new Float32Array(t);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r},r.prototype.brightness=function(t,r){var o=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(o,r)},r.prototype.greyscale=function(t,r){var o=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(o,r)},r.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},r.prototype.hue=function(t,r){t=(t||0)/180*Math.PI;var o=Math.cos(t),n=Math.sin(t),e=1/3,a=(0,Math.sqrt)(e),i=[o+(1-o)*e,e*(1-o)-a*n,e*(1-o)+a*n,0,0,e*(1-o)+a*n,o+e*(1-o),e*(1-o)-a*n,0,0,e*(1-o)-a*n,e*(1-o)+a*n,o+e*(1-o),0,0,0,0,0,1,0];this._loadMatrix(i,r)},r.prototype.contrast=function(t,r){var o=(t||0)+1,n=-.5*(o-1),e=[o,0,0,0,n,0,o,0,0,n,0,0,o,0,n,0,0,0,1,0];this._loadMatrix(e,r)},r.prototype.saturate=function(t,r){void 0===t&&(t=0);var o=2*t/3+1,n=-.5*(o-1),e=[o,n,n,0,0,n,o,n,0,0,n,n,o,0,0,0,0,0,1,0];this._loadMatrix(e,r)},r.prototype.desaturate=function(){this.saturate(-1)},r.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},r.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},r.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},r.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},r.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},r.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},r.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},r.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},r.prototype.colorTone=function(t,r,o,n,e){var a=((o=o||16770432)>>16&255)/255,i=(o>>8&255)/255,l=(255&o)/255,u=((n=n||3375104)>>16&255)/255,p=(n>>8&255)/255,s=(255&n)/255,c=[.3,.59,.11,0,0,a,i,l,t=t||.2,0,u,p,s,r=r||.15,0,a-u,i-p,l-s,0,0];this._loadMatrix(c,e)},r.prototype.night=function(t,r){var o=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(o,r)},r.prototype.predator=function(t,r){var o=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(o,r)},r.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},r.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(r.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),r}(qf);Ov.prototype.grayscale=Ov.prototype.greyscale;var zha=function(r,t){return(zha=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e])})(r,t)};function Aha(r,t){function e(){this.constructor=r}zha(r,t),r.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}var Bha="varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",Cha="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n",Dha=function(r){function t(t,e){var n=this,i=new Lb;return t.renderable=!1,(n=r.call(this,Cha,Bha,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=t,n.maskMatrix=i,null==e&&(e=20),n.scale=new Da(e,e),n}return Aha(t,r),t.prototype.apply=function(r,t,e,n){this.uniforms.filterMatrix=r.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var i=this.maskSprite.worldTransform,o=Math.sqrt(i.a*i.a+i.b*i.b),a=Math.sqrt(i.c*i.c+i.d*i.d);0!==o&&0!==a&&(this.uniforms.rotation[0]=i.a/o,this.uniforms.rotation[1]=i.b/o,this.uniforms.rotation[2]=i.c/a,this.uniforms.rotation[3]=i.d/a),r.applyFilter(this,t,e,n)},Object.defineProperty(t.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(r){this.uniforms.mapSampler=r},enumerable:!1,configurable:!0}),t}(qf);var Eha=function(n,e){return(Eha=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r])})(n,e)};function Fha(n,e){function r(){this.constructor=n}Eha(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Gha="\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",Hha="varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputPixel;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it's\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n",Iha=function(n){function e(){return n.call(this,Gha,Hha)||this}return Fha(e,n),e}(qf);var Jha=function(n,e){return(Jha=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r])})(n,e)};function Kha(n,e){function r(){this.constructor=n}Jha(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Lha="precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",Mha=function(n){function e(e,r){void 0===e&&(e=.5),void 0===r&&(r=Math.random());var o=n.call(this,qv,Lha,{uNoise:0,uSeed:0})||this;return o.noise=e,o.seed=r,o}return Kha(e,n),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(n){this.uniforms.uNoise=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(n){this.uniforms.uSeed=n},enumerable:!1,configurable:!0}),e}(qf);var MH=new Lb;Mb.prototype._cacheAsBitmap=!1,Mb.prototype._cacheData=null;var Nha=function(){return function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}();Object.defineProperties(Mb.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var a;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new Nha),(a=this._cacheData).originalRender=this.render,a.originalRenderCanvas=this.renderCanvas,a.originalUpdateTransform=this.updateTransform,a.originalCalculateBounds=this.calculateBounds,a.originalGetLocalBounds=this.getLocalBounds,a.originalDestroy=this.destroy,a.originalContainsPoint=this.containsPoint,a.originalMask=this._mask,a.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((a=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=a.originalRender,this.renderCanvas=a.originalRenderCanvas,this.calculateBounds=a.originalCalculateBounds,this.getLocalBounds=a.originalGetLocalBounds,this.destroy=a.originalDestroy,this.updateTransform=a.originalUpdateTransform,this.containsPoint=a.originalContainsPoint,this._mask=a.originalMask,this.filterArea=a.originalFilterArea))}}}),Mb.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},Mb.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var a=this.alpha;this.alpha=1,t.batch.flush();var e=this.getLocalBounds(null,!0).clone();if(this.filters){var i=this.filters[0].padding;e.pad(i)}e.ceil(ra.RESOLUTION);var r=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),h=t.projection.transform,n=Kh.create({width:e.width,height:e.height}),o="cacheAsBitmap_"+Eh();this._cacheData.textureCacheId=o,gb.addToCache(n.baseTexture,o),ya.addToCache(n,o);var c=this.transform.localTransform.copyTo(MH).invert().translate(-e.x,-e.y);this.render=this._cacheData.originalRender,t.render(this,n,!0,c,!1),t.projection.transform=h,t.renderTexture.bind(r,s),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var l=new Ph(n);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-e.x/e.width,l.anchor.y=-e.y/e.height,l.alpha=a,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=l.containsPoint.bind(l)}},Mb.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},Mb.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var a=this.getLocalBounds(null,!0),e=this.alpha;this.alpha=1;var i=t.context,r=t._projTransform;a.ceil(ra.RESOLUTION);var s=Kh.create({width:a.width,height:a.height}),h="cacheAsBitmap_"+Eh();this._cacheData.textureCacheId=h,gb.addToCache(s.baseTexture,h),ya.addToCache(s,h);var n=MH;this.transform.localTransform.copyTo(n),n.invert(),n.tx-=a.x,n.ty-=a.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,s,!0,n,!1),t.context=i,t._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var o=new Ph(s);o.transform.worldTransform=this.transform.worldTransform,o.anchor.x=-a.x/a.width,o.anchor.y=-a.y/a.height,o.alpha=e,o._bounds=this._bounds,this._cacheData.sprite=o,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=o.containsPoint.bind(o)}},Mb.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},Mb.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},Mb.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,gb.removeFromCache(this._cacheData.textureCacheId),ya.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},Mb.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Mb.prototype.name=null,qd.prototype.getChildByName=function(i,r){for(var e=0,t=this.children.length;e<t;e++)if(this.children[e].name===i)return this.children[e];if(r)for(e=0,t=this.children.length;e<t;e++){if(this.children[e].getChildByName){var n=this.children[e].getChildByName(i,!0);if(n)return n}}return null};Mb.prototype.getGlobalPosition=function(i,t){return void 0===i&&(i=new Da),void 0===t&&(t=!1),this.parent?this.parent.toGlobal(this.position,i,t):(i.x=this.position.x,i.y=this.position.y),i};var Rh={};var Oha=function(t,e){return(Oha=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function ek(t,e){function i(){this.constructor=t}Oha(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var NH=function(t){function e(e,i,r,h){void 0===e&&(e=100),void 0===i&&(i=100),void 0===r&&(r=10),void 0===h&&(h=10);var o=t.call(this)||this;return o.segWidth=r,o.segHeight=h,o.width=e,o.height=i,o.build(),o}return ek(e,t),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],i=[],r=[],h=this.segWidth-1,o=this.segHeight-1,s=this.width/h,n=this.height/o,a=0;a<t;a++){var u=a%this.segWidth,p=a/this.segWidth|0;e.push(u*s,p*n),i.push(u/h,p/o)}var c=h*o;for(a=0;a<c;a++){var d=a%h,$=a/h|0,f=$*this.segWidth+d,g=$*this.segWidth+d+1,l=($+1)*this.segWidth+d,_=($+1)*this.segWidth+d+1;r.push(f,g,l,g,_,l)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(Um),OH=function(t){function e(e,i,r){void 0===e&&(e=200),void 0===r&&(r=0);var h=t.call(this,new Float32Array(4*i.length),new Float32Array(4*i.length),new Uint16Array(6*(i.length-1)))||this;return h.points=i,h._width=e,h.textureScale=r,h.build(),h}return ek(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),r=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),i.data=new Float32Array(4*t.length),r.data=new Uint16Array(6*(t.length-1)));var h=i.data,o=r.data;h[0]=0,h[1]=0,h[2]=0,h[3]=1;for(var s=0,n=t[0],a=this._width*this.textureScale,u=t.length,p=0;p<u;p++){var c=4*p;if(this.textureScale>0){var d=n.x-t[p].x,$=n.y-t[p].y,f=Math.sqrt(d*d+$*$);n=t[p],s+=f/a}else s=p/(u-1);h[c]=s,h[c+1]=0,h[c+2]=s,h[c+3]=1}var g=0;for(p=0;p<u-1;p++){c=2*p;o[g++]=c,o[g++]=c+1,o[g++]=c+2,o[g++]=c+2,o[g++]=c+1,o[g++]=c+3}i.update(),r.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,i=t[0],r=0,h=0,o=this.buffers[0].data,s=t.length,n=0;n<s;n++){var a=t[n],u=4*n;h=-((e=n<t.length-1?t[n+1]:a).x-i.x),r=e.y-i.y;var p=Math.sqrt(r*r+h*h),c=this.textureScale>0?this.textureScale*this._width/2:this._width/2;r/=p,h/=p,r*=c,h*=c,o[u]=a.x+r,o[u+1]=a.y+h,o[u+2]=a.x-r,o[u+3]=a.y-h,i=a}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(Um),Pha=function(t){function e(e,i,r){void 0===r&&(r=0);var h=this,o=new OH(e.height,i,r),s=new Tm(e);return r>0&&(e.baseTexture.wrapMode=nf.REPEAT),(h=t.call(this,o,s)||this).autoUpdate=!0,h}return ek(e,t),e.prototype._render=function(e){var i=this.geometry;(this.autoUpdate||i._width!==this.shader.texture.height)&&(i._width=this.shader.texture.height,i.update()),t.prototype._render.call(this,e)},e}(dk),PH=function(t){function e(e,i,r){var h=this,o=new NH(e.width,e.height,i,r),s=new Tm(ya.WHITE);return(h=t.call(this,o,s)||this).texture=e,h}return ek(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry;t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build()},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},e}(dk),Qha=function(t){function e(e,i,r,h,o){void 0===e&&(e=ya.EMPTY);var s=this,n=new Um(i,r,h);n.getBuffer("aVertexPosition").static=!1;var a=new Tm(e);return(s=t.call(this,n,a,null,o)||this).autoUpdate=!0,s}return ek(e,t),Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)},e}(dk),xq=10,Rha=function(t){function e(e,i,r,h,o){void 0===i&&(i=xq),void 0===r&&(r=xq),void 0===h&&(h=xq),void 0===o&&(o=xq);var s=t.call(this,ya.WHITE,4,4)||this;return s._origWidth=e.orig.width,s._origHeight=e.orig.height,s._width=s._origWidth,s._height=s._origHeight,s._leftWidth=i,s._rightWidth=h,s._topHeight=r,s._bottomHeight=o,s.texture=e,s}return ek(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,i=this._topHeight+this._bottomHeight,r=this._height>i?1:this._height/i;return Math.min(e,r)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var i=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=i*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-i*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},e}(PH);Rh.SimpleRope=Pha,Rh.SimplePlane=PH,Rh.SimpleMesh=Qha,Rh.RopeGeometry=OH,Rh.PlaneGeometry=NH,Rh.NineSlicePlane=Rha;var QH={};var Sha=function(t,e){return(Sha=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function Tha(t,e){function r(){this.constructor=t}Sha(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Uha=function(t){function e(e,r){void 0===r&&(r=!0);var i=t.call(this,e[0]instanceof ya?e[0]:e[0].texture)||this;return i._textures=null,i._durations=null,i._autoUpdate=r,i._isConnectedToTicker=!1,i.animationSpeed=1,i.loop=!0,i.updateAnchor=!1,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i._playing=!1,i._previousFrame=null,i.textures=e,i}return Tha(e,t),e.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Nb.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Nb.shared.add(this.update,this,Be.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){var e=this.animationSpeed*t,r=this.currentFrame;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];var o=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r?this.onLoop():this.animationSpeed<0&&this.currentFrame>r&&this.onLoop()),this.updateTexture())},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var r=[],i=0;i<t.length;++i)r.push(ya.from(t[i]));return new e(r)},e.fromImages=function(t){for(var r=[],i=0;i<t.length;++i)r.push(ya.from(t[i]));return new e(r)},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof ya)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Nb.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Nb.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),e}(Ph);QH.AnimatedSprite=Uha;Ya.utils=Ca,mb(Ya,Uu),mb(Ya,Wj),mb(Ya,QF),mb(Ya,xa),mb(Ya,RG),mb(Ya,Jm),mb(Ya,wv),mb(Ya,Mm),mb(Ya,Iv),mb(Ya,Jv),mb(Ya,Rm),mb(Ya,Dm),mb(Ya,Ka),mb(Ya,Bm),mb(Ya,rd),mb(Ya,kc),mb(Ya,Sm),mb(Ya,Rh),mb(Ya,RF),mb(Ya,tH),mb(Ya,QH),mb(Ya,bk),mb(Ya,Cu);var Vha=function(e,r){return(Vha=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)};function RH(e,r){function t(){this.constructor=e}Vha(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var la="5.0.0";function Wha(){var e=this;Object.defineProperties(e,{SVG_SIZE:{get:function(){return ea(la,"PIXI.utils.SVG_SIZE property has moved to PIXI.resources.SVGResource.SVG_SIZE"),e.SVGResource.SVG_SIZE}},TransformStatic:{get:function(){return ea(la,"PIXI.TransformStatic class has been removed, use PIXI.Transform"),e.Transform}},TransformBase:{get:function(){return ea(la,"PIXI.TransformBase class has been removed, use PIXI.Transform"),e.Transform}},TRANSFORM_MODE:{get:function(){return ea(la,"PIXI.TRANSFORM_MODE property has been removed"),{STATIC:0,DYNAMIC:1}}},WebGLRenderer:{get:function(){return ea(la,"PIXI.WebGLRenderer class has moved to PIXI.Renderer"),e.Renderer}},CanvasRenderTarget:{get:function(){return ea(la,"PIXI.CanvasRenderTarget class has moved to PIXI.utils.CanvasRenderTarget"),e.utils.CanvasRenderTarget}},loader:{get:function(){return ea(la,"PIXI.loader instance has moved to PIXI.Loader.shared"),e.Loader.shared}},FilterManager:{get:function(){return ea(la,"PIXI.FilterManager class has moved to PIXI.systems.FilterSystem"),e.systems.FilterSystem}},CanvasTinter:{get:function(){return ea("5.2.0","PIXI.CanvasTinter namespace has moved to PIXI.canvasUtils"),e.canvasUtils}},GroupD8:{get:function(){return ea("5.2.0","PIXI.GroupD8 namespace has moved to PIXI.groupD8"),e.groupD8}}}),e.accessibility={},Object.defineProperties(e.accessibility,{AccessibilityManager:{get:function(){return ea("5.3.0","PIXI.accessibility.AccessibilityManager moved to PIXI.AccessibilityManager"),e.AccessibilityManager}}}),e.interaction={},Object.defineProperties(e.interaction,{InteractionManager:{get:function(){return ea("5.3.0","PIXI.interaction.InteractionManager moved to PIXI.InteractionManager"),e.InteractionManager}},InteractionData:{get:function(){return ea("5.3.0","PIXI.interaction.InteractionData moved to PIXI.InteractionData"),e.InteractionData}},InteractionEvent:{get:function(){return ea("5.3.0","PIXI.interaction.InteractionEvent moved to PIXI.InteractionEvent"),e.InteractionEvent}}}),e.prepare={},Object.defineProperties(e.prepare,{BasePrepare:{get:function(){return ea("5.2.1","PIXI.prepare.BasePrepare moved to PIXI.BasePrepare"),e.BasePrepare}},Prepare:{get:function(){return ea("5.2.1","PIXI.prepare.Prepare moved to PIXI.Prepare"),e.Prepare}},CanvasPrepare:{get:function(){return ea("5.2.1","PIXI.prepare.CanvasPrepare moved to PIXI.CanvasPrepare"),e.CanvasPrepare}}}),e.extract={},Object.defineProperties(e.extract,{Extract:{get:function(){return ea("5.2.1","PIXI.extract.Extract moved to PIXI.Extract"),e.Extract}},CanvasExtract:{get:function(){return ea("5.2.1","PIXI.extract.CanvasExtract moved to PIXI.CanvasExtract"),e.CanvasExtract}}}),e.extras={},Object.defineProperties(e.extras,{TilingSprite:{get:function(){return ea(la,"PIXI.extras.TilingSprite class has moved to PIXI.TilingSprite"),e.TilingSprite}},TilingSpriteRenderer:{get:function(){return ea(la,"PIXI.extras.TilingSpriteRenderer class has moved to PIXI.TilingSpriteRenderer"),e.TilingSpriteRenderer}},AnimatedSprite:{get:function(){return ea(la,"PIXI.extras.AnimatedSprite class has moved to PIXI.AnimatedSprite"),e.AnimatedSprite}},BitmapText:{get:function(){return ea(la,"PIXI.extras.BitmapText class has moved to PIXI.BitmapText"),e.BitmapText}}}),e.TilingSprite.fromFrame=function(r,t,i){return ea("5.3.0","TilingSprite.fromFrame is deprecated, use TilingSprite.from"),e.TilingSprite.from(r,{width:t,height:i})},e.TilingSprite.fromImage=function(r,t,i,a){return void 0===a&&(a={}),ea("5.3.0","TilingSprite.fromImage is deprecated, use TilingSprite.from"),a&&"object"!=typeof a&&(a={scaleMode:arguments[4],resourceOptions:{crossorigin:arguments[3]}}),a.width=t,a.height=i,e.TilingSprite.from(r,a)},Object.defineProperties(e.utils,{getSvgSize:{get:function(){return ea(la,"PIXI.utils.getSvgSize function has moved to PIXI.resources.SVGResource.getSize"),e.resources.SVGResource.getSize}}}),e.mesh={},Object.defineProperties(e.mesh,{Mesh:{get:function(){return ea(la,"PIXI.mesh.Mesh class has moved to PIXI.SimpleMesh"),e.SimpleMesh}},NineSlicePlane:{get:function(){return ea(la,"PIXI.mesh.NineSlicePlane class has moved to PIXI.NineSlicePlane"),e.NineSlicePlane}},Plane:{get:function(){return ea(la,"PIXI.mesh.Plane class has moved to PIXI.SimplePlane"),e.SimplePlane}},Rope:{get:function(){return ea(la,"PIXI.mesh.Rope class has moved to PIXI.SimpleRope"),e.SimpleRope}},RawMesh:{get:function(){return ea(la,"PIXI.mesh.RawMesh class has moved to PIXI.Mesh"),e.Mesh}},CanvasMeshRenderer:{get:function(){return ea(la,"PIXI.mesh.CanvasMeshRenderer class has moved to PIXI.CanvasMeshRenderer"),e.CanvasMeshRenderer}},MeshRenderer:{get:function(){return ea(la,"PIXI.mesh.MeshRenderer class has moved to PIXI.MeshRenderer"),e.MeshRenderer}}}),e.particles={},Object.defineProperties(e.particles,{ParticleContainer:{get:function(){return ea(la,"PIXI.particles.ParticleContainer class has moved to PIXI.ParticleContainer"),e.ParticleContainer}},ParticleRenderer:{get:function(){return ea(la,"PIXI.particles.ParticleRenderer class has moved to PIXI.ParticleRenderer"),e.ParticleRenderer}}}),e.ticker={},Object.defineProperties(e.ticker,{Ticker:{get:function(){return ea(la,"PIXI.ticker.Ticker class has moved to PIXI.Ticker"),e.Ticker}},shared:{get:function(){return ea(la,"PIXI.ticker.shared instance has moved to PIXI.Ticker.shared"),e.Ticker.shared}}}),e.loaders={},Object.defineProperties(e.loaders,{Loader:{get:function(){return ea(la,"PIXI.loaders.Loader class has moved to PIXI.Loader"),e.Loader}},Resource:{get:function(){return ea(la,"PIXI.loaders.Resource class has moved to PIXI.LoaderResource"),e.LoaderResource}},bitmapFontParser:{get:function(){return ea(la,"PIXI.loaders.bitmapFontParser function has moved to PIXI.BitmapFontLoader.use"),e.BitmapFontLoader.use}},parseBitmapFontData:{get:function(){ea(la,"PIXI.loaders.parseBitmapFontData function has removed")}},spritesheetParser:{get:function(){return ea(la,"PIXI.loaders.spritesheetParser function has moved to PIXI.SpritesheetLoader.use"),e.SpritesheetLoader.use}},getResourcePath:{get:function(){return ea(la,"PIXI.loaders.getResourcePath property has moved to PIXI.SpritesheetLoader.getResourcePath"),e.SpritesheetLoader.getResourcePath}}}),e.Loader.addPixiMiddleware=function(r){return ea(la,"PIXI.loaders.Loader.addPixiMiddleware function is deprecated, use PIXI.loaders.Loader.registerPlugin"),e.loaders.Loader.registerPlugin({use:r()})};var r=function(e){return"on"+e.charAt(0).toUpperCase()+e.slice(1)};Object.assign(e.Loader.prototype,{on:function(e){var t=r(e);ea(la,"PIXI.Loader#on is completely deprecated, use PIXI.Loader#"+t+".add")},once:function(e){var t=r(e);ea(la,"PIXI.Loader#once is completely deprecated, use PIXI.Loader#"+t+".once")},off:function(e){var t=r(e);ea(la,"PIXI.Loader#off is completely deprecated, use PIXI.Loader#"+t+".detach")}}),Object.defineProperty(e.extract,"WebGLExtract",{get:function(){return ea(la,"PIXI.extract.WebGLExtract method has moved to PIXI.Extract"),e.Extract}}),Object.defineProperty(e.prepare,"WebGLPrepare",{get:function(){return ea(la,"PIXI.prepare.WebGLPrepare class has moved to PIXI.Prepare"),e.Prepare}}),e.Container.prototype._renderWebGL=function(e){ea(la,"PIXI.Container._renderWebGL method has moved to PIXI.Container._render"),this._render(e)},e.Container.prototype.renderWebGL=function(e){ea(la,"PIXI.Container.renderWebGL method has moved to PIXI.Container.render"),this.render(e)},e.DisplayObject.prototype.renderWebGL=function(e){ea(la,"PIXI.DisplayObject.renderWebGL method has moved to PIXI.DisplayObject.render"),this.render(e)},e.Container.prototype.renderAdvancedWebGL=function(e){ea(la,"PIXI.Container.renderAdvancedWebGL method has moved to PIXI.Container.renderAdvanced"),this.renderAdvanced(e)},Object.defineProperties(e.settings,{TRANSFORM_MODE:{get:function(){return ea(la,"PIXI.settings.TRANSFORM_MODE property has been removed"),0},set:function(){ea(la,"PIXI.settings.TRANSFORM_MODE property has been removed")}}});var t=e.BaseTexture;t.prototype.loadSource=function(r){ea(la,"PIXI.BaseTexture.loadSource method has been deprecated");var t=e.resources.autoDetectResource(r);t.internal=!0,this.setResource(t),this.update()};var i=!1;Object.defineProperties(t.prototype,{hasLoaded:{get:function(){return ea(la,"PIXI.BaseTexture.hasLoaded property has been removed, use PIXI.BaseTexture.valid"),this.valid}},imageUrl:{get:function(){var e;return ea(la,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),null===(e=this.resource)||void 0===e?void 0:e.url},set:function(e){ea(la,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),this.resource&&(this.resource.url=e)}},source:{get:function(){return ea(la,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source`"),this.resource.source},set:function(e){ea(la,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source` if you want to set HTMLCanvasElement. Otherwise, create new BaseTexture."),this.resource&&(this.resource.source=e)}},premultiplyAlpha:{get:function(){return ea("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(e){ea("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(e)}},_id:{get:function(){return i||(ea("5.2.0","PIXI.BaseTexture._id batch local field has been changed to `_batchLocation`"),i=!0),this._batchLocation},set:function(e){this._batchLocation=e}}}),t.fromImage=function(e,r,i,a){ea(la,"PIXI.BaseTexture.fromImage method has been replaced with PIXI.BaseTexture.from");var o={scale:a,crossorigin:r};return t.from(e,{scaleMode:i,resourceOptions:o})},t.fromCanvas=function(e,r){return ea(la,"PIXI.BaseTexture.fromCanvas method has been replaced with PIXI.BaseTexture.from"),t.from(e,{scaleMode:r})},t.fromSVG=function(e,r,i,a){ea(la,"PIXI.BaseTexture.fromSVG method has been replaced with PIXI.BaseTexture.from");var o={scale:a,crossorigin:r};return t.from(e,{scaleMode:i,resourceOptions:o})},Object.defineProperties(e.resources.ImageResource.prototype,{premultiplyAlpha:{get:function(){return ea("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(e){ea("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(e)}}}),e.Point.prototype.copy=function(e){return ea(la,"PIXI.Point.copy method has been replaced with PIXI.Point.copyFrom"),this.copyFrom(e)},e.ObservablePoint.prototype.copy=function(e){return ea(la,"PIXI.ObservablePoint.copy method has been replaced with PIXI.ObservablePoint.copyFrom"),this.copyFrom(e)},e.Rectangle.prototype.copy=function(e){return ea(la,"PIXI.Rectangle.copy method has been replaced with PIXI.Rectangle.copyFrom"),this.copyFrom(e)},e.Matrix.prototype.copy=function(e){return ea(la,"PIXI.Matrix.copy method has been replaced with PIXI.Matrix.copyTo"),this.copyTo(e)},e.systems.StateSystem.prototype.setState=function(e){return ea("v5.1.0","StateSystem.setState has been renamed to StateSystem.set"),this.set(e)},Object.assign(e.systems.FilterSystem.prototype,{getRenderTarget:function(e,r){return ea(la,"PIXI.FilterManager.getRenderTarget method has been replaced with PIXI.systems.FilterSystem#getFilterTexture"),this.getFilterTexture(null,r)},returnRenderTarget:function(e){ea(la,"PIXI.FilterManager.returnRenderTarget method has been replaced with PIXI.systems.FilterSystem.returnFilterTexture"),this.returnFilterTexture(e)},calculateScreenSpaceMatrix:function(e){ea(la,"PIXI.systems.FilterSystem.calculateScreenSpaceMatrix method is removed, use `(vTextureCoord * inputSize.xy) + outputFrame.xy` instead");var r=e.identity(),t=this.activeState,i=t.sourceFrame,a=t.destinationFrame;return r.translate(i.x/a.width,i.y/a.height),r.scale(a.width,a.height),r},calculateNormalizedScreenSpaceMatrix:function(e){ea(la,"PIXI.systems.FilterManager.calculateNormalizedScreenSpaceMatrix method is removed, use `((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw` instead.");var r=this.activeState,t=r.sourceFrame,i=r.destinationFrame,a=e.identity();a.translate(t.x/i.width,t.y/i.height);var o=i.width/t.width,n=i.height/t.height;return a.scale(o,n),a}}),Object.defineProperties(e.RenderTexture.prototype,{sourceFrame:{get:function(){return ea(la,"PIXI.RenderTexture.sourceFrame property has been removed"),this.filterFrame}},size:{get:function(){return ea(la,"PIXI.RenderTexture.size property has been removed"),this._frame}}});var a=function(e){function r(r,t,i,a){return ea(la,"PIXI.filters.BlurXFilter class is deprecated, use PIXI.filters.BlurFilterPass"),e.call(this,!0,r,t,i,a)||this}return RH(r,e),r}(e.filters.BlurFilterPass),o=function(e){function r(r,t,i,a){return ea(la,"PIXI.filters.BlurYFilter class is deprecated, use PIXI.filters.BlurFilterPass"),e.call(this,!1,r,t,i,a)||this}return RH(r,e),r}(e.filters.BlurFilterPass);Object.assign(e.filters,{BlurXFilter:a,BlurYFilter:o});var n=e.Sprite,$=e.Texture,p=e.Graphics;function s(e,r,t,i){return ea(la,"PIXI.Sprite."+e+" method is deprecated, use PIXI.Sprite.from"),n.from(r,{resourceOptions:{scale:i,crossorigin:t}})}function c(e,r,t,i){return ea(la,"PIXI.Texture."+e+" method is deprecated, use PIXI.Texture.from"),$.from(r,{resourceOptions:{scale:i,crossorigin:t}})}p.prototype.generateCanvasTexture||(p.prototype.generateCanvasTexture=function(){ea(la,"PIXI.Graphics.generateCanvasTexture method is only available in \"pixi.js-legacy\"")}),Object.defineProperty(p.prototype,"graphicsData",{get:function(){return ea(la,"PIXI.Graphics.graphicsData property is deprecated, use PIXI.Graphics.geometry.graphicsData"),this.geometry.graphicsData}}),n.fromImage=s.bind(null,"fromImage"),n.fromSVG=s.bind(null,"fromSVG"),n.fromCanvas=s.bind(null,"fromCanvas"),n.fromVideo=s.bind(null,"fromVideo"),n.fromFrame=s.bind(null,"fromFrame"),$.fromImage=c.bind(null,"fromImage"),$.fromSVG=c.bind(null,"fromSVG"),$.fromCanvas=c.bind(null,"fromCanvas"),$.fromVideo=c.bind(null,"fromVideo"),$.fromFrame=c.bind(null,"fromFrame"),Object.defineProperty(e.AbstractRenderer.prototype,"autoResize",{get:function(){return ea(la,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity},set:function(e){ea(la,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity=e}}),Object.defineProperty(e.Renderer.prototype,"textureManager",{get:function(){return ea(la,"PIXI.Renderer.textureManager property is deprecated, use PIXI.Renderer.texture"),this.texture}}),e.utils.mixins={mixin:function(){ea(la,"PIXI.utils.mixins.mixin function is no longer available")},delayMixin:function(){ea(la,"PIXI.utils.mixins.delayMixin function is no longer available")},performMixins:function(){ea(la,"PIXI.utils.mixins.performMixins function is no longer available")}},Object.defineProperty(e.BitmapText.prototype,"font",{get:function(){return ea("5.3.0","PIXI.BitmapText.font property is deprecated, use fontName, fontSize, tint or align properties"),{name:this._fontName,size:this._fontSize,tint:this._tint,align:this._align}},set:function(r){if(ea("5.3.0","PIXI.BitmapText.font property is deprecated, use fontName, fontSize, tint or align properties"),r){var t={font:r};this._upgradeStyle(t),t.fontSize=t.fontSize||e.BitmapFont.available[t.fontName].size,this._fontName=t.fontName,this._fontSize=t.fontSize,this.dirty=!0}}})}rf.registerPlugin("accessibility",LF),rf.registerPlugin("extract",UG),rf.registerPlugin("interaction",PF),rf.registerPlugin("particle",jH),rf.registerPlugin("prepare",yH),rf.registerPlugin("batch",QG),rf.registerPlugin("tilingSprite",DH),Nh.registerPlugin(KH),Nh.registerPlugin(AH),Zj.registerPlugin(MF),Zj.registerPlugin(gH);var SH="5.3.3",Xha={AlphaFilter:$ga,BlurFilter:vha,BlurFilterPass:Nv,ColorMatrixFilter:Ov,DisplacementFilter:Dha,FXAAFilter:Iha,NoiseFilter:Mha};Ya.useDeprecated=Wha,Ya.filters=Xha,Ya.VERSION=SH;class Yha{constructor(t){this.viewport=t,this.touches=[],this.addListeners()}addListeners(){this.viewport.interactive=!0,this.viewport.forceHitArea||(this.viewport.hitArea=new La(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.on("pointerout",this.up,this),this.wheelFunction=t=>this.handleWheel(t),this.viewport.options.divWheel.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){this.viewport.options.divWheel.removeEventListener("wheel",this.wheelFunction)}down(t){if(this.viewport.pause||!this.viewport.worldVisible)return;if("mouse"===t.data.pointerType?this.isMouseDown=!0:this.get(t.data.pointerId)||this.touches.push({id:t.data.pointerId,last:null}),1===this.count()){this.last=t.data.global.clone();const e=this.viewport.plugins.get("decelerate",!0),i=this.viewport.plugins.get("bounce",!0);e&&e.isActive()||i&&i.isActive()?this.clickedAvailable=!1:this.clickedAvailable=!0}else this.clickedAvailable=!1;this.viewport.plugins.down(t)&&this.viewport.options.stopPropagation&&t.stopPropagation()}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold(t){return Math.abs(t)>=this.viewport.threshold}move(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const e=this.viewport.plugins.move(t);if(this.clickedAvailable){const e=t.data.global.x-this.last.x,i=t.data.global.y-this.last.y;(this.checkThreshold(e)||this.checkThreshold(i))&&(this.clickedAvailable=!1)}e&&this.viewport.options.stopPropagation&&t.stopPropagation()}up(t){if(this.viewport.pause||!this.viewport.worldVisible)return;"mouse"===t.data.pointerType&&(this.isMouseDown=!1),"mouse"!==t.data.pointerType&&this.remove(t.data.pointerId);const e=this.viewport.plugins.up(t);this.clickedAvailable&&0===this.count()&&(this.viewport.emit("clicked",{event:t,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this}),this.clickedAvailable=!1),e&&this.viewport.options.stopPropagation&&t.stopPropagation()}getPointerPosition(t){let e=new Da;return this.viewport.options.interaction?this.viewport.options.interaction.mapPositionToPoint(e,t.clientX,t.clientY):(e.x=t.clientX,e.y=t.clientY),e}handleWheel(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const e=this.viewport.toLocal(this.getPointerPosition(t));if(this.viewport.left<=e.x&&e.x<=this.viewport.right&&this.viewport.top<=e.y&&e.y<=this.viewport.bottom){this.viewport.plugins.wheel(t)&&!this.viewport.options.passiveWheel&&t.preventDefault()}}pause(){this.touches=[],this.isMouseDown=!1}get(t){for(let e of this.touches)if(e.id===t)return e;return null}remove(t){for(let e=0;e<this.touches.length;e++)if(this.touches[e].id===t)return void this.touches.splice(e,1)}count(){return(this.isMouseDown?1:0)+this.touches.length}}const Wm=["drag","pinch","wheel","follow","mouse-edges","decelerate","aniamte","bounce","snap-zoom","clamp-zoom","snap","clamp"];class Zha{constructor(t){this.viewport=t,this.list=[],this.plugins={}}add(t,e,i=Wm.length){this.plugins[t]=e;const s=Wm.indexOf(t);-1!==s&&Wm.splice(s,1),Wm.splice(i,0,t),this.sort()}get(t,e){return e&&void 0!==this.plugins[t]&&this.plugins[t].paused?null:this.plugins[t]}update(t){for(let e of this.list)e.update(t)}resize(){for(let t of this.list)t.resize()}reset(){for(let t of this.list)t.reset()}remove(t){this.plugins[t]&&(this.plugins[t]=null,this.viewport.emit(t+"-remove"),this.sort())}pause(t){this.plugins[t]&&this.plugins[t].pause()}resume(t){this.plugins[t]&&this.plugins[t].resume()}sort(){this.list=[];for(let t of Wm)this.plugins[t]&&this.list.push(this.plugins[t])}down(t){let e=!1;for(let i of this.list)i.down(t)&&(e=!0);return e}move(t){let e=!1;for(let i of this.viewport.plugins.list)i.move(t)&&(e=!0);return e}up(t){let e=!1;for(let i of this.list)i.up(t)&&(e=!0);return e}wheel(t){let e=!1;for(let i of this.list)i.wheel(t)&&(e=!0);return e}}class ud{constructor(t){this.parent=t,this.paused=!1}destroy(){}down(){return!1}move(){return!1}up(){return!1}wheel(){return!1}update(){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}const $ha={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1};class _ha extends ud{constructor(t,e={}){super(t),this.options=Object.assign({},$ha,e),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||"all"===this.options.direction||"x"===this.options.direction,this.yDirection=!this.options.direction||"all"===this.options.direction||"y"===this.options.direction,this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){parent.addEventListener("keydown",e=>{t.includes(e.code)&&(this.keyIsPressed=!0)}),parent.addEventListener("keyup",e=>{t.includes(e.code)&&(this.keyIsPressed=!1)})}mouseButtons(t){this.mouse=t&&"all"!==t?[-1!==t.indexOf("left"),-1!==t.indexOf("middle"),-1!==t.indexOf("right")]:[!0,!0,!0]}parseUnderflow(){const t=this.options.underflow.toLowerCase();"center"===t?(this.underflowX=0,this.underflowY=0):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0)}checkButtons(t){const e="mouse"===t.data.pointerType,i=this.parent.input.count();return!(!(1===i||i>1&&!this.parent.plugins.get("pinch",!0))||e&&!this.mouse[t.data.button])}checkKeyPress(t){return!!(!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&"touch"===t.data.pointerType)}down(t){if(!this.paused&&this.options.pressDrag)return this.checkButtons(t)&&this.checkKeyPress(t)?(this.last={x:t.data.global.x,y:t.data.global.y},this.current=t.data.pointerId,!0):void(this.last=null)}get active(){return this.moved}move(t){if(!this.paused&&this.options.pressDrag&&this.last&&this.current===t.data.pointerId){const e=t.data.global.x,i=t.data.global.y,s=this.parent.input.count();if(1===s||s>1&&!this.parent.plugins.get("pinch",!0)){const s=e-this.last.x,n=i-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(s)||this.yDirection&&this.parent.input.checkThreshold(n)){const s={x:e,y:i};return this.xDirection&&(this.parent.x+=(s.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(s.y-this.last.y)*this.options.factor),this.last=s,this.moved||this.parent.emit("drag-start",{event:t,screen:new Da(this.last.x,this.last.y),world:this.parent.toWorld(new Da(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}}up(t){if(this.paused)return;const e=this.parent.input.touches;if(1===e.length){const t=e[0];return t.last&&(this.last={x:t.last.x,y:t.last.y},this.current=t.id),this.moved=!1,!0}if(this.last&&this.moved){const e=new Da(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:t,screen:e,world:this.parent.toWorld(e),viewport:this.parent}),this.last=null,this.moved=!1,!0}}wheel(t){if(!this.paused&&this.options.wheel){if(!this.parent.plugins.get("wheel",!0))return this.xDirection&&(this.parent.x+=t.deltaX*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=t.deltaY*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||t.preventDefault(),!0}}resume(){this.last=null,this.paused=!1}clamp(){const t=this.parent.plugins.get("decelerate",!0)||{};if("y"!==this.options.clampWheel)if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2;}else this.parent.left<0?(this.parent.x=0,t.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,t.x=0);if("x"!==this.options.clampWheel)if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2;}else this.parent.top<0&&(this.parent.y=0,t.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,t.y=0)}}const aia={noDrag:!1,percent:1,center:null,factor:1};class bia extends ud{constructor(t,e={}){super(t),this.options=Object.assign({},aia,e)}down(){if(this.parent.input.count()>=2)return this.active=!0,!0}move(t){if(this.paused||!this.active)return;const e=t.data.global.x,i=t.data.global.y,s=this.parent.input.touches;if(s.length>=2){const n=s[0],h=s[1],o=n.last&&h.last?Math.sqrt(Math.pow(h.last.x-n.last.x,2)+Math.pow(h.last.y-n.last.y,2)):null;if(n.id===t.data.pointerId?n.last={x:e,y:i,data:t.data}:h.id===t.data.pointerId&&(h.last={x:e,y:i,data:t.data}),o){let t;const e={x:n.last.x+(h.last.x-n.last.x)/2,y:n.last.y+(h.last.y-n.last.y)/2};this.options.center||(t=this.parent.toLocal(e));let i=Math.sqrt(Math.pow(h.last.x-n.last.x,2)+Math.pow(h.last.y-n.last.y,2));const s=(1-o/(i=0===i?i=1e-10:i))*this.options.percent*this.parent.scale.x;this.parent.scale.x+=s,this.parent.scale.y+=s,this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:e});const r=this.parent.plugins.get("clamp-zoom",!0);if(r&&r.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const i=this.parent.toGlobal(t);this.parent.x+=(e.x-i.x)*this.options.factor,this.parent.y+=(e.y-i.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(e.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(e.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=e,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}}up(){if(this.pinching&&this.parent.input.touches.length<=1)return this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0}}const cia={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class dia extends ud{constructor(t,e={}){super(t),this.options=Object.assign({},cia,e),this.options.direction&&(this.options.left="x"===this.options.direction||"all"===this.options.direction||null,this.options.right="x"===this.options.direction||"all"===this.options.direction||null,this.options.top="y"===this.options.direction||"all"===this.options.direction||null,this.options.bottom="y"===this.options.direction||"all"===this.options.direction||null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const t=this.options.underflow.toLowerCase();"none"===t?this.noUnderflow=!0:"center"===t?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused)return;if(this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const t={x:this.parent.x,y:this.parent.y},e=this.parent.plugins.decelerate||{};if(null!==this.options.left||null!==this.options.right){let i=!1;if(this.parent.screenWorldWidth<this.parent.screenWidth){if(!this.noUnderflow)switch(this.underflowX){case-1:0!==this.parent.x&&(this.parent.x=0,i=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,i=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,i=!0);}}else null!==this.options.left&&this.parent.left<(!0===this.options.left?0:this.options.left)&&(this.parent.x=-(!0===this.options.left?0:this.options.left)*this.parent.scale.x,e.x=0,i=!0),null!==this.options.right&&this.parent.right>(!0===this.options.right?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(!0===this.options.right?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,e.x=0,i=!0);i&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-x"})}if(null!==this.options.top||null!==this.options.bottom){let i=!1;if(this.parent.screenWorldHeight<this.parent.screenHeight){if(!this.noUnderflow)switch(this.underflowY){case-1:0!==this.parent.y&&(this.parent.y=0,i=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,i=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,i=!0);}}else null!==this.options.top&&this.parent.top<(!0===this.options.top?0:this.options.top)&&(this.parent.y=-(!0===this.options.top?0:this.options.top)*this.parent.scale.y,e.y=0,i=!0),null!==this.options.bottom&&this.parent.bottom>(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,e.y=0,i=!0);i&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}const eia={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class fia extends ud{constructor(t,e={}){super(t),this.options=Object.assign({},eia,e),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused)if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight;if(null!==this.options.minWidth&&t<this.options.minWidth){const i=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxWidth&&t>this.options.maxWidth){const i=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.minHeight&&e<this.options.minHeight){const i=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxHeight&&e>this.options.maxHeight){const t=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/t,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else{let t=this.parent.scale.x;null!==this.options.minScale&&t<this.options.minScale&&(t=this.options.minScale),null!==this.options.maxScale&&t>this.options.maxScale&&(t=this.options.maxScale),t!==this.parent.scale.x&&(this.parent.scale.set(t),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}reset(){this.clamp()}}const gia={friction:.98,bounce:.8,minSpeed:.01},yg=16;class hia extends ud{constructor(t,e={}){super(t),this.options=Object.assign({},gia,e),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",t=>this.moved(t))}destroy(){this.parent}down(){this.saved=[],this.x=this.y=!1}isActive(){return this.x||this.y}move(){if(this.paused)return;const t=this.parent.input.count();(1===t||t>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30))}moved(t){if(this.saved.length){const e=this.saved[this.saved.length-1];"clamp-x"===t.type?e.x===t.original.x&&(e.x=this.parent.x):"clamp-y"===t.type&&e.y===t.original.y&&(e.y=this.parent.y)}}up(){if(0===this.parent.input.count()&&this.saved.length){const t=performance.now();for(let e of this.saved)if(e.time>=t-100){const i=t-e.time;this.x=(this.parent.x-e.x)/i,this.y=(this.parent.y-e.y)/i,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}}activate(t){void 0!==(t=t||{}).x&&(this.x=t.x,this.percentChangeX=this.options.friction),void 0!==t.y&&(this.y=t.y,this.percentChangeY=this.options.friction)}update(t){if(this.paused)return;const e=this.x||this.y,i=this.timeSinceRelease,s=this.timeSinceRelease+t;if(this.x){const t=this.percentChangeX,e=Math.log(t);this.parent.x+=this.x*yg/e*(Math.pow(t,s/yg)-Math.pow(t,i/yg))}if(this.y){const t=this.percentChangeY,e=Math.log(t);this.parent.y+=this.y*yg/e*(Math.pow(t,s/yg)-Math.pow(t,i/yg))}this.timeSinceRelease+=t,this.x*=Math.pow(this.percentChangeX,t/yg),this.y*=Math.pow(this.percentChangeY,t/yg),Math.abs(this.x)<this.options.minSpeed&&(this.x=0),Math.abs(this.y)<this.options.minSpeed&&(this.y=0),e&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}var iia="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof ab?ab:"undefined"!=typeof self?self:{};function jia(t,e,i){return t(i={path:e,exports:{},require:function(t,e){return kia(t,null==e?i.path:e)}},i.exports),i.exports}function kia(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var TH=jia(function(t,e){(function(){var e;(function(e){t.exports=e})(e={linear:function(t,e,i,s){return i*t/s+e},easeInQuad:function(t,e,i,s){return i*(t/=s)*t+e},easeOutQuad:function(t,e,i,s){return-i*(t/=s)*(t-2)+e},easeInOutQuad:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,s){return i*(t/=s)*t*t+e},easeOutCubic:function(t,e,i,s){return i*((t=t/s-1)*t*t+1)+e},easeInOutCubic:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,i,s){return i*(t/=s)*t*t*t+e},easeOutQuart:function(t,e,i,s){return-i*((t=t/s-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,i,s){return i*(t/=s)*t*t*t*t+e},easeOutQuint:function(t,e,i,s){return i*((t=t/s-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,i,s){return-i*Math.cos(t/s*(Math.PI/2))+i+e},easeOutSine:function(t,e,i,s){return i*Math.sin(t/s*(Math.PI/2))+e},easeInOutSine:function(t,e,i,s){return-i/2*(Math.cos(Math.PI*t/s)-1)+e},easeInExpo:function(t,e,i,s){return 0===t?e:i*Math.pow(2,10*(t/s-1))+e},easeOutExpo:function(t,e,i,s){return t===s?e+i:i*(1-Math.pow(2,-10*t/s))+e},easeInOutExpo:function(t,e,i,s){return(t/=s/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,i,s){return-i*(Math.sqrt(1-(t/=s)*t)-1)+e},easeOutCirc:function(t,e,i,s){return i*Math.sqrt(1-(t=t/s-1)*t)+e},easeInOutCirc:function(t,e,i,s){return(t/=s/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,i,s){var n,h,o;return o=1.70158,0===t||(t/=s),(h=0)||(h=.3*s),(n=i)<Math.abs(i)?(n=i,o=h/4):o=h/(2*Math.PI)*Math.asin(i/n),-n*Math.pow(2,10*(t-=1))*Math.sin((t*s-o)*(2*Math.PI)/h)+e},easeOutElastic:function(t,e,i,s){var n,h,o;return o=1.70158,0===t||(t/=s),(h=0)||(h=.3*s),(n=i)<Math.abs(i)?(n=i,o=h/4):o=h/(2*Math.PI)*Math.asin(i/n),n*Math.pow(2,-10*t)*Math.sin((t*s-o)*(2*Math.PI)/h)+i+e},easeInOutElastic:function(t,e,i,s){var n,h,o;return o=1.70158,0===t||(t/=s/2),(h=0)||(h=s*(.3*1.5)),(n=i)<Math.abs(i)?(n=i,o=h/4):o=h/(2*Math.PI)*Math.asin(i/n),t<1?n*Math.pow(2,10*(t-=1))*Math.sin((t*s-o)*(2*Math.PI)/h)*-.5+e:n*Math.pow(2,-10*(t-=1))*Math.sin((t*s-o)*(2*Math.PI)/h)*.5+i+e},easeInBack:function(t,e,i,s,n){return void 0===n&&(n=1.70158),i*(t/=s)*t*((n+1)*t-n)+e},easeOutBack:function(t,e,i,s,n){return void 0===n&&(n=1.70158),i*((t=t/s-1)*t*((n+1)*t+n)+1)+e},easeInOutBack:function(t,e,i,s,n){return void 0===n&&(n=1.70158),(t/=s/2)<1?i/2*(t*t*((1+(n*=1.525))*t-n))+e:i/2*((t-=2)*t*((1+(n*=1.525))*t+n)+2)+e},easeInBounce:function(t,i,s,n){return s-e.easeOutBounce(n-t,0,s,n)+i},easeOutBounce:function(t,e,i,s){return(t/=s)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,i,s,n){return t<n/2?.5*e.easeInBounce(2*t,0,s,n)+i:.5*e.easeOutBounce(2*t-n,0,s,n)+.5*s+i}})}).call(iia)});function yq(t,e){return t?"function"==typeof t?t:"string"==typeof t?TH[t]:void 0:TH[e]}const lia={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class mia extends ud{constructor(t,e={}){super(t),this.options=Object.assign({},lia,e),this.ease=yq(this.options.ease,"easeInOutSine"),this.options.sides&&("all"===this.options.sides?this.top=this.bottom=this.left=this.right=!0:"horizontal"===this.options.sides?this.right=this.left=!0:"vertical"===this.options.sides?this.top=this.bottom=!0:(this.top=-1!==this.options.sides.indexOf("top"),this.bottom=-1!==this.options.sides.indexOf("bottom"),this.left=-1!==this.options.sides.indexOf("left"),this.right=-1!==this.options.sides.indexOf("right"))),this.parseUnderflow(),this.last={},this.reset()}parseUnderflow(){const t=this.options.underflow.toLowerCase();"center"===t?(this.underflowX=0,this.underflowY=0):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0)}isActive(){return null!==this.toX||null!==this.toY}down(){this.toX=this.toY=null}up(){this.bounce()}update(t){if(!this.paused){if(this.bounce(),this.toX){const e=this.toX;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),e.time>=this.options.time?(this.parent.x=e.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(e.time,e.start,e.delta,this.options.time)}if(this.toY){const e=this.toY;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),e.time>=this.options.time?(this.parent.y=e.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(e.time,e.start,e.delta,this.options.time)}}}calcUnderflowX(){let t;switch(this.underflowX){case-1:t=0;break;case 1:t=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:t=(this.parent.screenWidth-this.parent.screenWorldWidth)/2;}return t}calcUnderflowY(){let t;switch(this.underflowY){case-1:t=0;break;case 1:t=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:t=(this.parent.screenHeight-this.parent.screenWorldHeight)/2;}return t}oob(){const t=this.options.bounceBox;if(t){const e=void 0===t.x?0:t.x,i=void 0===t.y?0:t.y,s=void 0===t.width?this.parent.worldWidth:t.width,n=void 0===t.height?this.parent.worldHeight:t.height;return{left:this.parent.left<e,right:this.parent.right>s,top:this.parent.top<i,bottom:this.parent.bottom>n,topLeft:new Da(e*this.parent.scale.x,i*this.parent.scale.y),bottomRight:new Da(s*this.parent.scale.x-this.parent.screenWidth,n*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new Da(0,0),bottomRight:new Da(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){if(this.paused)return;let t,e=this.parent.plugins.get("decelerate",!0);e&&(e.x||e.y)&&(e.x&&e.percentChangeX===e.options.friction||e.y&&e.percentChangeY===e.options.friction)&&(((t=this.oob()).left&&this.left||t.right&&this.right)&&(e.percentChangeX=this.options.friction),(t.top&&this.top||t.bottom&&this.bottom)&&(e.percentChangeY=this.options.friction));const i=this.parent.plugins.get("drag",!0)||{},s=this.parent.plugins.get("pinch",!0)||{};if(e=e||{},!(i.active||s.active||this.toX&&this.toY||e.x&&e.y)){const i=(t=t||this.oob()).topLeft,s=t.bottomRight;if(!this.toX&&!e.x){let e=null;t.left&&this.left?e=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-i.x:t.right&&this.right&&(e=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-s.x),null!==e&&this.parent.x!==e&&(this.toX={time:0,start:this.parent.x,delta:e-this.parent.x,end:e},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!e.y){let e=null;t.top&&this.top?e=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-i.y:t.bottom&&this.bottom&&(e=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-s.y),null!==e&&this.parent.y!==e&&(this.toY={time:0,start:this.parent.y,delta:e-this.parent.y,end:e},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}const nia={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class oia extends ud{constructor(t,e,i,s={}){super(t),this.options=Object.assign({},nia,s),this.ease=yq(s.ease,"easeInOutSine"),this.x=e,this.y=i,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const t=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-t.x,this.deltaY=this.y-t.y,this.startX=t.x,this.startY=t.y,this.parent.emit("snap-start",this.parent)}wheel(){this.options.removeOnInterrupt&&this.parent.plugins.remove("snap")}down(){this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null)}up(){if(0===this.parent.input.count()){const t=this.parent.plugins.get("decelerate",!0);t&&(t.x||t.y)&&(t.percentChangeX=t.percentChangeY=this.options.friction)}}update(t){if(!(this.paused||this.options.interrupt&&0!==this.parent.input.count()))if(this.snapping){const e=this.snapping;let i,s,n;if(e.time+=t,e.time>this.options.time)i=!0,s=this.startX+this.deltaX,n=this.startY+this.deltaY;else{const t=this.ease(e.time,0,1,this.options.time);s=this.startX+this.deltaX*t,n=this.startY+this.deltaY*t}this.options.topLeft?this.parent.moveCorner(s,n):this.parent.moveCenter(s,n),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),i&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const t=this.options.topLeft?this.parent.corner:this.parent.center;t.x===this.x&&t.y===this.y||this.snapStart()}}}const pia={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupts:!1,forceStart:!1,noMove:!1};class qia extends ud{constructor(t,e={}){super(t),this.options=Object.assign({},pia,e),this.ease=yq(this.options.ease),this.options.width>0&&(this.xScale=t.screenWidth/this.options.width),this.options.height>0&&(this.yScale=t.screenHeight/this.options.height),this.xIndependent=!!this.xScale,this.yIndependent=!!this.yScale,this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,0===this.options.time?(t.container.scale.x=this.xScale,t.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):e.forceStart&&this.createSnapping()}createSnapping(){this.parent.scale;const t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,i=this.parent.screenWidth/this.xScale,s=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:t,startY:e,deltaX:i-t,deltaY:s-e},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom")}down(){this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null)}update(t){if(this.paused)return;if(this.options.interrupt&&0!==this.parent.input.count())return;let e;if(this.options.center||this.options.noMove||(e=this.parent.center),this.snapping){if(this.snapping){const i=this.snapping;if(i.time+=t,i.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const t=this.snapping,e=this.ease(t.time,t.startX,t.deltaX,this.options.time),i=this.ease(t.time,t.startY,t.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/e,this.parent.scale.y=this.parent.screenHeight/i}const s=this.parent.plugins.get("clamp-zoom",!0);s&&s.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(e))}}else this.parent.scale.x===this.xScale&&this.parent.scale.y===this.yScale||this.createSnapping()}resume(){this.snapping=null,super.resume()}}const ria={speed:0,acceleration:null,radius:null};class sia extends ud{constructor(t,e,i={}){super(t),this.target=e,this.options=Object.assign({},ria,i),this.velocity={x:0,y:0}}update(t){if(this.paused)return;const e=this.parent.center;let i=this.target.x,s=this.target.y;if(this.options.radius){if(!(Math.sqrt(Math.pow(this.target.y-e.y,2)+Math.pow(this.target.x-e.x,2))>this.options.radius))return;{const t=Math.atan2(this.target.y-e.y,this.target.x-e.x);i=this.target.x-Math.cos(t)*this.options.radius,s=this.target.y-Math.sin(t)*this.options.radius}}const n=i-e.x,h=s-e.y;if(n||h)if(this.options.speed){if(this.options.acceleration){const o=Math.atan2(s-e.y,i-e.x),r=Math.sqrt(Math.pow(n,2)+Math.pow(h,2));if(r){const a=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);this.velocity=r>a?{x:Math.min(this.velocity.x+this.options.acceleration*t,this.options.speed),y:Math.min(this.velocity.y+this.options.acceleration*t,this.options.speed)}:{x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const p=Math.cos(o)*this.velocity.x,l=Math.sin(o)*this.velocity.y,c=Math.abs(p)>Math.abs(n)?i:e.x+p,d=Math.abs(l)>Math.abs(h)?s:e.y+l;this.parent.moveCenter(c,d),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const t=Math.atan2(s-e.y,i-e.x),o=Math.cos(t)*this.options.speed,r=Math.sin(t)*this.options.speed,a=Math.abs(o)>Math.abs(n)?i:e.x+o,p=Math.abs(r)>Math.abs(h)?s:e.y+r;this.parent.moveCenter(a,p),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else this.parent.moveCenter(i,s),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}const tia={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20};class uia extends ud{constructor(t,e={}){super(t),this.options=Object.assign({},tia,e)}down(){this.options.interrupt&&(this.smoothing=null)}update(){if(this.smoothing){const t=this.smoothingCenter,e=this.smoothing;let i;this.options.center||(i=this.parent.toLocal(t)),this.parent.scale.x+=e.x,this.parent.scale.y+=e.y,this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const s=this.parent.plugins.get("clamp-zoom",!0);if(s&&s.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const e=this.parent.toGlobal(i);this.parent.x+=t.x-e.x,this.parent.y+=t.y-e.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}wheel(t){if(this.paused)return;let e=this.parent.input.getPointerPosition(t);const i=(this.options.reverse?-1:1)*-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/500,s=Math.pow(2,(1+this.options.percent)*i);if(this.options.smooth){const t={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+t.x)*s-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+t.y)*s-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=e}else{let t;this.options.center||(t=this.parent.toLocal(e)),this.parent.scale.x*=s,this.parent.scale.y*=s,this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const i=this.parent.plugins.get("clamp-zoom",!0);if(i&&i.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const i=this.parent.toGlobal(t);this.parent.x+=e.x-i.x,this.parent.y+=e.y-i.y}}return this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:t.deltaX,dy:t.deltaY,dz:t.deltaZ},event:t,viewport:this.parent}),!this.parent.options.passiveWheel||void 0}}const via={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class wia extends ud{constructor(t,e={}){super(t),this.options=Object.assign({},via,e),this.reverse=this.options.reverse?1:-1,this.radiusSquared=Math.pow(this.options.radius,2),this.resize()}resize(){const t=this.options.distance;null!==t?(this.left=t,this.top=t,this.right=this.parent.worldScreenWidth-t,this.bottom=this.parent.worldScreenHeight-t):this.radius||(this.left=this.options.left,this.top=this.options.top,this.right=null===this.options.right?null:this.parent.worldScreenWidth-this.options.right,this.bottom=null===this.options.bottom?null:this.parent.worldScreenHeight-this.options.bottom)}down(){this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null)}move(t){if(this.paused)return;if("mouse"!==t.data.pointerType&&1!==t.data.identifier||!this.options.allowButtons&&0!==t.data.buttons)return;const e=t.data.global.x,i=t.data.global.y;if(this.radiusSquared){const t=this.parent.toScreen(this.parent.center);if(Math.pow(t.x-e,2)+Math.pow(t.y-i,2)>=this.radiusSquared){const s=Math.atan2(t.y-i,t.x-e);this.options.linear?(this.horizontal=Math.round(Math.cos(s))*this.options.speed*this.reverse*.06,this.vertical=Math.round(Math.sin(s))*this.options.speed*this.reverse*.06):(this.horizontal=Math.cos(s)*this.options.speed*this.reverse*.06,this.vertical=Math.sin(s)*this.options.speed*this.reverse*.06)}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else null!==this.left&&e<this.left?this.horizontal=1*this.reverse*this.options.speed*.06:null!==this.right&&e>this.right?this.horizontal=-1*this.reverse*this.options.speed*.06:(this.decelerateHorizontal(),this.horizontal=0),null!==this.top&&i<this.top?this.vertical=1*this.reverse*this.options.speed*.06:null!==this.bottom&&i>this.bottom?this.vertical=-1*this.reverse*this.options.speed*.06:(this.decelerateVertical(),this.vertical=0)}decelerateHorizontal(){const t=this.parent.plugins.get("decelerate",!0);this.horizontal&&t&&!this.options.noDecelerate&&t.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}decelerateVertical(){const t=this.parent.plugins.get("decelerate",!0);this.vertical&&t&&!this.options.noDecelerate&&t.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}up(){this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null)}update(){if(!this.paused&&(this.horizontal||this.vertical)){const t=this.parent.center;this.horizontal&&(t.x+=this.horizontal*this.options.speed),this.vertical&&(t.y+=this.vertical*this.options.speed),this.parent.moveCenter(t),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const xia={removeOnInterrupt:!1,ease:"linear",time:1e3};class yia extends ud{constructor(t,e={}){super(t),this.options=Object.assign({},xia,e),this.options.ease=yq(this.options.ease),this.setupPosition(),this.setupZoom()}setupPosition(){void 0!==this.options.position?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,void 0!==this.options.scale?this.width=this.parent.screenWidth/this.options.scale:void 0!==this.options.scaleX||void 0!==this.options.scaleY?(void 0!==this.options.scaleX&&(this.width=this.parent.screenWidth/this.options.scaleX),void 0!==this.options.scaleY&&(this.height=this.parent.screenHeight/this.options.scaleY)):(void 0!==this.options.width&&(this.width=this.options.width),void 0!==this.options.height&&(this.height=this.options.height)),null!==typeof this.width&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),null!==typeof this.height&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight),this.time=0}down(){this.options.removeOnInterrupt&&this.parent.plugins.remove("animate")}complete(){this.parent.plugins.remove("animate"),null!==this.width&&this.parent.fitWidth(this.width,this.keepCenter,null===this.height),null!==this.height&&this.parent.fitHeight(this.height,this.keepCenter,null===this.width),this.keepCenter||this.parent.moveCenter(this.options.position.x,this.options.position.y),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(t){if(!this.paused)if(this.time+=t,this.time>=this.options.time)this.complete();else{const t=new Da(this.parent.scale.x,this.parent.scale.y),e=this.options.ease(this.time,0,1,this.options.time);if(null!==this.width&&this.parent.fitWidth(this.startWidth+this.deltaWidth*e,this.keepCenter,null===this.height),null!==this.height&&this.parent.fitHeight(this.startHeight+this.deltaHeight*e,this.keepCenter,null===this.width),null===this.width?this.parent.scale.x=this.parent.scale.y:null===this.height&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const t=new Da(this.parent.x,this.parent.y);this.parent.moveCenter(this.startX+this.deltaX*e,this.startY+this.deltaY*e),this.parent.emit("moved",{viewport:this.parent,original:t,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:t,type:"animate"}),this.keepCenter}}}const zia={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,interaction:null,disableOnContextMenu:!1};class Aia extends qd{constructor(t={}){if(super(),this.options=Object.assign({},zia,t),t.ticker)this.options.ticker=t.ticker;else{let e;e=parseInt(/^(\d+)\./.exec(SH)[1])<5?Ya.ticker.shared:Nb.shared,this.options.ticker=t.ticker||e}this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.divWheel=this.options.divWheel||document.body,this.options.disableOnContextMenu&&(this.options.divWheel.oncontextmenu=t=>t.preventDefault()),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new Yha(this),this.plugins=new Zha(this)}destroy(t){this.options.noTicker||this.options.ticker.remove(this.tickerFunction),this.input.destroy(),super.destroy(t)}update(t){this.pause||(this.plugins.update(t),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new La(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(t=window.innerWidth,e=window.innerHeight,i,s){this.screenWidth=t,this.screenHeight=e,void 0!==i&&(this._worldWidth=i),void 0!==s&&(this._worldHeight=s),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(t){this._worldWidth=t,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(t){this._worldHeight=t,this.plugins.resize()}getVisibleBounds(){return new La(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(t,e){return 2===arguments.length?this.toLocal(new Da(t,e)):this.toLocal(t)}toScreen(t,e){return 2===arguments.length?this.toGlobal(new Da(t,e)):this.toGlobal(t)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new Da(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(t){this.moveCenter(t)}moveCenter(){let t,e;return isNaN(arguments[0])?(t=arguments[0].x,e=arguments[0].y):(t=arguments[0],e=arguments[1]),this.position.set((this.worldScreenWidth/2-t)*this.scale.x,(this.worldScreenHeight/2-e)*this.scale.y),this.plugins.reset(),this.dirty=!0,this}get corner(){return new Da(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(t){this.moveCorner(t)}moveCorner(t,e){return 1===arguments.length?this.position.set(-t.x*this.scale.x,-t.y*this.scale.y):this.position.set(-t*this.scale.x,-e*this.scale.y),this.plugins.reset(),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(t){return this.screenWidth/t}findFitHeight(t){return this.screenHeight/t}findFit(t,e){const i=this.screenWidth/t,s=this.screenHeight/e;return Math.min(i,s)}findCover(t,e){const i=this.screenWidth/t,s=this.screenHeight/e;return Math.max(i,s)}fitWidth(t,e,i=!0,s){let n;e&&(n=this.center),this.scale.x=this.screenWidth/t,i&&(this.scale.y=this.scale.x);const h=this.plugins.get("clamp-zoom",!0);return!s&&h&&h.clamp(),e&&this.moveCenter(n),this}fitHeight(t,e,i=!0,s){let n;e&&(n=this.center),this.scale.y=this.screenHeight/t,i&&(this.scale.x=this.scale.y);const h=this.plugins.get("clamp-zoom",!0);return!s&&h&&h.clamp(),e&&this.moveCenter(n),this}fitWorld(t){let e;t&&(e=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const i=this.plugins.get("clamp-zoom",!0);return i&&i.clamp(),t&&this.moveCenter(e),this}fit(t,e=this.worldWidth,i=this.worldHeight){let s;t&&(s=this.center),this.scale.x=this.screenWidth/e,this.scale.y=this.screenHeight/i,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const n=this.plugins.get("clamp-zoom",!0);return n&&n.clamp(),t&&this.moveCenter(s),this}set visible(t){t||this.input.clear(),super.visible=t}setZoom(t,e){let i;e&&(i=this.center),this.scale.set(t);const s=this.plugins.get("clamp-zoom",!0);return s&&s.clamp(),e&&this.moveCenter(i),this}zoomPercent(t,e){return this.setZoom(this.scale.x+this.scale.x*t,e)}zoom(t,e){return this.fitWidth(t+this.worldScreenWidth,e),this}set scaled(t){this.setZoom(t,!0)}get scaled(){return this.scale.x}snapZoom(t){return this.plugins.add("snap-zoom",new qia(this,t)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this._worldHeight,cornerPoint:new Da(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(t){this.x=-t*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(t){this.x=-t*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(t){this.y=-t*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(t){this.y=-t*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return this._dirty}set dirty(t){this._dirty=t}get forceHitArea(){return this._forceHitArea}set forceHitArea(t){t?(this._forceHitArea=t,this.hitArea=t):(this._forceHitArea=null,this.hitArea=new La(0,0,this.worldWidth,this.worldHeight))}drag(t){return this.plugins.add("drag",new _ha(this,t)),this}clamp(t){return this.plugins.add("clamp",new dia(this,t)),this}decelerate(t){return this.plugins.add("decelerate",new hia(this,t)),this}bounce(t){return this.plugins.add("bounce",new mia(this,t)),this}pinch(t){return this.plugins.add("pinch",new bia(this,t)),this}snap(t,e,i){return this.plugins.add("snap",new oia(this,t,e,i)),this}follow(t,e){return this.plugins.add("follow",new sia(this,t,e)),this}wheel(t){return this.plugins.add("wheel",new uia(this,t)),this}animate(t){return this.plugins.add("animate",new yia(this,t)),this}clampZoom(t){return this.plugins.add("clamp-zoom",new fia(this,t)),this}mouseEdges(t){return this.plugins.add("mouse-edges",new wia(this,t)),this}get pause(){return this._pause}set pause(t){this._pause=t,this.lastViewport=null,this.moving=!1,this.zooming=!1,t&&this.input.pause()}ensureVisible(t,e,i,s,n){n&&(i>this.worldScreenWidth||s>this.worldScreenHeight)&&(this.fit(!0,i,s),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let h=!1;t<this.left?(this.left=t,h=!0):t+i>this.right&&(this.right=t+i,h=!0),e<this.top?(this.top=e,h=!0):e+s>this.bottom&&(this.bottom=e+s,h=!0),h&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}function Bia(e){return(Bia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cia(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UH(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Dia(e,t,r){return t&&UH(e.prototype,t),r&&UH(e,r),e}function Eia(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fia(e,t)}function Fia(e,t){return(Fia=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gia(e){var t=Jia();return function(){var r,o=VH(e);if(t){var i=VH(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return Hia(this,r)}}function Hia(e,t){return!t||"object"!==Bia(t)&&"function"!=typeof t?Iia(e):t}function Iia(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jia(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function VH(e){return(VH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fk=1e4,Kia=function(e){Eia(r,sd);var t=Gia(r);function r(e,o){var i;return Cia(this,r),(i=t.call(this)).__canvasHolder=e,i.__options=o,i.__size=new ca(fk,fk),i.__gridScale=1,i.width=i.__size.x,i.height=i.__size.y,i.drawRect(0,0,fk,fk),i.pivot.x=i.pivot.y=.5,ha.getInstance().addEventListener(gd,function(e){return i.__updateGrid(e.key)}),i.__updateGrid(),i}return Dia(r,[{key:"__updateGrid",value:function(){var e=ha.getNumericValue(tj),t=ka.cmToPixel(e),r=fk/t,o=.5*fk,i=1/this.__gridScale,n=1/this.__gridScale;this.clear();for(var $=0;$<r;$++){var a=$*t-o;$%5==0?(this.lineStyle(n,13684944).moveTo(-o,a).lineTo(o,a),this.lineStyle(n,13684944).moveTo(a,-o).lineTo(a,o)):(this.lineStyle(i,15461355).moveTo(-o,a).lineTo(o,a),this.lineStyle(i,15461355).moveTo(a,-o).lineTo(a,o))}}},{key:"__configurationUpdate",value:function(e){e.key===tj&&this.__updateGrid()}},{key:"gridScale",get:function(){return this.__gridScale},set:function(e){this.__gridScale=e,this.__updateGrid()}}]),r}();function Lia(t){return(Lia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mia(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WH(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Nia(t,e,r){return e&&WH(t.prototype,e),r&&WH(t,r),t}function gk(t,e,r){return(gk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=Oia(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function Oia(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=uf(t)););return t}function Pia(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qia(t,e)}function Qia(t,e){return(Qia=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ria(t){var e=Tia();return function(){var r,o=uf(t);if(e){var n=uf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Sia(this,r)}}function Sia(t,e){return!e||"object"!==Lia(e)&&"function"!=typeof e?Pv(t):e}function Pv(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tia(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function uf(t){return(uf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Uia(e){return(Uia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Via(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XH(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wia(e,t,o){return t&&XH(e.prototype,t),o&&XH(e,o),e}function Xia(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yia(e,t)}function Yia(e,t){return(Yia=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zia(e){var t=_ia();return function(){var o,n=YH(e);if(t){var r=YH(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return $ia(this,o)}}function $ia(e,t){return!t||"object"!==Uia(t)&&"function"!=typeof t?zg(e):t}function zg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _ia(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function YH(e){return(YH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aja(e){return(aja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bja(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cja(e,t,r){return t&&ZH(e.prototype,t),r&&ZH(e,r),e}function dja(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eja(e,t)}function eja(e,t){return(eja=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fja(e){var t=hja();return function(){var r,n=$H(e);if(t){var o=$H(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gja(this,r)}}function gja(e,t){return!t||"object"!==aja(t)&&"function"!=typeof t?Qv(e):t}function Qv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hja(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function $H(e){return($H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _H=function(e){dja(r,Qa);var t=fja(r);function r(){var e;return bja(this,r),(e=t.call(this)).__keyDownEvent=e.__keyDown.bind(Qv(e)),e.__keyUpEvent=e.__keyUp.bind(Qv(e)),window.addEventListener("keydown",e.__keyDownEvent),window.addEventListener("keyup",e.__keyUpEvent),e}return cja(r,[{key:"__keyDown",value:function(e){this.dispatchEvent({type:qj,key:e.key,code:e.code})}},{key:"__keyUp",value:function(e){this.dispatchEvent({type:rj,key:e.key,code:e.code})}},{key:"remove",value:function(){window.removeEventListener("keydown",this.__keyDownEvent),window.removeEventListener("keyup",this.__keyUpEvent)}}]),r}();var zq=function(e){Xia(o,sd);var t=Zia(o);function o(e,n){var r;return Via(this,o),(r=t.call(this)).__floorplan=e,r.__options=n,r.__eventDispatcher=new Qa,r.__interactable=!0,r.interactive=!0,r.buttonMode=!0,r.__isDragging=!1,r.__isSelected=!1,r.__snapToGrid=!1,r.__keyboard=new _H,r.__mouseDownEvent=r.__dragStart.bind(zg(r)),r.__mouseUpEvent=r.__dragEnd.bind(zg(r)),r.__mouseMoveEvent=r.__dragMove.bind(zg(r)),r.__mouseOverEvent=r.__mouseOver.bind(zg(r)),r.__mouseOutEvent=r.__mouseOut.bind(zg(r)),r.__mouseClickEvent=r.__click.bind(zg(r)),r.__keyListenerEvent=r.__keyListener.bind(zg(r)),r.on("mousedown",r.__mouseClickEvent).on("touchstart",r.__mouseClickEvent),r.on("mouseupoutside",r.__mouseUpEvent).on("touchendoutside",r.__mouseUpEvent),r.on("mouseup",r.__mouseUpEvent).on("touchend",r.__mouseUpEvent),r.on("mousemove",r.__mouseMoveEvent).on("touchmove",r.__mouseMoveEvent),r.on("mouseover",r.__mouseOverEvent).on("mouseout",r.__mouseOutEvent),r.__keyboard.addEventListener(rj,r.__keyListenerEvent),r.__keyboard.addEventListener(qj,r.__keyListenerEvent),r}return Wia(o,[{key:"__deactivate",value:function(){this.off("mousedown",this.__mouseClickEvent).off("touchstart",this.__mouseClickEvent),this.off("mouseupoutside",this.__mouseUpEvent).off("touchendoutside",this.__mouseUpEvent),this.off("mouseup",this.__mouseUpEvent).off("touchend",this.__mouseUpEvent),this.off("mousemove",this.__mouseMoveEvent).off("touchmove",this.__mouseMoveEvent),this.off("mouseover",this.__mouseOverEvent).off("mouseout",this.__mouseOutEvent)}},{key:"__keyListener",value:function(e){this.selected&&"Delete"===e.key&&this.__removeFromFloorplan(),e.type===qj&&"Shift"===e.key&&(this.__snapToGrid=!0),e.type===rj&&"Shift"===e.key&&(this.__snapToGrid=!1)}},{key:"__vectorToPixels",value:function(e){return e.x=ka.cmToPixel(e.x),e.y=ka.cmToPixel(e.y),e}},{key:"__drawSelectedState",value:function(){}},{key:"__drawHoveredOnState",value:function(){}},{key:"__drawHoveredOffState",value:function(){}},{key:"__click",value:function(e){this.selected=!0,this.__isDragging=!0,this.__drawSelectedState(),void 0!==e&&e.stopPropagation()}},{key:"__mouseOver",value:function(e){this.selected||(this.__drawHoveredOnState(),e.stopPropagation())}},{key:"__mouseOut",value:function(e){this.selected||(this.__drawHoveredOffState(),void 0!==e&&e.stopPropagation())}},{key:"__dragStart",value:function(e){this.__isDragging=!0,e.stopPropagation()}},{key:"__dragEnd",value:function(e){this.__isDragging=!1,e.stopPropagation()}},{key:"__dragMove",value:function(e){this.__isDragging&&e.stopPropagation()}},{key:"__removeFromFloorplan",value:function(){}},{key:"remove",value:function(){this.off("mousedown",this.__mouseDownEvent).off("touchstart",this.__mouseDownEvent),this.off("mouseupoutside",this.__mouseUpEvent).off("touchendoutside",this.__mouseUpEvent),this.off("mouseup",this.__mouseUpEvent).off("touchend",this.__mouseUpEvent),this.off("mousemove",this.__mouseMoveEvent).off("touchmove",this.__mouseMoveEvent),this.off("mouseover",this.__mouseOverEvent).off("mouseout",this.__mouseOutEvent),this.off("click",this.__mouseClickEvent),this.__keyboard.removeEventListener(rj,this.__keyListenerEvent),this.__keyboard.removeEventListener(qj,this.__keyListenerEvent),this.__keyboard.remove(),this.parent&&this.parent.removeChild(this)}},{key:"addFloorplanListener",value:function(e,t){this.__eventDispatcher.addEventListener(e,t)}},{key:"removeFloorplanListener",value:function(e,t){this.__eventDispatcher.removeEventListener(e,t)}},{key:"selected",get:function(){return this.__isSelected},set:function(e){this.__isSelected=e,this.__isSelected||this.__drawHoveredOffState(),e?this.__eventDispatcher.dispatchEvent({type:Yl,item:this}):this.__eventDispatcher.dispatchEvent({type:DX,item:this})}},{key:"interactable",get:function(){return this.__interactable},set:function(e){this.__interactable=e,this.interactive=e,this.buttonMode=e}}]),o}();var aI={};function ija(){var i=!1;if(null!==navigator||navigator,"maxTouchPoints"in navigator)i=navigator.maxTouchPoints>0;else if("msMaxTouchPoints"in navigator)null!==navigator&&(i=navigator.msMaxTouchPoints>0);else{var e=window.matchMedia&&matchMedia("(pointer:coarse)");if(e&&"(pointer:coarse)"===e.media)i=!!e.matches;else if("orientation"in window)i=!0;else{var o=navigator.userAgent;i=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(o)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(o)}}return i}Object.defineProperty(aI,"__esModule",{value:!0});var Rv=ija();aI.isMobile=Rv;var Sv=function(t){Pia(r,zq);var e=Ria(r);function r(t,o,n){var i;return Mia(this,r),(i=e.call(this,t,o)).__corner=n,i.pivot.x=i.pivot.y=.5,i.__cornerUpdateEvent=i.__updateWithModel.bind(Pv(i)),i.__cornerDeletedEvent=i.__cornerDeleted.bind(Pv(i)),i.interactive=n.isLocked,i.buttonMode=n.isLocked,n.isLocked&&i.__deactivate(),i.__drawHoveredOffState(),i.__corner.addEventListener(Va,i.__cornerUpdateEvent),i.__corner.addEventListener(rb,i.__cornerDeletedEvent),i.__updateWithModel(),i}return Nia(r,[{key:"__drawCornerState",value:function(t,e,r){this.clear();Rv&&(this.beginFill(e,1),this.drawCircle(0,0,2.5*t),this.endFill()),this.beginFill(e,1),this.drawCircle(0,0,t),this.endFill(),this.beginFill(r,1),this.drawCircle(0,0,.55*t),this.endFill()}},{key:"__drawSelectedState",value:function(){gk(uf(r.prototype),"__drawSelectedState",this).call(this);var t=this.__options["corner-radius"];this.__drawCornerState(t,305653,301461)}},{key:"__drawHoveredOnState",value:function(){gk(uf(r.prototype),"__drawHoveredOnState",this).call(this);var t=1*this.__options["corner-radius"];this.__drawCornerState(t,0,305653)}},{key:"__drawHoveredOffState",value:function(){gk(uf(r.prototype),"__drawHoveredOffState",this).call(this);var t=this.__options["corner-radius"];this.__drawCornerState(t,13421772,0)}},{key:"__updateWithModel",value:function(){var t=ka.cmToPixel(this.__corner.location.x),e=ka.cmToPixel(this.__corner.location.y);this.position.x=t,this.position.y=e}},{key:"__dragMove",value:function(t){if(gk(uf(r.prototype),"__dragMove",this).call(this,t),this.__isDragging){var e=t.data.getLocalPosition(this.parent),o=new Da(e.x,e.y);o.x=ka.pixelToCm(o.x),o.y=ka.pixelToCm(o.y),(ha.getBooleanValue(bf)||this.__snapToGrid)&&(o.x=Math.floor(o.x/ha.getNumericValue(Wa))*ha.getNumericValue(Wa),o.y=Math.floor(o.y/ha.getNumericValue(Wa))*ha.getNumericValue(Wa)),ha.getBooleanValue(uj)&&!ha.getBooleanValue(vj)&&(o.y=this.__corner.location.y),!ha.getBooleanValue(uj)&&ha.getBooleanValue(vj)&&(o.x=this.__corner.location.x),this.__corner.move(o.x,o.y)}}},{key:"__dragEnd",value:function(t){gk(uf(r.prototype),"__dragEnd",this).call(this,t),this.__floorplan.update()}},{key:"__cornerDeleted",value:function(t){this.remove(),this.__corner=null}},{key:"__removeFromFloorplan",value:function(){this.__corner.remove()}},{key:"remove",value:function(){this.__corner.removeEventListener(rb,this.__cornerDeletedEvent),this.__corner.removeEventListener(Va,this.__cornerUpdateEvent),gk(uf(r.prototype),"remove",this).call(this)}},{key:"corner",get:function(){return this.__corner}}]),r}();function jja(e){return(jja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kja(e,t,i,o){return(kja="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,i,o){var r,n=bI(e,t);if(n){if((r=Object.getOwnPropertyDescriptor(n,t)).set)return r.set.call(o,i),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(o,t)){if(!r.writable)return!1;r.value=i,Object.defineProperty(o,t,r)}else mja(o,t,i);return!0})(e,t,i,o)}function lja(e,t,i,o,r){if(!kja(e,t,i,o||e)&&r)throw new Error("failed to set property");return i}function mja(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Tv(e,t,i){return(Tv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var o=bI(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function bI(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sh(e)););return e}function Uv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cI(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Vv(e,t,i){return t&&cI(e.prototype,t),i&&cI(e,i),e}function Wv(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nja(e,t)}function nja(e,t){return(nja=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xv(e){var t=pja();return function(){var i,o=Sh(e);if(t){var r=Sh(this).constructor;i=Reflect.construct(o,arguments,r)}else i=o.apply(this,arguments);return oja(this,i)}}function oja(e,t){return!t||"object"!==jja(t)&&"function"!=typeof t?Yv(e):t}function Yv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pja(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function Sh(e){return(Sh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qja=function(e){Wv(i,sd);var t=Xv(i);function i(e,o,r){var n;Uv(this,i),n=t.call(this);var l={dimlinecolor:"#3EDEDE",dimarrowcolor:"#000000",dimtextcolor:"#000000"};for(var a in l)l.hasOwnProperty(a)&&o.hasOwnProperty(a)&&(l[a]=o[a]);return l.dimlinecolor=new ga(l.dimlinecolor).getHex(),l.dimarrowcolor=new ga(l.dimarrowcolor).getHex(),l.dimtextcolor=new ga(l.dimtextcolor).getHex(),n.__floorplan=e,n.__options=l,n.__wall=r,n.__textfield=new wg("Length: ",{fontFamily:"Arial",fontSize:14,fill:n.__options.dimtextcolor,align:"center"}),n.__textfield.anchor.set(.5,.5),n.interactive=n.__textfield.interactive=!1,n.addChild(n.__textfield),n.update(),n}return Vv(i,[{key:"__getPolygon",value:function(e,t,i){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=[],n=0;n<i;n++){var l=n/i*Math.PI*2,a=Math.sin(l+o)*t+e.x,$=Math.cos(l+o)*t+e.y;r.push(new ca(a,$))}return r}},{key:"__wallNormal",value:function(){if(this.__wall.attachedRooms.length)return this.__wall.attachedRooms[0].getWallOutDirection(this.__wall);var e=this.__wall.wallDirectionNormalized(),t=new ba(e.x,e.y,0);return t.applyAxisAngle(new ba(0,0,1),1.57),t}},{key:"__wallOffsetLocation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,i=this.__wallNormal();null===i&&(i=new ba(0,1,0));var o=e.add(i.multiplyScalar(t));return this.__toPixels(o)}},{key:"__wallOffsetLocationFromCenter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=this.__wall.wallCenter().clone();return this.__wallOffsetLocation(t,e)}},{key:"__toPixels",value:function(e){return e.x=ka.cmToPixel(e.x),e.y=ka.cmToPixel(e.y),e}},{key:"__drawDimensionLine",value:function(){var e=this.__wall.wallDirectionNormalized(),t=this.__wall.wallDirectionNormalized().angle(),i=this.__toPixels(this.__wall.start.location.clone()),o=this.__wallOffsetLocation(this.__wall.start.location.clone(),100),r=this.__toPixels(this.__wall.end.location.clone()),n=this.__wallOffsetLocation(this.__wall.end.location.clone(),100),l=this.__wallOffsetLocation(this.__wall.start.location.clone(),50),a=this.__wallOffsetLocation(this.__wall.end.location.clone(),50);this.clear(),this.lineStyle(2,this.__options.dimlinecolor),this.moveTo(i.x,i.y),this.lineTo(o.x,o.y),this.moveTo(r.x,r.y),this.lineTo(n.x,n.y),this.moveTo(l.x,l.y),this.lineTo(a.x,a.y);var $=l.add(e.clone().multiplyScalar(5)),s=a.sub(e.clone().multiplyScalar(5)),_=this.__getPolygon($,5,4,t+1.57),c=this.__getPolygon(s,5,4,t+1.57),w=0;for(this.beginFill(this.__options.dimarrowcolor,1),this.moveTo(_[0].x,_[0].y),w=1;w<_.length;w++)this.lineTo(_[w].x,_[w].y);for(this.lineTo(_[0].x,_[0].y),this.moveTo(c[0].x,c[0].y),w=1;w<c.length;w++)this.lineTo(c[w].x,c[w].y);this.lineTo(c[0].x,c[0].y),this.endFill()}},{key:"__updateDimensionText",value:function(){var e=this.__wallOffsetLocationFromCenter(100);this.__textfield.text=ka.cmToMeasure(this.__wall.wallSize),this.__textfield.position.x=e.x,this.__textfield.position.y=e.y}},{key:"update",value:function(){this.__drawDimensionLine(),this.__updateDimensionText()}}]),i}();var dI=function(e){Wv(i,zq);var t=Xv(i);function i(e,o,r,n){var l;return Uv(this,i),(l=t.call(this,e,o)).__wall=r,l.__edge=n,l.__debugMode=!1,l.__deactivate(),l}return Vv(i,[{key:"__getCornerCoordinates",value:function(){return[ka.cmToPixelVector2D(this.__wall.start.location.clone()),ka.cmToPixelVector2D(this.__wall.end.location.clone())]}},{key:"__getPolygonCoordinates",value:function(e){var t=[e.exteriorStart(this.__debugMode),e.exteriorEnd(this.__debugMode),e.interiorEnd(this.__debugMode),e.interiorStart(this.__debugMode)];if(Rv){for(var i=[],o=e.getStart().location,r=e.getEnd().location,n=[o,r,r,o],l=0;l<t.length;l++){var a=t[l],$=n[l],s=a.clone().sub($);s=s.multiplyScalar(3).add($);var _=ka.cmToPixelVector2D(s);i.push(_)}return i}for(var c=0;c<t.length;c++)t[c]=ka.cmToPixelVector2D(t[c]);return t}},{key:"__drawEdgeArrow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:14540253,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=ka.cmToPixelVector2D(e.getStart().location.clone()),r=ka.cmToPixelVector2D(e.getEnd().location.clone()).clone().sub(o),n=o.clone().add(r.multiplyScalar(.5));this.lineStyle(3,t,i),this.moveTo(o.x,o.y),this.lineTo(n.x,n.y),this.beginFill(t,i),this.drawCircle(o.x,o.y,5),this.drawRect(n.x-3.5,n.y-3.5,7,7),this.endFill()}},{key:"__drawEdgePolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:14540253,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=this.__getPolygonCoordinates(e);this.clear();this.lineStyle(2.5,t,1),this.moveTo(o[2].x,o[2].y),this.lineTo(o[3].x,o[3].y),this.lineStyle(2.5,t,0),this.beginFill(t,i);for(var r=0;r<o.length;r++){var n=o[r];0===r?this.moveTo(n.x,n.y):this.lineTo(n.x,n.y)}this.endFill()}},{key:"drawEdge",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:14540253,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.clear();var i=this.__debugMode?.1:t;if(this.__drawEdgePolygon(this.__edge,e,i),this.__debugMode&&(this.__drawEdgeArrow(this.__edge,0,t),this.__edge.prev&&this.__drawEdgeArrow(this.__edge.prev,16711680,t),this.__edge.next&&this.__drawEdgeArrow(this.__edge.next,255,t)),!this.__debugMode){var o=this.__getCornerCoordinates();this.lineStyle(1.5,15790320),this.moveTo(o[1].x,o[1].y),this.lineTo(o[0].x,o[0].y)}}},{key:"edge",get:function(){return this.__edge}},{key:"debugMode",get:function(){return this.__debugMode},set:function(e){this.__debugMode=e}}]),i}();var Zv=function(e){Wv(i,zq);var t=Xv(i);function i(e,o,r){var n;return Uv(this,i),(n=t.call(this,e,o)).__options=o,n.__wall=r,n.__frontEdge=null,n.__backEdge=null,n.__info=new qja(e,o,r),n.viewDimensions=!1,n.interactive=r.isLocked,n.buttonMode=r.isLocked,r.isLocked&&n.__deactivate(),n.__wallUpdatedEvent=n.__drawUpdatedWall.bind(Yv(n)),n.__wallDeletedEvent=n.__wallDeleted.bind(Yv(n)),n.__wall.addEventListener(Va,n.__wallUpdatedEvent),n.__wall.addEventListener(Fd,n.__wallUpdatedEvent),n.__wall.addEventListener(rb,n.__wallDeletedEvent),r.backEdge&&(n.__backEdge=new dI(n.__floorplan,o,n.__wall,r.backEdge),n.addChild(n.__backEdge)),r.frontEdge&&(n.__frontEdge=new dI(n.__floorplan,o,n.__wall,r.frontEdge),n.addChild(n.__frontEdge)),n.addChild(n.__info),n.__mouseOut(),n}return Vv(i,[{key:"__getCornerCoordinates",value:function(){return[ka.cmToPixelVector2D(this.__wall.start.location.clone()),ka.cmToPixelVector2D(this.__wall.end.location.clone())]}},{key:"__drawInWallItems",value:function(){this.lineStyle(0,15790320);for(var e=this.__wall.inWallItems,t=this.__wall.wallDirectionNormalized(),i=0;i<e.length;i++){var o=e[i],r=new ca(o.position.x,o.position.z),n=o.halfSize.x,l=o.halfSize.z,a=t.clone().multiplyScalar(n),$=t.clone().multiplyScalar(n).multiplyScalar(-1),s=t.clone().rotateAround(new ca,.5*Math.PI).multiplyScalar(l),_=s.clone().multiplyScalar(-1),c=r.clone().add(a.clone().add(s)),w=r.clone().add(a.clone().sub(s)),d=r.clone().add($.clone().add(_)),u=r.clone().add($.clone().sub(_)),p=[new Da(ka.cmToPixel(c.x),ka.cmToPixel(c.y)),new Da(ka.cmToPixel(w.x),ka.cmToPixel(w.y)),new Da(ka.cmToPixel(d.x),ka.cmToPixel(d.y)),new Da(ka.cmToPixel(u.x),ka.cmToPixel(u.y))];this.beginFill(240,.85),this.drawPolygon(p),this.endFill()}}},{key:"__drawPolygon",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:14540253,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.clear();var i=e,o=e;this.__frontEdge&&this.__frontEdge.drawEdge(i,t),this.__backEdge&&this.__backEdge.drawEdge(o,t),this.__drawInWallItems()}},{key:"__drawSelectedState",value:function(){this.__frontEdge&&(this.__frontEdge.debugMode=!0),this.__backEdge&&(this.__backEdge.debugMode=!0),this.__drawPolygon(301461,1)}},{key:"__drawHoveredOnState",value:function(){this.__drawPolygon(305653,1)}},{key:"__drawHoveredOffState",value:function(){this.__frontEdge&&(this.__frontEdge.debugMode=!1),this.__backEdge&&(this.__backEdge.debugMode=!1),this.__drawPolygon(0,1)}},{key:"__dragMove",value:function(e){if(Tv(Sh(i.prototype),"__dragMove",this).call(this,e),this.__isDragging){var t=e.data.getLocalPosition(this.parent),o=new ca(t.x,t.y);if(o.x=ka.pixelToCm(o.x),o.y=ka.pixelToCm(o.y),(ha.getBooleanValue(bf)||this.__snapToGrid)&&(o.x=Math.floor(o.x/ha.getNumericValue(Wa))*ha.getNumericValue(Wa),o.y=Math.floor(o.y/ha.getNumericValue(Wa))*ha.getNumericValue(Wa)),ha.getBooleanValue(Ot)){var r=this.__wall.projectOnWallPlane(o),n=o.clone().sub(r);if(ha.getBooleanValue(bf)||this.__snapToGrid){var l=Math.floor(n.length()/ha.getNumericValue(Wa))*ha.getNumericValue(Wa);n=n.normalize().multiplyScalar(l)}o=this.__wall.location.clone().add(n)}ha.getBooleanValue(uj)&&!ha.getBooleanValue(vj)&&(o.y=this.__wall.location.y),!ha.getBooleanValue(uj)&&ha.getBooleanValue(vj)&&(o.x=this.__wall.location.x),this.__wall.location=o,e.stopPropagation()}}},{key:"__drawUpdatedWall",value:function(e){this.__info.update(),this.viewDimensions=!0,this.selected?this.__drawSelectedState():this.__drawHoveredOffState()}},{key:"__wallDeleted",value:function(){this.remove(),this.__wall=null}},{key:"__removeFromFloorplan",value:function(){this.__wall.remove()}},{key:"remove",value:function(){this.__wall.removeEventListener(Va,this.__wallUpdatedEvent),this.__wall.removeEventListener(Fd,this.__wallUpdatedEvent),this.__wall.removeEventListener(rb,this.__wallDeletedEvent),this.removeChild(this.__info),Tv(Sh(i.prototype),"remove",this).call(this)}},{key:"viewDimensions",get:function(){return this.__info.alpha>.9},set:function(e){this.__info.alpha=e?1:.15}},{key:"wall",get:function(){return this.__wall}},{key:"selected",get:function(){return Tv(Sh(i.prototype),"selected",this)},set:function(e){lja(Sh(i.prototype),"selected",e,this,!0),this.viewDimensions=e}}]),i}();function rja(e){return(rja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sja(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eI(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function tja(e,t,r){return t&&eI(e.prototype,t),r&&eI(e,r),e}function uja(e,t,r){return(uja="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var o=vja(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function vja(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Aq(e)););return e}function wja(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xja(e,t)}function xja(e,t){return(xja=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yja(e){var t=Aja();return function(){var r,o=Aq(e);if(t){var i=Aq(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return zja(this,r)}}function zja(e,t){return!t||"object"!==rja(t)&&"function"!=typeof t?fI(e):t}function fI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aja(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function Aq(e){return(Aq=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $v=function(e){wja(r,zq);var t=yja(r);function r(e,o,i){var n;return sja(this,r),(n=t.call(this,e,o)).__room=i,n.__updatedRoomEvent=n.__drawUpdatedRoom.bind(fI(n)),n.__roomNameField=new wg("Room Name ",{fontFamily:"Arial",fontSize:14,fill:"#000000",align:"left"}),n.__roomAreaField=new wg("Room Area ",{fontFamily:"Arial",fontSize:14,fill:"#000000",align:"left"}),n.__roomAreaField.alpha=.5,n.__roomNameField.alpha=.5,n.interactive=i.isLocked,n.buttonMode=i.isLocked,i.isLocked&&n.__deactivate(),n.addChild(n.__roomNameField),n.addChild(n.__roomAreaField),n.__room.addEventListener(lg,n.__updatedRoomEvent),n.__room.addEventListener(gd,n.__updatedRoomEvent),ha.getInstance().addEventListener(gd,n.__updatedRoomEvent),n.__drawUpdatedLabel(),n.__mouseOut(),n}return tja(r,[{key:"__drawUpdatedLabel",value:function(){var e=this.__room.areaCenter,t=Math.round(100*this.__room.area)/100,r=ka.cmToMeasure(t.toFixed(1),2);this.__roomNameField.position.x=this.__roomAreaField.position.x=ka.cmToPixel(e.x),this.__roomNameField.position.y=ka.cmToPixel(e.y)-15,this.__roomAreaField.position.y=ka.cmToPixel(e.y)+15,this.__roomAreaField.text=r+"\xB2",this.__roomNameField.text=this.__room.name,this.__roomNameField.anchor.set(.5,.5),this.__roomAreaField.anchor.set(.5,.5)}},{key:"__drawUpdatedRoom",value:function(){this.__drawUpdatedLabel(),this.__drawPolygon(),this.__drawHoveredOffState()}},{key:"__drawPolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=[];this.clear(),this.beginFill(e,t),this.__room.corners.forEach(function(e){r.push(new ca(e.x,e.y))});for(var o=0;o<r.length;o++){var i=ka.cmToPixel(r[o].x),n=ka.cmToPixel(r[o].y);0===o?this.moveTo(i,n):this.lineTo(i,n)}this.endFill()}},{key:"__drawSelectedState",value:function(){this.__drawPolygon(47756,.4)}},{key:"__drawHoveredOnState",value:function(){this.__drawPolygon(36026,.4)}},{key:"__drawHoveredOffState",value:function(){this.__drawPolygon(16702207,.4)}},{key:"remove",value:function(){this.__room.removeEventListener(lg,this.__updatedRoomEvent),this.__room.removeEventListener(gd,this.__updatedRoomEvent),ha.getInstance().removeEventListener(gd,this.__updatedRoomEvent),uja(Aq(r.prototype),"remove",this).call(this)}},{key:"room",get:function(){return this.__room}}]),r}();function Bja(t){return(Bja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gI(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Cq(t,e,r){return e&&gI(t.prototype,e),r&&gI(t,r),t}function Dq(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cja(t,e)}function Cja(t,e){return(Cja=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Eq(t){var e=Eja();return function(){var r,i=hI(t);if(e){var n=hI(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return Dja(this,r)}}function Dja(t,e){return!e||"object"!==Bja(e)&&"function"!=typeof e?cc(t):e}function cc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Eja(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function hI(t){return(hI=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Fja=function(t){Dq(r,sd);var e=Eq(r);function r(t,i){var n;Bq(this,r),(n=e.call(this)).__size=t.clone(),n.__center=i.clone();var o=n.__size.clone().multiplyScalar(.5);return n.__tl=n.__center.clone().sub(o),n.__br=n.__center.clone().add(o),n.__tr=new ca(n.__br.x,n.__tl.y),n.__bl=new ca(n.__tl.x,n.__br.y),n.__vertices=[n.__tl,n.__tr,n.__br,n.__bl],n.__originalSize=n.__size.clone(),n.__originalCenter=n.__center.clone(),n.__currentRadians=0,n.__currentScaleMatrix=new fa,n.__currentRotationMatrix=new fa,n.__currentTranslationMatrix=new fa,n.__drawRectangle(),n.__ticker=Nb.shared,n}return Cq(r,[{key:"translateByPosition",value:function(t){for(var e=new fa().makeTranslation(t.x,t.y,0),r=0;r<this.__vertices.length;r++){var i=this.__vertices[r].clone(),n=new ba(i.x,i.y,0);n=n.applyMatrix4(e),this.__vertices[r].x=n.x,this.__vertices[r].y=n.y}this.__center.y=this.__tr.y-this.__tl.y,this.__size.x=this.__tl.clone().sub(this.__tr).length(),this.__size.y=this.__tl.clone().sub(this.__bl).length(),this.__center=this.__br.clone().sub(this.__tl).multiplyScalar(.5).add(this.__tl);var o=this.__center.clone().sub(this.__originalCenter);this.__currentTranslationMatrix=new fa().makeTranslation(o.x,o.y,0),this.__drawRectangle()}},{key:"rotateByRadians",value:function(t){for(var e=new fa().makeTranslation(-this.__center.x,-this.__center.y,0),r=new fa().makeTranslation(this.__center.x,this.__center.y,0),i=new fa().makeRotationAxis(new ba(0,0,1),t),n=r.clone().multiply(i).multiply(e),o=new fa().makeRotationAxis(new ba(0,0,1),-this.__currentRadians),a=r.clone().multiply(o).multiply(e),s=0;s<this.__vertices.length;s++){var _=this.__vertices[s].clone(),l=new ba(_.x,_.y,0);l=(l=l.applyMatrix4(a)).applyMatrix4(n),this.__vertices[s].x=l.x,this.__vertices[s].y=l.y}this.__currentRotationMatrix=n.clone(),this.__currentRadians=t,this.__center.y=this.__tr.y-this.__tl.y,this.__size.x=this.__tl.clone().sub(this.__tr).length(),this.__size.y=this.__tl.clone().sub(this.__bl).length(),this.__center=this.__br.clone().sub(this.__tl).multiplyScalar(.5).add(this.__tl),this.__drawRectangle()}},{key:"scaleBySize",value:function(t,e,r){for(var i=new ca(t/this.__size.x,e/this.__size.y),n=new fa().makeTranslation(-r.x,-r.y,0),o=new fa().makeTranslation(r.x,r.y,0),a=new fa().makeRotationAxis(new ba(0,0,1),this.__currentRadians),s=new fa().makeScale(i.x,i.y,1),_=o.clone().multiply(s).multiply(n),l=o.clone().multiply(a).multiply(n),c=l.clone().getInverse(l.clone()),u=l.clone().multiply(_).multiply(c),$=0;$<this.__vertices.length;$++){var m=this.__vertices[$].clone(),p=new ba(m.x,m.y,0);p=p.applyMatrix4(u),this.__vertices[$].x=p.x,this.__vertices[$].y=p.y}this.__size.x=t,this.__size.y=e,this.__center=this.__br.clone().sub(this.__tl).multiplyScalar(.5).add(this.__tl);var h=this.__center.clone().sub(this.__originalCenter);this.__currentRotationMatrix=a.clone(),this.__currentScaleMatrix=this.__currentScaleMatrix.multiply(s),this.__currentTranslationMatrix=new fa().makeTranslation(h.x,h.y,0),this.__drawRectangle()}},{key:"__tick",value:function(){console.log("TICK TICK TICK")}},{key:"__drawRectangle",value:function(){this.clear(),this.beginFill(13421772,.5),this.moveTo(this.__tl.x,this.__tl.y),this.lineTo(this.__tr.x,this.__tr.y),this.lineTo(this.__br.x,this.__br.y),this.lineTo(this.__bl.x,this.__bl.y),this.endFill()}},{key:"destroy",value:function(){this.__ticker.remove(this.__tick,this),this.__ticker.destroy()}},{key:"tl",get:function(){return this.__tl}},{key:"tr",get:function(){return this.__tr}},{key:"br",get:function(){return this.__br}},{key:"bl",get:function(){return this.__bl}},{key:"size",get:function(){return this.__size}},{key:"center",get:function(){return this.__center}},{key:"rotationMatrix",get:function(){return this.__currentRotationMatrix.clone()}},{key:"scalingMatrix",get:function(){return this.__currentScaleMatrix}},{key:"translationMatrix",get:function(){return this.__currentTranslationMatrix}},{key:"rotationRadians",get:function(){return this.__currentRadians}},{key:"origin",get:function(){return this.__center}},{key:"matrix4",get:function(){var t=new ba().setFromMatrixScale(this.__currentScaleMatrix),e=new yb().setFromRotationMatrix(this.__currentRotationMatrix),r=new ba().setFromMatrixPosition(this.__currentTranslationMatrix),i=new fa().makeScale(t.x,t.y,1),n=new fa().makeRotationFromQuaternion(e),o=new fa().makeTranslation(r.x,r.y,r.z);return n.multiply(i).multiply(o)}}]),r}(),iI=function(t){Dq(r,Ph);var e=Eq(r);function r(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"icons/rotateGroup.svg";return Bq(this,r),(t=e.call(this,new ya.from(i))).__eventDispatcher=new Qa,t.__mouseUpEvent=t.__dragEnd.bind(cc(t)),t.__mouseMoveEvent=t.__dragMove.bind(cc(t)),t.__mouseOverEvent=t.__mouseOver.bind(cc(t)),t.__mouseOutEvent=t.__mouseOut.bind(cc(t)),t.__mouseDownEvent=t.__mouseDown.bind(cc(t)),t.on("mousedown",t.__mouseDownEvent).on("touchstart",t.__mouseDownEvent),t.on("mouseupoutside",t.__mouseUpEvent).on("touchendoutside",t.__mouseUpEvent),t.on("mouseup",t.__mouseUpEvent).on("touchend",t.__mouseUpEvent),t.on("mousemove",t.__mouseMoveEvent).on("touchmove",t.__mouseMoveEvent),t.on("mouseover",t.__mouseOverEvent).on("mouseout",t.__mouseOutEvent),t.interactive=!0,t.buttonMode=!0,t.scale.set(.05,.05),t.anchor.set(.5),t}return Cq(r,[{key:"__mouseDown",value:function(t){t.stopPropagation(),this.__isDragged=!0;var e=t.data.getLocalPosition(this.parent);this.__eventDispatcher.dispatchEvent({type:"DragStart",position:e,handle:this})}},{key:"__mouseOver",value:function(t){t.stopPropagation()}},{key:"__mouseOut",value:function(t){t.stopPropagation()}},{key:"__dragEnd",value:function(t){t.stopPropagation(),this.__isDragged=!1;var e=t.data.getLocalPosition(this.parent);this.__eventDispatcher.dispatchEvent({type:"DragEnd",position:e,handle:this})}},{key:"__dragMove",value:function(t){if(this.__isDragged){t.stopPropagation();var e=ha.getBooleanValue(bf),r=t.data.getLocalPosition(this.parent);e&&(r.x=Math.floor(r.x/ha.getNumericValue(Wa))*ha.getNumericValue(Wa),r.y=Math.floor(r.y/ha.getNumericValue(Wa))*ha.getNumericValue(Wa)),this.__eventDispatcher.dispatchEvent({type:"DragMove",position:r,handle:this})}}},{key:"addFloorplanListener",value:function(t,e){this.__eventDispatcher.addEventListener(t,e)}},{key:"removeFloorplanListener",value:function(t,e){this.__eventDispatcher.removeEventListener(t,e)}}]),r}(),Gja=function(t){Dq(r,sd);var e=Eq(r);function r(t,i){var n;Bq(this,r),n=e.call(this);var o={radius:10,outerColor:65280,innerColor:"#FFFF00",move:{x:1,y:1},offset:{x:-.5,y:-.5}};if(i)for(var a in o)o.hasOwnProperty(a)&&i.hasOwnProperty(a)&&(o[a]=i[a]),"outerColor"!==a&&"innerColor"!==a||(o[a]=$p(o[a]));return n.id=va.guide(),n.__index=t,n.__isDragged=!1,n.__center=new ca,n.__size=new ca,n.__parameters=o,n.__parameters.move=new ca(o.move.x,o.move.y),n.__opposite=null,n.__matrix4=new fa,n.__eventDispatcher=new Qa,n.__textfield=new wg(n.__index,{fontFamily:"Arial",fontSize:12,fill:0,align:"center"}),n.__textfield.pivot.x=3,n.__textfield.pivot.y=6,n.__mouseUpEvent=n.__dragEnd.bind(cc(n)),n.__mouseMoveEvent=n.__dragMove.bind(cc(n)),n.__mouseOverEvent=n.__mouseOver.bind(cc(n)),n.__mouseOutEvent=n.__mouseOut.bind(cc(n)),n.__mouseDownEvent=n.__mouseDown.bind(cc(n)),n.on("mousedown",n.__mouseDownEvent).on("touchstart",n.__mouseDownEvent),n.on("mouseupoutside",n.__mouseUpEvent).on("touchendoutside",n.__mouseUpEvent),n.on("mouseup",n.__mouseUpEvent).on("touchend",n.__mouseUpEvent),n.on("mousemove",n.__mouseMoveEvent).on("touchmove",n.__mouseMoveEvent),n.on("mouseover",n.__mouseOverEvent).on("mouseout",n.__mouseOutEvent),n.interactive=!0,n.buttonMode=!0,n.addChild(n.__textfield),n.__drawPoint(),n}return Cq(r,[{key:"__drawPoint",value:function(){this.clear();var t=3*this.__parameters.radius,e=2*this.__parameters.radius,r=this.__parameters.radius;this.beginFill(0,.1),this.drawRect(.5*-t,.5*-t,t,t),this.beginFill(this.__parameters.outerColor,1),this.drawRect(.5*-e,.5*-e,e,e),this.beginFill(this.__parameters.innerColor,1),this.drawRect(.5*-r,.5*-r,r,r)}},{key:"__mouseDown",value:function(t){t.stopPropagation(),this.__isDragged=!0;var e=t.data.getLocalPosition(this.parent);this.__eventDispatcher.dispatchEvent({type:"DragStart",position:e,handle:this,opposite:this.opposite})}},{key:"__mouseOver",value:function(t){t.stopPropagation()}},{key:"__mouseOut",value:function(t){t.stopPropagation()}},{key:"__dragEnd",value:function(t){t.stopPropagation(),this.__isDragged=!1;var e=t.data.getLocalPosition(this.parent);this.__eventDispatcher.dispatchEvent({type:"DragEnd",position:e,handle:this,opposite:this.opposite})}},{key:"__dragMove",value:function(t){if(this.__isDragged){t.stopPropagation();var e=ha.getBooleanValue(bf),r=t.data.getLocalPosition(this.parent);e&&(r.x=Math.floor(r.x/ha.getNumericValue(Wa))*ha.getNumericValue(Wa),r.y=Math.floor(r.y/ha.getNumericValue(Wa))*ha.getNumericValue(Wa)),this.__eventDispatcher.dispatchEvent({type:"DragMove",position:r,handle:this,opposite:this.opposite})}}},{key:"updateCenterAndSize",value:function(t,e){var r=e.x*this.__parameters.offset.x,i=e.y*this.__parameters.offset.y;this.position.x=r+t.x,this.position.y=i+t.y}},{key:"addFloorplanListener",value:function(t,e){this.__eventDispatcher.addEventListener(t,e)}},{key:"removeFloorplanListener",value:function(t,e){this.__eventDispatcher.removeEventListener(t,e)}},{key:"location",get:function(){return new ca(this.position.x,this.position.y)}},{key:"index",get:function(){return this.__index}},{key:"opposite",get:function(){return this.__opposite},set:function(t){this.__opposite=t}},{key:"move",get:function(){return this.__parameters.move}},{key:"offset",get:function(){return this.__parameters.offset}},{key:"matrix4",get:function(){return this.__matrix4},set:function(t){this.__matrix4=t.clone()}}]),r}(),Hja=function(t){Dq(r,sd);var e=Eq(r);function r(t,i){var n;Bq(this,r),n=e.call(this);var o={scale:!0,rotate:!0,translate:!0};if(i)for(var a in o)o.hasOwnProperty(a)&&i.hasOwnProperty(a)&&(o[a]=i[a]);return n.__parameters=o,n.__floorplan=t,n.__groups=n.__floorplan.cornerGroups,n.__currentGroup=null,n.__cornerPointer=null,n.__isActive=!1,n.__originalPositions=[],n.__size=null,n.__center=null,n.__scalingHandles=[],n.__rotateHandle=new iI,n.__translateHandle=new iI("icons/translateGroup.svg"),n.__resizer=null,n.__scaleHandleDragStartEvent=n.__scaleHandleDragStart.bind(cc(n)),n.__scaleHandleDragEndEvent=n.__scaleHandleDragEnd.bind(cc(n)),n.__scaleHandleDragMoveEvent=n.__scaleHandleDragMove.bind(cc(n)),n.__rotateHandleDragStartEvent=n.__rotateHandleDragStart.bind(cc(n)),n.__rotateHandleDragEndEvent=n.__rotateHandleDragEnd.bind(cc(n)),n.__rotateHandleDragMoveEvent=n.__rotateHandleDragMove.bind(cc(n)),n.__parameters.scale&&n.__createScalingHandles(),n.__parameters.rotate&&(n.__rotateHandle.addFloorplanListener("DragStart",n.__rotateHandleDragStartEvent),n.__rotateHandle.addFloorplanListener("DragMove",n.__rotateHandleDragMoveEvent),n.__rotateHandle.addFloorplanListener("DragEnd",n.__rotateHandleDragEndEvent),n.addChild(n.__rotateHandle)),n.__parameters.translate&&(n.__translateHandle.addFloorplanListener("DragStart",n.__rotateHandleDragStartEvent),n.__translateHandle.addFloorplanListener("DragMove",n.__rotateHandleDragMoveEvent),n.__translateHandle.addFloorplanListener("DragEnd",n.__rotateHandleDragEndEvent),n.addChild(n.__translateHandle)),n}return Cq(r,[{key:"__createScalingHandles",value:function(){for(var t=0,e=1,r=0,i=[-.5,0,.5,.5,.5,0,-.5,-.5],n=[-.5,-.5,-.5,0,.5,.5,.5,-0],o=[0,-1,1,-1,2,-1,3,-1];t<8;t++){var a=1,s=1;t%2==1&&(a=e=Number(!e),s=r=Number(!r));var _=new Gja(t,{move:{x:a,y:s},offset:{x:i[t],y:n[t]}});_.addFloorplanListener("DragStart",this.__scaleHandleDragStartEvent),_.addFloorplanListener("DragEnd",this.__scaleHandleDragEndEvent),_.addFloorplanListener("DragMove",this.__scaleHandleDragMoveEvent),this.addChild(_),this.__scalingHandles.push(_)}for(t=0;t<8;t++){var l=this.__scalingHandles[t],c=(t+4)%8;l.extraIndex=o[t],l.opposite=this.__scalingHandles[c]}}},{key:"__scaleHandleDragStart",value:function(t){}},{key:"__scaleHandleDragMove",value:function(t){this.__isActive=!0;var e=new ba(t.position.x,t.position.y,0),r=t.handle,i=t.opposite,n=new ba(i.location.x,i.location.y,0).clone().sub(e),o=this.__resizer.size.x,a=this.__resizer.size.y;if(r.move.x&&r.move.y){var s=null,_=null,l=new ca(t.position.x,t.position.y);switch(r.extraIndex){case 0:s=l.clone().sub(this.__resizer.tr.clone()),_=l.clone().sub(this.__resizer.bl.clone());break;case 1:s=l.clone().sub(this.__resizer.tl.clone()),_=l.clone().sub(this.__resizer.br.clone());break;case 2:s=l.clone().sub(this.__resizer.bl.clone()),_=l.clone().sub(this.__resizer.tr.clone());break;default:s=l.clone().sub(this.__resizer.br.clone()),_=l.clone().sub(this.__resizer.tl.clone());}o=s.length(),a=_.length()}else r.move.x?o=n.length():r.move.y&&(a=n.length());this.__resizer.scaleBySize(o,a,i.location),this.__setControlsPosition()}},{key:"__scaleHandleDragEnd",value:function(t){this.__isActive&&(this.__setControlsPosition(),this.__updateMatrixOfGroup(),this.__isActive=!1)}},{key:"__rotateHandleDragStart",value:function(t){}},{key:"__rotateHandleDragMove",value:function(t){this.__isActive=!0;var e=t.handle;if(e===this.__rotateHandle){var r=new ca(t.position.x,t.position.y).sub(this.__resizer.center),i=Math.atan2(r.y,r.x);this.__resizer.rotateByRadians(i)}else if(e===this.__translateHandle){var n=new ca(t.position.x,t.position.y).sub(this.__resizer.center);this.__resizer.translateByPosition(n)}this.__setControlsPosition()}},{key:"__rotateHandleDragEnd",value:function(t){this.__isActive&&(this.__setControlsPosition(),this.__updateMatrixOfGroup(),this.__isActive=!1)}},{key:"__updateMatrixOfGroup",value:function(){var t=this.__resizer.matrix4,e=new ba().setFromMatrixScale(t);this.__currentGroup.applyTransformations(e,this.__resizer.rotationRadians,this.__toUnits(this.__resizer.origin.clone()))}},{key:"__toPixels",value:function(t){return t.x=ka.cmToPixel(t.x),t.y=ka.cmToPixel(t.y),t}},{key:"__toUnits",value:function(t){return t.x=ka.pixelToCm(t.x),t.y=ka.pixelToCm(t.y),t}},{key:"__setControlsPosition",value:function(){if(this.__parameters.scale)for(var t=this.__resizer.center,e=this.__resizer.tr.clone().sub(this.__resizer.tl),r=this.__resizer.bl.clone().sub(this.__resizer.tl),i=0;i<this.__scalingHandles.length;i++){var n=this.__scalingHandles[i],o=e.clone().multiplyScalar(n.offset.x),a=r.clone().multiplyScalar(n.offset.y),s=o.add(a),_=t.clone().add(s);n.position.set(_.x,_.y),this.__originalPositions.push(new ca(n.position.x,n.position.y))}if(this.__parameters.rotate){var l=this.__resizer.br.clone().sub(this.__resizer.tr).multiplyScalar(.5).add(this.__resizer.tr),c=this.__resizer.bl.clone().sub(this.__resizer.br).normalize().negate(),u=l.add(c.multiplyScalar(50));this.__rotateHandle.position.set(u.x,u.y)}this.__parameters.translate&&this.__translateHandle.position.set(this.__resizer.center.x,this.__resizer.center.y)}},{key:"__updateTransformControls",value:function(){this.__currentScale=new ca(1,1),this.__size=this.__toPixels(this.__currentGroup.size.clone()),this.__center=this.__toPixels(this.__currentGroup.center.clone()),this.__matrix=this.__currentGroup.matrix.clone(),this.__resizer&&(this.__resizer.destroy(),this.removeChild(this.__resizer)),this.__resizer=new Fja(this.__size,this.__center),this.addChild(this.__resizer),this.__setControlsPosition()}},{key:"selected",get:function(){return this.__selected},set:function(t){if(this.__currentGroup&&this.__currentGroup.update(),this.__selected=t,this.__selected){var e=null;if(t instanceof Tt)e=t;else if(t instanceof Vt)e=t.start;else{if(!(t instanceof Dp))throw new Error("selected  can assigned with a Corner, Wall, Room or null. Unrecogonized datatype");e=t.corners[0]}this.__currentGroup=this.__groups.getContainingGroup(e),this.__cornerPointer=e,this.__updateTransformControls()}else this.__resizer&&this.__resizer.destroy(),this.__cornerPointer=null}}]),r}();var hb={MOVE:0,DRAW:1,EDIT_ISLANDS:2};var Ija=function(e){QE(o,sd);var n=RE(o);function o(){var e;return NE(this,o),(e=n.call(this)).__textfield=new wg("Length: ",{fontFamily:"Arial",fontSize:14,fill:"black",align:"center"}),e.addChild(e.__textfield),e}return PE(o,[{key:"__toPixels",value:function(e){return e.x=ka.cmToPixel(e.x),e.y=ka.cmToPixel(e.y),e}},{key:"update",value:function(e,n,o){if(this.clear(),this.__textfield.visible=!1,void 0!==e&&void 0!==n){var r=this.__toPixels(e.location.clone()),t=this.__toPixels(n.clone()),i=n.clone().sub(e.location),_=t.clone().sub(r).multiplyScalar(.5).add(r);this.lineStyle(10,36026),this.moveTo(r.x,r.y),this.lineTo(t.x,t.y),this.beginFill(36026,.5),this.drawCircle(t.x,t.y,10),this.__textfield.position.x=_.x,this.__textfield.position.y=_.y,this.__textfield.text=ka.cmToMeasure(i.length()),this.__textfield.visible=!0}if(void 0!==o){var a=this.__toPixels(o);this.beginFill(36026,.5),this.drawCircle(a.x,a.y,10)}}}]),o}(),Jja=function(e){QE(o,Zj);var n=RE(o);function o(e,r,t){var i;NE(this,o),(i=n.call(this,{width:512,height:512})).__eventDispatcher=new Qa;var _={"corner-radius":20,pannable:!0,zoomable:!0,dimlinecolor:"#3EDEDE",dimarrowcolor:"#000000",dimtextcolor:"#000000",scale:!0,rotate:!0,translate:!0};for(var a in _)_.hasOwnProperty(a)&&t.hasOwnProperty(a)&&(_[a]=t[a]);i.__mode=hb.MOVE,i.__canvasHolder=document.getElementById(e),i.__floorplan=r,i.__options=_,i.__lastNode=null,i.__tempWall=new Ija,i.__corners2d=[],i.__walls2d=[],i.__rooms2d=[],i.__entities2D=[],i.__externalCorners2d=[],i.__externalWalls2d=[],i.__externalRooms2d=[],i.__externalEntities2d=[],i.__worldWidth=3e3,i.__worldHeight=3e3,i.__currentSelection=null,i.__zoomedEvent=i.__zoomed.bind(Uc(i)),i.__pannedEvent=i.__panned.bind(Uc(i)),i.__selectionMonitorEvent=i.__selectionMonitor.bind(Uc(i)),i.__cornerMovedEvent=i.__cornerMoved.bind(Uc(i)),i.__drawModeMouseDownEvent=i.__drawModeMouseDown.bind(Uc(i)),i.__drawModeMouseUpEvent=i.__drawModeMouseUp.bind(Uc(i)),i.__drawModeMouseMoveEvent=i.__drawModeMouseMove.bind(Uc(i)),i.__redrawFloorplanEvent=i.__redrawFloorplan.bind(Uc(i)),i.__drawExternalFloorplanEvent=i.__drawExternalFloorplan.bind(Uc(i)),i.__windowResizeEvent=i._handleWindowResize.bind(Uc(i)),i.__resetFloorplanEvent=i.__resetFloorplan.bind(Uc(i)),i.__floorplanContainer=new Aia({screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:i.__worldWidth,worldHeight:i.__worldHeight,interaction:i.renderer.plugins.interaction}),i.__snapToGrid=!1,i.__keyboard=new _H,i.__keyListenerEvent=i.__keyListener.bind(Uc(i)),i.__keyboard.addEventListener(rj,i.__keyListenerEvent),i.__keyboard.addEventListener(qj,i.__keyListenerEvent);var l=new sd;return i.__floorplanElementsHolder=new sd,i.__grid2d=new Kia(i.view,t),i.__groupTransformer=new Hja(i.__floorplan,i.__options),i.__groupTransformer.visible=!1,i.__groupTransformer.selected=null,l.beginFill(16711680),l.drawCircle(0,0,5),i.__floorplanContainer.position.set(.5*window.innerWidth,.5*window.innerHeight),i.renderer.backgroundColor=16777215,i.renderer.autoResize=!0,i.__tempWall.visible=!1,i.__floorplanContainer.addChild(i.__grid2d),i.__floorplanContainer.addChild(i.__tempWall),i.__floorplanContainer.addChild(l),i.__floorplanContainer.addChild(i.__floorplanElementsHolder),i.__floorplanContainer.addChild(i.__groupTransformer),i.stage.addChild(i.__floorplanContainer),i.__canvasHolder.appendChild(i.view),i.__floorplanContainer.drag().pinch().wheel(),i.__options.pannable||i.__floorplanContainer.plugins.pause("drag"),i.__options.zoomable||(i.__floorplanContainer.plugins.pause("wheel"),i.__floorplanContainer.plugins.pause("pinch")),i.__floorplanContainer.on("zoomed",i.__zoomedEvent),i.__floorplanContainer.on("moved",i.__pannedEvent),i.__floorplanContainer.on("clicked",i.__selectionMonitorEvent),i.__floorplanContainer.on("mousedown",i.__drawModeMouseDownEvent),i.__floorplanContainer.on("mouseup",i.__drawModeMouseUpEvent),i.__floorplanContainer.on("mousemove",i.__drawModeMouseMoveEvent),i.__floorplanContainer.on("touchstart",i.__drawModeMouseUpEvent),i.__floorplanContainer.on("touchend",i.__drawModeMouseUpEvent),i.__floorplanContainer.on("touchmove",i.__drawModeMouseMoveEvent),i.__floorplan.addEventListener(qp,i.__resetFloorplanEvent),i.__floorplan.addEventListener(Vl,i.__redrawFloorplanEvent),i.__floorplan.addEventListener(rb,i.__redrawFloorplanEvent),i.__floorplan.addEventListener(Jt,i.__redrawFloorplanEvent),i.__floorplan.addEventListener(op,i.__drawExternalFloorplanEvent),window.addEventListener("resize",i.__windowResizeEvent),window.addEventListener("orientationchange",i.__windowResizeEvent),i}return PE(o,[{key:"__keyListener",value:function(e){e.type===qj&&"Shift"===e.key&&(this.__snapToGrid=!0),e.type===rj&&"Shift"===e.key&&(this.__snapToGrid=!1),"Escape"===e.key&&this.switchMode(hb.MOVE)}},{key:"switchMode",value:function(e){switch(this.__mode===hb.EDIT_ISLANDS&&e!==hb.EDIT_ISLANDS&&this.__floorplan.update(),e){case hb.DRAW:this.__mode=hb.DRAW,this.__floorplanContainer.plugins.pause("drag");for(var n=0;n<this.__entities2D.length;n++)this.__entities2D[n].interactive=!1;this.__changeCursorMode(),this.__tempWall.update(),this.__tempWall.visible=!0,this.__groupTransformer.visible=!1,this.__groupTransformer.selected=null;break;case hb.EDIT_ISLANDS:this.__mode=hb.EDIT_ISLANDS,this.__currentSelection instanceof Dp?(this.__groupTransformer.visible=!0,this.__groupTransformer.selected=this.__currentSelection):(this.__groupTransformer.visible=!1,this.__groupTransformer.selected=null),this.__floorplanContainer.plugins.pause("drag");for(var o=0;o<this.__corners2d.length;o++)this.__corners2d[o].interactive=!1;for(var r=0;r<this.__walls2d.length;r++)this.__walls2d[r].interactive=!1;this.__changeCursorMode();break;case hb.MOVE:this.__mode=hb.MOVE;for(var t=0;t<this.__entities2D.length;t++)this.__entities2D[t].interactive=!0;this.__tempWall.visible=!1,this.__groupTransformer.visible=!1,this.__groupTransformer.selected=null,this.__lastNode=null,this.__floorplanContainer.plugins.resume("drag"),this.__changeCursorMode();break;default:throw new Error("Unknown Viewer2D mode");}}},{key:"__changeCursorMode",value:function(){var e=this.__mode===hb.DRAW?"crosshair":"pointer";this.renderer.plugins.interaction.cursorStyles.crosshair=e,this.renderer.plugins.interaction.cursorStyles.default=e,this.renderer.plugins.interaction.setCursorMode(e)}},{key:"__drawModeMouseDown",value:function(e){yu&&this.__drawModeMouseUp(e)}},{key:"__drawModeMouseUp",value:function(e){if(this.__mode===hb.DRAW){var n=e.data.getLocalPosition(this.__floorplanContainer),o=new ca(n.x,n.y);o.x=ka.pixelToCm(o.x),o.y=ka.pixelToCm(o.y),(ha.getBooleanValue(bf)||this.__snapToGrid)&&(o.x=Math.floor(o.x/ha.getNumericValue(Wa))*ha.getNumericValue(Wa),o.y=Math.floor(o.y/ha.getNumericValue(Wa))*ha.getNumericValue(Wa));var r=this.__floorplan.newCorner(o.x,o.y);null!=this.__lastNode&&(this.__floorplan.newWall(this.__lastNode,r),this.__floorplan.newWallsForIntersections(this.__lastNode,r)),r.mergeWithIntersected()&&null!=this.__lastNode&&(this.__tempWall.visible=!1,this.__lastNode=null,this.switchMode(hb.MOVE)),null===this.__lastNode&&this.__mode===hb.DRAW&&(this.__tempWall.visible=!0),yu&&r&&null!==this.__lastNode?(this.__tempWall.visible=!1,this.__lastNode=null):this.__lastNode=r}}},{key:"__drawModeMouseMove",value:function(e){if(this.__mode===hb.DRAW){var n=e.data.getLocalPosition(this.__floorplanContainer),o=new ca(n.x,n.y);o.x=ka.pixelToCm(o.x),o.y=ka.pixelToCm(o.y),(ha.getBooleanValue(bf)||this.__snapToGrid)&&(o.x=Math.floor(o.x/ha.getNumericValue(Wa))*ha.getNumericValue(Wa),o.y=Math.floor(o.y/ha.getNumericValue(Wa))*ha.getNumericValue(Wa)),null!==this.__lastNode?this.__tempWall.update(this.__lastNode,o):this.__tempWall.update(void 0,void 0,o)}}},{key:"__cornerMoved",value:function(e){this.__mode!==hb.EDIT_ISLANDS&&(this.__groupTransformer.visible=!1,this.__groupTransformer.selected=null)}},{key:"__selectionMonitor",value:function(e){this.__currentSelection=null,this.__groupTransformer.visible=!1,this.__groupTransformer.selected=null,this.__eventDispatcher.dispatchEvent({type:Nt});for(var n=0;n<this.__entities2D.length;n++){var o=this.__entities2D[n];void 0!==e.item&&e.item===o||(o.selected=!1)}if(e.item){var r=null;e.item instanceof Zv?(r=e.item.wall,this.__eventDispatcher.dispatchEvent({type:Lt,item:e.item.wall,entity:e.item})):e.item instanceof Sv?(r=e.item.corner,this.__eventDispatcher.dispatchEvent({type:Kt,item:e.item.corner,entity:e.item})):e.item instanceof $v&&(r=e.item.room,this.__eventDispatcher.dispatchEvent({type:Mt,item:e.item.room,entity:e.item})),this.__mode===hb.EDIT_ISLANDS&&(this.__groupTransformer.visible=!0,this.__groupTransformer.selected=r),this.__currentSelection=r}}},{key:"__zoomed",value:function(){var e=this.__floorplanContainer.scale.x;e=e<.4?.4:e>60?60:e,this.__floorplanContainer.scale.x=this.__floorplanContainer.scale.y=e,this.__grid2d.gridScale=this.__floorplanContainer.scale.x}},{key:"__panned",value:function(){var e=this.__floorplanContainer.y,n=this.__floorplanContainer.x;e=Math.max(-4100,e),e=Math.min(4100,e),n=Math.max(-3e3,n),n=Math.min(3e3,n),this.__floorplanContainer.x=n,this.__floorplanContainer.y=e}},{key:"__resetFloorplan",value:function(e){this.__mode=hb.MOVE,this.__groupTransformer.visible=!1,this.__groupTransformer.selected=null,this.__drawExternalFloorplan()}},{key:"__redrawFloorplan",value:function(){var e=this,n=0;this.__entities2D.forEach(function(n){n.removeFloorplanListener(Yl,e.__selectionMonitorEvent),n.remove()}),this.__corners2d=[],this.__walls2d=[],this.__rooms2d=[],this.__entities2D=[];var o=this.__floorplan.getRooms();for(n=0;n<o.length;n++){var r=o[n],t=new $v(this.__floorplan,this.__options,r);this.__floorplanElementsHolder.addChild(t),this.__rooms2d.push(t),this.__entities2D.push(t),t.interactive=this.__mode===hb.MOVE,t.addFloorplanListener(Yl,this.__selectionMonitorEvent)}for(n=0;n<this.__floorplan.walls.length;n++){var i=this.__floorplan.walls[n],_=new Zv(this.__floorplan,this.__options,i);this.__floorplanElementsHolder.addChild(_),this.__walls2d.push(_),this.__entities2D.push(_),_.interactive=this.__mode===hb.MOVE,_.addFloorplanListener(Yl,this.__selectionMonitorEvent)}for(n=0;n<this.__floorplan.corners.length;n++){var a=this.__floorplan.corners[n],l=new Sv(this.__floorplan,this.__options,a);this.__floorplanElementsHolder.addChild(l),this.__corners2d.push(l),this.__entities2D.push(l),l.interactive=this.__mode===hb.MOVE,l.addFloorplanListener(Yl,this.__selectionMonitorEvent),a.removeEventListener(Va,this.__cornerMovedEvent),a.addEventListener(Va,this.__cornerMovedEvent)}this._handleWindowResize()}},{key:"__drawExternalFloorplan",value:function(){var e=0;this.__externalEntities2d.forEach(function(e){e.remove()}),this.__externalCorners2d=[],this.__externalWalls2d=[],this.__externalRooms2d=[];var n=this.__floorplan.externalRooms;for(e=0;e<n.length;e++){var o=n[e],r=new $v(this.__floorplan,this.__options,o);this.__floorplanElementsHolder.addChild(r),this.__externalRooms2d.push(r),this.__externalEntities2d.push(r)}for(e=0;e<this.__floorplan.externalWalls.length;e++){var t=this.__floorplan.externalWalls[e],i=new Zv(this.__floorplan,this.__options,t);this.__floorplanElementsHolder.addChild(i),this.__externalWalls2d.push(i),this.__externalEntities2d.push(i)}for(e=0;e<this.__floorplan.externalCorners.length;e++){var _=this.__floorplan.externalCorners[e],a=new Sv(this.__floorplan,this.__options,_);this.__floorplanElementsHolder.addChild(a),this.__externalCorners2d.push(a),this.__externalEntities2d.push(a)}this._handleWindowResize()}},{key:"_handleWindowResize",value:function(){var e=window.innerWidth,n=window.innerHeight;this.renderer.resize(e,n),this.__floorplanContainer.resize(e,n,this.__worldWidth,this.__worldHeight),this.renderer.render(this.stage)}},{key:"addFloorplanListener",value:function(e,n){this.__eventDispatcher.addEventListener(e,n)}},{key:"removeFloorplanListener",value:function(e,n){this.__eventDispatcher.removeEventListener(e,n)}},{key:"dispose",value:function(){this.__floorplanContainer.off("zoomed",this.__zoomedEvent),this.__floorplanContainer.off("moved",this.__pannedEvent),this.__floorplanContainer.off("clicked",this.__selectionMonitorEvent),this.__floorplan.removeEventListener(Vl,this.__redrawFloorplanEvent),this.__floorplan.removeEventListener(rb,this.__redrawFloorplanEvent),this.__floorplan.removeEventListener(Wl,this.__redrawFloorplanEvent),window.removeEventListener("resize",this.__windowResizeEvent),window.removeEventListener("orientationchange",this.__windowResizeEvent)}}]),o}();function Kja(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}function jI(r,a){for(var n=0;n<a.length;n++){var $=a[n];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(r,$.key,$)}}function Lja(r,a,n){return a&&jI(r.prototype,a),n&&jI(r,n),r}var lc=ha,kI=tj,lI=Wa,mI=_B,nI=$B,oI=vj,pI=uj,qI=Ot,rI=bf,Mja=function(){function r(){Kja(this,r),this.__snapToGrid=lc.getBooleanValue(rI),this.__directionalDrag=lc.getBooleanValue(qI),this.__dragOnlyX=lc.getBooleanValue(pI),this.__dragOnlyY=lc.getBooleanValue(oI),this.__boundsX=lc.getNumericValue(nI),this.__boundsY=lc.getNumericValue(mI),this.__snapTolerance=lc.getNumericValue(lI),this.__gridSpacing=lc.getNumericValue(kI)}return Lja(r,[{key:"snapToGrid",get:function(){return this.__snapToGrid},set:function(r){this.__snapToGrid=r,lc.setValue(rI,r)}},{key:"directionalDrag",get:function(){return this.__directionalDrag},set:function(r){this.__directionalDrag=r,lc.setValue(qI,r)}},{key:"dragOnlyX",get:function(){return this.__dragOnlyX},set:function(r){this.__dragOnlyX=r,lc.setValue(pI,r)}},{key:"dragOnlyY",get:function(){return this.__dragOnlyY},set:function(r){this.__dragOnlyY=r,lc.setValue(oI,r)}},{key:"boundsX",get:function(){return this.__boundsX},set:function(r){this.__boundsX=r,lc.setValue(nI,r)}},{key:"boundsY",get:function(){return this.__boundsY},set:function(r){this.__boundsY=r,lc.setValue(mI,r)}},{key:"snapTolerance",get:function(){return this.__snapTolerance},set:function(r){this.__snapTolerance=r,lc.setValue(lI,r)}},{key:"gridSpacing",get:function(){return this.__gridSpacing},set:function(r){this.__gridSpacing=r,lc.setValue(kI,r)}}]),r}();function Nja(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sI(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Oja(e,t,i){return t&&sI(e.prototype,t),i&&sI(e,i),e}var Pja=function(){function e(t,i){Nja(this,e),this.__floorplan=t,this.__floorplanner=i,this.__wallThickness=ka.cmToMeasureRaw(20),this.__cornerElevation=ka.cmToMeasureRaw(250),this.__roomName="A New Room",this.__selectedWall=null,this.__selectedCorner=null,this.__selectedRoom=null,this.__selectedWallEntity=null,this.__selectedCornerEntity=null,this.__selectedRoomEntity=null,this.__nothingSelectedEvent=this.__resetSelections.bind(this),this.__cornerSelectedEvent=this.__cornerSelected.bind(this),this.__wallSelectedEvent=this.__wallSelected.bind(this),this.__roomSelectedEvent=this.__roomSelected.bind(this),this.__floorplanner.addFloorplanListener(Nt,this.__nothingSelectedEvent),this.__floorplanner.addFloorplanListener(Kt,this.__cornerSelectedEvent),this.__floorplanner.addFloorplanListener(Lt,this.__wallSelectedEvent),this.__floorplanner.addFloorplanListener(Mt,this.__roomSelectedEvent)}return Oja(e,[{key:"__resetSelections",value:function(){this.__selectedCorner=null,this.__selectedWall=null,this.__selectedRoom=null,this.__selectedCornerEntity=null,this.__selectedWallEntity=null,this.__selectedRoomEntity=null}},{key:"__cornerSelected",value:function(e){this.__resetSelections(),this.__selectedCorner=e.item,this.__selectedCornerEntity=e.entity,this.__cornerElevation=ka.cmToMeasureRaw(this.__selectedCorner.elevation)}},{key:"__wallSelected",value:function(e){this.__resetSelections(),this.__selectedWall=e.item,this.__selectedWallEntity=e.entity,this.__wallThickness=ka.cmToMeasureRaw(e.item.thickness)}},{key:"__roomSelected",value:function(e){this.__resetSelections(),this.__selectedRoom=e.item,this.__selectedRoomEntity=e.entity,this.__roomName=e.item.name}},{key:"__nothingSelected",value:function(){this.__resetSelections()}},{key:"deleteCurrentItem",value:function(){this.__selectedWall&&(this.__selectedWall.remove(),this.__resetSelections()),this.__selectedCorner&&(this.__selectedCorner.remove(),this.__resetSelections())}},{key:"wallThickness",set:function(e){if(this.__selectedWall){var t=ka.cmFromMeasureRaw(e);this.__selectedWall.thickness=t,this.__wallThickness=e}},get:function(){return ka.cmToMeasureRaw(this.__wallThickness)}},{key:"cornerElevation",set:function(e){if(this.__selectedCorner){var t=ka.cmFromMeasureRaw(e);this.__selectedCorner.elevation=t,this.__cornerElevation=e}},get:function(){return ka.cmToMeasureRaw(this.__cornerElevation)}},{key:"roomName",set:function(e){this.__selectedRoom&&(this.__selectedRoom.name=e,this.__roomName=e)},get:function(){return this.__roomName}}]),e}();function Qja(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tI(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Rja(e,t,o){return t&&tI(e.prototype,t),o&&tI(e,o),e}var Sja=function(){function e(t,o,i){Qja(this,e),this.__model=t,this.__floorplan=o,this.__roomplanner=i,this.__wallThickness=ka.cmToMeasureRaw(20),this.__cornerElevation=ka.cmToMeasureRaw(250),this.__roomName="A New Room",this.__selectedEdge=null,this.__selectedEdgeNormal=null,this.__selectedEdgePoint=null,this.__selectedItem=null,this.__selectedRoom=null,this.__wallTexturePack=null,this.__roomTexturePack=null,this.__roomWallsTexturePack=null,this.__nothingSelectedEvent=this.__nothingSelected.bind(this),this.__itemSelectedEvent=this.__itemSelected.bind(this),this.__wallSelectedEvent=this.__wallSelected.bind(this),this.__roomSelectedEvent=this.__roomSelected.bind(this),this.__roomplanner.addRoomplanListener(pp,this.__nothingSelectedEvent),this.__roomplanner.addRoomplanListener(Xl,this.__itemSelectedEvent),this.__roomplanner.addRoomplanListener(rp,this.__wallSelectedEvent),this.__roomplanner.addRoomplanListener(sp,this.__roomSelectedEvent)}return Rja(e,[{key:"__itemSelected",value:function(e){this.__selectedItem=e.item}},{key:"__wallSelected",value:function(e){this.__selectedEdge=e.item,this.__selectedEdgeNormal=e.normal,this.__selectedEdgePoint=e.point,this.__wallThickness=ka.cmToMeasureRaw(e.item.thickness)}},{key:"__roomSelected",value:function(e){this.__selectedRoom=e.item,this.__roomName=e.item.name}},{key:"__nothingSelected",value:function(){}},{key:"addParametricDoorToCurrentWall",value:function(e){if(this.__selectedEdge){var t={itemName:"Parametric Door",isParametric:!0,baseParametricType:"DOOR",subParametricData:{type:e,frameColor:"#E7E7E7",doorColor:"#E7E7E7",doorHandleColor:"#F0F0F0",glassColor:"#87CEEB",frameWidth:100,frameHeight:200,frameSize:5,frameThickness:20,doorRatio:.5,openDirection:"RIGHT",handleType:"HANDLE_01"},itemType:7,position:[0,0,0],rotation:[0,0,0],scale:[1,1,1],size:[100,200,20],fixed:!1,resizable:!1,wall:this.__selectedEdge.id},o=new Ap(t,this.__model);this.__model.addItem(o),o.snapToWall(this.__selectedEdgePoint,this.__selectedEdge.wall,this.__selectedEdge)}}},{key:"wallThickness",set:function(e){if(this.__selectedEdge){var t=ka.cmFromMeasureRaw(e);this.__selectedEdge.thickness=t,this.__wallThickness=e}},get:function(){return ka.cmToMeasureRaw(this.__wallThickness)}},{key:"cornerElevation",set:function(e){if(this.__selectedCorner){var t=ka.cmFromMeasureRaw(e);this.__selectedCorner.elevation=t,this.__cornerElevation=e}},get:function(){return ka.cmToMeasureRaw(this.__cornerElevation)}},{key:"roomName",set:function(e){this.__selectedRoom&&(this.__selectedRoom.name=e,this.__roomName=e)},get:function(){return this.__roomName}},{key:"wallTexturePack",get:function(){return this.__wallTexturePack},set:function(e){this.__wallTexturePack=e,this.__selectedEdge&&this.__selectedEdge.setTextureMaps(e)}},{key:"roomTexturePack",get:function(){return this.__roomTexturePack},set:function(e){this.__roomTexturePack=e,this.__selectedRoom&&this.__selectedRoom.setTextureMaps(e)}},{key:"roomWallsTexturePack",get:function(){return this.__roomWallsTexturePack},set:function(e){this.__roomTexturePack=e,this.__selectedRoom&&this.__selectedRoom.setRoomWallsTextureMaps(e)}}]),e}();var Tja=function(){function e(i){EQ(this,e),ha.setValue(wb,Rd),console.log("BLUEPRINT JS :: OPTIONS ::: ",i),this.options=i,this.model=new kaa(i.textureDir),this.roomplanner=new hda(this.model,i.viewer3d.id,this.options.viewer3d.viewer3dOptions),this.configurationHelper=new Mja,this.floorplanningHelper=null,this.roomplanningHelper=new Sja(this.model,this.model.floorplan,this.roomplanner),i.widget||(this.floorplanner=new Jja(i.viewer2d.id,this.model.floorplan,this.options.viewer2d.viewer2dOptions),this.floorplanningHelper=new Pja(this.model.floorplan,this.floorplanner)),this.view_now=3,this.switchView()}return FQ(e,[{key:"switchView",value:function(){this.floorplanner.switchMode(hb.MOVE),this.options.widget||(3!==this.view_now||this.options.widget?2!==this.view_now||this.options.widget||(this.view_now=3,document.getElementById(this.options.viewer2d.id).style.visibility="hidden",document.getElementById(this.options.viewer3d.id).style.visibility="visible",this.roomplanner.enabled=!0):(this.view_now=2,document.getElementById(this.options.viewer2d.id).style.visibility="visible",document.getElementById(this.options.viewer3d.id).style.visibility="hidden",this.roomplanner.enabled=!1))}},{key:"setViewer2DModeToDraw",value:function(e){this.options.widget||this.floorplanner.switchMode(hb.DRAW)}},{key:"setViewer2DModeToMove",value:function(e){this.options.widget||this.floorplanner.switchMode(hb.MOVE)}},{key:"switchViewer2DToTransform",value:function(e){this.options.widget||this.floorplanner.switchMode(hb.EDIT_ISLANDS)}},{key:"updateView3D",value:function(){this.viewer3d.needsUpdate=!0}},{key:"currentView",get:function(){return this.view_now}}]),e}();var _v,aw={};!function(){function t(t,e){var r=n("div",null,"qs_label",e);return r.innerHTML=t,r}function e(t,e,r,i){var o=n("input",e,r,i);return o.type=t,o}function n(t,e,n,r){var i=document.createElement(t);if(i)return i.id=e,n&&(i.className=n),r&&r.appendChild(i),i}function r(){return-1!=navigator.userAgent.indexOf("rv:11")||-1!=navigator.userAgent.indexOf("MSIE")}var i=!1,o=".qs_main{background-color:#dddddd;text-align:left;position:absolute;width:200px;font:12px sans-serif;box-shadow:5px 5px 8px rgba(0,0,0,0.35);user-select:none;-webkit-user-select:none;color:#000000;border:none}.qs_content{background-color:#cccccc;overflow-y:auto}.qs_title_bar{background-color:#eeeeee;user-select:none;-webkit-user-select:none;cursor:pointer;padding:5px;font-weight:bold;border:none;color:#000000}.qs_container{margin:5px;padding:5px;background-color:#eeeeee;border:none;position:relative}.qs_container_selected{border:none;background-color:#ffffff}.qs_range{-webkit-appearance:none;-moz-appearance:none;width:100%;height:17px;padding:0;margin:0;background-color:transparent;border:none;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.qs_range:focus{outline:none;border:none}.qs_range::-webkit-slider-runnable-track{width:100%;height:15px;cursor:pointer;background:#cccccc;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.qs_range:focus::-webkit-slider-runnable-track{background:#cccccc}.qs_range::-webkit-slider-thumb{-webkit-appearance:none;height:15px;width:15px;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;background:#999999;cursor:pointer;margin-top:0}.qs_range::-moz-range-track{width:100%;height:15px;cursor:pointer;background:#cccccc;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.qs_range::-moz-range-thumb{height:15px;width:15px;border:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;background:#999999;cursor:pointer}.qs_range::-ms-track{width:100%;height:15px;cursor:pointer;visibility:hidden;background:transparent}.qs_range::-ms-thumb{height:15px;width:15px;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;background:#999999;cursor:pointer;border:none}.qs_range::-ms-fill-lower{background:#cccccc;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.qs_range:focus::-ms-fill-lower{background:#cccccc}.qs_range::-ms-fill-upper{background:#cccccc;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.qs_range:focus::-ms-fill-upper{background:#cccccc}.qs_button{background-color:#f6f6f6;color:#000000;height:30px;border:1px solid #aaaaaa;font:12px sans-serif}.qs_button:active{background-color:#ffffff;border:1px solid #aaaaaa}.qs_button:focus{border:1px solid #aaaaaa;outline:none}.qs_checkbox{cursor:pointer}.qs_checkbox input{position:absolute;left:-99999px}.qs_checkbox span{height:16px;width:100%;display:block;text-indent:20px;background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAALklEQVQ4T2OcOXPmfwYKACPIgLS0NLKMmDVrFsOoAaNhMJoOGBioFwZkZUWoJgApdFaxjUM1YwAAAABJRU5ErkJggg==') no-repeat}.qs_checkbox input:checked+span{background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvElEQVQ4T63Tyw2EIBAA0OFKBxBL40wDRovAUACcKc1IB1zZDAkG18GYZTmSmafzgTnnMgwchoDWGlJKheGcP3JtnPceCqCUAmttSZznuYtgchsXQrgC+77DNE0kUpPbmBOoJaBOIVQylnqWgAAeKhDve/AN+EaklJBzhhgjWRoJVGTbNjiOowAIret6a+4jYIwpX8aDwLIs74C2D0IIYIyVP6Gm898m9kbVm85ljHUTf16k4VUefkwDrxk+zoUEwCt0GbUAAAAASUVORK5CYII=') no-repeat}.qs_checkbox_label{position:absolute;top:7px;left:30px}.qs_label{margin-bottom:3px;user-select:none;-webkit-user-select:none;cursor:default;font:12px sans-serif}.qs_text_input{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:100%;padding:0 0 0 5px;height:24px;border:1px inset #ffffff;background-color:#ffffff;color:#000000;font-size:12px}.qs_text_input:focus{outline:none;background:#ffffff;border:1px inset #ffffff}.qs_select{background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAp0lEQVRIS+2SsQ3FIAwF7RVYhA5mgQFhFuhYhJKWL0eKxI8SGylKZ0p4+OBsHGNM+HChAiS7qkgyBKrovaLeOxhjbgtxZ+cFtgelFMg5QwgBvPd/EO5sDbKAlBLUWo/8CjmL075zDmKMj6rEKbpCqBL9aqc4ZUQAhVbInBMQUXz5Vg/WfxOktXZsWWtZLds9uIqlqaH1NFV3jdhSJA47E1CAaE8ViYp+wGiWMZ/T+cgAAAAASUVORK5CYII=') no-repeat right #f6f6f6;-webkit-appearance:none;-moz-appearance:none;appearance:none;color:#000000;width:100%;height:24px;border:1px solid #aaaaaa;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;padding:0 5px;-moz-outline:none;font-size:14px}.qs_select option{font-size:14px}.qs_select::-ms-expand{display:none}.qs_select:focus{outline:none}.qs_number{height:24px}.qs_image{width:100%}.qs_progress{width:100%;height:15px;background-color:#cccccc;border:none;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.qs_progress_value{height:100%;background-color:#999999}.qs_textarea{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;resize:vertical;width:100%;padding:3px 5px;border:1px inset #ffffff;background-color:#ffffff;color:#000000;font-size:12px}.qs_textarea:focus{outline:none;background:#ffffff;border:1px inset #ffffff}.qs_color{position:absolute;left:-999999px}.qs_color_label{width:100%;height:20px;display:block;border:1px solid #aaaaaa;cursor:pointer;padding:0 0 0 5px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.qs_file_chooser{position:absolute;left:-999999px}.qs_file_chooser_label{background-color:#f6f6f6;color:#000000;height:30px;border:1px solid #aaaaaa;font:12px sans-serif;width:100%;display:block;cursor:pointer;padding:7px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}",a={_version:"2.1",_topZ:1,_panel:null,_titleBar:null,_content:null,_startX:0,_startY:0,_hidden:!1,_collapsed:!1,_controls:null,_keyCode:-1,_draggable:!0,_collapsible:!0,_globalChangeHandler:null,useExtStyleSheet:function(){i=!0},create:function(t,e,n,r){var i=Object.create(this);return i._init(t,e,n,r),i},destroy:function(){for(var t in this._panel.parentElement&&this._panel.parentElement.removeChild(this._panel),this)this[t]=null},_init:function(t,e,n,r){i||function(){var t=document.createElement("style");t.innerText=o,document.head.appendChild(t),i=!0}(),this._bindHandlers(),this._createPanel(t,e,r),this._createTitleBar(n||"QuickSettings"),this._createContent()},_bindHandlers:function(){this._startDrag=this._startDrag.bind(this),this._drag=this._drag.bind(this),this._endDrag=this._endDrag.bind(this),this._doubleClickTitle=this._doubleClickTitle.bind(this),this._onKeyUp=this._onKeyUp.bind(this)},getValuesAsJSON:function(t){var e={};for(var n in this._controls)this._controls[n].getValue&&(e[n]=this._controls[n].getValue());return t&&(e=JSON.stringify(e)),e},setValuesFromJSON:function(t){for(var e in"string"==typeof t&&(t=JSON.parse(t)),t)this._controls[e].setValue&&this._controls[e].setValue(t[e]);return this},saveInLocalStorage:function(t){return this._localStorageName=t,this._readFromLocalStorage(t),this},clearLocalStorage:function(t){return localStorage.removeItem(t),this},_saveInLocalStorage:function(t){localStorage.setItem(t,this.getValuesAsJSON(!0))},_readFromLocalStorage:function(t){var e=localStorage.getItem(t);e&&this.setValuesFromJSON(e)},_createPanel:function(t,e,r){this._panel=n("div",null,"qs_main",r||document.body),this._panel.style.zIndex=++a._topZ,this.setPosition(t||0,e||0),this._controls={}},_createTitleBar:function(t){this._titleBar=n("div",null,"qs_title_bar",this._panel),this._titleBar.textContent=t,this._titleBar.addEventListener("mousedown",this._startDrag),this._titleBar.addEventListener("dblclick",this._doubleClickTitle)},_createContent:function(){this._content=n("div",null,"qs_content",this._panel)},_createContainer:function(){var t=n("div",null,"qs_container");return t.addEventListener("focus",function(){this.className+=" qs_container_selected"},!0),t.addEventListener("blur",function(){var t=this.className.indexOf(" qs_container_selected");t>-1&&(this.className=this.className.substr(0,t))},!0),this._content.appendChild(t),t},setPosition:function(t,e){return this._panel.style.left=t+"px",this._panel.style.top=Math.max(e,0)+"px",this},setSize:function(t,e){return this._panel.style.width=t+"px",this._content.style.width=t+"px",this._content.style.height=e-this._titleBar.offsetHeight+"px",this},setWidth:function(t){return this._panel.style.width=t+"px",this._content.style.width=t+"px",this},setHeight:function(t){return this._content.style.height=t-this._titleBar.offsetHeight+"px",this},setDraggable:function(t){return this._draggable=t,this._draggable||this._collapsible?this._titleBar.style.cursor="pointer":this._titleBar.style.cursor="default",this},_startDrag:function(t){this._draggable&&(this._panel.style.zIndex=++a._topZ,document.addEventListener("mousemove",this._drag),document.addEventListener("mouseup",this._endDrag),this._startX=t.clientX,this._startY=t.clientY),t.preventDefault()},_drag:function(t){var e=parseInt(this._panel.style.left),n=parseInt(this._panel.style.top),r=t.clientX,i=t.clientY;this.setPosition(e+r-this._startX,n+i-this._startY),this._startX=r,this._startY=i,t.preventDefault()},_endDrag:function(t){document.removeEventListener("mousemove",this._drag),document.removeEventListener("mouseup",this._endDrag),t.preventDefault()},setGlobalChangeHandler:function(t){return this._globalChangeHandler=t,this},_callGCH:function(){this._localStorageName&&this._saveInLocalStorage(this._localStorageName),this._globalChangeHandler&&this._globalChangeHandler()},hide:function(){return this._panel.style.visibility="hidden",this._hidden=!0,this},show:function(){return this._panel.style.visibility="visible",this._panel.style.zIndex=++a._topZ,this._hidden=!1,this},toggleVisibility:function(){return this._hidden?this.show():this.hide(),this},setCollapsible:function(t){return this._collapsible=t,this._draggable||this._collapsible?this._titleBar.style.cursor="pointer":this._titleBar.style.cursor="default",this},collapse:function(){return this._panel.removeChild(this._content),this._collapsed=!0,this},expand:function(){return this._panel.appendChild(this._content),this._collapsed=!1,this},toggleCollapsed:function(){return this._collapsed?this.expand():this.collapse(),this},setKey:function(t){return this._keyCode=t.toUpperCase().charCodeAt(0),document.body.addEventListener("keyup",this.onKeyUp),this},_onKeyUp:function(t){t.keyCode===this._keyCode&&this.toggleVisibility()},_doubleClickTitle:function(){this._collapsible&&this.toggleCollapsed()},removeControl:function(t){if(this._controls[t])var e=this._controls[t].container;return e&&e.parentElement&&e.parentElement.removeChild(e),this._controls[t]=null,this},enableControl:function(t){return this._controls[t]&&(this._controls[t].control.disabled=!1),this},disableControl:function(t){return this._controls[t]&&(this._controls[t].control.disabled=!0),this},hideControl:function(t){return this._controls[t]&&(this._controls[t].container.style.display="none"),this},showControl:function(t){return this._controls[t]&&(this._controls[t].container.style.display="block"),this},overrideStyle:function(t,e,n){return this._controls[t]&&(this._controls[t].control.style[e]=n),this},hideTitle:function(t){var e=this._controls[t].label;return e&&(e.style.display="none"),this},showTitle:function(t){var e=this._controls[t].label;return e&&(e.style.display="block"),this},hideAllTitles:function(){for(var t in this._controls){var e=this._controls[t].label;e&&(e.style.display="none")}return this},showAllTitles:function(){for(var t in this._controls){var e=this._controls[t].label;e&&(e.style.display="block")}return this},getValue:function(t){return this._controls[t].getValue()},setValue:function(t,e){return this._controls[t].setValue(e),this._callGCH(),this},addBoolean:function(t,r,i){var o=this._createContainer(),a=n("label",null,"qs_checkbox_label",o);a.textContent=t,a.setAttribute("for",t);var s=n("label",null,"qs_checkbox",o);s.setAttribute("for",t);var l=e("checkbox",t,null,s);l.checked=r,n("span",null,null,s),this._controls[t]={container:o,control:l,getValue:function(){return this.control.checked},setValue:function(t){this.control.checked=t,i&&i(t)}};var c=this;return l.addEventListener("change",function(){i&&i(l.checked),c._callGCH()}),this},bindBoolean:function(t,e,n){return this.addBoolean(t,e,function(e){n[t]=e})},addButton:function(t,n){var r=this._createContainer(),i=e("button",t,"qs_button",r);i.value=t,this._controls[t]={container:r,control:i};var o=this;return i.addEventListener("click",function(){n&&n(i),o._callGCH()}),this},addColor:function(i,o,a){if(function(){var t=navigator.userAgent.toLowerCase();return!(t.indexOf("chrome")>-1||t.indexOf("firefox")>-1||t.indexOf("epiphany")>-1)&&t.indexOf("safari/")>-1}()||navigator.userAgent.toLowerCase().indexOf("edge")>-1||r())return this.addText(i,o,a);var s=this._createContainer(),l=t("<b>"+i+":</b> "+o,s),c=e("color",i,"qs_color",s);c.value=o||"#ff0000";var u=n("label",null,"qs_color_label",s);u.setAttribute("for",i),u.style.backgroundColor=c.value,this._controls[i]={container:s,control:c,colorLabel:u,label:l,title:i,getValue:function(){return this.control.value},setValue:function(t){this.control.value=t,this.colorLabel.style.backgroundColor=c.value,this.label.innerHTML="<b>"+this.title+":</b> "+this.control.value,a&&a(t)}};var d=this;return c.addEventListener("input",function(){l.innerHTML="<b>"+i+":</b> "+c.value,u.style.backgroundColor=c.value,a&&a(c.value),d._callGCH()}),this},bindColor:function(t,e,n){return this.addColor(t,e,function(e){n[t]=e})},addDate:function(n,i,o){var a;if(i instanceof Date){var s=i.getFullYear(),l=i.getMonth()+1;l<10&&(l="0"+l),a=s+"-"+l+"-"+i.getDate()}else a=i;if(r())return this.addText(n,a,o);var c=this._createContainer(),u=t("<b>"+n+"</b>",c),d=e("date",n,"qs_text_input",c);d.value=a||"",this._controls[n]={container:c,control:d,label:u,getValue:function(){return this.control.value},setValue:function(t){var e;if(t instanceof Date){var n=t.getFullYear(),r=t.getMonth()+1;r<10&&(r="0"+r);var i=t.getDate();i<10&&(i="0"+i),e=n+"-"+r+"-"+i}else e=t;this.control.value=e||"",o&&o(e)}};var h=this;return d.addEventListener("input",function(){o&&o(d.value),h._callGCH()}),this},bindDate:function(t,e,n){return this.addDate(t,e,function(e){n[t]=e})},addDropDown:function(e,r,i){for(var o=this._createContainer(),a=t("<b>"+e+"</b>",o),s=n("select",null,"qs_select",o),l=0;l<r.length;l++){var c=n("option");c.label=r[l],c.innerText=r[l],s.add(c)}var u=this;return s.addEventListener("change",function(){var t=s.selectedIndex,e=s.options;i&&i({index:t,value:e[t].label}),u._callGCH()}),this._controls[e]={container:o,control:s,label:a,getValue:function(){var t=this.control.selectedIndex;return{index:t,value:this.control.options[t].label}},setValue:function(t){var e;e=null!=t.index?t.index:t;var n=this.control.options;this.control.selectedIndex=e,i&&i({index:e,value:n[e].label})}},this},bindDropDown:function(t,e,n){return this.addDropDown(t,e,function(e){n[t]=e.value})},addElement:function(e,n){var r=this._createContainer(),i=t("<b>"+e+"</b>",r);return r.appendChild(n),this._controls[e]={container:r,label:i},this},addFileChooser:function(r,i,o,a){var s=this._createContainer(),l=t("<b>"+r+"</b>",s),c=e("file",r,"qs_file_chooser",s);o&&(c.accept=o);var u=n("label",null,"qs_file_chooser_label",s);u.setAttribute("for",r),u.textContent=i||"Choose a file...",this._controls[r]={container:s,control:c,label:l,getValue:function(){return this.control.files[0]}};var d=this;return c.addEventListener("change",function(){c.files&&c.files.length&&(u.textContent=c.files[0].name,a&&a(c.files[0]),d._callGCH())}),this},addHTML:function(e,r){var i=this._createContainer(),o=t("<b>"+e+":</b> ",i),a=n("div",null,null,i);return a.innerHTML=r,this._controls[e]={label:o,control:a,getValue:function(){return this.control.innerHTML},setValue:function(t){this.control.innerHTML=t}},this},addImage:function(e,r){var i=this._createContainer(),o=t("<b>"+e+"</b>",i);return img=n("img",null,"qs_image",i),img.src=r,this._controls[e]={container:i,control:img,label:o,getValue:function(){return this.control.src},setValue:function(t){this.control.src=t}},this},addRange:function(t,e,n,r,i,o){return this._addNumber("range",t,e,n,r,i,o)},addNumber:function(t,e,n,r,i,o){return this._addNumber("number",t,e,n,r,i,o)},_addNumber:function(n,i,o,a,s,l,c){var u=this._createContainer(),d=t("",u),h=e(n,i,"range"===n?"qs_range":"qs_text_input qs_number",u);h.min=o||0,h.max=a||100,h.step=l||1,h.value=s||0,d.innerHTML="<b>"+i+":</b> "+h.value,this._controls[i]={container:u,control:h,label:d,title:i,callback:c,getValue:function(){return parseFloat(this.control.value)},setValue:function(t){this.control.value=t,this.label.innerHTML="<b>"+this.title+":</b> "+this.control.value,c&&c(parseFloat(t))}};var b="input";"range"===n&&r()&&(b="change");var f=this;return h.addEventListener(b,function(){d.innerHTML="<b>"+i+":</b> "+h.value,c&&c(parseFloat(h.value)),f._callGCH()}),this},bindRange:function(t,e,n,r,i,o){return this.addRange(t,e,n,r,i,function(e){o[t]=e})},bindNumber:function(t,e,n,r,i,o){return this.addNumber(t,e,n,r,i,function(e){o[t]=e})},setRangeParameters:function(t,e,n,r){return this.setNumberParameters(t,e,n,r)},setNumberParameters:function(t,e,n,r){var i=this._controls[t],o=i.control.value;return i.control.min=e,i.control.max=n,i.control.step=r,i.control.value!==o&&i.callback&&i.callback(i.control.value),this},addPassword:function(t,e,n){return this._addText("password",t,e,n)},bindPassword:function(t,e,n){return this.addPassword(t,e,function(e){n[t]=e})},addProgressBar:function(e,r,i,o){var a=this._createContainer(),s=t("",a),l=n("div",null,"qs_progress",a),c=n("div",null,"qs_progress_value",l);return c.style.width=i/r*100+"%",s.innerHTML="numbers"===o?"<b>"+e+":</b> "+i+" / "+r:"percent"===o?"<b>"+e+":</b> "+Math.round(i/r*100)+"%":"<b>"+e+"</b>",this._controls[e]={container:a,control:l,valueDiv:c,valueDisplay:o,label:s,value:i,max:r,title:e,getValue:function(){return this.value},setValue:function(t){this.value=Math.max(0,Math.min(t,this.max)),this.valueDiv.style.width=this.value/this.max*100+"%","numbers"===this.valueDisplay?this.label.innerHTML="<b>"+this.title+":</b> "+this.value+" / "+this.max:"percent"===this.valueDisplay&&(this.label.innerHTML="<b>"+this.title+":</b> "+Math.round(this.value/this.max*100)+"%")}},this},setProgressMax:function(t,e){var n=this._controls[t];return n.max=e,n.value=Math.min(n.value,n.max),n.valueDiv.style.width=n.value/n.max*100+"%","numbers"===n.valueDisplay?n.label.innerHTML="<b>"+n.title+":</b> "+n.value+" / "+n.max:"percent"===n.valueDisplay?n.label.innerHTML="<b>"+n.title+":</b> "+Math.round(n.value/n.max*100)+"%":n.label.innerHTML="<b>"+n.title+"</b>",this},addText:function(t,e,n){return this._addText("text",t,e,n)},_addText:function(r,i,o,a){var s,l=this._createContainer(),c=t("<b>"+i+"</b>",l);"textarea"===r?(s=n("textarea",i,"qs_textarea",l)).rows=5:s=e(r,i,"qs_text_input",l),s.value=o||"",this._controls[i]={container:l,control:s,label:c,getValue:function(){return this.control.value},setValue:function(t){this.control.value=t,a&&a(t)}};var u=this;return s.addEventListener("input",function(){a&&a(s.value),u._callGCH()}),this},bindText:function(t,e,n){return this.addText(t,e,function(e){n[t]=e})},addTextArea:function(t,e,n){return this._addText("textarea",t,e,n)},setTextAreaRows:function(t,e){return this._controls[t].control.rows=e,this},bindTextArea:function(t,e,n){return this.addTextArea(t,e,function(e){n[t]=e})},addTime:function(n,i,o){var a;if(i instanceof Date){var s=i.getHours();s<10&&(s="0"+s);var l=i.getMinutes();l<10&&(l="0"+l);var c=i.getSeconds();c<10&&(c="0"+c),a=s+":"+l+":"+c}else a=i;if(r())return this.addText(n,a,o);var u=this._createContainer(),d=t("<b>"+n+"</b>",u),h=e("time",n,"qs_text_input",u);h.value=a||"",this._controls[n]={container:u,control:h,label:d,getValue:function(){return this.control.value},setValue:function(t){var e;if(t instanceof Date){var n=t.getHours();n<10&&(n="0"+n);var r=t.getMinutes();r<10&&(r="0"+r);var i=t.getSeconds();i<10&&(i="0"+i),e=n+":"+r+":"+i}else e=t;this.control.value=e||"",o&&o(e)}};var b=this;return h.addEventListener("input",function(){o&&o(h.value),b._callGCH()}),this},bindTime:function(t,e,n){return this.addTime(t,e,function(e){n[t]=e})}};"object"==typeof aw?aw=a:"function"==typeof _v&&_v.amd?_v(a):window.QuickSettings=a}();function Uja(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uI(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vja(e,t,a){return t&&uI(e.prototype,t),a&&uI(e,a),e}var Wja=function(){function e(t,a){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;var $IlK2$$interop$default=Wc(aw);Uja(this,e),this.__parametricDataClass=t,this.__viewer3D=a,this.__settings=$IlK2$$interop$default.d.create(r,n,"Parametric Item: ".concat(t.name),s),this.__constructUI()}return Vja(e,[{key:"__constructUI",value:function(){var e=this,t=this.__parametricDataClass.parameters,a=this.__parametricDataClass,r=this.__viewer3D,n=function(n){var s=t[n];switch(s.type){case"color":e.__settings.addColor(n,a[n],function(e){a[n]=e,r.needsUpdate=!0});break;case"number":e.__settings.addNumber(n,10,5e3,a[n],1,function(e){a[n]=e,r.needsUpdate=!0});break;case"range":e.__settings.addRange(n,s.min,s.max,a[n],s.step,function(e){a[n]=e,r.needsUpdate=!0});break;case"choice":e.__settings.addDropDown(n,s.value,function(e){a[n]=e.value,r.needsUpdate=!0});break;default:console.log("YET TO IMPLEMENT");}};for(var s in t)n(s)}},{key:"destroy",value:function(){this.__settings&&this.__settings.destroy()}}]),e}();var Xja={};Xja={Stylized_Stone_Floor_001:{repeat:100,ambientmap:"textures/Floor/Stylized_Stone_Floor_001/Stylized_Stone_Floor_001_ambientOcclusion.jpg",normalmap:"textures/Floor/Stylized_Stone_Floor_001/Stylized_Stone_Floor_001_normal.jpg",colormap:"textures/Floor/Stylized_Stone_Floor_001/Stylized_Stone_Floor_001_basecolor.jpg",roughnessmap:"textures/Floor/Stylized_Stone_Floor_001/Stylized_Stone_Floor_001_roughness.jpg"},Rubber_Floor_001:{repeat:100,reflective:1,roughnessmap:"textures/Floor/Rubber_Floor_001/Rubber_Floor_001_roughness.jpg",colormap:"textures/Floor/Rubber_Floor_001/Rubber_Floor_001_basecolor.jpg",ambientmap:"textures/Floor/Rubber_Floor_001/Rubber_Floor_001_ambientOcclusion.jpg",normalmap:"textures/Floor/Rubber_Floor_001/Rubber_Floor_001_normal.jpg"},Wood_Herringbone_Tiles_001:{repeat:100,ambientmap:"textures/Floor/Wood_Herringbone_Tiles_001/Wood_Herringbone_Tiles_001_ambientOcclusion.jpg",colormap:"textures/Floor/Wood_Herringbone_Tiles_001/Wood_Herringbone_Tiles_001_basecolor.jpg",normalmap:"textures/Floor/Wood_Herringbone_Tiles_001/Wood_Herringbone_Tiles_001_normal.jpg",roughnessmap:"textures/Floor/Wood_Herringbone_Tiles_001/Wood_Herringbone_Tiles_001_roughness.jpg"},Stone_Tiles_004:{repeat:100,ambientmap:"textures/Floor/Stone_Tiles_004/Stone_Tiles_004_ambientOcclusion.jpg",roughnessmap:"textures/Floor/Stone_Tiles_004/Stone_Tiles_004_roughness.jpg",normalmap:"textures/Floor/Stone_Tiles_004/Stone_Tiles_004_normal.jpg",colormap:"textures/Floor/Stone_Tiles_004/Stone_Tiles_004_basecolor.jpg"},Terracotta_Tiles_003:{repeat:100,reflective:1,normalmap:"textures/Floor/Terracotta_Tiles_003/Terracota_Tiles_003_normal.jpg",ambientmap:"textures/Floor/Terracotta_Tiles_003/Terracota_Tiles_003_ambientOcclusion.jpg",colormap:"textures/Floor/Terracotta_Tiles_003/Terracota_Tiles_003_basecolor.jpg",roughnessmap:"textures/Floor/Terracotta_Tiles_003/Terracota_Tiles_003_roughness.jpg"},Marble_Tiles_001:{repeat:100,reflective:.1,ambientmap:"textures/Floor/Marble_Tiles_001/Marble_Tiles_001_ambientOcclusion.jpg",colormap:"textures/Floor/Marble_Tiles_001/Marble_Tiles_001_basecolor.jpg",roughnessmap:"textures/Floor/Marble_Tiles_001/Marble_Tiles_001_roughness.jpg",normalmap:"textures/Floor/Marble_Tiles_001/Marble_Tiles_001_normal.jpg"},Terrazzo_Tiles_001:{repeat:100,roughnessmap:"textures/Floor/Terrazzo_Tiles_001/Terrazzo_Tiles_001_roughness.jpg",ambientmap:"textures/Floor/Terrazzo_Tiles_001/Terrazzo_Tiles_001_ambientOcclusion.jpg",normalmap:"textures/Floor/Terrazzo_Tiles_001/Terrazzo_Tiles_001_normal.jpg",colormap:"textures/Floor/Terrazzo_Tiles_001/Terrazzo_Tiles_001_basecolor.jpg"}};var Yja={};Yja={Concrete_Wall_005_SD:{repeat:200,colormap:"textures/Wall/Concrete_Wall_005_SD/Concrete_Wall_005_BaseColor.jpg",normalmap:"textures/Wall/Concrete_Wall_005_SD/Concrete_Wall_005_Normal.jpg",bumpmap:"textures/Wall/Concrete_Wall_005_SD/Concrete_Wall_005_Height.png",ambientmap:"textures/Wall/Concrete_Wall_005_SD/Concrete_Wall_005_AmbientOcclusion.jpg",roughnessmap:"textures/Wall/Concrete_Wall_005_SD/Concrete_Wall_005_Roughness.jpg"},Terracotta_Bricks_002:{repeat:200,normalmap:"textures/Wall/Terracotta_Bricks_002/Bricks_Terracotta_002_normal.jpg",ambientmap:"textures/Wall/Terracotta_Bricks_002/Bricks_Terracotta_002_ambientOcclusion.jpg",bumpmap:"textures/Wall/Terracotta_Bricks_002/Bricks_Terracotta_002_height.png",roughnessmap:"textures/Wall/Terracotta_Bricks_002/Bricks_Terracotta_002_roughness.jpg",colormap:"textures/Wall/Terracotta_Bricks_002/Bricks_Terracotta_002_basecolor.jpg"},"Concrete-Wall-002":{repeat:200,colormap:"textures/Wall/Concrete-Wall-002/Concrete_Wall_002_basecolor.jpg",bumpmap:"textures/Wall/Concrete-Wall-002/Concrete_Wall_002_height.png",normalmap:"textures/Wall/Concrete-Wall-002/Concrete_Wall_002_normal.jpg",roughnessmap:"textures/Wall/Concrete-Wall-002/Concrete_Wall_002_roughness.jpg",ambientmap:"textures/Wall/Concrete-Wall-002/Concrete_Wall_002_ambientocclusion.jpg"},Concrete_016_SD:{repeat:200,bumpmap:"textures/Wall/Concrete_016_SD/Concrete_016_height.png",ambientmap:"textures/Wall/Concrete_016_SD/Concrete_016_ambientOcclusion.jpg",normalmap:"textures/Wall/Concrete_016_SD/Concrete_016_normal.jpg",roughnessmap:"textures/Wall/Concrete_016_SD/Concrete_016_roughness.jpg",colormap:"textures/Wall/Concrete_016_SD/Concrete_016_baseColor.jpg"},Concrete_Column_001_SD:{repeat:200,ambientmap:"textures/Wall/Concrete_Column_001_SD/Concrete_Column_001_ambientOcclusion.jpg",normalmap:"textures/Wall/Concrete_Column_001_SD/Concrete_Column_001_normal.jpg",bumpmap:"textures/Wall/Concrete_Column_001_SD/Concrete_Column_001_height.png",roughnessmap:"textures/Wall/Concrete_Column_001_SD/Concrete_Column_001_roughness.jpg",colormap:"textures/Wall/Concrete_Column_001_SD/Concrete_Column_001_basecolor.jpg"},Brick_Wall_017_SD:{repeat:200,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png"},"Stone-Wall-015":{repeat:200,normalmap:"textures/Wall/Stone-Wall-015/Wall_Stone_015_normal.jpg",colormap:"textures/Wall/Stone-Wall-015/Wall_Stone_015_basecolor.jpg",ambientmap:"textures/Wall/Stone-Wall-015/Wall_Stone_015_ambientOcclusion.jpg",bumpmap:"textures/Wall/Stone-Wall-015/Wall_Stone_015_height.png",roughnessmap:"textures/Wall/Stone-Wall-015/Wall_Stone_015_roughness.jpg"},Stone_Wall_012_SD:{repeat:200,ambientmap:"textures/Wall/Stone_Wall_012_SD/Stone_Wall_ambientOcclusion.jpg",colormap:"textures/Wall/Stone_Wall_012_SD/Stone_Wall_basecolor.jpg",normalmap:"textures/Wall/Stone_Wall_012_SD/Stone_Wall_normal.jpg",bumpmap:"textures/Wall/Stone_Wall_012_SD/Stone_Wall_height.png",roughnessmap:"textures/Wall/Stone_Wall_012_SD/Stone_Wall_roughness.jpg"},"Stylized-Sci-fi Wall-001":{repeat:125,normalmap:"textures/Wall/Stylized-Sci-fi Wall-001/Stylized_Sci-fi_Wall_001_normal.jpg",ambientmap:"textures/Wall/Stylized-Sci-fi Wall-001/Stylized_Sci-fi_Wall_001_ambientOcclusion.jpg",colormap:"textures/Wall/Stylized-Sci-fi Wall-001/Stylized_Sci-fi_Wall_001_basecolor.jpg",roughnessmap:"textures/Wall/Stylized-Sci-fi Wall-001/Stylized_Sci-fi_Wall_001_roughness.jpg",bumpmap:"textures/Wall/Stylized-Sci-fi Wall-001/Stylized_Sci-fi_Wall_001_height.png"}};var Zja={};Zja={floorplan:{version:"2.0.1a",corners:{"4ae6fabe-5cdc-ec3a-c858-f4537b0bd0b1":{x:0,y:-5,elevation:2.5},"a103d9da-46bd-88c7-3710-e0323ac74352":{x:10,y:-5,elevation:2.5},"718bc5a1-ef34-deaf-3e91-b7289a043090":{x:10,y:5,elevation:2.5},"732d5821-5f91-217d-79aa-e8d11c51e97f":{x:5,y:5,elevation:2.5},"47ad5165-6d74-ff0c-32c9-3f2660a988b5":{x:5,y:0,elevation:2.5},"331a6234-c305-ab4c-2d4a-4aa69be00cab":{x:0,y:0,elevation:2.5}},walls:[{corner1:"4ae6fabe-5cdc-ec3a-c858-f4537b0bd0b1",corner2:"a103d9da-46bd-88c7-3710-e0323ac74352",frontTexture:{color:"#FFFFFF",repeat:300,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png",emissive:"#000000",reflective:.5,shininess:.5},backTexture:{color:"#FFFFFF",repeat:300,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png",emissive:"#000000",reflective:.5,shininess:.5},wallType:"STRAIGHT",a:{x:-146.44660940672622,y:-146.44660940672628},b:{x:146.44660940672628,y:-146.44660940672622},thickness:.2},{corner1:"a103d9da-46bd-88c7-3710-e0323ac74352",corner2:"718bc5a1-ef34-deaf-3e91-b7289a043090",frontTexture:{color:"#FFFFFF",repeat:300,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png",emissive:"#000000",reflective:.5,shininess:.5},backTexture:{color:"#FFFFFF",repeat:300,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png",emissive:"#000000",reflective:.5,shininess:.5},wallType:"STRAIGHT",a:{x:146.44660940672628,y:-146.44660940672622},b:{x:146.44660940672622,y:146.44660940672628},thickness:.2},{corner1:"718bc5a1-ef34-deaf-3e91-b7289a043090",corner2:"732d5821-5f91-217d-79aa-e8d11c51e97f",frontTexture:{color:"#FFFFFF",repeat:300,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png",emissive:"#000000",reflective:.5,shininess:.5},backTexture:{color:"#FFFFFF",repeat:300,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png",emissive:"#000000",reflective:.5,shininess:.5},wallType:"STRAIGHT",a:{x:323.2233047033631,y:323.22330470336317},b:{x:176.77669529663686,y:323.2233047033631},thickness:.2},{corner1:"732d5821-5f91-217d-79aa-e8d11c51e97f",corner2:"47ad5165-6d74-ff0c-32c9-3f2660a988b5",frontTexture:{color:"#FFFFFF",repeat:300,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png",emissive:"#000000",reflective:.5,shininess:.5},backTexture:{color:"#FFFFFF",repeat:300,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png",emissive:"#000000",reflective:.5,shininess:.5},wallType:"STRAIGHT",a:{x:176.77669529663686,y:323.2233047033631},b:{x:176.7766952966369,y:176.77669529663686},thickness:.2},{corner1:"47ad5165-6d74-ff0c-32c9-3f2660a988b5",corner2:"331a6234-c305-ab4c-2d4a-4aa69be00cab",frontTexture:{color:"#FFFFFF",repeat:300,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png",emissive:"#000000",reflective:.5,shininess:.5},backTexture:{color:"#FFFFFF",repeat:300,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png",emissive:"#000000",reflective:.5,shininess:.5},wallType:"STRAIGHT",a:{x:-176.7766952966369,y:-176.77669529663686},b:{x:-323.22330470336317,y:-176.7766952966369},thickness:.2},{corner1:"331a6234-c305-ab4c-2d4a-4aa69be00cab",corner2:"4ae6fabe-5cdc-ec3a-c858-f4537b0bd0b1",frontTexture:{color:"#FFFFFF",repeat:300,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png",emissive:"#000000",reflective:.5,shininess:.5},backTexture:{color:"#FFFFFF",repeat:300,normalmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_normal.jpg",roughnessmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_roughness.jpg",colormap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_basecolor.jpg",ambientmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_ambientOcclusion.jpg",bumpmap:"textures/Wall/Brick_Wall_017_SD/Brick_Wall_017_height.png",emissive:"#000000",reflective:.5,shininess:.5},wallType:"STRAIGHT",a:{x:-323.22330470336317,y:-176.7766952966369},b:{x:-323.2233047033631,y:-323.22330470336317},thickness:.2}],rooms:{"71d4f128-ae80-3d58-9bd2-711c6ce6cdf2,4e3d65cb-54c0-0681-28bf-bddcc7bdb571,da026c08-d76a-a944-8e7b-096b752da9ed,f90da5e3-9e0e-eba7-173d-eb0b071e838e":{name:"Ashok's Room"},"f90da5e3-9e0e-eba7-173d-eb0b071e838e,71d4f128-ae80-3d58-9bd2-711c6ce6cdf2,4e3d65cb-54c0-0681-28bf-bddcc7bdb571,da026c08-d76a-a944-8e7b-096b752da9ed":{name:"A New Room"},"4ae6fabe-5cdc-ec3a-c858-f4537b0bd0b1,a103d9da-46bd-88c7-3710-e0323ac74352,718bc5a1-ef34-deaf-3e91-b7289a043090,732d5821-5f91-217d-79aa-e8d11c51e97f,47ad5165-6d74-ff0c-32c9-3f2660a988b5,331a6234-c305-ab4c-2d4a-4aa69be00cab":{name:"A New Room"}},wallTextures:[],floorTextures:{},newFloorTextures:{"331a6234-c305-ab4c-2d4a-4aa69be00cab,47ad5165-6d74-ff0c-32c9-3f2660a988b5,4ae6fabe-5cdc-ec3a-c858-f4537b0bd0b1,718bc5a1-ef34-deaf-3e91-b7289a043090,732d5821-5f91-217d-79aa-e8d11c51e97f,a103d9da-46bd-88c7-3710-e0323ac74352":{color:"#FFFFFF",emissive:"#181818",repeat:300,ambientmap:"textures/Floor/Marble_Tiles_001/Marble_Tiles_001_ambientOcclusion.jpg",colormap:"textures/Floor/Marble_Tiles_001/Marble_Tiles_001_basecolor.jpg",roughnessmap:"textures/Floor/Marble_Tiles_001/Marble_Tiles_001_roughness.jpg",normalmap:"textures/Floor/Marble_Tiles_001/Marble_Tiles_001_normal.jpg",reflective:.5,shininess:.5}},carbonSheet:{},units:"m"},items:[]};var $ja=JSON.stringify(Zja),bw=0,hk=200,cw=450,vI=460,dw=Xja.default,wI=Object.keys(dw),Fq=Yja.default,Gq=Object.keys(Fq),Za=null,Kd=document.getElementById("bp3d-js-app"),mc=null,Ag=null,Hq=null,Bb=null,Bg=null,Cg=null,Dg=null,Zb=null,Sb=null,Th=null,Vc=null,Ce=null,Iq={"Door Type 1":{src:"assets/doors/DoorType1.png",type:1},"Door Type 2":{src:"assets/doors/DoorType2.png",type:2},"Door Type 3":{src:"assets/doors/DoorType3.png",type:3},"Door Type 4":{src:"assets/doors/DoorType4.png",type:4},"Door Type 5":{src:"assets/doors/DoorType5.png",type:5},"Door Type 6":{src:"assets/doors/DoorType6.png",type:6}},xI=Object.keys(Iq),yI={viewer2d:{id:"bp3djs-viewer2d",viewer2dOptions:{"corner-radius":12.5,pannable:!0,zoomable:!0,scale:!1,rotate:!0,translate:!0,dimlinecolor:"#3E0000",dimarrowcolor:"#FF0000",dimtextcolor:"#000000"}},viewer3d:{id:"bp3djs-viewer3d",viewer3dOptions:{occludedWalls:!1,occludedRoofs:!1}},textureDir:"models/textures/",widget:!1,resize:!0};function zI(e){e.index||(e=Zb.getValue("Floor Textures"));var r=dw[e.value];Zb.setValue("Floor Texture:",r.colormap),Hq.roomTexturePack=r}function Jq(e){e.index||(e=Sb._hidden&&!Zb._hidden?Zb.getValue("All Wall Textures"):Sb.getValue("Wall Textures"));var r=Fq[e.value];Sb._hidden&&!Zb._hidden?(Zb.setValue("All Wall Texture:",r.colormap),Hq.roomWallsTexturePack=r):(Sb.setValue("Wall Texture:",r.colormap),Hq.wallTexturePack=r)}function _ja(e){e.index||(e=Sb.getValue("Select Door"));var r=Iq[e.value];Sb.setValue("Door Preview:",r.src)}function aka(){var e=Sb.getValue("Select Door"),r=Iq[e.value];Hq.addParametricDoorToCurrentWall(r.type)}function bka(){Za.switchView(),2===Za.currentView?(Vc.setValue("Current View","Floor Planning"),Th.hide(),Bb.show(),Sb.hide(),Zb.hide(),Ce&&(Ce.destroy(),Ce=null)):3===Za.currentView&&(Vc.setValue("Current View","Room Planning"),Bb.hide(),Bg.hide(),Cg.hide(),Dg.hide(),Th.show())}function cka(){Za.setViewer2DModeToDraw()}function dka(){Za.setViewer2DModeToMove()}function eka(){Za.switchViewer2DToTransform()}function fka(e){var r=new FileReader;r.onload=function(e){var r=e.target.result;Za.model.loadSerialized(r)},r.readAsText(e)}function gka(e){var r=new FileReader;r.onload=function(e){var r=e.target.result;Za.model.loadLockedSerialized(r)},r.readAsText(e)}function hka(){var e=Za.model.exportSerialized(),r=window.document.createElement("a"),o=new Blob([e],{type:"text"});r.href=window.URL.createObjectURL(o),r.download="design.blueprint3d",document.body.appendChild(r),r.click(),document.body.removeChild(r)}function ika(){Za.roomplanner.exportSceneAsGTLF()}function jka(){function e(e,r){var o=[];return e?(e.normalmap&&!r.includes(e.normalmap)&&o.push(e.normalmap),e.colormap&&!r.includes(e.colormap)&&o.push(e.colormap),e.roughnessmap&&!r.includes(e.roughnessmap)&&o.push(e.roughnessmap),e.ambientmap&&!r.includes(e.ambientmap)&&o.push(e.ambientmap),e.bumpmap&&!r.includes(e.bumpmap)&&o.push(e.bumpmap),o):o}var r=Za.model.exportSerialized(),o=JSON.parse(r),$=o.floorplan,t=o.items,a=[],n=[],c=0;for(c=0;c<$.walls.length;c++){var l=$.walls[c];a=(a=a.concat(e(l.frontTexture,a))).concat(e(l.backTexture,a))}for(Object.values($.newFloorTextures).forEach(function(r){a=a.concat(e(r,a)),console.log("TEXTURE PACK ",r)}),c=0;c<t.length;c++){var i=t[c];i.isParametric||n.includes(i.modelURL)||n.push(i.modelURL)}var $miM6$$interop$default=Wc(AI);var m=new $miM6$$interop$default.d;for(m.file("design.blueprint3d",r),c=0;c<a.length;c++){var s=a[c],d=fetch(s).then(function(e){return 200===e.status?e.blob():Promise.reject(new Error(e.statusText))});m.file(s,d)}for(c=0;c<n.length;c++){var F=n[c],p=fetch(F).then(function(e){return 200===e.status?e.blob():Promise.reject(new Error(e.statusText))});m.file(F,p)}m.generateAsync({type:"blob"}).then(function(e){var $KAEt$$interop$default=Wc(fs);$KAEt$$interop$default.d.saveAs(e,"YourBlueprintProject.zip")})}var Eg=Wc(aw);console.log("ON DOCUMENT READY "),Za=new Tja(yI),ha.setValue(wb,Oe),mc=Za.configurationHelper,Ag=Za.floorplanningHelper,Hq=Za.roomplanningHelper,Za.model.addEventListener(Wl,function(){console.log("LOAD SERIALIZED JSON ::: ")}),Za.floorplanner.addFloorplanListener(Nt,function(){Bg.hide(),Cg.hide(),Dg.hide(),Bb.hideControl("Delete")}),Za.floorplanner.addFloorplanListener(Kt,function(e){Bg.show(),Cg.hide(),Dg.hide(),Bb.showControl("Delete"),Bg.setValue("cornerElevation",ka.cmToMeasureRaw(e.item.elevation))}),Za.floorplanner.addFloorplanListener(Lt,function(e){Bg.hide(),Cg.show(),Dg.hide(),Bb.showControl("Delete"),Cg.setValue("wallThickness",ka.cmToMeasureRaw(e.item.thickness))}),Za.floorplanner.addFloorplanListener(Mt,function(e){Bg.hide(),Cg.hide(),Dg.show(),Dg.setValue("roomName",e.item.name)}),Za.roomplanner.addRoomplanListener(Xl,function(e){Sb.hide(),Zb.hide();var r=e.itemModel;Ce&&(Ce.destroy(),Ce=null),r.isParametric&&(Ce=new Wja(r.parametricClass,Za.roomplanner))}),Za.roomplanner.addRoomplanListener(pp,function(){Sb.hide(),Zb.hide(),Ce&&(Ce.destroy(),Ce=null)}),Za.roomplanner.addRoomplanListener(rp,function(e){Sb.show(),Zb.hide(),Ce&&(Ce.destroy(),Ce=null)}),Za.roomplanner.addRoomplanListener(sp,function(e){Sb.hide(),Zb.show(),Ce&&(Ce.destroy(),Ce=null)}),Za.roomplanner.addRoomplanListener(UB,function(e){var r=e.gltf,o=window.document.createElement("a"),$=new Blob([r],{type:"text"});o.href=window.URL.createObjectURL($),o.download="design.gltf",document.body.appendChild(o),o.click(),document.body.removeChild(o)}),Za.model.loadSerialized($ja),yI.widget||(Vc=Eg.d.create(0,0,"BlueprintJS",Kd),Bb=Eg.d.create(0,0,"Viewer 2D",Kd),Bg=Eg.d.create(0,0,"Corner",Kd),Cg=Eg.d.create(0,0,"Wall",Kd),Dg=Eg.d.create(0,0,"Room",Kd),Th=Eg.d.create(0,0,"Viewer 3D",Kd),Sb=Eg.d.create(0,0,"Wall",Kd),Zb=Eg.d.create(0,0,"Room",Kd),Vc.addButton("Switch Viewer",bka),Vc.addHTML("Current View","Floorplanning"),Vc.addFileChooser("Load Design","Load Design",".blueprint3d",fka),Vc.addButton("Save Design",hka),Vc.addButton("Export as GLTF",ika),Vc.addButton("Export Project (blueprint-py)",jka),Vc.addButton("Reset",Za.model.reset.bind(Za.model)),Vc.addFileChooser("Load Locked Design","Load Locked Design",".blueprint3d",gka),Bb.addButton("Draw Mode",cka),Bb.addButton("Move Mode",dka),Bb.addButton("Transform Mode",eka),Bb.addButton("Delete",Ag.deleteCurrentItem.bind(Ag)),Bb.bindBoolean("snapToGrid",mc.snapToGrid,mc),Bb.bindBoolean("directionalDrag",mc.directionalDrag,mc),Bb.bindBoolean("dragOnlyX",mc.dragOnlyX,mc),Bb.bindBoolean("dragOnlyY",mc.dragOnlyY,mc),Bb.bindRange("snapTolerance",1,200,mc.snapTolerance,1,mc),Bb.bindRange("gridSpacing",10,200,mc.gridSpacing,1,mc),Bb.bindNumber("boundsX",1,200,mc.boundsX,1,mc),Bb.bindNumber("boundsY",1,200,mc.boundsY,1,mc),Bg.bindRange("cornerElevation",1,500,Ag.cornerElevation,1,Ag),Cg.bindRange("wallThickness",.01,1,Ag.wallThickness,.1,Ag),Dg.bindText("roomName",Ag.roomName,Ag),Zb.addDropDown("Floor Textures",wI,zI),Zb.addImage("Floor Texture:",dw[wI[0]].colormap,null),Zb.addButton("Apply",zI),Zb.addDropDown("All Wall Textures",Gq,Jq),Zb.addImage("All Wall Texture:",Fq[Gq[0]].colormap,null),Zb.addButton("Apply",Jq),Sb.addDropDown("Wall Textures",Gq,Jq),Sb.addImage("Wall Texture:",Fq[Gq[0]].colormap,null),Sb.addButton("Apply",Jq),Sb.addDropDown("Select Door",xI,_ja),Sb.addImage("Door Preview:",Iq[xI[0]].src,null),Sb.addButton("Add",aka),Th.addHTML("Tips:","<p>Click and drag to rotate the room in 360\xB0</p><p>Add room items <ul><li>Add parametric doors</li><li>Other items (Coming soon)</li></ul></p><p>Drag and Place items(pink boxes and parametric doors) in the room</p><p>There are 8 different types of items <ul><li>1: FloorItem</li> <li>2: WallItem</li> <li>3: InWallItem</li> <li>7: InWallFloorItem</li> <li>8: OnFloorItem</li> <li>9: WallFloorItem</li><li>0: Item</li> <li>4: RoofItem</li></ul></p>"),Vc.setWidth(hk),Vc.setHeight(cw),Bb.hideControl("Delete"),Bb.setWidth(hk),Th.setWidth(hk),Bb.setHeight(vI),Th.setHeight(vI),Vc.setPosition(Kd.clientWidth-hk,bw),Bb.setPosition(Kd.clientWidth-hk,bw+cw),Th.setPosition(Kd.clientWidth-hk,bw+cw),Bg.hide(),Cg.hide(),Dg.hide(),Th.hide(),Sb.hide(),Zb.hide());return{"Focm":{}};});